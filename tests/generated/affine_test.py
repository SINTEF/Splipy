# --- Automatic generated test file  ---
# Generator    : generate_affine.py
# Date         : 2016-02-10
# Git revision : ce198333cbf3bf3a7d964b947e07c74c43df1cdd

import numpy as np
from splipy import Volume, Surface, Curve, BSplineBasis
from math import sqrt
import unittest


class TestAffine(unittest.TestCase):
    def test_translate_curve_2D_p2_rational(self):
        controlpoints = np.array(
            [[-5.0, 2.0, 0.7], [21.0, 2.0, 1.2], [46.0, -3.0, 1.2], [78.0, 3.0, 0.9], [95.0, 4.0, 1.2]]
        )
        basis0 = BSplineBasis(2, np.array([0.0, 0.0, 1.3, 1.9, 3.3, 4.0, 4.0]))
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 += np.array([4.9, 4.7])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 4.900000
        pt2[..., 1] -= 4.700000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_2D_p3_rational(self):
        controlpoints = np.array(
            [[-5.0, -3.0, 1.1], [20.0, 4.0, 1.4], [51.0, 0.0, 0.6], [72.0, -1.0, 1.1], [99.0, 0.0, 1.3]]
        )
        basis0 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.2, 2.2, 3.0, 3.0, 3.0]))
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 *= np.array([8.7, 5.4])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 8.700000
        pt2[..., 1] /= 5.400000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_2D_p43_rational(self):
        controlpoints = np.array(
            [
                [2.0, -4.0, 1.3],
                [17.0, 3.0, 1.0],
                [27.0, 0.0, 0.9],
                [40.0, -3.0, 0.6],
                [57.0, -5.0, 1.3],
                [75.0, -4.0, 1.2],
                [85.0, 0.0, 1.1],
                [95.0, -3.0, 0.7],
                [-4.0, 21.0, 0.8],
                [18.0, 23.0, 0.9],
                [25.0, 28.0, 0.7],
                [38.0, 21.0, 1.4],
                [58.0, 25.0, 1.0],
                [74.0, 24.0, 1.5],
                [82.0, 26.0, 0.5],
                [100.0, 27.0, 1.4],
                [0.0, 45.0, 0.5],
                [10.0, 47.0, 1.2],
                [30.0, 45.0, 0.7],
                [42.0, 52.0, 0.7],
                [57.0, 52.0, 0.5],
                [71.0, 47.0, 0.9],
                [85.0, 45.0, 0.8],
                [97.0, 51.0, 1.0],
                [2.0, 75.0, 0.6],
                [18.0, 79.0, 0.7],
                [25.0, 78.0, 1.1],
                [46.0, 72.0, 1.2],
                [59.0, 71.0, 1.4],
                [76.0, 78.0, 0.8],
                [89.0, 77.0, 1.3],
                [95.0, 71.0, 1.4],
                [-1.0, 101.0, 1.3],
                [10.0, 95.0, 1.5],
                [25.0, 99.0, 1.4],
                [41.0, 97.0, 0.8],
                [53.0, 98.0, 1.4],
                [70.0, 101.0, 1.0],
                [84.0, 103.0, 0.8],
                [102.0, 102.0, 1.4],
            ]
        )
        basis0 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.1, 1.9, 3.3, 4.2, 5.0, 5.0, 5.0, 5.0]))
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.1, 2.3, 3.0, 3.0, 3.0]))
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 += np.array([4.6, 0.4])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 4.600000
        pt2[..., 1] -= 0.400000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_surface_2D_p33_rational(self):
        controlpoints = np.array(
            [
                [2.0, 1.0, 0.6],
                [21.0, 1.0, 0.8],
                [30.0, 4.0, 0.5],
                [51.0, -5.0, 0.9],
                [68.0, -4.0, 0.8],
                [82.0, -4.0, 1.2],
                [100.0, -1.0, 0.6],
                [-3.0, 21.0, 0.8],
                [13.0, 22.0, 0.7],
                [30.0, 22.0, 1.5],
                [49.0, 29.0, 0.6],
                [66.0, 24.0, 0.6],
                [86.0, 25.0, 1.4],
                [101.0, 21.0, 0.8],
                [4.0, 50.0, 0.7],
                [13.0, 45.0, 1.1],
                [35.0, 47.0, 0.8],
                [49.0, 47.0, 1.3],
                [71.0, 51.0, 0.6],
                [84.0, 50.0, 1.1],
                [99.0, 47.0, 0.8],
                [2.0, 70.0, 0.8],
                [11.0, 79.0, 1.1],
                [37.0, 73.0, 1.2],
                [54.0, 76.0, 1.4],
                [68.0, 77.0, 1.0],
                [80.0, 77.0, 1.3],
                [100.0, 76.0, 1.3],
                [-1.0, 97.0, 1.4],
                [21.0, 102.0, 1.3],
                [29.0, 95.0, 1.5],
                [45.0, 99.0, 0.9],
                [65.0, 99.0, 0.8],
                [88.0, 95.0, 0.8],
                [97.0, 99.0, 1.3],
            ]
        )
        basis0 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.1, 1.7, 3.1, 4.1, 5.0, 5.0, 5.0]))
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.2, 2.2, 3.0, 3.0, 3.0]))
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 *= np.array([3.5, 4.9])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 3.500000
        pt2[..., 1] /= 4.900000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_2D_p4_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [97.0, -4.0, 1.2],
                [72.0, 66.0, 1.1],
                [-4.0, 96.0, 1.4],
                [-69.0, 69.0, 1.0],
                [-100.0, 0.0, 1.0],
                [-70.0, -71.0, 1.0],
                [3.0, -99.0, 1.4],
                [66.0, -71.0, 0.6],
            ]
        )
        basis0 = BSplineBasis(
            4, np.array([-1.4, 0.0, 0.0, 0.0, 1.1, 2.3, 3.2, 4.2, 4.6, 6.0, 6.0, 6.0, 7.1]), 0
        )
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 += np.array([4.8, 9.5, 8.3])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 4.800000
        pt2[..., 1] -= 9.500000
        pt2[..., 2] -= 8.300000
        allZero = pt2
        allZero[..., :-1] -= pt
        self.assertAlmostEqual(np.linalg.norm(allZero), 0.0)

    def test_scale_curve_2D_p3_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [97.0, -1.0, 1.4],
                [67.0, 74.0, 1.1],
                [0.0, 95.0, 0.6],
                [-76.0, 69.0, 1.1],
                [-96.0, -2.0, 1.4],
                [-72.0, -67.0, 1.4],
                [-4.0, -100.0, 1.4],
                [67.0, -68.0, 0.7],
            ]
        )
        basis0 = BSplineBasis(3, np.array([-0.8, 0.0, 0.0, 1.2, 1.7, 2.8, 3.9, 5.1, 6.2, 7.0, 7.0, 8.2]), 0)
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 *= np.array([5.4, 2.6])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 5.400000
        pt2[..., 1] /= 2.600000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_2D_p22_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [64.0, 2.0, 0.8],
                [-32.0, 51.0, 1.0],
                [-26.0, -54.0, 1.2],
                [73.0, 4.0, 0.8],
                [-38.0, 66.0, 0.9],
                [-34.0, -62.0, 1.5],
                [90.0, -3.0, 0.8],
                [-40.0, 75.0, 1.1],
                [-47.0, -71.0, 1.0],
                [99.0, -1.0, 1.4],
                [-52.0, 84.0, 1.3],
                [-48.0, -85.0, 1.3],
            ]
        )
        basis0 = BSplineBasis(2, np.array([-1.2, 0.0, 0.6, 1.8, 3.0, 3.6]), 0)
        basis1 = BSplineBasis(2, np.array([0.0, 0.0, 0.9, 2.0, 3.0, 3.0]))
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 += np.array([4.7, 9.4])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 4.700000
        pt2[..., 1] -= 9.400000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_surface_2D_p33_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [59.0, 0.0, 0.6],
                [16.0, 55.0, 1.4],
                [-49.0, 30.0, 1.0],
                [-53.0, -31.0, 1.5],
                [15.0, -55.0, 1.2],
                [66.0, 4.0, 0.7],
                [17.0, 59.0, 1.5],
                [-50.0, 38.0, 0.9],
                [-52.0, -44.0, 0.7],
                [22.0, -64.0, 0.9],
                [70.0, -4.0, 1.0],
                [18.0, 68.0, 0.6],
                [-65.0, 39.0, 0.9],
                [-55.0, -45.0, 1.1],
                [27.0, -66.0, 1.1],
                [81.0, 4.0, 1.2],
                [22.0, 74.0, 0.7],
                [-64.0, 48.0, 1.2],
                [-67.0, -51.0, 0.7],
                [21.0, -75.0, 0.6],
                [88.0, -1.0, 0.6],
                [28.0, 83.0, 1.5],
                [-69.0, 50.0, 1.5],
                [-66.0, -55.0, 0.9],
                [25.0, -88.0, 1.1],
                [93.0, 0.0, 0.8],
                [26.0, 88.0, 1.0],
                [-81.0, 55.0, 0.6],
                [-80.0, -59.0, 1.3],
                [24.0, -92.0, 1.0],
                [99.0, 3.0, 0.8],
                [27.0, 93.0, 1.4],
                [-83.0, 57.0, 1.2],
                [-81.0, -59.0, 1.3],
                [28.0, -93.0, 1.2],
            ]
        )
        basis0 = BSplineBasis(3, np.array([-1.1, 0.0, 0.0, 0.9, 2.2, 2.9, 4.0, 4.0, 4.9]), 0)
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.4, 1.6, 2.7, 4.4, 5.0, 5.0, 5.0]))
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 *= np.array([4.3, 7.2])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 4.300000
        pt2[..., 1] /= 7.200000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_2D_p3_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [104.0, -3.0, 0.6],
                [65.0, 74.0, 0.7],
                [-22.0, 95.0, 1.0],
                [-88.0, 42.0, 0.7],
                [-94.0, -43.0, 1.3],
                [-22.0, -99.0, 0.7],
                [59.0, -79.0, 0.7],
            ]
        )
        basis0 = BSplineBasis(3, np.array([-2.1, -0.7, 0.0, 0.7, 1.8, 2.9, 4.1, 4.9, 6.3, 7.0, 7.7, 8.8]), 1)
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 += np.array([1.8, 5.4])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 1.800000
        pt2[..., 1] -= 5.400000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_2D_p3_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [101.0, -1.0, 1.4],
                [69.0, 71.0, 0.7],
                [0.0, 103.0, 1.4],
                [-69.0, 75.0, 1.1],
                [-96.0, 2.0, 1.4],
                [-67.0, -71.0, 0.7],
                [0.0, -102.0, 1.2],
                [74.0, -67.0, 1.2],
            ]
        )
        basis0 = BSplineBasis(
            3, np.array([-2.1, -0.7, 0.0, 1.2, 1.7, 3.3, 4.2, 5.3, 5.9, 7.3, 8.0, 9.2, 9.7]), 1
        )
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 *= np.array([5.3, 7.4])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 5.300000
        pt2[..., 1] /= 7.400000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_2D_p32_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [59.0, 1.0, 0.6],
                [13.0, 58.0, 0.7],
                [-47.0, 38.0, 1.3],
                [-48.0, -37.0, 0.8],
                [18.0, -61.0, 1.4],
                [68.0, -4.0, 0.7],
                [20.0, 60.0, 0.8],
                [-57.0, 37.0, 1.2],
                [-58.0, -41.0, 1.0],
                [16.0, -69.0, 0.8],
                [80.0, -2.0, 1.1],
                [26.0, 68.0, 0.6],
                [-59.0, 48.0, 0.6],
                [-62.0, -47.0, 0.7],
                [25.0, -78.0, 1.0],
                [87.0, -5.0, 1.4],
                [23.0, 83.0, 0.8],
                [-67.0, 47.0, 1.0],
                [-68.0, -50.0, 0.8],
                [27.0, -79.0, 1.4],
                [94.0, 3.0, 1.0],
                [28.0, 92.0, 1.3],
                [-76.0, 49.0, 1.1],
                [-78.0, -54.0, 0.6],
                [32.0, -88.0, 1.0],
                [98.0, -1.0, 1.0],
                [26.0, 96.0, 1.0],
                [-80.0, 54.0, 0.8],
                [-80.0, -57.0, 1.1],
                [28.0, -93.0, 1.5],
            ]
        )
        basis0 = BSplineBasis(3, np.array([-1.8, -0.9, 0.0, 1.4, 1.7, 3.2, 4.1, 5.0, 6.4, 6.7]), 1)
        basis1 = BSplineBasis(2, np.array([0.0, 0.0, 0.9, 2.3, 3.4, 4.3, 5.0, 5.0]))
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 += np.array([3.3, 5.5])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 3.300000
        pt2[..., 1] -= 5.500000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_surface_2D_p43_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [55.0, 3.0, 1.5],
                [19.0, 53.0, 1.5],
                [-46.0, 35.0, 1.0],
                [-45.0, -35.0, 0.7],
                [22.0, -56.0, 1.4],
                [72.0, 1.0, 1.3],
                [18.0, 71.0, 1.0],
                [-60.0, 38.0, 0.8],
                [-65.0, -47.0, 1.4],
                [17.0, -66.0, 1.3],
                [83.0, 4.0, 1.2],
                [22.0, 83.0, 1.2],
                [-74.0, 55.0, 1.4],
                [-66.0, -52.0, 0.6],
                [26.0, -83.0, 0.5],
                [103.0, -1.0, 0.6],
                [32.0, 96.0, 0.6],
                [-85.0, 58.0, 1.4],
                [-79.0, -56.0, 0.9],
                [31.0, -99.0, 0.8],
            ]
        )
        basis0 = BSplineBasis(4, np.array([-2.0, -0.8, 0.0, 0.0, 1.3, 2.0, 3.2, 4.0, 4.0, 5.3, 6.0]), 1)
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 0.9, 2.0, 2.0, 2.0]))
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 *= np.array([3.7, 3.3])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 3.700000
        pt2[..., 1] /= 3.300000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_2D_p4(self):
        controlpoints = np.array(
            [[-2.0, 1.0], [16.0, -1.0], [31.0, -2.0], [45.0, -3.0], [63.0, 1.0], [87.0, -2.0], [103.0, -4.0]]
        )
        basis0 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.2, 2.2, 3.1, 4.0, 4.0, 4.0, 4.0]))
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 += np.array([1.9, 4.2])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 1.900000
        pt2[..., 1] -= 4.200000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_2D_p4(self):
        controlpoints = np.array(
            [[-3.0, -4.0], [20.0, -3.0], [28.0, 2.0], [54.0, 1.0], [67.0, 0.0], [80.0, 2.0], [104.0, -3.0]]
        )
        basis0 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.2, 1.7, 2.8, 4.0, 4.0, 4.0, 4.0]))
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 *= np.array([2.2, 8.1])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 2.200000
        pt2[..., 1] /= 8.100000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_2D_p34(self):
        controlpoints = np.array(
            [
                [-5.0, -1.0],
                [9.0, -5.0],
                [30.0, -1.0],
                [44.0, -4.0],
                [53.0, 1.0],
                [72.0, -3.0],
                [82.0, 4.0],
                [101.0, 4.0],
                [-4.0, 19.0],
                [14.0, 16.0],
                [28.0, 21.0],
                [45.0, 19.0],
                [59.0, 15.0],
                [71.0, 19.0],
                [82.0, 24.0],
                [104.0, 23.0],
                [0.0, 37.0],
                [13.0, 40.0],
                [27.0, 44.0],
                [42.0, 36.0],
                [59.0, 38.0],
                [72.0, 39.0],
                [85.0, 43.0],
                [97.0, 38.0],
                [-1.0, 57.0],
                [9.0, 56.0],
                [24.0, 55.0],
                [42.0, 61.0],
                [57.0, 59.0],
                [75.0, 62.0],
                [89.0, 57.0],
                [95.0, 58.0],
                [-3.0, 81.0],
                [16.0, 84.0],
                [25.0, 81.0],
                [40.0, 77.0],
                [56.0, 75.0],
                [71.0, 84.0],
                [82.0, 83.0],
                [97.0, 80.0],
                [1.0, 100.0],
                [16.0, 103.0],
                [24.0, 100.0],
                [43.0, 95.0],
                [55.0, 96.0],
                [72.0, 95.0],
                [83.0, 96.0],
                [101.0, 102.0],
            ]
        )
        basis0 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.1, 1.8, 2.6, 4.4, 4.6, 6.0, 6.0, 6.0]))
        basis1 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 0.6, 1.9, 3.0, 3.0, 3.0, 3.0]))
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 += np.array([0.4, 1.8])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 0.400000
        pt2[..., 1] -= 1.800000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_surface_2D_p44(self):
        controlpoints = np.array(
            [
                [2.0, -4.0],
                [20.0, 3.0],
                [50.0, 2.0],
                [72.0, -4.0],
                [95.0, -5.0],
                [-3.0, 20.0],
                [29.0, 17.0],
                [50.0, 14.0],
                [71.0, 13.0],
                [99.0, 20.0],
                [0.0, 38.0],
                [23.0, 37.0],
                [45.0, 29.0],
                [71.0, 35.0],
                [99.0, 35.0],
                [-5.0, 52.0],
                [25.0, 49.0],
                [54.0, 45.0],
                [74.0, 48.0],
                [98.0, 49.0],
                [-4.0, 64.0],
                [23.0, 63.0],
                [46.0, 64.0],
                [79.0, 63.0],
                [97.0, 69.0],
                [0.0, 79.0],
                [25.0, 88.0],
                [47.0, 86.0],
                [76.0, 87.0],
                [96.0, 78.0],
                [-4.0, 104.0],
                [29.0, 103.0],
                [48.0, 98.0],
                [77.0, 95.0],
                [96.0, 96.0],
            ]
        )
        basis0 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 2.0, 2.0, 2.0]))
        basis1 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.2, 1.9, 2.6, 4.0, 4.0, 4.0, 4.0]))
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 *= np.array([7.9, 9.3])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 7.900000
        pt2[..., 1] /= 9.300000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_2D_p2_C0_periodic(self):
        controlpoints = np.array([[97.0, 2.0], [31.0, 98.0], [-77.0, 61.0], [-78.0, -62.0], [31.0, -91.0]])
        basis0 = BSplineBasis(2, np.array([-0.9, 0.0, 0.8, 2.0, 2.8, 4.1, 5.0, 5.8]), 0)
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 += np.array([0.5, 8.6])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 0.500000
        pt2[..., 1] -= 8.600000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_2D_p3_C0_periodic(self):
        controlpoints = np.array([[102.0, 1.0], [-4.0, 102.0], [-98.0, -3.0], [3.0, -101.0]])
        basis0 = BSplineBasis(3, np.array([-0.8, 0.0, 0.0, 0.8, 2.2, 3.0, 3.0, 3.8]), 0)
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 *= np.array([11.0, 3.1])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 11.000000
        pt2[..., 1] /= 3.100000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_2D_p24_C0_periodic(self):
        controlpoints = np.array(
            [
                [62.0, -5.0],
                [34.0, 47.0],
                [-13.0, 55.0],
                [-50.0, 25.0],
                [-56.0, -25.0],
                [-12.0, -63.0],
                [40.0, -47.0],
                [71.0, 0.0],
                [38.0, 52.0],
                [-13.0, 63.0],
                [-64.0, 28.0],
                [-58.0, -29.0],
                [-19.0, -63.0],
                [45.0, -52.0],
                [75.0, 4.0],
                [51.0, 55.0],
                [-19.0, 76.0],
                [-67.0, 30.0],
                [-67.0, -29.0],
                [-13.0, -72.0],
                [46.0, -63.0],
                [85.0, 3.0],
                [51.0, 61.0],
                [-24.0, 82.0],
                [-75.0, 37.0],
                [-80.0, -40.0],
                [-23.0, -84.0],
                [54.0, -70.0],
                [91.0, 4.0],
                [58.0, 75.0],
                [-17.0, 93.0],
                [-83.0, 36.0],
                [-87.0, -37.0],
                [-17.0, -86.0],
                [60.0, -72.0],
                [104.0, -3.0],
                [66.0, 78.0],
                [-18.0, 102.0],
                [-91.0, 48.0],
                [-95.0, -46.0],
                [-19.0, -94.0],
                [59.0, -76.0],
            ]
        )
        basis0 = BSplineBasis(2, np.array([-1.1, 0.0, 1.4, 2.1, 3.2, 3.9, 4.8, 5.9, 7.0, 8.4]), 0)
        basis1 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.3, 1.7, 3.0, 3.0, 3.0, 3.0]))
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 += np.array([8.6, 5.9])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 8.600000
        pt2[..., 1] -= 5.900000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_surface_2D_p34_C0_periodic(self):
        controlpoints = np.array(
            [
                [63.0, -1.0],
                [42.0, 48.0],
                [-18.0, 55.0],
                [-50.0, 25.0],
                [-53.0, -29.0],
                [-15.0, -64.0],
                [38.0, -49.0],
                [64.0, -1.0],
                [45.0, 49.0],
                [-21.0, 70.0],
                [-66.0, 32.0],
                [-60.0, -33.0],
                [-17.0, -66.0],
                [41.0, -55.0],
                [78.0, -4.0],
                [48.0, 60.0],
                [-22.0, 70.0],
                [-73.0, 30.0],
                [-70.0, -36.0],
                [-19.0, -74.0],
                [46.0, -62.0],
                [84.0, 4.0],
                [49.0, 67.0],
                [-16.0, 77.0],
                [-77.0, 35.0],
                [-76.0, -33.0],
                [-20.0, -84.0],
                [48.0, -62.0],
                [91.0, 0.0],
                [54.0, 70.0],
                [-23.0, 86.0],
                [-79.0, 40.0],
                [-80.0, -44.0],
                [-25.0, -95.0],
                [52.0, -69.0],
                [101.0, 3.0],
                [61.0, 73.0],
                [-26.0, 97.0],
                [-95.0, 48.0],
                [-93.0, -48.0],
                [-21.0, -101.0],
                [59.0, -77.0],
            ]
        )
        basis0 = BSplineBasis(3, np.array([-1.3, 0.0, 0.0, 1.2, 2.0, 2.8, 3.9, 4.7, 6.0, 6.0, 7.2]), 0)
        basis1 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.0, 1.9, 3.0, 3.0, 3.0, 3.0]))
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 *= np.array([3.1, 5.3])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 3.100000
        pt2[..., 1] /= 5.300000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_2D_p4_C1_periodic(self):
        controlpoints = np.array(
            [
                [104.0, -5.0],
                [73.0, 65.0],
                [3.0, 101.0],
                [-67.0, 70.0],
                [-105.0, 0.0],
                [-76.0, -74.0],
                [4.0, -98.0],
                [68.0, -73.0],
            ]
        )
        basis0 = BSplineBasis(
            4, np.array([-2.2, -0.6, 0.0, 0.0, 0.7, 2.0, 2.9, 4.3, 4.8, 6.4, 7.0, 7.0, 7.7, 9.0]), 1
        )
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 += np.array([4.7, 0.3])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 4.700000
        pt2[..., 1] -= 0.300000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_2D_p43_C1_periodic(self):
        controlpoints = np.array(
            [
                [56.0, 2.0],
                [17.0, 61.0],
                [-45.0, 31.0],
                [-48.0, -39.0],
                [17.0, -61.0],
                [74.0, 1.0],
                [21.0, 67.0],
                [-57.0, 41.0],
                [-61.0, -43.0],
                [23.0, -68.0],
                [79.0, -2.0],
                [22.0, 72.0],
                [-63.0, 46.0],
                [-61.0, -47.0],
                [23.0, -75.0],
                [89.0, -2.0],
                [23.0, 87.0],
                [-70.0, 49.0],
                [-78.0, -54.0],
                [23.0, -86.0],
                [95.0, -2.0],
                [30.0, 98.0],
                [-84.0, 57.0],
                [-83.0, -61.0],
                [34.0, -99.0],
            ]
        )
        basis0 = BSplineBasis(4, np.array([-2.4, -0.7, 0.0, 0.0, 1.3, 1.6, 3.3, 4.0, 4.0, 5.3, 5.6]), 1)
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.0, 2.2, 3.0, 3.0, 3.0]))
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 += np.array([8.6, 0.1])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 8.600000
        pt2[..., 1] -= 0.100000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_surface_2D_p33_C1_periodic(self):
        controlpoints = np.array(
            [
                [60.0, 0.0],
                [17.0, 60.0],
                [-53.0, 31.0],
                [-45.0, -33.0],
                [16.0, -55.0],
                [77.0, -4.0],
                [25.0, 69.0],
                [-60.0, 39.0],
                [-56.0, -46.0],
                [25.0, -65.0],
                [82.0, 4.0],
                [25.0, 85.0],
                [-70.0, 51.0],
                [-70.0, -47.0],
                [27.0, -80.0],
                [102.0, 2.0],
                [32.0, 91.0],
                [-79.0, 55.0],
                [-79.0, -60.0],
                [29.0, -93.0],
            ]
        )
        basis0 = BSplineBasis(3, np.array([-2.4, -0.6, 0.0, 0.7, 2.2, 2.6, 4.4, 5.0, 5.7, 7.2]), 1)
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 0.9, 2.0, 2.0, 2.0]))
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 *= np.array([3.1, 8.4])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 3.100000
        pt2[..., 1] /= 8.400000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_3D_p3_rational(self):
        controlpoints = np.array(
            [
                [0.0, -4.0, 4.0, 1.3],
                [15.0, 3.0, -4.0, 1.1],
                [43.0, 1.0, 1.0, 0.9],
                [64.0, -2.0, -3.0, 0.7],
                [80.0, -3.0, 4.0, 0.9],
                [97.0, 2.0, 0.0, 0.9],
            ]
        )
        basis0 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 0.9, 2.2, 3.1, 4.0, 4.0, 4.0]))
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 += np.array([5.6, 5.7, 2.2])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 5.600000
        pt2[..., 1] -= 5.700000
        pt2[..., 2] -= 2.200000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_3D_p4_rational(self):
        controlpoints = np.array(
            [
                [2.0, 4.0, -3.0, 1.1],
                [17.0, 4.0, -2.0, 0.8],
                [30.0, -1.0, -4.0, 0.6],
                [41.0, 3.0, -4.0, 1.3],
                [54.0, 4.0, 2.0, 0.8],
                [67.0, 2.0, -3.0, 1.0],
                [86.0, -4.0, 3.0, 0.7],
                [102.0, 2.0, -4.0, 1.2],
            ]
        )
        basis0 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.0, 2.1, 2.8, 3.7, 5.0, 5.0, 5.0, 5.0]))
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 *= np.array([9.5, 11.0, 2.1])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 9.500000
        pt2[..., 1] /= 11.000000
        pt2[..., 2] /= 2.100000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_curve_3D_p3_rational(self):
        controlpoints = np.array(
            [
                [-4.0, 3.0, 1.0, 0.7],
                [21.0, -4.0, -4.0, 0.9],
                [47.0, 4.0, -3.0, 1.4],
                [70.0, -5.0, -1.0, 0.8],
                [103.0, -4.0, -5.0, 1.4],
            ]
        )
        basis0 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 0.8, 1.8, 3.0, 3.0, 3.0]))
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2.mirror([0, 0, 1])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 2] = -pt2[..., 2]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_3D_p44_rational(self):
        controlpoints = np.array(
            [
                [0.0, 1.0, -1.0, 1.2],
                [17.0, -1.0, 2.0, 1.0],
                [41.0, -2.0, -2.0, 0.9],
                [64.0, 4.0, -2.0, 0.7],
                [84.0, -1.0, 1.0, 1.3],
                [98.0, 4.0, -4.0, 1.4],
                [-4.0, 10.0, 1.0, 1.0],
                [21.0, 10.0, -4.0, 1.0],
                [40.0, 10.0, -1.0, 1.2],
                [64.0, 17.0, -5.0, 1.0],
                [80.0, 16.0, 4.0, 1.1],
                [99.0, 15.0, -4.0, 0.6],
                [-4.0, 29.0, 3.0, 1.4],
                [23.0, 24.0, -3.0, 1.4],
                [44.0, 30.0, 0.0, 1.2],
                [61.0, 30.0, 0.0, 1.3],
                [76.0, 29.0, 3.0, 1.5],
                [99.0, 30.0, 3.0, 0.5],
                [2.0, 47.0, 4.0, 1.5],
                [23.0, 37.0, -2.0, 1.0],
                [35.0, 39.0, 3.0, 0.8],
                [57.0, 41.0, -4.0, 1.3],
                [81.0, 42.0, -4.0, 0.6],
                [102.0, 47.0, -1.0, 1.5],
                [0.0, 59.0, 4.0, 0.9],
                [18.0, 62.0, -4.0, 0.6],
                [39.0, 60.0, -2.0, 0.7],
                [64.0, 55.0, 3.0, 1.2],
                [81.0, 57.0, 1.0, 0.7],
                [97.0, 58.0, -4.0, 1.3],
                [4.0, 74.0, 2.0, 0.6],
                [17.0, 69.0, -5.0, 1.1],
                [36.0, 76.0, 4.0, 1.3],
                [57.0, 76.0, -3.0, 1.4],
                [79.0, 69.0, -3.0, 0.6],
                [104.0, 70.0, -1.0, 0.6],
                [-1.0, 83.0, -2.0, 1.4],
                [16.0, 86.0, -3.0, 1.4],
                [38.0, 83.0, 0.0, 0.8],
                [56.0, 87.0, -3.0, 1.0],
                [75.0, 81.0, -5.0, 1.5],
                [104.0, 89.0, 4.0, 1.4],
                [-5.0, 99.0, -3.0, 0.7],
                [15.0, 96.0, 1.0, 1.3],
                [41.0, 104.0, 4.0, 0.9],
                [64.0, 95.0, 4.0, 0.8],
                [77.0, 100.0, -1.0, 1.0],
                [97.0, 96.0, -4.0, 1.0],
            ]
        )
        basis0 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.3, 1.8, 3.0, 3.0, 3.0, 3.0]))
        basis1 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 0.7, 1.8, 3.3, 4.1, 5.0, 5.0, 5.0, 5.0]))
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 += np.array([3.7, 2.6, 9.4])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 3.700000
        pt2[..., 1] -= 2.600000
        pt2[..., 2] -= 9.400000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_surface_3D_p43_rational(self):
        controlpoints = np.array(
            [
                [-5.0, 2.0, 2.0, 0.9],
                [16.0, -3.0, 3.0, 0.7],
                [26.0, -2.0, 1.0, 1.3],
                [40.0, -2.0, -5.0, 0.5],
                [52.0, 3.0, 3.0, 1.2],
                [67.0, -3.0, -3.0, 0.6],
                [88.0, -1.0, -2.0, 1.4],
                [95.0, 3.0, 0.0, 0.5],
                [4.0, 18.0, -5.0, 1.2],
                [15.0, 20.0, 1.0, 0.6],
                [32.0, 15.0, 2.0, 0.6],
                [46.0, 14.0, 4.0, 1.1],
                [56.0, 18.0, 3.0, 0.7],
                [67.0, 14.0, -5.0, 0.9],
                [88.0, 14.0, -4.0, 0.6],
                [98.0, 21.0, -3.0, 0.9],
                [-4.0, 36.0, -3.0, 1.2],
                [16.0, 34.0, -5.0, 1.3],
                [27.0, 37.0, -5.0, 0.7],
                [43.0, 36.0, -3.0, 1.0],
                [55.0, 30.0, 2.0, 0.8],
                [67.0, 33.0, 4.0, 0.8],
                [83.0, 33.0, 4.0, 0.6],
                [102.0, 35.0, -1.0, 0.7],
                [1.0, 47.0, -2.0, 0.5],
                [12.0, 48.0, 2.0, 0.7],
                [26.0, 49.0, 1.0, 1.3],
                [45.0, 49.0, -2.0, 1.2],
                [58.0, 46.0, 3.0, 0.6],
                [74.0, 46.0, -2.0, 1.4],
                [88.0, 54.0, -5.0, 1.5],
                [97.0, 47.0, -2.0, 1.1],
                [0.0, 67.0, 0.0, 1.4],
                [11.0, 66.0, 1.0, 1.2],
                [31.0, 65.0, -3.0, 0.5],
                [47.0, 68.0, -2.0, 1.3],
                [59.0, 69.0, 0.0, 1.1],
                [71.0, 69.0, -4.0, 1.2],
                [89.0, 66.0, -1.0, 0.7],
                [102.0, 63.0, -1.0, 0.6],
                [3.0, 79.0, 2.0, 1.3],
                [12.0, 78.0, -2.0, 0.6],
                [33.0, 87.0, -1.0, 0.6],
                [41.0, 82.0, 2.0, 0.6],
                [54.0, 84.0, -3.0, 1.0],
                [66.0, 81.0, 2.0, 1.3],
                [85.0, 85.0, -2.0, 1.3],
                [103.0, 80.0, 4.0, 0.8],
                [4.0, 98.0, 0.0, 1.0],
                [18.0, 102.0, 2.0, 0.6],
                [30.0, 95.0, -2.0, 0.8],
                [42.0, 97.0, -4.0, 1.3],
                [60.0, 99.0, -3.0, 1.5],
                [73.0, 103.0, 4.0, 1.3],
                [90.0, 100.0, 3.0, 0.7],
                [102.0, 100.0, -5.0, 0.8],
            ]
        )
        basis0 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.3, 2.4, 3.3, 4.3, 5.0, 5.0, 5.0, 5.0]))
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 0.6, 2.2, 3.4, 3.7, 5.0, 5.0, 5.0]))
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 *= np.array([3.2, 11.4, 10.3])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 3.200000
        pt2[..., 1] /= 11.400000
        pt2[..., 2] /= 10.300000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_surface_3D_p33_rational(self):
        controlpoints = np.array(
            [
                [-2.0, 3.0, -5.0, 1.2],
                [30.0, 2.0, 0.0, 0.6],
                [70.0, 0.0, 4.0, 0.7],
                [103.0, 4.0, -1.0, 1.1],
                [-1.0, 12.0, -1.0, 0.7],
                [34.0, 12.0, 4.0, 1.1],
                [62.0, 14.0, 1.0, 1.1],
                [102.0, 16.0, 3.0, 0.7],
                [2.0, 33.0, -5.0, 0.7],
                [34.0, 33.0, 2.0, 0.6],
                [64.0, 32.0, -3.0, 1.0],
                [96.0, 29.0, 0.0, 1.3],
                [-4.0, 54.0, 3.0, 1.3],
                [34.0, 49.0, 1.0, 1.0],
                [66.0, 53.0, -1.0, 1.1],
                [101.0, 54.0, -1.0, 0.9],
                [-4.0, 66.0, 3.0, 1.0],
                [30.0, 63.0, -5.0, 0.6],
                [67.0, 66.0, 2.0, 0.8],
                [101.0, 62.0, 4.0, 1.4],
                [3.0, 84.0, -5.0, 1.5],
                [33.0, 81.0, 0.0, 0.6],
                [64.0, 84.0, -4.0, 0.8],
                [102.0, 87.0, -3.0, 0.9],
                [0.0, 95.0, -1.0, 0.7],
                [29.0, 103.0, 1.0, 0.6],
                [67.0, 95.0, 4.0, 0.6],
                [96.0, 95.0, 2.0, 0.7],
            ]
        )
        basis0 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 0.7, 2.0, 2.0, 2.0]))
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.2, 1.7, 2.7, 4.3, 5.0, 5.0, 5.0]))
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2.mirror([0, 3, 0])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 1] = -pt2[..., 1]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_volume_3D_p342_rational(self):
        controlpoints = np.array(
            [
                [4.0, -4.0, -2.0, 1.4],
                [15.0, 2.0, -3.0, 1.4],
                [34.0, 3.0, 1.0, 0.5],
                [50.0, 3.0, -4.0, 1.1],
                [69.0, 1.0, -5.0, 0.9],
                [83.0, 0.0, -1.0, 0.6],
                [98.0, 3.0, 2.0, 0.7],
                [2.0, 10.0, -5.0, 0.5],
                [21.0, 7.0, 2.0, 0.8],
                [30.0, 8.0, -4.0, 1.1],
                [47.0, 13.0, -1.0, 0.6],
                [68.0, 13.0, -3.0, 0.8],
                [84.0, 15.0, -4.0, 1.5],
                [95.0, 12.0, -4.0, 1.0],
                [-2.0, 25.0, 4.0, 1.4],
                [15.0, 27.0, 0.0, 0.6],
                [31.0, 26.0, 2.0, 1.3],
                [52.0, 28.0, 3.0, 0.9],
                [63.0, 23.0, 3.0, 0.9],
                [79.0, 20.0, -5.0, 1.3],
                [99.0, 20.0, 1.0, 1.2],
                [1.0, 35.0, -5.0, 1.5],
                [19.0, 34.0, 3.0, 1.5],
                [32.0, 37.0, 4.0, 1.4],
                [51.0, 35.0, -4.0, 1.4],
                [66.0, 40.0, -3.0, 1.2],
                [81.0, 37.0, 4.0, 1.0],
                [97.0, 41.0, 3.0, 1.4],
                [-1.0, 50.0, 1.0, 0.6],
                [13.0, 46.0, 1.0, 0.8],
                [36.0, 52.0, -5.0, 0.8],
                [50.0, 53.0, -3.0, 1.4],
                [70.0, 50.0, 3.0, 1.4],
                [79.0, 52.0, 1.0, 0.8],
                [100.0, 53.0, 4.0, 1.2],
                [-5.0, 59.0, 2.0, 1.1],
                [21.0, 60.0, -5.0, 0.7],
                [35.0, 60.0, -2.0, 0.6],
                [52.0, 66.0, 0.0, 0.8],
                [69.0, 58.0, 1.0, 1.0],
                [83.0, 61.0, -5.0, 0.8],
                [101.0, 63.0, 3.0, 0.9],
                [-1.0, 71.0, 3.0, 0.8],
                [13.0, 79.0, -4.0, 0.6],
                [35.0, 72.0, -3.0, 0.6],
                [48.0, 75.0, -3.0, 0.9],
                [70.0, 71.0, 3.0, 0.6],
                [79.0, 73.0, -3.0, 1.4],
                [95.0, 72.0, -2.0, 0.6],
                [2.0, 91.0, -1.0, 1.4],
                [20.0, 89.0, -5.0, 0.8],
                [37.0, 89.0, 1.0, 1.1],
                [46.0, 91.0, 2.0, 1.2],
                [66.0, 89.0, 4.0, 0.7],
                [78.0, 85.0, 1.0, 1.2],
                [95.0, 91.0, 1.0, 0.7],
                [3.0, 104.0, 3.0, 1.5],
                [13.0, 99.0, -5.0, 1.1],
                [37.0, 102.0, 2.0, 1.2],
                [53.0, 98.0, -2.0, 1.4],
                [65.0, 103.0, 1.0, 1.4],
                [87.0, 103.0, 4.0, 1.0],
                [96.0, 104.0, -4.0, 0.7],
                [1.0, 1.0, 25.0, 1.3],
                [21.0, -3.0, 20.0, 0.9],
                [32.0, -4.0, 20.0, 0.9],
                [46.0, 4.0, 22.0, 0.9],
                [69.0, -4.0, 25.0, 0.8],
                [86.0, 4.0, 26.0, 1.4],
                [95.0, 0.0, 23.0, 1.3],
                [-2.0, 10.0, 26.0, 1.2],
                [14.0, 9.0, 28.0, 1.4],
                [35.0, 14.0, 23.0, 0.6],
                [51.0, 11.0, 27.0, 0.8],
                [68.0, 16.0, 23.0, 1.5],
                [79.0, 8.0, 29.0, 1.2],
                [97.0, 14.0, 21.0, 1.1],
                [4.0, 27.0, 22.0, 0.8],
                [16.0, 20.0, 27.0, 1.1],
                [38.0, 20.0, 21.0, 1.1],
                [52.0, 23.0, 20.0, 1.0],
                [65.0, 29.0, 28.0, 1.0],
                [81.0, 23.0, 21.0, 0.8],
                [104.0, 26.0, 25.0, 1.3],
                [0.0, 41.0, 27.0, 1.2],
                [21.0, 42.0, 28.0, 1.2],
                [37.0, 34.0, 26.0, 0.8],
                [47.0, 40.0, 25.0, 0.7],
                [63.0, 34.0, 23.0, 1.4],
                [82.0, 38.0, 24.0, 1.2],
                [102.0, 39.0, 24.0, 0.8],
                [1.0, 48.0, 20.0, 1.0],
                [15.0, 52.0, 23.0, 0.7],
                [34.0, 45.0, 23.0, 1.4],
                [53.0, 54.0, 24.0, 0.9],
                [63.0, 50.0, 26.0, 0.9],
                [84.0, 51.0, 21.0, 1.2],
                [102.0, 50.0, 25.0, 1.3],
                [0.0, 61.0, 24.0, 1.1],
                [19.0, 58.0, 25.0, 0.6],
                [30.0, 62.0, 26.0, 0.6],
                [50.0, 59.0, 29.0, 1.2],
                [61.0, 61.0, 29.0, 0.7],
                [82.0, 66.0, 24.0, 1.0],
                [102.0, 66.0, 25.0, 0.9],
                [3.0, 78.0, 28.0, 1.1],
                [15.0, 74.0, 28.0, 1.0],
                [29.0, 73.0, 25.0, 1.3],
                [54.0, 71.0, 26.0, 0.7],
                [66.0, 78.0, 20.0, 0.7],
                [87.0, 78.0, 24.0, 0.9],
                [100.0, 70.0, 28.0, 0.6],
                [3.0, 86.0, 26.0, 1.2],
                [12.0, 86.0, 22.0, 0.8],
                [34.0, 85.0, 23.0, 0.6],
                [52.0, 86.0, 21.0, 1.3],
                [69.0, 88.0, 28.0, 1.0],
                [86.0, 82.0, 24.0, 1.1],
                [104.0, 88.0, 24.0, 0.8],
                [-3.0, 95.0, 25.0, 1.5],
                [15.0, 101.0, 27.0, 0.9],
                [33.0, 95.0, 25.0, 0.9],
                [47.0, 101.0, 27.0, 0.6],
                [69.0, 102.0, 20.0, 0.6],
                [88.0, 96.0, 26.0, 0.7],
                [96.0, 95.0, 29.0, 1.3],
                [-5.0, -3.0, 54.0, 0.6],
                [15.0, -2.0, 51.0, 0.6],
                [30.0, -2.0, 50.0, 1.3],
                [54.0, -1.0, 53.0, 0.6],
                [65.0, -5.0, 54.0, 1.2],
                [84.0, 0.0, 49.0, 1.4],
                [101.0, -3.0, 54.0, 0.8],
                [-4.0, 15.0, 53.0, 1.1],
                [18.0, 10.0, 51.0, 0.9],
                [36.0, 15.0, 53.0, 0.7],
                [45.0, 16.0, 54.0, 0.6],
                [68.0, 9.0, 52.0, 1.4],
                [82.0, 14.0, 48.0, 0.7],
                [101.0, 8.0, 53.0, 1.0],
                [0.0, 27.0, 52.0, 1.2],
                [15.0, 26.0, 47.0, 1.4],
                [30.0, 26.0, 49.0, 1.0],
                [54.0, 28.0, 51.0, 1.5],
                [62.0, 24.0, 48.0, 1.1],
                [86.0, 25.0, 47.0, 0.8],
                [101.0, 22.0, 50.0, 1.2],
                [-4.0, 34.0, 51.0, 0.6],
                [14.0, 42.0, 48.0, 0.5],
                [33.0, 34.0, 53.0, 1.1],
                [52.0, 40.0, 47.0, 0.9],
                [63.0, 36.0, 54.0, 1.1],
                [83.0, 39.0, 52.0, 1.0],
                [104.0, 40.0, 53.0, 1.4],
                [-4.0, 46.0, 48.0, 1.1],
                [20.0, 51.0, 53.0, 0.6],
                [28.0, 49.0, 46.0, 0.6],
                [49.0, 47.0, 46.0, 0.9],
                [68.0, 45.0, 48.0, 1.1],
                [79.0, 50.0, 47.0, 1.4],
                [101.0, 45.0, 47.0, 1.4],
                [1.0, 59.0, 46.0, 1.4],
                [14.0, 65.0, 49.0, 1.0],
                [32.0, 60.0, 46.0, 0.9],
                [50.0, 63.0, 51.0, 0.6],
                [70.0, 65.0, 52.0, 1.1],
                [84.0, 65.0, 47.0, 1.2],
                [98.0, 59.0, 53.0, 1.4],
                [-5.0, 77.0, 54.0, 1.5],
                [21.0, 76.0, 53.0, 1.0],
                [34.0, 73.0, 50.0, 1.0],
                [45.0, 75.0, 54.0, 1.2],
                [66.0, 76.0, 45.0, 1.5],
                [81.0, 71.0, 51.0, 1.3],
                [102.0, 79.0, 49.0, 1.3],
                [-5.0, 82.0, 49.0, 0.8],
                [21.0, 87.0, 45.0, 0.8],
                [35.0, 87.0, 48.0, 0.8],
                [48.0, 85.0, 45.0, 1.0],
                [68.0, 89.0, 45.0, 0.8],
                [84.0, 83.0, 50.0, 0.6],
                [101.0, 85.0, 50.0, 1.3],
                [-5.0, 95.0, 46.0, 0.9],
                [14.0, 96.0, 53.0, 1.2],
                [36.0, 100.0, 47.0, 1.2],
                [47.0, 103.0, 46.0, 0.9],
                [63.0, 99.0, 54.0, 0.6],
                [85.0, 100.0, 50.0, 1.1],
                [102.0, 98.0, 47.0, 0.6],
                [1.0, 1.0, 74.0, 0.6],
                [20.0, -3.0, 77.0, 1.0],
                [28.0, 1.0, 70.0, 1.3],
                [45.0, 1.0, 77.0, 1.1],
                [68.0, -3.0, 78.0, 1.3],
                [81.0, -3.0, 77.0, 0.6],
                [104.0, -3.0, 73.0, 0.5],
                [0.0, 17.0, 79.0, 1.2],
                [16.0, 9.0, 72.0, 0.6],
                [34.0, 12.0, 71.0, 0.8],
                [48.0, 14.0, 75.0, 1.0],
                [65.0, 11.0, 75.0, 0.5],
                [86.0, 7.0, 78.0, 0.6],
                [95.0, 16.0, 72.0, 1.1],
                [3.0, 24.0, 70.0, 1.5],
                [18.0, 24.0, 74.0, 1.5],
                [32.0, 26.0, 71.0, 0.9],
                [48.0, 20.0, 78.0, 0.8],
                [68.0, 20.0, 70.0, 1.4],
                [80.0, 27.0, 73.0, 0.5],
                [103.0, 26.0, 71.0, 0.6],
                [0.0, 36.0, 70.0, 1.4],
                [12.0, 33.0, 79.0, 1.2],
                [29.0, 40.0, 71.0, 0.6],
                [45.0, 41.0, 72.0, 1.2],
                [63.0, 40.0, 77.0, 1.3],
                [82.0, 33.0, 76.0, 0.8],
                [95.0, 35.0, 75.0, 1.4],
                [-2.0, 46.0, 70.0, 0.8],
                [16.0, 51.0, 70.0, 1.3],
                [36.0, 45.0, 73.0, 1.1],
                [52.0, 48.0, 79.0, 1.5],
                [67.0, 49.0, 71.0, 1.4],
                [79.0, 51.0, 70.0, 0.6],
                [98.0, 53.0, 77.0, 0.6],
                [-5.0, 57.0, 79.0, 1.4],
                [13.0, 57.0, 70.0, 0.9],
                [32.0, 59.0, 74.0, 0.7],
                [54.0, 61.0, 77.0, 1.0],
                [66.0, 66.0, 75.0, 0.8],
                [84.0, 65.0, 79.0, 1.2],
                [96.0, 62.0, 71.0, 0.6],
                [2.0, 71.0, 78.0, 0.8],
                [18.0, 77.0, 77.0, 0.5],
                [33.0, 77.0, 75.0, 0.8],
                [54.0, 76.0, 74.0, 1.3],
                [69.0, 72.0, 76.0, 0.9],
                [87.0, 77.0, 72.0, 1.4],
                [101.0, 72.0, 76.0, 1.4],
                [-3.0, 83.0, 73.0, 1.4],
                [15.0, 89.0, 70.0, 1.3],
                [34.0, 89.0, 79.0, 1.0],
                [50.0, 85.0, 72.0, 1.4],
                [67.0, 90.0, 74.0, 1.5],
                [84.0, 92.0, 70.0, 1.1],
                [96.0, 87.0, 77.0, 1.3],
                [1.0, 102.0, 74.0, 0.6],
                [12.0, 97.0, 71.0, 0.7],
                [31.0, 104.0, 77.0, 0.8],
                [47.0, 99.0, 75.0, 0.9],
                [66.0, 102.0, 78.0, 1.2],
                [82.0, 103.0, 74.0, 1.2],
                [102.0, 103.0, 72.0, 0.9],
                [3.0, 0.0, 98.0, 1.4],
                [19.0, -3.0, 100.0, 1.3],
                [36.0, 2.0, 95.0, 1.1],
                [45.0, -1.0, 101.0, 0.5],
                [69.0, 3.0, 95.0, 0.7],
                [83.0, -4.0, 98.0, 0.8],
                [95.0, -1.0, 96.0, 1.2],
                [-1.0, 13.0, 95.0, 0.6],
                [16.0, 12.0, 97.0, 0.8],
                [37.0, 11.0, 97.0, 1.5],
                [50.0, 13.0, 97.0, 1.1],
                [67.0, 12.0, 95.0, 1.3],
                [78.0, 9.0, 103.0, 0.6],
                [103.0, 16.0, 99.0, 0.8],
                [-3.0, 24.0, 98.0, 0.9],
                [17.0, 27.0, 97.0, 1.5],
                [35.0, 26.0, 96.0, 0.8],
                [49.0, 24.0, 103.0, 1.1],
                [71.0, 24.0, 103.0, 1.3],
                [79.0, 21.0, 99.0, 1.4],
                [104.0, 29.0, 98.0, 1.1],
                [3.0, 41.0, 96.0, 0.7],
                [21.0, 32.0, 98.0, 1.5],
                [30.0, 36.0, 103.0, 0.8],
                [52.0, 41.0, 98.0, 0.6],
                [63.0, 37.0, 101.0, 1.4],
                [78.0, 39.0, 102.0, 1.4],
                [97.0, 41.0, 101.0, 0.5],
                [-4.0, 46.0, 99.0, 1.0],
                [12.0, 52.0, 100.0, 0.9],
                [29.0, 54.0, 98.0, 1.1],
                [47.0, 48.0, 101.0, 0.8],
                [65.0, 47.0, 100.0, 0.7],
                [82.0, 52.0, 97.0, 0.7],
                [96.0, 51.0, 101.0, 0.6],
                [1.0, 60.0, 98.0, 1.1],
                [19.0, 60.0, 102.0, 1.1],
                [35.0, 62.0, 101.0, 1.3],
                [48.0, 62.0, 101.0, 0.9],
                [67.0, 59.0, 98.0, 0.6],
                [87.0, 58.0, 100.0, 0.6],
                [97.0, 64.0, 95.0, 0.8],
                [-4.0, 76.0, 103.0, 1.1],
                [12.0, 76.0, 96.0, 1.0],
                [37.0, 71.0, 103.0, 0.5],
                [54.0, 74.0, 97.0, 0.8],
                [63.0, 79.0, 104.0, 1.5],
                [85.0, 72.0, 100.0, 1.0],
                [99.0, 78.0, 101.0, 1.3],
                [2.0, 90.0, 98.0, 0.9],
                [14.0, 86.0, 95.0, 0.9],
                [35.0, 85.0, 104.0, 1.4],
                [53.0, 85.0, 95.0, 1.2],
                [64.0, 83.0, 101.0, 1.2],
                [79.0, 87.0, 101.0, 1.1],
                [100.0, 89.0, 103.0, 0.5],
                [4.0, 100.0, 99.0, 0.9],
                [16.0, 101.0, 104.0, 0.8],
                [29.0, 97.0, 96.0, 1.0],
                [54.0, 95.0, 96.0, 0.6],
                [62.0, 95.0, 100.0, 1.4],
                [88.0, 98.0, 99.0, 0.5],
                [103.0, 102.0, 101.0, 0.5],
            ]
        )
        basis0 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 0.8, 2.0, 2.7, 4.1, 5.0, 5.0, 5.0]))
        basis1 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.3, 2.2, 3.3, 3.7, 4.7, 6.0, 6.0, 6.0, 6.0]))
        basis2 = BSplineBasis(2, np.array([0.0, 0.0, 0.7, 1.8, 3.3, 4.0, 4.0]))
        vol = Volume(basis0, basis1, basis2, controlpoints, True)
        vol2 = vol.clone()
        vol2 += np.array([3.3, 4.0, 8.4])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] -= 3.300000
        pt2[..., 1] -= 4.000000
        pt2[..., 2] -= 8.400000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_volume_3D_p332_rational(self):
        controlpoints = np.array(
            [
                [-2.0, 4.0, 1.0, 1.0],
                [20.0, -3.0, -5.0, 1.4],
                [43.0, -5.0, -1.0, 1.1],
                [58.0, -4.0, -4.0, 1.5],
                [82.0, -5.0, 3.0, 1.0],
                [96.0, 0.0, 0.0, 1.3],
                [0.0, 16.0, 0.0, 0.6],
                [22.0, 17.0, -1.0, 1.1],
                [35.0, 15.0, -5.0, 0.7],
                [61.0, 13.0, -3.0, 0.9],
                [83.0, 15.0, -2.0, 0.6],
                [95.0, 17.0, -4.0, 0.6],
                [2.0, 23.0, -5.0, 0.9],
                [16.0, 33.0, 1.0, 0.8],
                [35.0, 27.0, 0.0, 1.3],
                [60.0, 33.0, 1.0, 1.2],
                [75.0, 24.0, 0.0, 0.9],
                [100.0, 32.0, -2.0, 1.2],
                [1.0, 41.0, 2.0, 0.7],
                [20.0, 45.0, -2.0, 0.7],
                [42.0, 47.0, 4.0, 0.7],
                [57.0, 39.0, -1.0, 0.5],
                [84.0, 41.0, -2.0, 1.1],
                [98.0, 37.0, 4.0, 1.0],
                [1.0, 56.0, 4.0, 0.8],
                [15.0, 56.0, -5.0, 1.3],
                [38.0, 53.0, 2.0, 0.5],
                [63.0, 60.0, 2.0, 1.4],
                [82.0, 59.0, 3.0, 0.9],
                [100.0, 61.0, -5.0, 1.4],
                [-3.0, 72.0, -4.0, 0.6],
                [24.0, 70.0, -1.0, 0.9],
                [36.0, 71.0, -3.0, 0.5],
                [62.0, 72.0, -4.0, 1.5],
                [83.0, 74.0, -2.0, 1.3],
                [98.0, 73.0, -1.0, 0.5],
                [2.0, 81.0, 2.0, 1.3],
                [15.0, 90.0, 4.0, 1.0],
                [40.0, 82.0, 1.0, 1.4],
                [55.0, 83.0, -2.0, 1.5],
                [84.0, 88.0, -2.0, 0.7],
                [96.0, 85.0, -2.0, 1.5],
                [-4.0, 96.0, 0.0, 0.5],
                [17.0, 95.0, -3.0, 0.9],
                [40.0, 103.0, -5.0, 0.6],
                [62.0, 97.0, 0.0, 1.1],
                [77.0, 103.0, 1.0, 0.8],
                [103.0, 98.0, 0.0, 0.5],
                [2.0, 2.0, 16.0, 0.9],
                [20.0, -1.0, 22.0, 0.9],
                [41.0, 4.0, 24.0, 1.2],
                [57.0, -4.0, 17.0, 0.7],
                [77.0, 4.0, 24.0, 0.9],
                [101.0, -2.0, 16.0, 0.9],
                [-5.0, 12.0, 15.0, 1.3],
                [21.0, 14.0, 23.0, 0.7],
                [43.0, 14.0, 21.0, 0.7],
                [60.0, 11.0, 23.0, 0.8],
                [77.0, 18.0, 16.0, 0.6],
                [100.0, 14.0, 16.0, 1.3],
                [1.0, 29.0, 15.0, 1.3],
                [19.0, 27.0, 16.0, 0.7],
                [43.0, 32.0, 16.0, 1.4],
                [57.0, 29.0, 24.0, 1.2],
                [82.0, 27.0, 21.0, 0.8],
                [99.0, 32.0, 24.0, 1.1],
                [-5.0, 38.0, 24.0, 0.8],
                [24.0, 40.0, 24.0, 0.7],
                [36.0, 39.0, 22.0, 0.6],
                [56.0, 44.0, 24.0, 0.5],
                [80.0, 38.0, 24.0, 0.6],
                [102.0, 43.0, 24.0, 1.5],
                [1.0, 57.0, 22.0, 1.3],
                [22.0, 59.0, 21.0, 0.8],
                [39.0, 58.0, 18.0, 0.8],
                [56.0, 56.0, 15.0, 0.9],
                [79.0, 58.0, 24.0, 1.0],
                [101.0, 55.0, 20.0, 1.0],
                [3.0, 71.0, 17.0, 1.3],
                [20.0, 76.0, 18.0, 1.3],
                [35.0, 69.0, 22.0, 1.5],
                [61.0, 74.0, 18.0, 1.1],
                [77.0, 76.0, 15.0, 0.9],
                [97.0, 67.0, 19.0, 0.9],
                [0.0, 88.0, 18.0, 0.6],
                [22.0, 87.0, 21.0, 1.1],
                [42.0, 88.0, 17.0, 1.0],
                [61.0, 89.0, 16.0, 1.1],
                [75.0, 86.0, 19.0, 1.5],
                [96.0, 87.0, 15.0, 1.5],
                [-5.0, 96.0, 17.0, 0.8],
                [24.0, 98.0, 16.0, 1.3],
                [44.0, 100.0, 22.0, 0.6],
                [60.0, 95.0, 15.0, 1.3],
                [84.0, 102.0, 17.0, 1.1],
                [95.0, 95.0, 23.0, 0.7],
                [-2.0, 2.0, 39.0, 1.3],
                [23.0, 1.0, 37.0, 0.7],
                [37.0, 4.0, 42.0, 0.7],
                [60.0, 4.0, 44.0, 0.8],
                [82.0, 0.0, 40.0, 1.2],
                [99.0, -4.0, 35.0, 0.6],
                [0.0, 14.0, 42.0, 1.4],
                [21.0, 18.0, 43.0, 1.3],
                [38.0, 16.0, 41.0, 1.0],
                [64.0, 18.0, 35.0, 1.3],
                [82.0, 10.0, 43.0, 0.7],
                [102.0, 13.0, 40.0, 1.1],
                [4.0, 26.0, 36.0, 1.4],
                [20.0, 32.0, 44.0, 1.2],
                [41.0, 27.0, 41.0, 0.6],
                [55.0, 32.0, 43.0, 1.0],
                [77.0, 25.0, 39.0, 0.9],
                [103.0, 24.0, 41.0, 1.1],
                [-5.0, 42.0, 35.0, 0.8],
                [24.0, 38.0, 37.0, 1.3],
                [43.0, 44.0, 39.0, 1.1],
                [59.0, 39.0, 37.0, 1.0],
                [76.0, 40.0, 41.0, 0.5],
                [96.0, 46.0, 43.0, 1.1],
                [-5.0, 53.0, 44.0, 0.7],
                [17.0, 59.0, 39.0, 1.4],
                [40.0, 55.0, 38.0, 0.8],
                [56.0, 53.0, 37.0, 1.2],
                [77.0, 55.0, 37.0, 1.2],
                [99.0, 55.0, 35.0, 1.0],
                [4.0, 70.0, 43.0, 0.7],
                [15.0, 74.0, 36.0, 0.8],
                [41.0, 73.0, 40.0, 0.8],
                [58.0, 74.0, 35.0, 0.8],
                [78.0, 74.0, 36.0, 0.6],
                [99.0, 74.0, 36.0, 1.0],
                [4.0, 88.0, 44.0, 1.2],
                [17.0, 81.0, 39.0, 1.2],
                [39.0, 83.0, 44.0, 1.4],
                [63.0, 89.0, 44.0, 1.0],
                [79.0, 85.0, 39.0, 0.6],
                [102.0, 89.0, 39.0, 0.9],
                [3.0, 96.0, 44.0, 1.1],
                [22.0, 99.0, 43.0, 0.6],
                [44.0, 99.0, 43.0, 0.7],
                [55.0, 101.0, 38.0, 1.0],
                [83.0, 100.0, 42.0, 1.2],
                [97.0, 103.0, 41.0, 1.2],
                [-3.0, 0.0, 63.0, 1.0],
                [19.0, 3.0, 56.0, 0.6],
                [44.0, -4.0, 63.0, 0.9],
                [56.0, 3.0, 57.0, 1.5],
                [80.0, 4.0, 58.0, 1.0],
                [104.0, -3.0, 60.0, 1.3],
                [4.0, 17.0, 62.0, 1.3],
                [20.0, 14.0, 60.0, 1.1],
                [41.0, 11.0, 56.0, 1.5],
                [61.0, 17.0, 57.0, 0.6],
                [79.0, 16.0, 64.0, 0.5],
                [101.0, 14.0, 59.0, 0.5],
                [1.0, 33.0, 55.0, 0.8],
                [23.0, 30.0, 63.0, 0.9],
                [41.0, 28.0, 59.0, 0.6],
                [61.0, 31.0, 55.0, 1.0],
                [81.0, 25.0, 59.0, 0.6],
                [101.0, 24.0, 57.0, 1.2],
                [-3.0, 42.0, 64.0, 1.5],
                [18.0, 43.0, 60.0, 0.8],
                [39.0, 42.0, 58.0, 1.0],
                [56.0, 44.0, 64.0, 1.1],
                [79.0, 38.0, 63.0, 0.8],
                [102.0, 40.0, 55.0, 1.0],
                [2.0, 57.0, 56.0, 1.0],
                [23.0, 59.0, 63.0, 0.5],
                [42.0, 52.0, 58.0, 1.4],
                [63.0, 53.0, 61.0, 1.3],
                [76.0, 56.0, 60.0, 0.9],
                [104.0, 61.0, 64.0, 1.0],
                [-4.0, 68.0, 64.0, 1.1],
                [19.0, 70.0, 61.0, 0.6],
                [40.0, 66.0, 62.0, 0.8],
                [57.0, 69.0, 62.0, 0.6],
                [78.0, 71.0, 57.0, 1.0],
                [99.0, 72.0, 55.0, 0.6],
                [-4.0, 80.0, 62.0, 1.2],
                [15.0, 85.0, 63.0, 0.5],
                [42.0, 86.0, 63.0, 1.3],
                [62.0, 87.0, 64.0, 1.3],
                [80.0, 87.0, 59.0, 1.3],
                [99.0, 84.0, 58.0, 1.4],
                [-5.0, 97.0, 55.0, 0.7],
                [21.0, 102.0, 63.0, 1.0],
                [42.0, 95.0, 63.0, 1.0],
                [61.0, 101.0, 63.0, 1.4],
                [79.0, 103.0, 61.0, 1.2],
                [99.0, 102.0, 62.0, 1.0],
                [0.0, 1.0, 81.0, 0.9],
                [22.0, -5.0, 80.0, 0.6],
                [41.0, 0.0, 75.0, 1.4],
                [62.0, -4.0, 84.0, 1.3],
                [84.0, 3.0, 83.0, 1.0],
                [102.0, -2.0, 80.0, 1.0],
                [2.0, 15.0, 83.0, 1.4],
                [22.0, 10.0, 82.0, 1.1],
                [40.0, 14.0, 77.0, 0.9],
                [55.0, 11.0, 80.0, 1.1],
                [82.0, 16.0, 83.0, 0.8],
                [104.0, 10.0, 79.0, 0.5],
                [3.0, 28.0, 82.0, 1.4],
                [22.0, 23.0, 84.0, 1.0],
                [41.0, 26.0, 75.0, 0.6],
                [63.0, 31.0, 75.0, 0.6],
                [80.0, 30.0, 77.0, 0.6],
                [101.0, 28.0, 84.0, 1.4],
                [3.0, 42.0, 84.0, 1.3],
                [16.0, 43.0, 84.0, 0.9],
                [38.0, 46.0, 83.0, 0.6],
                [61.0, 37.0, 83.0, 1.3],
                [81.0, 39.0, 80.0, 1.0],
                [97.0, 38.0, 84.0, 0.6],
                [-4.0, 54.0, 76.0, 1.2],
                [24.0, 57.0, 79.0, 1.4],
                [36.0, 61.0, 76.0, 0.8],
                [58.0, 59.0, 79.0, 1.2],
                [80.0, 57.0, 82.0, 1.1],
                [99.0, 61.0, 80.0, 1.1],
                [4.0, 68.0, 78.0, 1.2],
                [20.0, 74.0, 81.0, 0.9],
                [40.0, 72.0, 82.0, 1.2],
                [62.0, 73.0, 80.0, 1.2],
                [77.0, 68.0, 75.0, 1.0],
                [99.0, 74.0, 76.0, 0.7],
                [3.0, 85.0, 82.0, 0.9],
                [18.0, 86.0, 76.0, 0.9],
                [41.0, 89.0, 83.0, 0.7],
                [56.0, 88.0, 76.0, 1.3],
                [78.0, 81.0, 82.0, 0.9],
                [101.0, 81.0, 83.0, 1.5],
                [-5.0, 96.0, 83.0, 0.8],
                [24.0, 95.0, 81.0, 0.8],
                [44.0, 104.0, 83.0, 0.6],
                [61.0, 104.0, 79.0, 0.5],
                [77.0, 95.0, 80.0, 0.9],
                [98.0, 100.0, 80.0, 0.8],
                [-5.0, 4.0, 102.0, 1.0],
                [19.0, 1.0, 104.0, 1.1],
                [42.0, 4.0, 104.0, 0.6],
                [55.0, -1.0, 100.0, 0.8],
                [81.0, -4.0, 99.0, 1.2],
                [98.0, -2.0, 100.0, 0.6],
                [2.0, 9.0, 103.0, 0.9],
                [21.0, 18.0, 101.0, 0.8],
                [39.0, 15.0, 97.0, 1.3],
                [64.0, 18.0, 97.0, 1.0],
                [84.0, 16.0, 95.0, 1.1],
                [96.0, 9.0, 100.0, 1.0],
                [2.0, 28.0, 97.0, 0.6],
                [18.0, 29.0, 97.0, 1.0],
                [35.0, 31.0, 104.0, 0.8],
                [57.0, 30.0, 98.0, 0.8],
                [78.0, 30.0, 100.0, 0.8],
                [104.0, 25.0, 95.0, 1.4],
                [3.0, 47.0, 96.0, 1.0],
                [19.0, 43.0, 95.0, 1.0],
                [38.0, 46.0, 96.0, 1.1],
                [64.0, 45.0, 95.0, 0.6],
                [84.0, 47.0, 100.0, 1.4],
                [95.0, 47.0, 99.0, 0.6],
                [-5.0, 56.0, 102.0, 1.1],
                [21.0, 59.0, 102.0, 1.1],
                [36.0, 57.0, 104.0, 0.9],
                [55.0, 61.0, 102.0, 0.8],
                [81.0, 52.0, 100.0, 0.7],
                [102.0, 58.0, 101.0, 1.3],
                [-5.0, 72.0, 100.0, 1.0],
                [16.0, 76.0, 104.0, 1.4],
                [36.0, 69.0, 104.0, 0.9],
                [63.0, 71.0, 102.0, 1.2],
                [82.0, 74.0, 104.0, 0.6],
                [100.0, 69.0, 102.0, 1.4],
                [2.0, 84.0, 104.0, 1.2],
                [18.0, 83.0, 97.0, 1.2],
                [39.0, 86.0, 103.0, 1.3],
                [64.0, 89.0, 97.0, 0.7],
                [75.0, 81.0, 104.0, 1.4],
                [99.0, 84.0, 97.0, 1.1],
                [4.0, 98.0, 102.0, 0.5],
                [16.0, 96.0, 98.0, 1.3],
                [40.0, 97.0, 104.0, 0.6],
                [61.0, 98.0, 103.0, 1.3],
                [77.0, 97.0, 102.0, 0.8],
                [97.0, 103.0, 104.0, 1.3],
            ]
        )
        basis0 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 0.9, 2.1, 3.1, 4.0, 4.0, 4.0]))
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 0.7, 1.7, 3.3, 4.3, 5.1, 6.0, 6.0, 6.0]))
        basis2 = BSplineBasis(2, np.array([0.0, 0.0, 1.1, 2.1, 3.1, 3.8, 5.0, 5.0]))
        vol = Volume(basis0, basis1, basis2, controlpoints, True)
        vol2 = vol.clone()
        vol2 *= np.array([2.2, 8.1, 2.7])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] /= 2.200000
        pt2[..., 1] /= 8.100000
        pt2[..., 2] /= 2.700000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_volume_3D_p323_rational(self):
        controlpoints = np.array(
            [
                [3.0, 1.0, 0.0, 1.5],
                [32.0, 0.0, 3.0, 1.4],
                [66.0, -4.0, -1.0, 1.0],
                [103.0, 3.0, -4.0, 0.8],
                [2.0, 24.0, 0.0, 1.2],
                [34.0, 23.0, 1.0, 0.5],
                [65.0, 22.0, -2.0, 0.8],
                [99.0, 24.0, -2.0, 0.5],
                [0.0, 43.0, 3.0, 1.5],
                [37.0, 38.0, 4.0, 1.4],
                [64.0, 43.0, 3.0, 1.4],
                [104.0, 35.0, 2.0, 1.4],
                [-4.0, 61.0, -3.0, 1.3],
                [37.0, 59.0, -2.0, 0.8],
                [65.0, 63.0, 2.0, 1.3],
                [104.0, 61.0, 1.0, 0.8],
                [-4.0, 82.0, -1.0, 1.1],
                [32.0, 75.0, 3.0, 0.8],
                [66.0, 80.0, 1.0, 0.6],
                [97.0, 82.0, -5.0, 1.1],
                [0.0, 95.0, -5.0, 1.4],
                [34.0, 103.0, 1.0, 0.9],
                [62.0, 99.0, 0.0, 0.7],
                [101.0, 99.0, -5.0, 1.1],
                [2.0, 2.0, 27.0, 0.7],
                [29.0, -4.0, 22.0, 1.1],
                [63.0, 3.0, 26.0, 1.4],
                [101.0, 0.0, 25.0, 1.1],
                [4.0, 20.0, 29.0, 1.5],
                [29.0, 20.0, 23.0, 0.9],
                [65.0, 22.0, 21.0, 1.3],
                [99.0, 21.0, 20.0, 1.0],
                [3.0, 42.0, 25.0, 1.4],
                [37.0, 40.0, 20.0, 1.1],
                [61.0, 37.0, 27.0, 1.1],
                [103.0, 40.0, 20.0, 1.1],
                [0.0, 57.0, 24.0, 0.7],
                [28.0, 64.0, 26.0, 1.0],
                [68.0, 63.0, 20.0, 1.4],
                [99.0, 56.0, 29.0, 1.5],
                [4.0, 75.0, 25.0, 0.8],
                [37.0, 75.0, 24.0, 1.0],
                [69.0, 76.0, 20.0, 1.0],
                [96.0, 78.0, 25.0, 0.5],
                [0.0, 99.0, 28.0, 1.5],
                [28.0, 97.0, 20.0, 1.3],
                [70.0, 96.0, 20.0, 0.6],
                [99.0, 95.0, 26.0, 1.1],
                [1.0, 4.0, 53.0, 1.0],
                [28.0, -5.0, 54.0, 1.3],
                [62.0, 4.0, 45.0, 0.5],
                [95.0, -4.0, 54.0, 1.0],
                [-5.0, 15.0, 50.0, 1.3],
                [31.0, 23.0, 49.0, 0.6],
                [67.0, 21.0, 45.0, 1.2],
                [95.0, 24.0, 47.0, 0.6],
                [3.0, 37.0, 51.0, 1.3],
                [34.0, 43.0, 49.0, 1.2],
                [65.0, 42.0, 48.0, 1.3],
                [101.0, 38.0, 47.0, 0.9],
                [-2.0, 55.0, 51.0, 1.2],
                [32.0, 61.0, 49.0, 0.9],
                [68.0, 62.0, 47.0, 0.6],
                [95.0, 62.0, 52.0, 1.0],
                [4.0, 75.0, 53.0, 0.9],
                [31.0, 76.0, 52.0, 1.4],
                [64.0, 82.0, 53.0, 1.0],
                [97.0, 80.0, 49.0, 0.9],
                [3.0, 98.0, 54.0, 0.5],
                [30.0, 104.0, 48.0, 1.4],
                [63.0, 98.0, 53.0, 1.4],
                [98.0, 95.0, 46.0, 1.1],
                [-5.0, 0.0, 73.0, 0.9],
                [31.0, -5.0, 76.0, 0.8],
                [69.0, -4.0, 74.0, 1.0],
                [104.0, 0.0, 76.0, 0.6],
                [-3.0, 17.0, 71.0, 0.8],
                [34.0, 17.0, 76.0, 0.8],
                [70.0, 17.0, 76.0, 1.0],
                [100.0, 22.0, 75.0, 1.1],
                [-3.0, 37.0, 72.0, 1.2],
                [32.0, 36.0, 74.0, 1.4],
                [61.0, 39.0, 74.0, 1.4],
                [102.0, 36.0, 79.0, 1.5],
                [0.0, 61.0, 71.0, 1.4],
                [36.0, 60.0, 71.0, 0.8],
                [67.0, 63.0, 72.0, 1.4],
                [95.0, 64.0, 75.0, 0.6],
                [-4.0, 78.0, 74.0, 0.7],
                [29.0, 78.0, 75.0, 1.2],
                [70.0, 76.0, 73.0, 1.4],
                [96.0, 79.0, 71.0, 1.0],
                [-5.0, 104.0, 75.0, 1.3],
                [31.0, 98.0, 70.0, 0.5],
                [67.0, 96.0, 74.0, 1.2],
                [97.0, 101.0, 79.0, 1.4],
                [1.0, -1.0, 101.0, 0.9],
                [28.0, 1.0, 99.0, 0.7],
                [70.0, 2.0, 101.0, 1.0],
                [98.0, -5.0, 96.0, 0.6],
                [-2.0, 15.0, 95.0, 1.0],
                [31.0, 17.0, 102.0, 0.5],
                [71.0, 19.0, 103.0, 0.6],
                [98.0, 15.0, 96.0, 1.1],
                [-2.0, 43.0, 96.0, 0.9],
                [29.0, 44.0, 103.0, 0.8],
                [68.0, 35.0, 102.0, 1.1],
                [102.0, 38.0, 95.0, 0.7],
                [-2.0, 59.0, 104.0, 0.8],
                [38.0, 62.0, 97.0, 0.6],
                [67.0, 57.0, 99.0, 1.0],
                [103.0, 58.0, 101.0, 0.6],
                [-2.0, 78.0, 100.0, 0.9],
                [35.0, 84.0, 96.0, 1.1],
                [68.0, 79.0, 103.0, 1.1],
                [96.0, 79.0, 99.0, 0.7],
                [-4.0, 99.0, 103.0, 1.1],
                [30.0, 104.0, 100.0, 0.5],
                [70.0, 104.0, 99.0, 1.0],
                [100.0, 97.0, 100.0, 1.1],
            ]
        )
        basis0 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 0.7, 2.0, 2.0, 2.0]))
        basis1 = BSplineBasis(2, np.array([0.0, 0.0, 0.9, 2.3, 2.8, 3.9, 5.0, 5.0]))
        basis2 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.1, 1.7, 3.0, 3.0, 3.0]))
        vol = Volume(basis0, basis1, basis2, controlpoints, True)
        vol2 = vol.clone()
        vol2.mirror([0, 0, 2])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 2] = -pt2[..., 2]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_3D_p4_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [97.0, -3.0, -3.0, 0.9],
                [76.0, 66.0, -1.0, 1.4],
                [19.0, 94.0, 4.0, 0.9],
                [-48.0, 82.0, -3.0, 1.4],
                [-90.0, 30.0, -4.0, 0.5],
                [-98.0, -34.0, 4.0, 1.0],
                [-53.0, -87.0, -3.0, 1.3],
                [15.0, -101.0, 3.0, 0.7],
                [76.0, -66.0, 0.0, 1.5],
            ]
        )
        basis0 = BSplineBasis(
            4, np.array([-1.2, 0.0, 0.0, 0.0, 1.3, 1.8, 2.8, 3.8, 5.1, 5.8, 7.0, 7.0, 7.0, 8.3]), 0
        )
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 += np.array([7.2, 4.8, 2.3])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 7.200000
        pt2[..., 1] -= 4.800000
        pt2[..., 2] -= 2.300000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_3D_p3_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [104.0, -4.0, 3.0, 0.7],
                [4.0, 98.0, -3.0, 0.7],
                [-104.0, -4.0, 2.0, 0.7],
                [0.0, -100.0, -2.0, 1.4],
            ]
        )
        basis0 = BSplineBasis(3, np.array([-0.9, 0.0, 0.0, 1.2, 2.1, 3.0, 3.0, 4.2]), 0)
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 *= np.array([3.7, 6.0, 2.6])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 3.700000
        pt2[..., 1] /= 6.000000
        pt2[..., 2] /= 2.600000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_curve_3D_p3_rational_C0_periodic(self):
        controlpoints = np.array(
            [[98.0, 4.0, -3.0, 1.5], [2.0, 98.0, -4.0, 0.7], [-102.0, 1.0, 3.0, 1.3], [1.0, -98.0, -1.0, 0.7]]
        )
        basis0 = BSplineBasis(3, np.array([-0.7, 0.0, 0.0, 1.4, 2.3, 3.0, 3.0, 4.4]), 0)
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2.mirror([3, 0, 0])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] = -pt2[..., 0]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_3D_p33_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [57.0, 3.0, 0.0, 1.1],
                [15.0, 57.0, 4.0, 0.9],
                [-51.0, 31.0, 2.0, 0.8],
                [-45.0, -39.0, 4.0, 0.8],
                [19.0, -61.0, -3.0, 1.5],
                [75.0, 1.0, -5.0, 0.7],
                [24.0, 70.0, -1.0, 0.6],
                [-61.0, 39.0, 3.0, 1.3],
                [-63.0, -44.0, -5.0, 1.0],
                [24.0, -68.0, -4.0, 1.3],
                [81.0, -2.0, -4.0, 1.4],
                [26.0, 77.0, 0.0, 0.9],
                [-73.0, 50.0, -4.0, 0.5],
                [-68.0, -48.0, 1.0, 1.4],
                [29.0, -85.0, 1.0, 0.9],
                [99.0, -1.0, 0.0, 0.7],
                [28.0, 91.0, -4.0, 1.2],
                [-84.0, 55.0, -5.0, 0.6],
                [-79.0, -63.0, 3.0, 1.3],
                [35.0, -98.0, -1.0, 0.9],
            ]
        )
        basis0 = BSplineBasis(3, np.array([-1.2, 0.0, 0.0, 0.9, 1.7, 2.8, 4.0, 4.0, 4.9]), 0)
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.0, 2.0, 2.0, 2.0]))
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 += np.array([4.9, 4.6, 6.3])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 4.900000
        pt2[..., 1] -= 4.600000
        pt2[..., 2] -= 6.300000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_surface_3D_p23_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [58.0, 4.0, 3.0, 0.9],
                [39.0, 48.0, 1.0, 1.3],
                [-16.0, 59.0, 0.0, 0.8],
                [-58.0, 23.0, 3.0, 0.6],
                [-50.0, -24.0, -3.0, 0.8],
                [-13.0, -59.0, 1.0, 1.2],
                [33.0, -47.0, 3.0, 1.0],
                [66.0, -2.0, 1.0, 1.2],
                [40.0, 56.0, 3.0, 0.7],
                [-19.0, 60.0, 4.0, 0.7],
                [-63.0, 30.0, -1.0, 0.5],
                [-56.0, -25.0, 3.0, 1.2],
                [-18.0, -66.0, 0.0, 0.6],
                [43.0, -48.0, -1.0, 1.4],
                [68.0, 0.0, 0.0, 1.5],
                [43.0, 60.0, -4.0, 0.5],
                [-14.0, 67.0, -2.0, 1.4],
                [-64.0, 28.0, -2.0, 1.4],
                [-69.0, -27.0, -1.0, 1.1],
                [-12.0, -66.0, 0.0, 0.7],
                [40.0, -59.0, 4.0, 1.4],
                [78.0, -2.0, -4.0, 0.8],
                [49.0, 58.0, 2.0, 0.6],
                [-21.0, 71.0, -3.0, 1.3],
                [-65.0, 29.0, -4.0, 1.2],
                [-68.0, -32.0, 3.0, 0.7],
                [-17.0, -79.0, 4.0, 1.2],
                [49.0, -60.0, -3.0, 0.8],
                [83.0, 1.0, -5.0, 0.9],
                [52.0, 60.0, -2.0, 1.3],
                [-18.0, 80.0, 3.0, 1.1],
                [-79.0, 37.0, -4.0, 1.2],
                [-78.0, -36.0, 4.0, 0.9],
                [-20.0, -80.0, 0.0, 1.2],
                [50.0, -68.0, 0.0, 1.2],
                [90.0, 0.0, -1.0, 0.9],
                [59.0, 73.0, -5.0, 0.6],
                [-18.0, 84.0, -5.0, 1.1],
                [-81.0, 37.0, -3.0, 0.9],
                [-76.0, -44.0, -3.0, 0.6],
                [-19.0, -87.0, 2.0, 1.4],
                [56.0, -70.0, 0.0, 1.1],
                [90.0, -2.0, -5.0, 1.2],
                [58.0, 72.0, 0.0, 0.8],
                [-18.0, 96.0, -1.0, 1.2],
                [-82.0, 42.0, 2.0, 1.2],
                [-83.0, -37.0, -2.0, 0.7],
                [-26.0, -91.0, 2.0, 0.7],
                [56.0, -75.0, 1.0, 1.4],
                [104.0, 3.0, 2.0, 0.6],
                [61.0, 78.0, 0.0, 0.8],
                [-20.0, 93.0, 3.0, 0.5],
                [-94.0, 45.0, -2.0, 0.8],
                [-89.0, -43.0, -5.0, 0.6],
                [-24.0, -98.0, 4.0, 0.5],
                [60.0, -82.0, 1.0, 0.7],
            ]
        )
        basis0 = BSplineBasis(2, np.array([-1.4, 0.0, 1.3, 2.4, 2.9, 4.0, 5.3, 5.6, 7.0, 8.3]), 0)
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.3, 2.1, 2.9, 3.9, 5.3, 6.0, 6.0, 6.0]))
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 *= np.array([6.8, 9.5, 4.1])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 6.800000
        pt2[..., 1] /= 9.500000
        pt2[..., 2] /= 4.100000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_surface_3D_p24_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [59.0, 3.0, -4.0, 0.8],
                [41.0, 42.0, -1.0, 1.4],
                [-13.0, 63.0, 4.0, 0.8],
                [-53.0, 30.0, -5.0, 0.5],
                [-58.0, -30.0, 3.0, 1.4],
                [-16.0, -58.0, 0.0, 1.5],
                [38.0, -43.0, 1.0, 0.5],
                [64.0, 2.0, 4.0, 1.4],
                [44.0, 49.0, -3.0, 0.9],
                [-16.0, 67.0, -1.0, 0.9],
                [-59.0, 29.0, 0.0, 1.4],
                [-65.0, -34.0, 3.0, 0.7],
                [-19.0, -64.0, 4.0, 0.8],
                [47.0, -52.0, -2.0, 0.8],
                [74.0, -2.0, 1.0, 1.5],
                [45.0, 55.0, 4.0, 0.8],
                [-13.0, 72.0, -5.0, 0.8],
                [-71.0, 36.0, -5.0, 0.6],
                [-66.0, -34.0, -5.0, 1.3],
                [-17.0, -71.0, 2.0, 1.5],
                [44.0, -59.0, -2.0, 1.2],
                [81.0, -4.0, -2.0, 0.8],
                [52.0, 68.0, -2.0, 0.6],
                [-16.0, 84.0, 2.0, 1.0],
                [-78.0, 36.0, 3.0, 0.7],
                [-80.0, -40.0, 1.0, 0.7],
                [-21.0, -79.0, -5.0, 1.3],
                [54.0, -63.0, -1.0, 0.9],
                [89.0, -4.0, 2.0, 0.7],
                [61.0, 75.0, 4.0, 0.7],
                [-23.0, 93.0, 2.0, 1.0],
                [-84.0, 44.0, -2.0, 1.2],
                [-85.0, -40.0, 2.0, 0.7],
                [-18.0, -93.0, 3.0, 1.3],
                [60.0, -77.0, 4.0, 0.9],
                [98.0, -3.0, 3.0, 1.3],
                [58.0, 77.0, -5.0, 1.3],
                [-19.0, 97.0, 3.0, 1.0],
                [-95.0, 47.0, 1.0, 0.6],
                [-92.0, -47.0, -3.0, 0.6],
                [-21.0, -96.0, 3.0, 0.5],
                [63.0, -76.0, 4.0, 0.6],
            ]
        )
        basis0 = BSplineBasis(2, np.array([-0.6, 0.0, 1.3, 1.9, 3.3, 4.2, 4.8, 6.4, 7.0, 8.3]), 0)
        basis1 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 0.6, 1.8, 3.0, 3.0, 3.0, 3.0]))
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2.mirror([0, 0, 1])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 2] = -pt2[..., 2]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_volume_3D_p342_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [52.0, -3.0, -2.0, 0.5],
                [33.0, 37.0, -2.0, 1.0],
                [-3.0, 45.0, -1.0, 1.3],
                [-40.0, 37.0, -2.0, 0.9],
                [-46.0, 3.0, -4.0, 0.5],
                [-34.0, -39.0, -4.0, 1.4],
                [-2.0, -54.0, 2.0, 1.4],
                [38.0, -41.0, 0.0, 1.2],
                [57.0, 4.0, -5.0, 0.6],
                [37.0, 44.0, -2.0, 0.9],
                [-4.0, 56.0, 2.0, 1.2],
                [-43.0, 36.0, 4.0, 1.2],
                [-60.0, 2.0, 4.0, 1.3],
                [-44.0, -37.0, 3.0, 0.8],
                [4.0, -61.0, -5.0, 1.5],
                [45.0, -39.0, -1.0, 1.1],
                [60.0, -2.0, 1.0, 1.1],
                [45.0, 45.0, -2.0, 1.0],
                [4.0, 64.0, 1.0, 1.2],
                [-41.0, 49.0, -2.0, 1.2],
                [-63.0, -5.0, -5.0, 1.3],
                [-44.0, -47.0, 2.0, 1.1],
                [-3.0, -63.0, 4.0, 0.9],
                [42.0, -49.0, -1.0, 1.3],
                [71.0, -2.0, -4.0, 0.7],
                [48.0, 54.0, -2.0, 1.4],
                [3.0, 74.0, 0.0, 1.5],
                [-47.0, 46.0, -4.0, 0.5],
                [-72.0, -1.0, 0.0, 1.1],
                [-55.0, -51.0, -3.0, 1.0],
                [-4.0, -75.0, 3.0, 1.4],
                [55.0, -48.0, 4.0, 0.8],
                [79.0, 3.0, 1.0, 1.4],
                [54.0, 58.0, -1.0, 0.8],
                [-3.0, 75.0, 0.0, 1.3],
                [-53.0, 53.0, 4.0, 1.1],
                [-76.0, -3.0, 4.0, 1.5],
                [-61.0, -55.0, 3.0, 1.4],
                [0.0, -83.0, 1.0, 1.1],
                [56.0, -55.0, 2.0, 1.0],
                [83.0, -1.0, -5.0, 0.5],
                [59.0, 59.0, -3.0, 1.3],
                [-2.0, 88.0, 4.0, 1.3],
                [-65.0, 56.0, -1.0, 0.8],
                [-84.0, -2.0, 3.0, 1.1],
                [-64.0, -66.0, -5.0, 1.2],
                [0.0, -86.0, -3.0, 1.5],
                [62.0, -65.0, 0.0, 1.5],
                [97.0, 4.0, -2.0, 1.0],
                [66.0, 69.0, -5.0, 1.4],
                [1.0, 91.0, 1.0, 1.4],
                [-69.0, 70.0, -3.0, 1.3],
                [-91.0, 0.0, -3.0, 1.5],
                [-64.0, -63.0, 3.0, 1.0],
                [-3.0, -98.0, 2.0, 0.5],
                [63.0, -68.0, 1.0, 0.7],
                [98.0, 0.0, -3.0, 1.1],
                [72.0, 71.0, 0.0, 0.5],
                [-4.0, 99.0, 3.0, 1.0],
                [-70.0, 70.0, 1.0, 0.6],
                [-105.0, 4.0, -1.0, 1.3],
                [-66.0, -72.0, 3.0, 1.3],
                [-1.0, -105.0, 2.0, 0.9],
                [67.0, -74.0, -4.0, 1.4],
                [50.0, 4.0, 13.0, 0.8],
                [34.0, 37.0, 12.0, 0.7],
                [2.0, 46.0, 5.0, 0.8],
                [-35.0, 38.0, 14.0, 1.1],
                [-51.0, 1.0, 10.0, 1.2],
                [-31.0, -39.0, 12.0, 0.5],
                [-5.0, -49.0, 7.0, 1.4],
                [31.0, -41.0, 5.0, 0.8],
                [53.0, 0.0, 10.0, 1.1],
                [35.0, 44.0, 10.0, 1.0],
                [0.0, 61.0, 9.0, 0.7],
                [-39.0, 41.0, 11.0, 1.0],
                [-53.0, -4.0, 10.0, 1.1],
                [-39.0, -42.0, 10.0, 1.1],
                [1.0, -63.0, 11.0, 1.3],
                [42.0, -46.0, 12.0, 1.4],
                [60.0, 2.0, 6.0, 1.4],
                [46.0, 46.0, 6.0, 1.2],
                [-1.0, 68.0, 9.0, 1.1],
                [-43.0, 43.0, 12.0, 1.3],
                [-62.0, -5.0, 6.0, 1.0],
                [-45.0, -44.0, 10.0, 0.7],
                [-3.0, -63.0, 14.0, 1.2],
                [44.0, -45.0, 7.0, 0.7],
                [68.0, 0.0, 8.0, 1.3],
                [54.0, 45.0, 5.0, 0.8],
                [1.0, 76.0, 12.0, 1.0],
                [-48.0, 48.0, 12.0, 0.7],
                [-72.0, 1.0, 11.0, 1.0],
                [-46.0, -51.0, 8.0, 1.3],
                [-3.0, -72.0, 8.0, 1.3],
                [51.0, -50.0, 11.0, 0.5],
                [77.0, -4.0, 6.0, 0.7],
                [56.0, 59.0, 12.0, 1.0],
                [-3.0, 79.0, 11.0, 0.7],
                [-57.0, 52.0, 13.0, 0.7],
                [-79.0, -5.0, 9.0, 0.8],
                [-61.0, -54.0, 6.0, 0.7],
                [-5.0, -74.0, 8.0, 1.5],
                [50.0, -61.0, 6.0, 1.4],
                [82.0, -3.0, 8.0, 1.4],
                [64.0, 62.0, 9.0, 1.4],
                [-4.0, 80.0, 13.0, 1.4],
                [-63.0, 61.0, 12.0, 0.9],
                [-84.0, 2.0, 7.0, 0.6],
                [-63.0, -65.0, 12.0, 0.8],
                [0.0, -90.0, 5.0, 0.5],
                [55.0, -57.0, 13.0, 0.6],
                [89.0, -4.0, 11.0, 1.3],
                [60.0, 62.0, 5.0, 0.9],
                [-4.0, 92.0, 12.0, 0.8],
                [-62.0, 63.0, 6.0, 1.3],
                [-89.0, -3.0, 11.0, 1.1],
                [-65.0, -68.0, 10.0, 0.8],
                [3.0, -95.0, 6.0, 1.0],
                [61.0, -64.0, 11.0, 1.4],
                [98.0, 2.0, 9.0, 0.8],
                [74.0, 69.0, 6.0, 0.5],
                [3.0, 97.0, 8.0, 0.5],
                [-70.0, 72.0, 10.0, 1.2],
                [-97.0, -5.0, 10.0, 1.1],
                [-76.0, -75.0, 14.0, 0.6],
                [-4.0, -99.0, 12.0, 1.1],
                [66.0, -73.0, 12.0, 1.3],
                [47.0, -1.0, 19.0, 1.4],
                [35.0, 40.0, 21.0, 1.5],
                [-3.0, 46.0, 24.0, 1.4],
                [-41.0, 30.0, 24.0, 0.9],
                [-53.0, -1.0, 22.0, 0.6],
                [-40.0, -32.0, 17.0, 0.5],
                [4.0, -48.0, 17.0, 0.5],
                [32.0, -33.0, 16.0, 0.8],
                [54.0, -4.0, 16.0, 0.9],
                [38.0, 39.0, 18.0, 1.3],
                [-3.0, 53.0, 22.0, 0.6],
                [-45.0, 36.0, 19.0, 1.3],
                [-56.0, -4.0, 20.0, 1.4],
                [-45.0, -45.0, 18.0, 1.5],
                [1.0, -55.0, 20.0, 0.8],
                [43.0, -46.0, 22.0, 1.0],
                [67.0, 4.0, 15.0, 0.6],
                [47.0, 47.0, 17.0, 0.6],
                [1.0, 67.0, 17.0, 0.6],
                [-44.0, 49.0, 22.0, 0.5],
                [-61.0, -3.0, 22.0, 0.7],
                [-43.0, -44.0, 15.0, 0.8],
                [-5.0, -68.0, 21.0, 1.1],
                [49.0, -45.0, 18.0, 0.9],
                [72.0, 2.0, 21.0, 0.9],
                [54.0, 53.0, 22.0, 1.0],
                [1.0, 69.0, 16.0, 1.2],
                [-55.0, 51.0, 23.0, 1.4],
                [-67.0, 0.0, 21.0, 0.6],
                [-53.0, -55.0, 22.0, 1.2],
                [-4.0, -69.0, 16.0, 1.4],
                [47.0, -52.0, 18.0, 1.5],
                [81.0, 4.0, 21.0, 0.6],
                [58.0, 56.0, 15.0, 1.0],
                [4.0, 82.0, 23.0, 0.9],
                [-54.0, 53.0, 24.0, 0.8],
                [-80.0, 1.0, 22.0, 1.1],
                [-58.0, -52.0, 21.0, 1.0],
                [-4.0, -75.0, 22.0, 0.7],
                [55.0, -56.0, 15.0, 0.9],
                [82.0, 2.0, 20.0, 1.3],
                [61.0, 56.0, 20.0, 0.7],
                [-5.0, 85.0, 22.0, 1.1],
                [-63.0, 65.0, 21.0, 1.0],
                [-84.0, -2.0, 22.0, 1.4],
                [-61.0, -63.0, 20.0, 0.8],
                [-5.0, -89.0, 15.0, 0.7],
                [61.0, -61.0, 22.0, 0.8],
                [89.0, 4.0, 18.0, 1.2],
                [63.0, 62.0, 24.0, 0.7],
                [-1.0, 96.0, 22.0, 1.2],
                [-65.0, 68.0, 24.0, 1.3],
                [-95.0, -2.0, 15.0, 1.5],
                [-67.0, -69.0, 21.0, 0.8],
                [4.0, -97.0, 22.0, 1.0],
                [69.0, -63.0, 23.0, 0.8],
                [97.0, 1.0, 23.0, 1.5],
                [67.0, 73.0, 15.0, 1.5],
                [4.0, 99.0, 21.0, 1.2],
                [-72.0, 74.0, 19.0, 1.4],
                [-103.0, 0.0, 20.0, 0.7],
                [-69.0, -73.0, 16.0, 1.0],
                [1.0, -98.0, 17.0, 1.3],
                [68.0, -74.0, 19.0, 0.5],
                [49.0, -4.0, 25.0, 1.3],
                [36.0, 38.0, 32.0, 1.0],
                [-1.0, 47.0, 28.0, 0.8],
                [-38.0, 34.0, 34.0, 0.8],
                [-49.0, 3.0, 30.0, 0.5],
                [-40.0, -38.0, 34.0, 0.6],
                [-3.0, -50.0, 31.0, 0.8],
                [40.0, -35.0, 33.0, 1.3],
                [52.0, 4.0, 30.0, 1.0],
                [36.0, 39.0, 25.0, 0.7],
                [-3.0, 53.0, 33.0, 0.6],
                [-45.0, 36.0, 30.0, 0.9],
                [-60.0, -5.0, 30.0, 1.0],
                [-41.0, -43.0, 26.0, 0.7],
                [2.0, -56.0, 34.0, 1.1],
                [37.0, -40.0, 32.0, 1.1],
                [62.0, -4.0, 29.0, 1.3],
                [47.0, 42.0, 26.0, 0.8],
                [1.0, 60.0, 34.0, 0.6],
                [-46.0, 49.0, 28.0, 1.0],
                [-65.0, 0.0, 33.0, 1.3],
                [-45.0, -42.0, 31.0, 0.9],
                [1.0, -61.0, 27.0, 1.0],
                [41.0, -44.0, 34.0, 0.5],
                [74.0, -5.0, 31.0, 0.8],
                [52.0, 53.0, 26.0, 1.2],
                [-1.0, 69.0, 27.0, 1.2],
                [-52.0, 50.0, 32.0, 1.0],
                [-76.0, 1.0, 33.0, 0.7],
                [-48.0, -54.0, 26.0, 0.9],
                [-2.0, -76.0, 29.0, 0.8],
                [48.0, -49.0, 34.0, 1.4],
                [79.0, 3.0, 30.0, 1.3],
                [52.0, 59.0, 34.0, 0.5],
                [1.0, 80.0, 28.0, 1.4],
                [-59.0, 53.0, 25.0, 1.1],
                [-77.0, -1.0, 31.0, 0.6],
                [-57.0, -54.0, 32.0, 0.7],
                [-5.0, -74.0, 27.0, 0.5],
                [53.0, -58.0, 31.0, 1.0],
                [81.0, 2.0, 32.0, 0.9],
                [58.0, 65.0, 31.0, 0.9],
                [-3.0, 83.0, 27.0, 0.9],
                [-64.0, 62.0, 29.0, 1.2],
                [-82.0, 1.0, 25.0, 0.8],
                [-65.0, -63.0, 32.0, 0.6],
                [-5.0, -89.0, 33.0, 0.5],
                [57.0, -64.0, 31.0, 0.8],
                [90.0, 0.0, 33.0, 1.2],
                [61.0, 61.0, 34.0, 0.6],
                [4.0, 97.0, 26.0, 0.7],
                [-69.0, 62.0, 27.0, 1.4],
                [-88.0, -4.0, 30.0, 0.8],
                [-61.0, -67.0, 26.0, 0.5],
                [-2.0, -93.0, 34.0, 1.2],
                [70.0, -65.0, 29.0, 0.9],
                [95.0, -1.0, 28.0, 0.7],
                [67.0, 70.0, 25.0, 0.9],
                [0.0, 104.0, 31.0, 0.6],
                [-67.0, 67.0, 28.0, 0.6],
                [-97.0, -3.0, 30.0, 1.1],
                [-76.0, -73.0, 32.0, 1.3],
                [2.0, -102.0, 34.0, 0.9],
                [75.0, -72.0, 34.0, 1.1],
                [54.0, -3.0, 43.0, 1.2],
                [33.0, 35.0, 44.0, 1.1],
                [-3.0, 52.0, 38.0, 0.7],
                [-40.0, 35.0, 41.0, 1.1],
                [-53.0, 4.0, 42.0, 0.8],
                [-36.0, -34.0, 44.0, 0.8],
                [-4.0, -49.0, 42.0, 1.5],
                [36.0, -40.0, 42.0, 1.4],
                [52.0, 2.0, 37.0, 0.5],
                [43.0, 43.0, 36.0, 1.0],
                [1.0, 53.0, 41.0, 0.5],
                [-41.0, 44.0, 44.0, 0.6],
                [-58.0, -3.0, 41.0, 1.2],
                [-42.0, -43.0, 39.0, 1.2],
                [1.0, -57.0, 35.0, 0.8],
                [42.0, -44.0, 44.0, 0.8],
                [59.0, 0.0, 37.0, 0.7],
                [40.0, 41.0, 42.0, 1.0],
                [-1.0, 61.0, 36.0, 0.5],
                [-41.0, 40.0, 37.0, 1.1],
                [-64.0, -5.0, 44.0, 0.9],
                [-41.0, -45.0, 36.0, 1.5],
                [4.0, -66.0, 43.0, 1.2],
                [43.0, -45.0, 39.0, 0.7],
                [68.0, 4.0, 37.0, 1.1],
                [52.0, 51.0, 36.0, 0.5],
                [-1.0, 74.0, 43.0, 0.5],
                [-53.0, 52.0, 35.0, 0.5],
                [-76.0, -1.0, 35.0, 1.4],
                [-50.0, -52.0, 37.0, 0.8],
                [-1.0, -73.0, 38.0, 0.5],
                [49.0, -55.0, 44.0, 1.3],
                [77.0, -4.0, 44.0, 1.2],
                [59.0, 57.0, 38.0, 0.9],
                [0.0, 82.0, 38.0, 1.3],
                [-57.0, 52.0, 43.0, 0.6],
                [-77.0, 4.0, 35.0, 0.8],
                [-60.0, -57.0, 37.0, 0.7],
                [-4.0, -84.0, 35.0, 0.9],
                [57.0, -57.0, 35.0, 0.8],
                [90.0, -4.0, 37.0, 0.9],
                [61.0, 59.0, 43.0, 0.6],
                [0.0, 84.0, 44.0, 0.7],
                [-59.0, 58.0, 38.0, 0.6],
                [-84.0, -4.0, 38.0, 1.0],
                [-63.0, -57.0, 43.0, 0.9],
                [-5.0, -87.0, 36.0, 0.7],
                [57.0, -63.0, 41.0, 1.1],
                [91.0, 2.0, 37.0, 0.9],
                [67.0, 65.0, 36.0, 0.5],
                [-3.0, 91.0, 35.0, 1.3],
                [-63.0, 61.0, 44.0, 1.1],
                [-94.0, 0.0, 43.0, 0.8],
                [-63.0, -71.0, 43.0, 1.1],
                [-1.0, -95.0, 42.0, 1.3],
                [60.0, -65.0, 36.0, 1.4],
                [97.0, 4.0, 43.0, 1.1],
                [66.0, 70.0, 37.0, 0.5],
                [-3.0, 98.0, 36.0, 1.2],
                [-68.0, 70.0, 43.0, 0.7],
                [-103.0, 1.0, 44.0, 1.1],
                [-71.0, -67.0, 35.0, 1.4],
                [-1.0, -104.0, 35.0, 1.0],
                [71.0, -75.0, 35.0, 1.5],
            ]
        )
        basis0 = BSplineBasis(3, np.array([-0.7, 0.0, 0.0, 1.3, 1.8, 3.2, 3.9, 4.6, 6.3, 7.0, 7.0, 8.3]), 0)
        basis1 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 0.9, 2.0, 2.6, 4.2, 5.0, 5.0, 5.0, 5.0]))
        basis2 = BSplineBasis(2, np.array([0.0, 0.0, 0.8, 1.9, 2.9, 4.0, 4.0]))
        vol = Volume(basis0, basis1, basis2, controlpoints, True)
        vol2 = vol.clone()
        vol2 += np.array([5.5, 3.5, 9.1])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] -= 5.500000
        pt2[..., 1] -= 3.500000
        pt2[..., 2] -= 9.100000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_volume_3D_p432_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [53.0, -4.0, -3.0, 0.7],
                [21.0, 42.0, 3.0, 1.1],
                [-30.0, 46.0, -5.0, 0.6],
                [-52.0, -3.0, 2.0, 1.4],
                [-21.0, -41.0, -1.0, 1.4],
                [26.0, -43.0, -3.0, 1.3],
                [70.0, -2.0, -5.0, 1.2],
                [30.0, 55.0, 1.0, 0.9],
                [-37.0, 62.0, -5.0, 1.2],
                [-71.0, -1.0, 2.0, 1.2],
                [-30.0, -56.0, -2.0, 0.5],
                [36.0, -55.0, 0.0, 1.0],
                [88.0, -3.0, 4.0, 0.5],
                [37.0, 72.0, -3.0, 0.5],
                [-39.0, 70.0, -1.0, 0.7],
                [-82.0, -2.0, 1.0, 1.0],
                [-45.0, -77.0, 0.0, 1.4],
                [37.0, -76.0, -2.0, 1.5],
                [102.0, 1.0, -2.0, 1.2],
                [53.0, 85.0, 4.0, 1.4],
                [-49.0, 83.0, -2.0, 1.3],
                [-98.0, -3.0, 4.0, 0.8],
                [-48.0, -88.0, 0.0, 1.0],
                [52.0, -89.0, 3.0, 0.7],
                [53.0, -2.0, 19.0, 1.4],
                [22.0, 39.0, 20.0, 1.0],
                [-23.0, 40.0, 19.0, 0.8],
                [-47.0, 4.0, 20.0, 0.6],
                [-25.0, -40.0, 17.0, 0.5],
                [21.0, -47.0, 18.0, 0.8],
                [67.0, -4.0, 22.0, 0.7],
                [36.0, 57.0, 21.0, 0.9],
                [-39.0, 59.0, 22.0, 0.6],
                [-70.0, -4.0, 16.0, 1.0],
                [-33.0, -56.0, 23.0, 1.0],
                [35.0, -59.0, 22.0, 0.9],
                [79.0, -5.0, 20.0, 1.3],
                [45.0, 75.0, 15.0, 0.6],
                [-39.0, 69.0, 23.0, 1.1],
                [-85.0, -5.0, 19.0, 0.9],
                [-45.0, -71.0, 20.0, 1.4],
                [41.0, -72.0, 15.0, 1.0],
                [102.0, -3.0, 24.0, 1.0],
                [53.0, 90.0, 17.0, 1.3],
                [-55.0, 82.0, 22.0, 1.3],
                [-98.0, 3.0, 21.0, 1.1],
                [-49.0, -89.0, 19.0, 1.5],
                [49.0, -89.0, 24.0, 1.1],
                [52.0, 1.0, 38.0, 0.7],
                [27.0, 38.0, 36.0, 1.2],
                [-26.0, 48.0, 40.0, 1.3],
                [-47.0, 3.0, 35.0, 0.8],
                [-21.0, -39.0, 42.0, 1.2],
                [28.0, -47.0, 36.0, 0.5],
                [65.0, -1.0, 37.0, 1.2],
                [33.0, 54.0, 41.0, 1.4],
                [-33.0, 52.0, 43.0, 1.2],
                [-62.0, -1.0, 44.0, 0.7],
                [-38.0, -62.0, 35.0, 1.4],
                [31.0, -54.0, 36.0, 1.0],
                [82.0, -4.0, 37.0, 0.9],
                [38.0, 75.0, 37.0, 0.9],
                [-38.0, 69.0, 40.0, 0.9],
                [-88.0, -2.0, 44.0, 0.8],
                [-41.0, -73.0, 42.0, 1.4],
                [44.0, -70.0, 43.0, 1.1],
                [95.0, -1.0, 36.0, 0.8],
                [49.0, 90.0, 43.0, 1.3],
                [-52.0, 83.0, 40.0, 1.5],
                [-100.0, -1.0, 42.0, 1.5],
                [-52.0, -89.0, 44.0, 1.4],
                [46.0, -88.0, 39.0, 0.8],
            ]
        )
        basis0 = BSplineBasis(4, np.array([-1.3, 0.0, 0.0, 0.0, 1.3, 1.8, 2.7, 4.0, 4.0, 4.0, 5.3]), 0)
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.4, 2.0, 2.0, 2.0]))
        basis2 = BSplineBasis(2, np.array([0.0, 0.0, 0.8, 2.0, 2.0]))
        vol = Volume(basis0, basis1, basis2, controlpoints, True)
        vol2 = vol.clone()
        vol2 *= np.array([8.2, 2.1, 4.1])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] /= 8.200000
        pt2[..., 1] /= 2.100000
        pt2[..., 2] /= 4.100000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_volume_3D_p432_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [51.0, 4.0, 0.0, 1.0],
                [31.0, 34.0, 0.0, 1.1],
                [-8.0, 44.0, -4.0, 1.0],
                [-45.0, 19.0, -3.0, 0.9],
                [-42.0, -25.0, 4.0, 0.6],
                [-13.0, -48.0, -3.0, 0.9],
                [28.0, -41.0, 4.0, 1.5],
                [64.0, 1.0, -4.0, 1.0],
                [40.0, 50.0, -1.0, 1.1],
                [-14.0, 60.0, 4.0, 1.5],
                [-51.0, 24.0, -2.0, 0.5],
                [-57.0, -28.0, -1.0, 0.9],
                [-13.0, -62.0, -4.0, 1.0],
                [38.0, -47.0, 4.0, 1.3],
                [71.0, -5.0, 0.0, 1.0],
                [45.0, 52.0, 4.0, 0.7],
                [-12.0, 71.0, 4.0, 1.3],
                [-67.0, 31.0, 1.0, 0.5],
                [-67.0, -36.0, -5.0, 1.3],
                [-15.0, -68.0, -1.0, 1.0],
                [43.0, -53.0, -1.0, 0.9],
                [83.0, 1.0, 0.0, 0.7],
                [48.0, 58.0, 1.0, 1.5],
                [-19.0, 82.0, -4.0, 1.1],
                [-74.0, 33.0, 0.0, 0.5],
                [-71.0, -34.0, -3.0, 0.9],
                [-16.0, -78.0, 4.0, 0.7],
                [44.0, -59.0, 3.0, 1.0],
                [89.0, -1.0, 3.0, 1.1],
                [56.0, 73.0, -4.0, 0.6],
                [-16.0, 88.0, -1.0, 0.6],
                [-81.0, 35.0, -4.0, 1.2],
                [-79.0, -43.0, 2.0, 0.6],
                [-17.0, -88.0, -3.0, 1.0],
                [55.0, -75.0, -4.0, 1.2],
                [102.0, -5.0, 4.0, 0.8],
                [66.0, 81.0, -1.0, 0.6],
                [-19.0, 101.0, -5.0, 1.0],
                [-89.0, 41.0, 2.0, 1.5],
                [-88.0, -47.0, -1.0, 0.8],
                [-23.0, -103.0, -2.0, 0.8],
                [61.0, -75.0, 3.0, 0.7],
                [46.0, -3.0, 10.0, 1.1],
                [33.0, 37.0, 11.0, 1.2],
                [-13.0, 52.0, 10.0, 0.7],
                [-47.0, 20.0, 4.0, 1.5],
                [-49.0, -21.0, 10.0, 1.3],
                [-17.0, -48.0, 11.0, 0.5],
                [27.0, -38.0, 4.0, 0.8],
                [56.0, 1.0, 6.0, 0.8],
                [34.0, 45.0, 5.0, 1.3],
                [-13.0, 54.0, 7.0, 1.0],
                [-50.0, 29.0, 9.0, 0.6],
                [-53.0, -22.0, 10.0, 0.6],
                [-13.0, -54.0, 12.0, 0.7],
                [36.0, -44.0, 11.0, 0.5],
                [68.0, -3.0, 9.0, 0.5],
                [41.0, 57.0, 11.0, 1.4],
                [-14.0, 72.0, 10.0, 1.3],
                [-61.0, 33.0, 5.0, 1.3],
                [-65.0, -26.0, 7.0, 0.9],
                [-20.0, -73.0, 10.0, 1.4],
                [44.0, -57.0, 6.0, 0.6],
                [80.0, 3.0, 8.0, 1.1],
                [53.0, 59.0, 4.0, 1.3],
                [-14.0, 73.0, 6.0, 1.0],
                [-75.0, 39.0, 6.0, 0.6],
                [-70.0, -30.0, 8.0, 1.3],
                [-14.0, -78.0, 9.0, 0.8],
                [52.0, -59.0, 11.0, 0.9],
                [88.0, 3.0, 5.0, 0.9],
                [60.0, 73.0, 8.0, 1.3],
                [-22.0, 83.0, 6.0, 1.5],
                [-80.0, 34.0, 12.0, 0.7],
                [-77.0, -41.0, 11.0, 1.4],
                [-20.0, -87.0, 6.0, 1.1],
                [57.0, -75.0, 6.0, 1.3],
                [98.0, -5.0, 7.0, 1.0],
                [64.0, 81.0, 12.0, 0.7],
                [-24.0, 94.0, 6.0, 0.5],
                [-93.0, 42.0, 7.0, 0.6],
                [-90.0, -47.0, 11.0, 1.3],
                [-22.0, -97.0, 7.0, 1.0],
                [64.0, -81.0, 5.0, 0.7],
                [53.0, -2.0, 20.0, 1.2],
                [28.0, 42.0, 12.0, 0.7],
                [-15.0, 52.0, 16.0, 1.1],
                [-43.0, 24.0, 13.0, 0.6],
                [-42.0, -21.0, 17.0, 0.7],
                [-8.0, -54.0, 17.0, 1.3],
                [30.0, -38.0, 11.0, 1.0],
                [58.0, -2.0, 15.0, 1.3],
                [38.0, 47.0, 13.0, 1.0],
                [-18.0, 60.0, 20.0, 1.0],
                [-58.0, 27.0, 16.0, 0.6],
                [-55.0, -26.0, 13.0, 1.4],
                [-12.0, -58.0, 20.0, 1.2],
                [41.0, -49.0, 15.0, 1.0],
                [68.0, 2.0, 11.0, 1.3],
                [39.0, 51.0, 12.0, 0.5],
                [-19.0, 65.0, 15.0, 1.4],
                [-69.0, 32.0, 16.0, 0.6],
                [-63.0, -31.0, 18.0, 1.1],
                [-20.0, -67.0, 12.0, 1.1],
                [42.0, -55.0, 13.0, 1.2],
                [78.0, -4.0, 18.0, 1.0],
                [52.0, 61.0, 12.0, 0.7],
                [-14.0, 82.0, 17.0, 1.0],
                [-75.0, 31.0, 19.0, 1.1],
                [-75.0, -37.0, 17.0, 1.4],
                [-21.0, -80.0, 13.0, 1.5],
                [52.0, -59.0, 20.0, 0.6],
                [89.0, 3.0, 13.0, 0.7],
                [55.0, 70.0, 11.0, 1.3],
                [-23.0, 85.0, 13.0, 0.9],
                [-80.0, 39.0, 13.0, 1.3],
                [-84.0, -39.0, 13.0, 1.3],
                [-20.0, -91.0, 19.0, 1.4],
                [58.0, -71.0, 15.0, 0.8],
                [97.0, -2.0, 17.0, 1.0],
                [65.0, 77.0, 14.0, 0.9],
                [-21.0, 100.0, 18.0, 1.2],
                [-88.0, 41.0, 17.0, 0.7],
                [-87.0, -42.0, 20.0, 1.3],
                [-24.0, -96.0, 17.0, 1.3],
                [62.0, -78.0, 18.0, 1.2],
                [54.0, -4.0, 24.0, 0.5],
                [34.0, 36.0, 23.0, 1.3],
                [-16.0, 47.0, 21.0, 1.3],
                [-47.0, 23.0, 27.0, 1.2],
                [-43.0, -26.0, 23.0, 0.6],
                [-10.0, -53.0, 20.0, 0.5],
                [26.0, -41.0, 25.0, 0.7],
                [57.0, -3.0, 27.0, 0.8],
                [38.0, 48.0, 20.0, 0.8],
                [-10.0, 60.0, 28.0, 1.2],
                [-51.0, 27.0, 27.0, 0.8],
                [-55.0, -25.0, 24.0, 1.0],
                [-16.0, -62.0, 25.0, 0.9],
                [37.0, -48.0, 20.0, 0.7],
                [68.0, -2.0, 25.0, 1.3],
                [46.0, 55.0, 24.0, 1.2],
                [-19.0, 70.0, 22.0, 1.4],
                [-68.0, 31.0, 28.0, 1.1],
                [-62.0, -36.0, 24.0, 0.7],
                [-12.0, -65.0, 22.0, 1.0],
                [42.0, -59.0, 19.0, 1.3],
                [83.0, -3.0, 25.0, 0.6],
                [50.0, 65.0, 27.0, 0.7],
                [-19.0, 81.0, 21.0, 0.8],
                [-68.0, 37.0, 20.0, 1.0],
                [-74.0, -38.0, 28.0, 0.8],
                [-21.0, -81.0, 25.0, 1.4],
                [54.0, -60.0, 28.0, 1.4],
                [91.0, -3.0, 28.0, 1.5],
                [59.0, 70.0, 22.0, 1.4],
                [-23.0, 84.0, 28.0, 0.5],
                [-83.0, 39.0, 20.0, 1.2],
                [-79.0, -44.0, 19.0, 1.4],
                [-19.0, -87.0, 27.0, 0.6],
                [60.0, -72.0, 28.0, 1.0],
                [104.0, 3.0, 21.0, 1.4],
                [63.0, 76.0, 24.0, 1.4],
                [-25.0, 96.0, 28.0, 0.6],
                [-89.0, 44.0, 27.0, 1.3],
                [-94.0, -40.0, 26.0, 0.9],
                [-18.0, -98.0, 24.0, 1.1],
                [63.0, -76.0, 25.0, 1.1],
                [49.0, -4.0, 29.0, 0.8],
                [26.0, 43.0, 34.0, 1.0],
                [-11.0, 45.0, 33.0, 1.4],
                [-50.0, 25.0, 28.0, 1.0],
                [-44.0, -24.0, 36.0, 1.2],
                [-13.0, -44.0, 31.0, 1.0],
                [28.0, -40.0, 35.0, 0.8],
                [62.0, -5.0, 35.0, 1.0],
                [35.0, 49.0, 28.0, 1.3],
                [-18.0, 62.0, 31.0, 1.0],
                [-51.0, 29.0, 33.0, 0.9],
                [-53.0, -24.0, 27.0, 1.1],
                [-11.0, -55.0, 33.0, 0.5],
                [38.0, -51.0, 35.0, 1.3],
                [69.0, -1.0, 33.0, 0.7],
                [45.0, 52.0, 32.0, 1.1],
                [-19.0, 68.0, 33.0, 1.0],
                [-61.0, 32.0, 34.0, 1.2],
                [-65.0, -32.0, 30.0, 0.9],
                [-17.0, -64.0, 28.0, 1.2],
                [40.0, -55.0, 34.0, 1.2],
                [81.0, 0.0, 27.0, 0.5],
                [48.0, 59.0, 35.0, 0.5],
                [-23.0, 73.0, 30.0, 1.0],
                [-76.0, 31.0, 31.0, 1.5],
                [-72.0, -40.0, 29.0, 1.5],
                [-16.0, -74.0, 32.0, 1.0],
                [46.0, -64.0, 32.0, 1.1],
                [90.0, -5.0, 35.0, 1.2],
                [54.0, 66.0, 29.0, 0.7],
                [-19.0, 88.0, 35.0, 0.8],
                [-79.0, 40.0, 27.0, 1.2],
                [-85.0, -35.0, 33.0, 1.4],
                [-25.0, -92.0, 29.0, 1.4],
                [53.0, -66.0, 34.0, 1.1],
                [104.0, -2.0, 30.0, 0.8],
                [65.0, 78.0, 31.0, 0.7],
                [-27.0, 92.0, 28.0, 0.6],
                [-93.0, 43.0, 36.0, 0.5],
                [-94.0, -42.0, 36.0, 1.3],
                [-24.0, -94.0, 33.0, 1.4],
                [63.0, -77.0, 27.0, 0.6],
                [45.0, 2.0, 38.0, 1.4],
                [35.0, 36.0, 37.0, 1.0],
                [-8.0, 53.0, 42.0, 1.3],
                [-46.0, 22.0, 41.0, 1.3],
                [-45.0, -20.0, 41.0, 1.0],
                [-8.0, -47.0, 42.0, 1.2],
                [29.0, -36.0, 43.0, 1.5],
                [57.0, -5.0, 35.0, 0.6],
                [36.0, 48.0, 44.0, 0.9],
                [-11.0, 60.0, 35.0, 1.5],
                [-54.0, 22.0, 39.0, 1.4],
                [-56.0, -26.0, 44.0, 1.3],
                [-11.0, -56.0, 41.0, 0.8],
                [36.0, -46.0, 35.0, 1.5],
                [69.0, 4.0, 40.0, 0.8],
                [47.0, 56.0, 44.0, 0.5],
                [-21.0, 64.0, 39.0, 0.6],
                [-68.0, 26.0, 35.0, 0.7],
                [-61.0, -31.0, 36.0, 1.2],
                [-14.0, -67.0, 39.0, 1.1],
                [46.0, -51.0, 38.0, 1.4],
                [80.0, -4.0, 35.0, 1.2],
                [51.0, 67.0, 42.0, 1.4],
                [-16.0, 78.0, 35.0, 1.3],
                [-72.0, 31.0, 36.0, 0.9],
                [-69.0, -34.0, 41.0, 1.4],
                [-20.0, -76.0, 43.0, 1.4],
                [48.0, -60.0, 41.0, 0.7],
                [92.0, -5.0, 42.0, 0.8],
                [57.0, 69.0, 40.0, 1.0],
                [-23.0, 89.0, 39.0, 1.2],
                [-77.0, 37.0, 38.0, 1.2],
                [-78.0, -35.0, 43.0, 1.1],
                [-23.0, -91.0, 39.0, 0.6],
                [58.0, -73.0, 41.0, 1.4],
                [103.0, 1.0, 43.0, 1.0],
                [57.0, 74.0, 42.0, 0.6],
                [-23.0, 96.0, 39.0, 0.5],
                [-87.0, 45.0, 42.0, 0.6],
                [-93.0, -46.0, 38.0, 1.1],
                [-25.0, -95.0, 42.0, 1.0],
                [62.0, -75.0, 43.0, 1.3],
            ]
        )
        basis0 = BSplineBasis(4, np.array([-1.0, 0.0, 0.0, 0.0, 0.7, 2.2, 3.1, 4.0, 5.0, 5.0, 5.0, 5.7]), 0)
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 0.8, 2.4, 2.8, 4.0, 4.0, 4.0]))
        basis2 = BSplineBasis(2, np.array([0.0, 0.0, 0.9, 1.9, 3.0, 3.9, 5.0, 5.0]))
        vol = Volume(basis0, basis1, basis2, controlpoints, True)
        vol2 = vol.clone()
        vol2.mirror([0, 0, 2])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 2] = -pt2[..., 2]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_3D_p3_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [97.0, 4.0, 4.0, 1.3],
                [61.0, 75.0, 4.0, 0.7],
                [-24.0, 100.0, 1.0, 1.1],
                [-87.0, 41.0, 4.0, 0.9],
                [-89.0, -47.0, 3.0, 1.2],
                [-22.0, -99.0, -4.0, 1.5],
                [58.0, -82.0, 0.0, 1.5],
            ]
        )
        basis0 = BSplineBasis(3, np.array([-2.1, -1.1, 0.0, 0.9, 2.0, 3.2, 4.1, 4.9, 5.9, 7.0, 7.9, 9.0]), 1)
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 += np.array([8.5, 8.3, 9.4])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 8.500000
        pt2[..., 1] -= 8.300000
        pt2[..., 2] -= 9.400000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_3D_p3_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [95.0, 2.0, -3.0, 1.0],
                [73.0, 66.0, 1.0, 0.9],
                [-4.0, 98.0, -3.0, 1.1],
                [-74.0, 66.0, -1.0, 1.5],
                [-96.0, 0.0, -3.0, 1.4],
                [-75.0, -74.0, -3.0, 1.0],
                [-1.0, -104.0, 2.0, 1.5],
                [66.0, -72.0, -2.0, 0.9],
            ]
        )
        basis0 = BSplineBasis(
            3, np.array([-2.0, -1.1, 0.0, 1.0, 1.9, 2.9, 4.4, 4.7, 6.0, 6.9, 8.0, 9.0, 9.9]), 1
        )
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 *= np.array([4.1, 5.2, 11.0])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 4.100000
        pt2[..., 1] /= 5.200000
        pt2[..., 2] /= 11.000000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_curve_3D_p3_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [96.0, 4.0, 4.0, 0.6],
                [63.0, 79.0, 4.0, 1.1],
                [-25.0, 98.0, 4.0, 0.7],
                [-88.0, 41.0, 4.0, 1.4],
                [-95.0, -46.0, 2.0, 0.8],
                [-24.0, -97.0, 0.0, 0.8],
                [67.0, -79.0, -5.0, 0.6],
            ]
        )
        basis0 = BSplineBasis(3, np.array([-2.0, -0.8, 0.0, 0.9, 2.2, 3.0, 3.9, 5.0, 6.2, 7.0, 7.9, 9.2]), 1)
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2.mirror([0, 2, 0])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 1] = -pt2[..., 1]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_surface_3D_p44_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [57.0, 0.0, -2.0, 0.7],
                [48.0, 34.0, 4.0, 0.5],
                [12.0, 56.0, -5.0, 1.4],
                [-35.0, 49.0, -5.0, 1.1],
                [-58.0, 23.0, 3.0, 1.4],
                [-54.0, -20.0, -4.0, 1.2],
                [-31.0, -54.0, 0.0, 1.2],
                [13.0, -58.0, -3.0, 0.8],
                [40.0, -41.0, 3.0, 1.1],
                [72.0, -2.0, -4.0, 1.5],
                [54.0, 43.0, -1.0, 0.8],
                [14.0, 69.0, -3.0, 1.2],
                [-37.0, 63.0, 1.0, 0.9],
                [-68.0, 20.0, 1.0, 1.5],
                [-66.0, -29.0, -5.0, 0.9],
                [-38.0, -61.0, 0.0, 1.5],
                [10.0, -72.0, 2.0, 0.8],
                [51.0, -50.0, -4.0, 1.1],
                [76.0, -2.0, -5.0, 1.5],
                [60.0, 56.0, -5.0, 1.3],
                [11.0, 81.0, -5.0, 1.4],
                [-45.0, 68.0, 3.0, 0.8],
                [-77.0, 28.0, -1.0, 0.8],
                [-77.0, -31.0, -3.0, 1.4],
                [-38.0, -71.0, 1.0, 0.8],
                [11.0, -82.0, 4.0, 1.0],
                [62.0, -52.0, 2.0, 0.7],
                [92.0, 0.0, 2.0, 1.2],
                [72.0, 58.0, 4.0, 1.5],
                [20.0, 84.0, 3.0, 0.6],
                [-46.0, 77.0, -4.0, 0.9],
                [-85.0, 27.0, 3.0, 1.5],
                [-81.0, -33.0, 4.0, 0.9],
                [-44.0, -75.0, -1.0, 1.1],
                [16.0, -89.0, 0.0, 1.1],
                [70.0, -54.0, -1.0, 1.3],
                [104.0, 1.0, 4.0, 0.6],
                [79.0, 64.0, 1.0, 0.8],
                [19.0, 95.0, 0.0, 1.4],
                [-50.0, 82.0, 1.0, 0.7],
                [-96.0, 38.0, 3.0, 1.1],
                [-97.0, -37.0, 2.0, 0.9],
                [-53.0, -91.0, 1.0, 0.8],
                [21.0, -96.0, -5.0, 1.5],
                [73.0, -67.0, 1.0, 1.2],
            ]
        )
        basis0 = BSplineBasis(
            4, np.array([-2.2, -1.4, 0.0, 0.0, 0.7, 2.4, 3.3, 4.1, 5.1, 5.8, 6.6, 8.0, 8.0, 8.7, 10.4]), 1
        )
        basis1 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.3, 2.0, 2.0, 2.0, 2.0]))
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2.mirror([0, 0, 3])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 2] = -pt2[..., 2]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_volume_3D_p434_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [47.0, -2.0, 3.0, 1.1],
                [42.0, 35.0, -4.0, 0.7],
                [9.0, 53.0, 0.0, 0.9],
                [-25.0, 40.0, -2.0, 1.0],
                [-44.0, 14.0, -3.0, 1.3],
                [-49.0, -13.0, -3.0, 0.7],
                [-24.0, -40.0, 2.0, 1.3],
                [5.0, -51.0, -3.0, 0.7],
                [33.0, -32.0, 2.0, 0.9],
                [69.0, -3.0, 2.0, 0.7],
                [55.0, 42.0, -2.0, 1.2],
                [8.0, 61.0, 4.0, 0.7],
                [-36.0, 59.0, 2.0, 0.9],
                [-62.0, 25.0, -3.0, 1.3],
                [-61.0, -18.0, -3.0, 0.9],
                [-32.0, -62.0, -1.0, 1.3],
                [6.0, -69.0, -4.0, 0.9],
                [49.0, -48.0, -5.0, 0.8],
                [82.0, -1.0, -1.0, 0.5],
                [60.0, 53.0, 3.0, 1.4],
                [10.0, 81.0, 0.0, 1.1],
                [-41.0, 72.0, 4.0, 1.4],
                [-77.0, 28.0, 1.0, 1.4],
                [-75.0, -25.0, -1.0, 1.4],
                [-45.0, -71.0, -3.0, 1.0],
                [17.0, -80.0, 2.0, 0.6],
                [64.0, -56.0, 4.0, 0.8],
                [95.0, -1.0, -3.0, 0.7],
                [71.0, 63.0, -3.0, 0.6],
                [20.0, 102.0, -5.0, 0.6],
                [-52.0, 90.0, -2.0, 1.0],
                [-94.0, 35.0, -2.0, 1.4],
                [-99.0, -34.0, 0.0, 0.9],
                [-48.0, -89.0, 3.0, 1.1],
                [20.0, -101.0, 2.0, 0.6],
                [77.0, -60.0, 2.0, 1.5],
                [48.0, -1.0, 6.0, 0.5],
                [39.0, 31.0, 8.0, 1.4],
                [12.0, 47.0, 7.0, 1.2],
                [-29.0, 39.0, 5.0, 0.7],
                [-52.0, 16.0, 4.0, 1.2],
                [-45.0, -15.0, 5.0, 0.7],
                [-30.0, -45.0, 10.0, 0.6],
                [8.0, -47.0, 7.0, 0.8],
                [41.0, -33.0, 7.0, 1.2],
                [68.0, 1.0, 8.0, 1.2],
                [53.0, 46.0, 5.0, 1.0],
                [8.0, 66.0, 6.0, 1.0],
                [-37.0, 61.0, 11.0, 0.7],
                [-60.0, 24.0, 3.0, 1.3],
                [-66.0, -24.0, 7.0, 0.9],
                [-31.0, -57.0, 3.0, 1.5],
                [12.0, -67.0, 11.0, 1.3],
                [46.0, -38.0, 9.0, 1.1],
                [85.0, 0.0, 10.0, 1.4],
                [67.0, 56.0, 4.0, 1.3],
                [12.0, 82.0, 5.0, 1.4],
                [-41.0, 73.0, 9.0, 1.1],
                [-84.0, 32.0, 4.0, 0.8],
                [-75.0, -28.0, 8.0, 0.7],
                [-40.0, -72.0, 7.0, 0.6],
                [14.0, -87.0, 7.0, 1.3],
                [63.0, -57.0, 10.0, 1.2],
                [98.0, -3.0, 9.0, 1.4],
                [76.0, 59.0, 3.0, 0.8],
                [15.0, 101.0, 8.0, 1.5],
                [-48.0, 83.0, 10.0, 0.5],
                [-97.0, 34.0, 3.0, 0.7],
                [-93.0, -35.0, 8.0, 1.2],
                [-54.0, -90.0, 10.0, 0.8],
                [13.0, -101.0, 4.0, 0.7],
                [75.0, -65.0, 7.0, 1.1],
                [48.0, -2.0, 12.0, 1.3],
                [34.0, 31.0, 13.0, 1.3],
                [7.0, 54.0, 19.0, 0.6],
                [-23.0, 40.0, 18.0, 0.6],
                [-46.0, 14.0, 16.0, 1.2],
                [-51.0, -20.0, 11.0, 1.2],
                [-27.0, -44.0, 19.0, 0.8],
                [5.0, -47.0, 17.0, 0.9],
                [40.0, -30.0, 16.0, 1.4],
                [66.0, -1.0, 14.0, 1.5],
                [54.0, 40.0, 16.0, 0.9],
                [7.0, 61.0, 18.0, 1.1],
                [-32.0, 60.0, 15.0, 0.7],
                [-63.0, 26.0, 17.0, 0.9],
                [-62.0, -20.0, 16.0, 1.3],
                [-34.0, -62.0, 12.0, 1.3],
                [10.0, -62.0, 13.0, 1.1],
                [49.0, -47.0, 17.0, 1.1],
                [88.0, 3.0, 17.0, 1.3],
                [67.0, 53.0, 18.0, 0.9],
                [19.0, 78.0, 13.0, 0.8],
                [-46.0, 73.0, 13.0, 0.5],
                [-76.0, 30.0, 17.0, 1.1],
                [-83.0, -27.0, 11.0, 0.6],
                [-38.0, -71.0, 16.0, 0.7],
                [16.0, -82.0, 18.0, 1.0],
                [58.0, -56.0, 18.0, 1.1],
                [95.0, -3.0, 20.0, 1.0],
                [74.0, 62.0, 20.0, 1.4],
                [18.0, 97.0, 18.0, 1.0],
                [-54.0, 86.0, 12.0, 1.3],
                [-93.0, 30.0, 20.0, 0.9],
                [-97.0, -38.0, 19.0, 1.5],
                [-52.0, -85.0, 20.0, 1.0],
                [12.0, -100.0, 13.0, 1.4],
                [75.0, -64.0, 19.0, 0.7],
                [52.0, 4.0, 26.0, 0.6],
                [40.0, 35.0, 24.0, 0.8],
                [4.0, 51.0, 24.0, 0.7],
                [-25.0, 43.0, 28.0, 1.1],
                [-48.0, 17.0, 27.0, 1.2],
                [-48.0, -18.0, 20.0, 1.1],
                [-21.0, -46.0, 27.0, 1.4],
                [11.0, -51.0, 26.0, 1.2],
                [34.0, -34.0, 23.0, 1.4],
                [70.0, 1.0, 22.0, 1.0],
                [47.0, 39.0, 25.0, 1.1],
                [7.0, 68.0, 25.0, 0.8],
                [-36.0, 53.0, 28.0, 1.1],
                [-59.0, 27.0, 25.0, 1.2],
                [-67.0, -20.0, 22.0, 0.8],
                [-34.0, -56.0, 20.0, 0.7],
                [8.0, -69.0, 22.0, 1.4],
                [50.0, -46.0, 22.0, 0.9],
                [87.0, -4.0, 19.0, 1.4],
                [58.0, 52.0, 21.0, 0.8],
                [9.0, 81.0, 25.0, 0.8],
                [-46.0, 71.0, 23.0, 1.0],
                [-76.0, 32.0, 20.0, 1.5],
                [-75.0, -30.0, 26.0, 1.0],
                [-45.0, -73.0, 23.0, 1.0],
                [19.0, -82.0, 20.0, 0.7],
                [61.0, -56.0, 20.0, 1.0],
                [95.0, -1.0, 24.0, 0.7],
                [78.0, 59.0, 28.0, 1.5],
                [14.0, 101.0, 19.0, 0.6],
                [-54.0, 90.0, 22.0, 1.5],
                [-98.0, 30.0, 23.0, 0.6],
                [-91.0, -39.0, 27.0, 1.3],
                [-53.0, -86.0, 28.0, 1.2],
                [15.0, -104.0, 19.0, 1.5],
                [76.0, -66.0, 26.0, 0.6],
                [52.0, 4.0, 34.0, 1.3],
                [36.0, 33.0, 33.0, 1.4],
                [4.0, 46.0, 32.0, 1.0],
                [-28.0, 42.0, 30.0, 0.9],
                [-48.0, 13.0, 31.0, 0.7],
                [-50.0, -19.0, 30.0, 0.7],
                [-28.0, -44.0, 32.0, 0.6],
                [8.0, -46.0, 35.0, 0.7],
                [42.0, -37.0, 29.0, 0.7],
                [65.0, 1.0, 27.0, 1.1],
                [49.0, 41.0, 31.0, 1.4],
                [14.0, 63.0, 28.0, 0.5],
                [-31.0, 57.0, 28.0, 1.0],
                [-60.0, 19.0, 28.0, 1.2],
                [-61.0, -25.0, 33.0, 1.0],
                [-34.0, -54.0, 33.0, 1.5],
                [13.0, -62.0, 35.0, 0.9],
                [51.0, -48.0, 29.0, 0.6],
                [79.0, -1.0, 33.0, 0.5],
                [66.0, 57.0, 31.0, 1.2],
                [18.0, 82.0, 31.0, 1.3],
                [-41.0, 75.0, 34.0, 1.2],
                [-79.0, 27.0, 28.0, 0.6],
                [-83.0, -26.0, 36.0, 1.1],
                [-45.0, -72.0, 27.0, 1.0],
                [12.0, -88.0, 28.0, 1.1],
                [63.0, -54.0, 34.0, 1.3],
                [97.0, -3.0, 31.0, 0.7],
                [77.0, 63.0, 35.0, 0.6],
                [15.0, 97.0, 28.0, 1.5],
                [-55.0, 83.0, 27.0, 0.7],
                [-96.0, 36.0, 35.0, 1.2],
                [-90.0, -35.0, 28.0, 1.4],
                [-50.0, -83.0, 32.0, 1.0],
                [17.0, -102.0, 31.0, 0.7],
                [81.0, -67.0, 30.0, 1.1],
                [47.0, 1.0, 44.0, 1.1],
                [36.0, 29.0, 40.0, 1.2],
                [8.0, 46.0, 35.0, 0.5],
                [-21.0, 44.0, 35.0, 1.0],
                [-52.0, 17.0, 43.0, 0.8],
                [-46.0, -20.0, 42.0, 0.7],
                [-25.0, -47.0, 42.0, 0.7],
                [10.0, -50.0, 44.0, 0.6],
                [34.0, -34.0, 35.0, 1.1],
                [64.0, -3.0, 42.0, 0.7],
                [47.0, 47.0, 43.0, 0.7],
                [10.0, 62.0, 36.0, 1.1],
                [-31.0, 59.0, 38.0, 1.4],
                [-59.0, 19.0, 36.0, 1.5],
                [-60.0, -24.0, 39.0, 1.1],
                [-36.0, -62.0, 44.0, 1.2],
                [10.0, -71.0, 41.0, 1.2],
                [53.0, -40.0, 39.0, 1.0],
                [81.0, -3.0, 42.0, 0.8],
                [67.0, 53.0, 36.0, 1.5],
                [12.0, 80.0, 38.0, 1.1],
                [-43.0, 71.0, 42.0, 0.5],
                [-81.0, 31.0, 37.0, 0.8],
                [-76.0, -25.0, 38.0, 1.0],
                [-45.0, -72.0, 43.0, 0.9],
                [16.0, -85.0, 43.0, 0.8],
                [62.0, -55.0, 42.0, 0.5],
                [95.0, -5.0, 42.0, 1.4],
                [81.0, 64.0, 41.0, 1.4],
                [18.0, 98.0, 40.0, 0.9],
                [-53.0, 86.0, 38.0, 0.8],
                [-92.0, 34.0, 36.0, 1.4],
                [-96.0, -36.0, 43.0, 1.4],
                [-51.0, -84.0, 35.0, 1.4],
                [17.0, -102.0, 38.0, 1.4],
                [73.0, -62.0, 41.0, 0.9],
            ]
        )
        basis0 = BSplineBasis(
            4, np.array([-1.8, -0.8, 0.0, 0.0, 0.8, 2.2, 3.2, 4.2, 5.3, 6.2, 7.2, 8.0, 8.0, 8.8, 10.2]), 1
        )
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 0.7, 2.0, 2.0, 2.0]))
        basis2 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.2, 2.2, 3.0, 3.0, 3.0, 3.0]))
        vol = Volume(basis0, basis1, basis2, controlpoints, True)
        vol2 = vol.clone()
        vol2 += np.array([1.7, 2.4, 7.1])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] -= 1.700000
        pt2[..., 1] -= 2.400000
        pt2[..., 2] -= 7.100000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_volume_3D_p443_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [53.0, -3.0, 4.0, 0.8],
                [21.0, 41.0, 1.0, 0.9],
                [-30.0, 43.0, 3.0, 0.8],
                [-51.0, 4.0, -4.0, 1.3],
                [-26.0, -43.0, -5.0, 0.7],
                [28.0, -42.0, -2.0, 1.3],
                [58.0, -1.0, -2.0, 1.4],
                [32.0, 53.0, 0.0, 0.6],
                [-29.0, 54.0, -5.0, 1.0],
                [-58.0, -3.0, -5.0, 0.6],
                [-30.0, -50.0, 4.0, 1.1],
                [30.0, -54.0, -5.0, 0.9],
                [77.0, 2.0, -4.0, 0.7],
                [39.0, 69.0, -4.0, 1.1],
                [-34.0, 64.0, 3.0, 0.7],
                [-72.0, 2.0, 4.0, 1.1],
                [-38.0, -62.0, -2.0, 1.5],
                [36.0, -67.0, 1.0, 1.2],
                [82.0, -5.0, 2.0, 1.0],
                [41.0, 77.0, -3.0, 0.7],
                [-39.0, 77.0, 1.0, 0.9],
                [-86.0, -4.0, 4.0, 1.4],
                [-41.0, -74.0, 2.0, 0.9],
                [39.0, -73.0, 0.0, 0.6],
                [99.0, -5.0, -3.0, 1.0],
                [49.0, 83.0, -1.0, 1.4],
                [-55.0, 90.0, -2.0, 0.8],
                [-100.0, -1.0, 2.0, 0.8],
                [-55.0, -90.0, 4.0, 1.1],
                [45.0, -84.0, 0.0, 0.5],
                [54.0, -2.0, 8.0, 1.5],
                [26.0, 41.0, 8.0, 0.9],
                [-23.0, 44.0, 2.0, 1.0],
                [-46.0, -3.0, 7.0, 1.1],
                [-28.0, -42.0, 7.0, 0.6],
                [26.0, -46.0, 1.0, 0.9],
                [65.0, 0.0, 0.0, 0.5],
                [34.0, 57.0, 4.0, 1.4],
                [-34.0, 53.0, 6.0, 0.7],
                [-58.0, -4.0, 2.0, 0.5],
                [-29.0, -55.0, 9.0, 0.6],
                [33.0, -51.0, 4.0, 0.7],
                [71.0, -1.0, 10.0, 0.5],
                [36.0, 65.0, 5.0, 0.9],
                [-40.0, 63.0, 4.0, 0.8],
                [-74.0, -2.0, 6.0, 1.1],
                [-38.0, -63.0, 2.0, 0.6],
                [35.0, -65.0, 3.0, 0.9],
                [90.0, -2.0, 4.0, 1.0],
                [42.0, 75.0, 2.0, 1.0],
                [-42.0, 75.0, 7.0, 0.7],
                [-87.0, -4.0, 1.0, 1.3],
                [-42.0, -78.0, 8.0, 1.4],
                [42.0, -79.0, 6.0, 0.6],
                [99.0, 0.0, 3.0, 1.4],
                [46.0, 87.0, 1.0, 0.8],
                [-54.0, 82.0, 5.0, 0.9],
                [-97.0, 3.0, 5.0, 1.4],
                [-52.0, -89.0, 10.0, 1.3],
                [54.0, -85.0, 3.0, 0.6],
                [50.0, 0.0, 11.0, 1.0],
                [29.0, 43.0, 6.0, 1.2],
                [-22.0, 42.0, 7.0, 0.8],
                [-53.0, -2.0, 14.0, 1.0],
                [-29.0, -44.0, 8.0, 1.3],
                [20.0, -41.0, 14.0, 1.2],
                [64.0, -2.0, 12.0, 1.1],
                [31.0, 52.0, 10.0, 1.1],
                [-30.0, 55.0, 13.0, 1.3],
                [-66.0, 2.0, 14.0, 1.2],
                [-31.0, -55.0, 8.0, 1.4],
                [34.0, -59.0, 7.0, 1.2],
                [73.0, -2.0, 8.0, 1.2],
                [41.0, 66.0, 8.0, 0.7],
                [-42.0, 61.0, 11.0, 0.8],
                [-79.0, 1.0, 12.0, 1.2],
                [-36.0, -62.0, 8.0, 1.4],
                [37.0, -68.0, 6.0, 1.3],
                [89.0, -3.0, 11.0, 0.8],
                [40.0, 75.0, 14.0, 1.4],
                [-46.0, 77.0, 15.0, 1.0],
                [-84.0, 1.0, 15.0, 0.9],
                [-41.0, -80.0, 11.0, 1.4],
                [41.0, -72.0, 10.0, 1.1],
                [104.0, -3.0, 13.0, 0.8],
                [50.0, 85.0, 15.0, 0.7],
                [-48.0, 89.0, 11.0, 1.2],
                [-98.0, 4.0, 12.0, 1.0],
                [-55.0, -85.0, 11.0, 1.4],
                [53.0, -87.0, 15.0, 1.0],
                [53.0, -2.0, 14.0, 1.3],
                [25.0, 41.0, 17.0, 1.1],
                [-28.0, 47.0, 13.0, 0.7],
                [-46.0, 4.0, 20.0, 0.9],
                [-29.0, -45.0, 21.0, 0.9],
                [24.0, -44.0, 20.0, 1.3],
                [65.0, -2.0, 20.0, 1.1],
                [32.0, 54.0, 17.0, 0.8],
                [-35.0, 52.0, 19.0, 0.7],
                [-59.0, -2.0, 19.0, 1.5],
                [-35.0, -50.0, 15.0, 1.1],
                [29.0, -58.0, 19.0, 1.4],
                [75.0, 3.0, 21.0, 1.4],
                [39.0, 64.0, 21.0, 1.4],
                [-40.0, 67.0, 12.0, 0.7],
                [-72.0, 1.0, 21.0, 1.4],
                [-40.0, -64.0, 18.0, 1.1],
                [39.0, -67.0, 12.0, 0.6],
                [88.0, -3.0, 18.0, 1.2],
                [44.0, 79.0, 21.0, 1.3],
                [-48.0, 71.0, 16.0, 0.7],
                [-87.0, 0.0, 14.0, 1.3],
                [-47.0, -79.0, 14.0, 1.1],
                [47.0, -72.0, 18.0, 0.7],
                [103.0, -3.0, 17.0, 1.2],
                [46.0, 91.0, 20.0, 1.5],
                [-51.0, 81.0, 20.0, 1.1],
                [-104.0, 4.0, 16.0, 0.8],
                [-50.0, -90.0, 12.0, 0.6],
                [48.0, -87.0, 20.0, 0.6],
                [50.0, -4.0, 26.0, 0.9],
                [26.0, 45.0, 24.0, 1.0],
                [-26.0, 39.0, 20.0, 0.8],
                [-52.0, -2.0, 24.0, 1.2],
                [-29.0, -47.0, 23.0, 0.7],
                [29.0, -44.0, 26.0, 1.0],
                [66.0, -3.0, 21.0, 0.5],
                [33.0, 50.0, 25.0, 1.4],
                [-27.0, 58.0, 18.0, 0.9],
                [-60.0, -3.0, 23.0, 1.1],
                [-34.0, -59.0, 23.0, 1.5],
                [30.0, -50.0, 20.0, 1.3],
                [71.0, -3.0, 21.0, 1.4],
                [35.0, 60.0, 23.0, 1.4],
                [-43.0, 61.0, 20.0, 0.9],
                [-73.0, -3.0, 23.0, 1.3],
                [-42.0, -63.0, 22.0, 1.4],
                [34.0, -69.0, 23.0, 1.2],
                [92.0, 3.0, 27.0, 1.4],
                [40.0, 77.0, 23.0, 1.4],
                [-45.0, 73.0, 22.0, 1.4],
                [-92.0, -4.0, 18.0, 1.3],
                [-39.0, -72.0, 23.0, 1.2],
                [44.0, -73.0, 20.0, 1.1],
                [102.0, 3.0, 19.0, 1.2],
                [53.0, 88.0, 24.0, 0.6],
                [-54.0, 89.0, 19.0, 0.9],
                [-102.0, 1.0, 24.0, 0.5],
                [-46.0, -83.0, 18.0, 0.7],
                [50.0, -89.0, 20.0, 1.5],
                [50.0, 1.0, 30.0, 1.5],
                [23.0, 40.0, 29.0, 1.2],
                [-25.0, 44.0, 32.0, 0.7],
                [-48.0, 2.0, 27.0, 1.5],
                [-30.0, -39.0, 31.0, 1.0],
                [20.0, -42.0, 30.0, 1.4],
                [58.0, 2.0, 24.0, 0.8],
                [35.0, 50.0, 24.0, 0.8],
                [-28.0, 52.0, 30.0, 0.9],
                [-58.0, -5.0, 30.0, 1.4],
                [-37.0, -51.0, 26.0, 1.0],
                [26.0, -51.0, 30.0, 1.2],
                [75.0, 4.0, 23.0, 1.4],
                [33.0, 62.0, 26.0, 1.2],
                [-43.0, 64.0, 26.0, 1.5],
                [-80.0, 1.0, 32.0, 1.0],
                [-38.0, -66.0, 32.0, 1.2],
                [36.0, -65.0, 32.0, 0.8],
                [86.0, -1.0, 31.0, 0.9],
                [43.0, 78.0, 29.0, 0.7],
                [-41.0, 80.0, 30.0, 0.8],
                [-90.0, -3.0, 31.0, 0.5],
                [-47.0, -77.0, 33.0, 1.1],
                [43.0, -76.0, 32.0, 0.9],
                [98.0, 3.0, 30.0, 0.7],
                [54.0, 83.0, 31.0, 1.3],
                [-52.0, 87.0, 25.0, 0.7],
                [-96.0, -4.0, 23.0, 1.1],
                [-52.0, -89.0, 31.0, 1.3],
                [49.0, -92.0, 28.0, 1.1],
                [48.0, -2.0, 38.0, 0.6],
                [20.0, 45.0, 33.0, 1.4],
                [-30.0, 45.0, 38.0, 1.1],
                [-47.0, -2.0, 31.0, 1.4],
                [-30.0, -45.0, 30.0, 0.6],
                [20.0, -44.0, 37.0, 1.0],
                [57.0, -2.0, 34.0, 1.0],
                [30.0, 53.0, 29.0, 0.6],
                [-36.0, 56.0, 30.0, 1.3],
                [-58.0, -4.0, 39.0, 0.5],
                [-29.0, -55.0, 34.0, 0.7],
                [34.0, -57.0, 37.0, 0.7],
                [78.0, 3.0, 34.0, 0.8],
                [36.0, 69.0, 39.0, 0.9],
                [-42.0, 64.0, 29.0, 0.7],
                [-78.0, -2.0, 30.0, 1.1],
                [-38.0, -69.0, 33.0, 0.6],
                [37.0, -69.0, 34.0, 1.4],
                [84.0, 2.0, 34.0, 0.7],
                [42.0, 80.0, 32.0, 0.7],
                [-40.0, 77.0, 35.0, 1.0],
                [-91.0, 3.0, 32.0, 0.7],
                [-44.0, -80.0, 33.0, 1.3],
                [43.0, -78.0, 38.0, 0.7],
                [104.0, -4.0, 37.0, 0.9],
                [45.0, 83.0, 30.0, 0.9],
                [-47.0, 83.0, 35.0, 1.0],
                [-100.0, 1.0, 37.0, 1.4],
                [-48.0, -90.0, 35.0, 0.6],
                [47.0, -90.0, 31.0, 0.9],
                [54.0, -4.0, 37.0, 1.3],
                [29.0, 47.0, 37.0, 0.7],
                [-21.0, 44.0, 42.0, 1.2],
                [-54.0, 3.0, 38.0, 1.3],
                [-22.0, -46.0, 42.0, 0.6],
                [24.0, -41.0, 42.0, 1.3],
                [64.0, 4.0, 40.0, 0.6],
                [28.0, 52.0, 41.0, 1.3],
                [-34.0, 54.0, 35.0, 1.4],
                [-63.0, 3.0, 37.0, 0.9],
                [-27.0, -52.0, 37.0, 0.5],
                [33.0, -54.0, 36.0, 0.7],
                [70.0, -3.0, 41.0, 1.3],
                [37.0, 64.0, 43.0, 1.0],
                [-36.0, 60.0, 44.0, 1.1],
                [-79.0, -2.0, 39.0, 1.2],
                [-33.0, -63.0, 44.0, 1.0],
                [42.0, -62.0, 41.0, 1.3],
                [84.0, 3.0, 35.0, 1.4],
                [47.0, 76.0, 35.0, 1.1],
                [-43.0, 76.0, 44.0, 1.2],
                [-83.0, -5.0, 43.0, 0.5],
                [-47.0, -80.0, 41.0, 0.8],
                [42.0, -72.0, 36.0, 0.9],
                [96.0, 0.0, 38.0, 1.1],
                [49.0, 86.0, 40.0, 1.1],
                [-46.0, 85.0, 38.0, 0.6],
                [-99.0, -2.0, 39.0, 1.3],
                [-52.0, -89.0, 42.0, 1.5],
                [47.0, -86.0, 39.0, 0.9],
            ]
        )
        basis0 = BSplineBasis(4, np.array([-2.2, -0.8, 0.0, 0.0, 1.3, 1.7, 2.8, 4.2, 5.0, 5.0, 6.3, 6.7]), 1)
        basis1 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 0.7, 2.0, 2.0, 2.0, 2.0]))
        basis2 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 0.7, 2.2, 3.0, 4.4, 4.8, 6.0, 6.0, 6.0]))
        vol = Volume(basis0, basis1, basis2, controlpoints, True)
        vol2 = vol.clone()
        vol2.mirror([0, 0, 2])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 2] = -pt2[..., 2]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_3D_p3(self):
        controlpoints = np.array(
            [
                [-3.0, -1.0, -2.0],
                [12.0, 2.0, -1.0],
                [29.0, 4.0, 3.0],
                [47.0, 3.0, -5.0],
                [61.0, -1.0, 3.0],
                [75.0, 4.0, -3.0],
                [81.0, -2.0, 3.0],
                [95.0, 0.0, -2.0],
            ]
        )
        basis0 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.2, 1.7, 3.2, 3.8, 5.4, 6.0, 6.0, 6.0]))
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 += np.array([3.6, 4.3, 6.6])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 3.600000
        pt2[..., 1] -= 4.300000
        pt2[..., 2] -= 6.600000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_3D_p2(self):
        controlpoints = np.array([[2.0, -2.0, -2.0], [51.0, -3.0, -4.0], [99.0, -5.0, -2.0]])
        basis0 = BSplineBasis(2, np.array([0.0, 0.0, 1.0, 2.0, 2.0]))
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 *= np.array([5.8, 7.0, 6.5])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 5.800000
        pt2[..., 1] /= 7.000000
        pt2[..., 2] /= 6.500000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_curve_3D_p3(self):
        controlpoints = np.array(
            [
                [4.0, -1.0, 1.0],
                [12.0, -2.0, 0.0],
                [38.0, -2.0, 1.0],
                [54.0, -2.0, -2.0],
                [67.0, 4.0, 2.0],
                [87.0, 4.0, 2.0],
                [100.0, -4.0, -1.0],
            ]
        )
        basis0 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.2, 2.3, 2.6, 4.1, 5.0, 5.0, 5.0]))
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2.mirror([2, 0, 0])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] = -pt2[..., 0]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_3D_p43(self):
        controlpoints = np.array(
            [
                [4.0, 0.0, 2.0],
                [18.0, -3.0, -4.0],
                [41.0, 4.0, -5.0],
                [55.0, 2.0, 3.0],
                [84.0, -4.0, 2.0],
                [98.0, -5.0, 3.0],
                [0.0, 18.0, 4.0],
                [24.0, 18.0, 2.0],
                [42.0, 17.0, 2.0],
                [55.0, 17.0, 3.0],
                [76.0, 23.0, -5.0],
                [97.0, 22.0, -5.0],
                [3.0, 37.0, 1.0],
                [15.0, 35.0, -5.0],
                [43.0, 41.0, 4.0],
                [57.0, 43.0, 2.0],
                [75.0, 37.0, 4.0],
                [96.0, 43.0, 3.0],
                [0.0, 62.0, 1.0],
                [15.0, 56.0, 1.0],
                [44.0, 61.0, -3.0],
                [58.0, 55.0, 2.0],
                [76.0, 62.0, 2.0],
                [95.0, 56.0, -2.0],
                [-1.0, 84.0, 0.0],
                [21.0, 75.0, -4.0],
                [41.0, 81.0, 2.0],
                [60.0, 82.0, -2.0],
                [79.0, 79.0, 3.0],
                [101.0, 76.0, -1.0],
                [-3.0, 95.0, 1.0],
                [24.0, 96.0, 4.0],
                [36.0, 96.0, -4.0],
                [64.0, 100.0, 2.0],
                [81.0, 100.0, -1.0],
                [104.0, 99.0, -2.0],
            ]
        )
        basis0 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.1, 2.1, 3.0, 3.0, 3.0, 3.0]))
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.4, 2.0, 3.4, 4.0, 4.0, 4.0]))
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 += np.array([5.1, 3.7, 6.1])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 5.100000
        pt2[..., 1] -= 3.700000
        pt2[..., 2] -= 6.100000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_surface_3D_p42(self):
        controlpoints = np.array(
            [
                [3.0, 4.0, 1.0],
                [18.0, 4.0, -2.0],
                [38.0, -4.0, 3.0],
                [60.0, -1.0, 0.0],
                [77.0, -5.0, 1.0],
                [100.0, 0.0, -3.0],
                [1.0, 28.0, 0.0],
                [23.0, 27.0, 4.0],
                [38.0, 26.0, 4.0],
                [61.0, 26.0, 2.0],
                [81.0, 28.0, -2.0],
                [96.0, 25.0, -5.0],
                [-2.0, 46.0, 4.0],
                [19.0, 51.0, 1.0],
                [38.0, 54.0, 3.0],
                [59.0, 46.0, -3.0],
                [82.0, 51.0, 1.0],
                [100.0, 49.0, -2.0],
                [-3.0, 72.0, 0.0],
                [24.0, 76.0, -4.0],
                [35.0, 70.0, -3.0],
                [63.0, 74.0, -4.0],
                [80.0, 78.0, -1.0],
                [104.0, 74.0, 1.0],
                [-4.0, 103.0, -2.0],
                [23.0, 95.0, 2.0],
                [43.0, 95.0, 1.0],
                [63.0, 97.0, -5.0],
                [80.0, 103.0, 1.0],
                [104.0, 103.0, 4.0],
            ]
        )
        basis0 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.1, 1.7, 3.0, 3.0, 3.0, 3.0]))
        basis1 = BSplineBasis(2, np.array([0.0, 0.0, 1.1, 2.4, 2.9, 4.0, 4.0]))
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 *= np.array([3.2, 4.3, 7.6])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 3.200000
        pt2[..., 1] /= 4.300000
        pt2[..., 2] /= 7.600000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_surface_3D_p22(self):
        controlpoints = np.array(
            [
                [-5.0, -5.0, 2.0],
                [29.0, 4.0, 1.0],
                [47.0, 2.0, 1.0],
                [78.0, 2.0, -2.0],
                [95.0, 0.0, 1.0],
                [-3.0, 28.0, -2.0],
                [24.0, 20.0, -2.0],
                [45.0, 22.0, -3.0],
                [75.0, 25.0, -5.0],
                [95.0, 23.0, -5.0],
                [4.0, 51.0, 2.0],
                [29.0, 46.0, -4.0],
                [47.0, 54.0, 3.0],
                [77.0, 49.0, 1.0],
                [98.0, 47.0, -1.0],
                [-2.0, 75.0, -3.0],
                [21.0, 73.0, -3.0],
                [51.0, 75.0, 2.0],
                [71.0, 73.0, -4.0],
                [97.0, 79.0, 4.0],
                [2.0, 104.0, -5.0],
                [23.0, 103.0, -1.0],
                [49.0, 101.0, 2.0],
                [74.0, 102.0, -5.0],
                [97.0, 103.0, 4.0],
            ]
        )
        basis0 = BSplineBasis(2, np.array([0.0, 0.0, 0.8, 2.2, 3.1, 4.0, 4.0]))
        basis1 = BSplineBasis(2, np.array([0.0, 0.0, 1.2, 2.0, 2.8, 4.0, 4.0]))
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2.mirror([2, 0, 0])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] = -pt2[..., 0]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_volume_3D_p334(self):
        controlpoints = np.array(
            [
                [1.0, 1.0, 4.0],
                [17.0, 2.0, 3.0],
                [29.0, 1.0, 4.0],
                [37.0, -3.0, 3.0],
                [52.0, 1.0, 1.0],
                [70.0, 1.0, 0.0],
                [82.0, 3.0, 4.0],
                [96.0, 1.0, 0.0],
                [-5.0, 18.0, -3.0],
                [10.0, 20.0, 0.0],
                [27.0, 21.0, -1.0],
                [46.0, 17.0, -4.0],
                [60.0, 18.0, 2.0],
                [74.0, 22.0, -5.0],
                [88.0, 18.0, -4.0],
                [103.0, 16.0, 1.0],
                [3.0, 40.0, 0.0],
                [17.0, 44.0, -5.0],
                [24.0, 38.0, -2.0],
                [46.0, 43.0, -2.0],
                [61.0, 38.0, 3.0],
                [68.0, 43.0, 1.0],
                [84.0, 39.0, 2.0],
                [104.0, 35.0, 4.0],
                [-5.0, 63.0, -1.0],
                [17.0, 59.0, 2.0],
                [27.0, 55.0, -4.0],
                [45.0, 58.0, 3.0],
                [52.0, 62.0, -2.0],
                [68.0, 62.0, -5.0],
                [84.0, 64.0, 2.0],
                [101.0, 55.0, 0.0],
                [-1.0, 78.0, -3.0],
                [16.0, 83.0, -1.0],
                [33.0, 75.0, 3.0],
                [44.0, 81.0, -5.0],
                [52.0, 80.0, 0.0],
                [71.0, 78.0, 2.0],
                [84.0, 76.0, -5.0],
                [96.0, 83.0, -4.0],
                [-5.0, 101.0, -1.0],
                [12.0, 96.0, -3.0],
                [33.0, 98.0, 4.0],
                [47.0, 97.0, -5.0],
                [54.0, 97.0, 3.0],
                [74.0, 99.0, 2.0],
                [80.0, 96.0, -3.0],
                [104.0, 96.0, 3.0],
                [-5.0, 4.0, 14.0],
                [17.0, 1.0, 12.0],
                [26.0, -5.0, 16.0],
                [47.0, -1.0, 17.0],
                [52.0, 4.0, 13.0],
                [70.0, -4.0, 12.0],
                [84.0, 3.0, 13.0],
                [102.0, 3.0, 10.0],
                [-1.0, 16.0, 16.0],
                [18.0, 20.0, 13.0],
                [26.0, 24.0, 14.0],
                [37.0, 21.0, 12.0],
                [57.0, 17.0, 19.0],
                [69.0, 24.0, 16.0],
                [87.0, 16.0, 15.0],
                [102.0, 23.0, 14.0],
                [-3.0, 39.0, 15.0],
                [18.0, 40.0, 18.0],
                [26.0, 39.0, 12.0],
                [38.0, 35.0, 14.0],
                [60.0, 42.0, 14.0],
                [73.0, 39.0, 16.0],
                [87.0, 44.0, 10.0],
                [98.0, 39.0, 14.0],
                [1.0, 59.0, 12.0],
                [14.0, 57.0, 17.0],
                [32.0, 62.0, 17.0],
                [42.0, 55.0, 16.0],
                [53.0, 57.0, 18.0],
                [68.0, 57.0, 13.0],
                [88.0, 55.0, 10.0],
                [102.0, 59.0, 16.0],
                [2.0, 84.0, 12.0],
                [18.0, 77.0, 17.0],
                [27.0, 84.0, 14.0],
                [46.0, 81.0, 13.0],
                [53.0, 82.0, 17.0],
                [67.0, 81.0, 17.0],
                [82.0, 80.0, 14.0],
                [99.0, 78.0, 11.0],
                [4.0, 100.0, 15.0],
                [18.0, 95.0, 18.0],
                [32.0, 99.0, 19.0],
                [47.0, 100.0, 10.0],
                [57.0, 98.0, 14.0],
                [68.0, 101.0, 11.0],
                [88.0, 103.0, 18.0],
                [97.0, 96.0, 11.0],
                [0.0, 0.0, 32.0],
                [10.0, 3.0, 31.0],
                [23.0, 0.0, 25.0],
                [44.0, -5.0, 29.0],
                [55.0, 4.0, 26.0],
                [70.0, -4.0, 29.0],
                [89.0, -1.0, 26.0],
                [100.0, -4.0, 33.0],
                [4.0, 17.0, 31.0],
                [11.0, 24.0, 26.0],
                [25.0, 22.0, 23.0],
                [40.0, 18.0, 26.0],
                [61.0, 24.0, 31.0],
                [74.0, 15.0, 30.0],
                [86.0, 22.0, 27.0],
                [98.0, 15.0, 24.0],
                [2.0, 39.0, 26.0],
                [17.0, 42.0, 33.0],
                [30.0, 37.0, 25.0],
                [44.0, 35.0, 31.0],
                [52.0, 39.0, 24.0],
                [67.0, 39.0, 33.0],
                [81.0, 38.0, 24.0],
                [95.0, 36.0, 24.0],
                [-1.0, 62.0, 30.0],
                [13.0, 63.0, 26.0],
                [27.0, 60.0, 31.0],
                [46.0, 57.0, 26.0],
                [56.0, 62.0, 26.0],
                [72.0, 59.0, 32.0],
                [88.0, 55.0, 25.0],
                [103.0, 62.0, 24.0],
                [-3.0, 84.0, 29.0],
                [14.0, 82.0, 27.0],
                [25.0, 84.0, 31.0],
                [43.0, 77.0, 26.0],
                [53.0, 75.0, 29.0],
                [67.0, 82.0, 23.0],
                [88.0, 80.0, 27.0],
                [96.0, 81.0, 31.0],
                [2.0, 96.0, 25.0],
                [17.0, 101.0, 27.0],
                [25.0, 101.0, 24.0],
                [46.0, 104.0, 25.0],
                [61.0, 103.0, 29.0],
                [73.0, 98.0, 24.0],
                [84.0, 98.0, 23.0],
                [95.0, 102.0, 27.0],
                [0.0, -2.0, 38.0],
                [10.0, 4.0, 42.0],
                [24.0, -4.0, 45.0],
                [44.0, -1.0, 42.0],
                [54.0, 1.0, 40.0],
                [66.0, 2.0, 43.0],
                [85.0, 0.0, 42.0],
                [103.0, 1.0, 45.0],
                [3.0, 21.0, 47.0],
                [15.0, 20.0, 39.0],
                [29.0, 17.0, 38.0],
                [44.0, 18.0, 45.0],
                [52.0, 21.0, 47.0],
                [72.0, 16.0, 47.0],
                [89.0, 21.0, 46.0],
                [95.0, 20.0, 39.0],
                [4.0, 41.0, 43.0],
                [9.0, 42.0, 38.0],
                [33.0, 44.0, 39.0],
                [39.0, 42.0, 41.0],
                [53.0, 41.0, 41.0],
                [71.0, 43.0, 47.0],
                [90.0, 44.0, 44.0],
                [95.0, 38.0, 37.0],
                [-2.0, 57.0, 41.0],
                [16.0, 58.0, 46.0],
                [25.0, 55.0, 42.0],
                [42.0, 64.0, 43.0],
                [52.0, 62.0, 41.0],
                [74.0, 63.0, 45.0],
                [80.0, 59.0, 45.0],
                [100.0, 56.0, 39.0],
                [2.0, 84.0, 46.0],
                [18.0, 81.0, 40.0],
                [25.0, 77.0, 45.0],
                [45.0, 78.0, 43.0],
                [58.0, 84.0, 45.0],
                [67.0, 80.0, 43.0],
                [84.0, 84.0, 41.0],
                [104.0, 82.0, 46.0],
                [1.0, 101.0, 44.0],
                [17.0, 97.0, 44.0],
                [33.0, 101.0, 45.0],
                [38.0, 96.0, 39.0],
                [60.0, 95.0, 42.0],
                [66.0, 96.0, 39.0],
                [88.0, 96.0, 39.0],
                [104.0, 102.0, 40.0],
                [4.0, -5.0, 54.0],
                [14.0, -2.0, 52.0],
                [28.0, -2.0, 53.0],
                [47.0, -2.0, 57.0],
                [57.0, 4.0, 53.0],
                [68.0, -4.0, 60.0],
                [83.0, -5.0, 57.0],
                [99.0, 4.0, 56.0],
                [-5.0, 21.0, 58.0],
                [16.0, 24.0, 59.0],
                [33.0, 15.0, 55.0],
                [47.0, 23.0, 56.0],
                [54.0, 15.0, 54.0],
                [68.0, 23.0, 52.0],
                [82.0, 17.0, 61.0],
                [95.0, 24.0, 54.0],
                [-4.0, 41.0, 53.0],
                [13.0, 43.0, 52.0],
                [29.0, 37.0, 54.0],
                [42.0, 44.0, 54.0],
                [58.0, 42.0, 54.0],
                [72.0, 40.0, 55.0],
                [82.0, 42.0, 58.0],
                [97.0, 43.0, 54.0],
                [3.0, 62.0, 54.0],
                [14.0, 57.0, 55.0],
                [32.0, 61.0, 53.0],
                [41.0, 63.0, 53.0],
                [61.0, 55.0, 52.0],
                [69.0, 63.0, 53.0],
                [86.0, 64.0, 52.0],
                [103.0, 59.0, 53.0],
                [-3.0, 76.0, 60.0],
                [12.0, 77.0, 56.0],
                [26.0, 82.0, 61.0],
                [40.0, 76.0, 59.0],
                [58.0, 84.0, 56.0],
                [69.0, 79.0, 53.0],
                [82.0, 75.0, 57.0],
                [102.0, 84.0, 56.0],
                [3.0, 104.0, 57.0],
                [15.0, 96.0, 53.0],
                [30.0, 97.0, 53.0],
                [46.0, 103.0, 56.0],
                [53.0, 102.0, 61.0],
                [75.0, 96.0, 56.0],
                [82.0, 98.0, 55.0],
                [104.0, 101.0, 53.0],
                [1.0, -3.0, 71.0],
                [10.0, -2.0, 69.0],
                [24.0, -3.0, 75.0],
                [46.0, 4.0, 74.0],
                [57.0, 0.0, 71.0],
                [71.0, 4.0, 70.0],
                [85.0, 1.0, 67.0],
                [101.0, 1.0, 72.0],
                [3.0, 17.0, 68.0],
                [15.0, 15.0, 69.0],
                [30.0, 24.0, 74.0],
                [45.0, 22.0, 71.0],
                [61.0, 18.0, 72.0],
                [70.0, 22.0, 70.0],
                [86.0, 24.0, 70.0],
                [98.0, 24.0, 69.0],
                [1.0, 42.0, 74.0],
                [16.0, 40.0, 71.0],
                [30.0, 41.0, 70.0],
                [46.0, 36.0, 70.0],
                [52.0, 42.0, 71.0],
                [75.0, 41.0, 68.0],
                [87.0, 38.0, 66.0],
                [100.0, 44.0, 67.0],
                [-1.0, 61.0, 68.0],
                [18.0, 56.0, 73.0],
                [31.0, 55.0, 75.0],
                [41.0, 57.0, 73.0],
                [57.0, 59.0, 71.0],
                [73.0, 59.0, 71.0],
                [89.0, 58.0, 66.0],
                [96.0, 56.0, 69.0],
                [-4.0, 81.0, 73.0],
                [18.0, 79.0, 74.0],
                [30.0, 81.0, 74.0],
                [43.0, 78.0, 71.0],
                [53.0, 84.0, 74.0],
                [69.0, 83.0, 75.0],
                [86.0, 76.0, 69.0],
                [101.0, 82.0, 76.0],
                [4.0, 100.0, 73.0],
                [10.0, 101.0, 71.0],
                [23.0, 99.0, 67.0],
                [42.0, 102.0, 74.0],
                [53.0, 102.0, 70.0],
                [75.0, 104.0, 73.0],
                [87.0, 100.0, 75.0],
                [97.0, 103.0, 71.0],
                [3.0, 3.0, 84.0],
                [16.0, -4.0, 81.0],
                [29.0, -5.0, 86.0],
                [43.0, 0.0, 90.0],
                [55.0, -4.0, 88.0],
                [73.0, 1.0, 85.0],
                [89.0, 2.0, 82.0],
                [98.0, -5.0, 83.0],
                [4.0, 15.0, 81.0],
                [18.0, 21.0, 89.0],
                [27.0, 21.0, 84.0],
                [43.0, 15.0, 87.0],
                [54.0, 24.0, 85.0],
                [75.0, 19.0, 83.0],
                [90.0, 21.0, 89.0],
                [99.0, 16.0, 83.0],
                [0.0, 37.0, 88.0],
                [9.0, 37.0, 80.0],
                [25.0, 38.0, 83.0],
                [42.0, 35.0, 88.0],
                [57.0, 38.0, 87.0],
                [70.0, 40.0, 81.0],
                [87.0, 39.0, 81.0],
                [100.0, 41.0, 86.0],
                [2.0, 62.0, 85.0],
                [17.0, 59.0, 86.0],
                [32.0, 55.0, 81.0],
                [38.0, 58.0, 82.0],
                [58.0, 64.0, 84.0],
                [75.0, 64.0, 81.0],
                [90.0, 59.0, 88.0],
                [98.0, 63.0, 85.0],
                [2.0, 76.0, 89.0],
                [18.0, 79.0, 86.0],
                [28.0, 75.0, 85.0],
                [41.0, 78.0, 82.0],
                [55.0, 76.0, 80.0],
                [68.0, 81.0, 82.0],
                [88.0, 76.0, 86.0],
                [99.0, 75.0, 80.0],
                [-2.0, 102.0, 83.0],
                [11.0, 96.0, 86.0],
                [28.0, 102.0, 82.0],
                [43.0, 96.0, 83.0],
                [57.0, 95.0, 83.0],
                [75.0, 97.0, 89.0],
                [84.0, 95.0, 82.0],
                [100.0, 97.0, 82.0],
                [2.0, 2.0, 104.0],
                [9.0, -3.0, 95.0],
                [28.0, 4.0, 101.0],
                [39.0, 3.0, 101.0],
                [61.0, 2.0, 95.0],
                [74.0, 2.0, 97.0],
                [88.0, 2.0, 98.0],
                [102.0, 4.0, 99.0],
                [-4.0, 24.0, 101.0],
                [14.0, 24.0, 99.0],
                [32.0, 16.0, 99.0],
                [47.0, 16.0, 104.0],
                [56.0, 15.0, 103.0],
                [69.0, 24.0, 101.0],
                [84.0, 17.0, 104.0],
                [97.0, 18.0, 100.0],
                [1.0, 41.0, 95.0],
                [16.0, 42.0, 102.0],
                [27.0, 38.0, 100.0],
                [45.0, 39.0, 95.0],
                [61.0, 36.0, 98.0],
                [72.0, 37.0, 97.0],
                [81.0, 38.0, 104.0],
                [98.0, 36.0, 98.0],
                [-4.0, 57.0, 97.0],
                [15.0, 56.0, 101.0],
                [30.0, 58.0, 99.0],
                [39.0, 55.0, 98.0],
                [54.0, 60.0, 99.0],
                [71.0, 61.0, 95.0],
                [86.0, 59.0, 97.0],
                [102.0, 61.0, 98.0],
                [2.0, 78.0, 102.0],
                [13.0, 77.0, 97.0],
                [26.0, 77.0, 97.0],
                [41.0, 80.0, 95.0],
                [57.0, 82.0, 104.0],
                [70.0, 81.0, 100.0],
                [89.0, 79.0, 97.0],
                [104.0, 81.0, 100.0],
                [0.0, 99.0, 99.0],
                [10.0, 102.0, 103.0],
                [25.0, 104.0, 101.0],
                [38.0, 95.0, 100.0],
                [60.0, 97.0, 102.0],
                [76.0, 98.0, 100.0],
                [82.0, 96.0, 97.0],
                [101.0, 95.0, 99.0],
            ]
        )
        basis0 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.3, 2.1, 2.9, 3.7, 5.3, 6.0, 6.0, 6.0]))
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.2, 2.2, 3.0, 4.0, 4.0, 4.0]))
        basis2 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.1, 1.6, 2.8, 4.1, 5.0, 5.0, 5.0, 5.0]))
        vol = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2 += np.array([7.9, 7.7, 2.5])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] -= 7.900000
        pt2[..., 1] -= 7.700000
        pt2[..., 2] -= 2.500000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_volume_3D_p232(self):
        controlpoints = np.array(
            [
                [-1.0, -4.0, -1.0],
                [21.0, 3.0, -5.0],
                [36.0, -2.0, 0.0],
                [49.0, 4.0, -4.0],
                [64.0, 0.0, -3.0],
                [78.0, 3.0, -2.0],
                [100.0, 0.0, 1.0],
                [3.0, 18.0, -2.0],
                [13.0, 19.0, -5.0],
                [33.0, 13.0, -5.0],
                [47.0, 14.0, 1.0],
                [64.0, 19.0, 2.0],
                [80.0, 15.0, 4.0],
                [101.0, 12.0, 1.0],
                [3.0, 35.0, -1.0],
                [19.0, 36.0, 4.0],
                [37.0, 37.0, -4.0],
                [45.0, 32.0, 0.0],
                [71.0, 33.0, -4.0],
                [79.0, 33.0, -4.0],
                [102.0, 35.0, 3.0],
                [1.0, 47.0, -1.0],
                [19.0, 54.0, 3.0],
                [34.0, 49.0, 4.0],
                [49.0, 54.0, -1.0],
                [70.0, 46.0, -3.0],
                [88.0, 49.0, -3.0],
                [100.0, 48.0, 1.0],
                [0.0, 69.0, -2.0],
                [12.0, 70.0, 2.0],
                [37.0, 70.0, 4.0],
                [48.0, 62.0, -4.0],
                [66.0, 66.0, -1.0],
                [81.0, 68.0, 1.0],
                [100.0, 69.0, -2.0],
                [4.0, 87.0, 2.0],
                [15.0, 82.0, -2.0],
                [29.0, 85.0, -2.0],
                [54.0, 87.0, -2.0],
                [65.0, 85.0, -2.0],
                [88.0, 88.0, 1.0],
                [96.0, 82.0, -5.0],
                [-5.0, 100.0, -4.0],
                [18.0, 102.0, 0.0],
                [34.0, 102.0, -2.0],
                [54.0, 100.0, 1.0],
                [64.0, 103.0, 4.0],
                [81.0, 102.0, 0.0],
                [100.0, 95.0, 2.0],
                [4.0, -4.0, 34.0],
                [14.0, 3.0, 35.0],
                [29.0, -3.0, 28.0],
                [50.0, -1.0, 30.0],
                [66.0, 1.0, 30.0],
                [82.0, 2.0, 34.0],
                [100.0, 3.0, 29.0],
                [4.0, 15.0, 29.0],
                [19.0, 13.0, 34.0],
                [34.0, 20.0, 34.0],
                [50.0, 15.0, 37.0],
                [62.0, 18.0, 35.0],
                [83.0, 19.0, 30.0],
                [100.0, 19.0, 38.0],
                [1.0, 29.0, 29.0],
                [18.0, 33.0, 37.0],
                [30.0, 32.0, 28.0],
                [52.0, 35.0, 36.0],
                [63.0, 33.0, 37.0],
                [81.0, 29.0, 34.0],
                [100.0, 30.0, 34.0],
                [-1.0, 54.0, 31.0],
                [18.0, 51.0, 31.0],
                [33.0, 45.0, 34.0],
                [51.0, 48.0, 31.0],
                [67.0, 52.0, 30.0],
                [79.0, 45.0, 28.0],
                [99.0, 53.0, 36.0],
                [-2.0, 70.0, 36.0],
                [16.0, 62.0, 31.0],
                [32.0, 68.0, 32.0],
                [50.0, 62.0, 29.0],
                [61.0, 62.0, 29.0],
                [80.0, 62.0, 33.0],
                [101.0, 62.0, 36.0],
                [-3.0, 83.0, 32.0],
                [18.0, 84.0, 37.0],
                [29.0, 83.0, 31.0],
                [50.0, 83.0, 35.0],
                [70.0, 86.0, 31.0],
                [88.0, 81.0, 35.0],
                [99.0, 84.0, 33.0],
                [1.0, 96.0, 33.0],
                [21.0, 96.0, 31.0],
                [36.0, 104.0, 34.0],
                [53.0, 102.0, 37.0],
                [68.0, 101.0, 32.0],
                [78.0, 96.0, 33.0],
                [99.0, 103.0, 29.0],
                [4.0, 2.0, 67.0],
                [11.0, 3.0, 70.0],
                [31.0, -3.0, 71.0],
                [49.0, -4.0, 66.0],
                [71.0, 3.0, 64.0],
                [79.0, 0.0, 67.0],
                [101.0, 1.0, 67.0],
                [0.0, 15.0, 63.0],
                [19.0, 19.0, 70.0],
                [31.0, 18.0, 63.0],
                [50.0, 16.0, 70.0],
                [65.0, 15.0, 67.0],
                [84.0, 12.0, 69.0],
                [96.0, 15.0, 64.0],
                [-1.0, 31.0, 69.0],
                [13.0, 37.0, 70.0],
                [29.0, 34.0, 67.0],
                [50.0, 33.0, 65.0],
                [66.0, 35.0, 67.0],
                [85.0, 29.0, 69.0],
                [104.0, 32.0, 66.0],
                [0.0, 50.0, 62.0],
                [14.0, 46.0, 63.0],
                [34.0, 48.0, 63.0],
                [52.0, 47.0, 68.0],
                [65.0, 52.0, 66.0],
                [80.0, 46.0, 63.0],
                [103.0, 47.0, 64.0],
                [-4.0, 63.0, 68.0],
                [14.0, 66.0, 65.0],
                [37.0, 66.0, 62.0],
                [54.0, 67.0, 61.0],
                [69.0, 64.0, 61.0],
                [83.0, 69.0, 70.0],
                [96.0, 70.0, 69.0],
                [2.0, 82.0, 63.0],
                [19.0, 81.0, 64.0],
                [33.0, 83.0, 69.0],
                [53.0, 80.0, 61.0],
                [67.0, 87.0, 69.0],
                [78.0, 84.0, 66.0],
                [97.0, 83.0, 69.0],
                [4.0, 98.0, 67.0],
                [12.0, 97.0, 69.0],
                [32.0, 95.0, 68.0],
                [53.0, 104.0, 62.0],
                [68.0, 103.0, 69.0],
                [84.0, 99.0, 66.0],
                [97.0, 97.0, 68.0],
                [0.0, 1.0, 99.0],
                [17.0, -5.0, 101.0],
                [32.0, -5.0, 100.0],
                [49.0, -4.0, 101.0],
                [62.0, -5.0, 103.0],
                [80.0, -2.0, 102.0],
                [98.0, -1.0, 97.0],
                [-2.0, 12.0, 97.0],
                [20.0, 17.0, 102.0],
                [28.0, 21.0, 97.0],
                [49.0, 20.0, 100.0],
                [62.0, 19.0, 102.0],
                [86.0, 15.0, 100.0],
                [98.0, 12.0, 99.0],
                [1.0, 37.0, 98.0],
                [17.0, 34.0, 103.0],
                [29.0, 32.0, 98.0],
                [48.0, 31.0, 96.0],
                [63.0, 30.0, 103.0],
                [80.0, 38.0, 103.0],
                [97.0, 29.0, 95.0],
                [-5.0, 54.0, 96.0],
                [19.0, 52.0, 101.0],
                [38.0, 46.0, 100.0],
                [49.0, 52.0, 97.0],
                [63.0, 49.0, 96.0],
                [79.0, 47.0, 101.0],
                [102.0, 46.0, 96.0],
                [4.0, 62.0, 104.0],
                [20.0, 70.0, 96.0],
                [31.0, 65.0, 104.0],
                [46.0, 71.0, 104.0],
                [63.0, 70.0, 96.0],
                [81.0, 67.0, 101.0],
                [97.0, 62.0, 104.0],
                [-5.0, 86.0, 104.0],
                [12.0, 78.0, 104.0],
                [34.0, 83.0, 103.0],
                [46.0, 86.0, 97.0],
                [64.0, 87.0, 99.0],
                [85.0, 82.0, 104.0],
                [97.0, 85.0, 101.0],
                [2.0, 99.0, 104.0],
                [17.0, 99.0, 95.0],
                [30.0, 103.0, 102.0],
                [53.0, 102.0, 98.0],
                [64.0, 102.0, 99.0],
                [79.0, 100.0, 101.0],
                [101.0, 97.0, 96.0],
            ]
        )
        basis0 = BSplineBasis(2, np.array([0.0, 0.0, 0.6, 1.6, 3.1, 3.8, 5.2, 6.0, 6.0]))
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 0.8, 1.8, 2.9, 3.8, 5.0, 5.0, 5.0]))
        basis2 = BSplineBasis(2, np.array([0.0, 0.0, 1.0, 2.2, 3.0, 3.0]))
        vol = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2 *= np.array([2.9, 3.8, 11.7])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] /= 2.900000
        pt2[..., 1] /= 3.800000
        pt2[..., 2] /= 11.700000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_volume_3D_p242(self):
        controlpoints = np.array(
            [
                [-4.0, -4.0, 2.0],
                [23.0, -1.0, -1.0],
                [47.0, 0.0, 2.0],
                [71.0, -5.0, -4.0],
                [97.0, -2.0, 2.0],
                [-4.0, 17.0, 4.0],
                [27.0, 17.0, -3.0],
                [47.0, 12.0, -3.0],
                [73.0, 18.0, 3.0],
                [98.0, 18.0, -3.0],
                [-5.0, 33.0, 2.0],
                [24.0, 37.0, -4.0],
                [48.0, 37.0, 2.0],
                [79.0, 36.0, 4.0],
                [104.0, 29.0, 3.0],
                [-1.0, 51.0, 2.0],
                [27.0, 45.0, -3.0],
                [45.0, 54.0, 3.0],
                [70.0, 49.0, 1.0],
                [100.0, 52.0, 2.0],
                [1.0, 68.0, 3.0],
                [25.0, 70.0, 1.0],
                [48.0, 63.0, -3.0],
                [72.0, 67.0, -3.0],
                [103.0, 64.0, -1.0],
                [1.0, 79.0, 1.0],
                [21.0, 82.0, -3.0],
                [46.0, 83.0, -2.0],
                [70.0, 84.0, -4.0],
                [104.0, 81.0, -3.0],
                [4.0, 100.0, -4.0],
                [27.0, 100.0, -4.0],
                [51.0, 95.0, -5.0],
                [70.0, 100.0, 1.0],
                [95.0, 101.0, 4.0],
                [2.0, -3.0, 36.0],
                [26.0, 3.0, 28.0],
                [52.0, -4.0, 30.0],
                [76.0, 2.0, 31.0],
                [98.0, -5.0, 30.0],
                [-4.0, 21.0, 37.0],
                [26.0, 15.0, 32.0],
                [54.0, 19.0, 34.0],
                [73.0, 14.0, 30.0],
                [97.0, 17.0, 28.0],
                [-1.0, 30.0, 30.0],
                [24.0, 37.0, 35.0],
                [51.0, 32.0, 35.0],
                [73.0, 34.0, 32.0],
                [100.0, 32.0, 32.0],
                [-5.0, 47.0, 35.0],
                [23.0, 45.0, 32.0],
                [54.0, 46.0, 35.0],
                [77.0, 51.0, 37.0],
                [104.0, 52.0, 28.0],
                [2.0, 61.0, 33.0],
                [21.0, 65.0, 30.0],
                [45.0, 69.0, 37.0],
                [79.0, 68.0, 31.0],
                [101.0, 68.0, 33.0],
                [-5.0, 88.0, 33.0],
                [28.0, 81.0, 35.0],
                [47.0, 87.0, 31.0],
                [70.0, 78.0, 32.0],
                [102.0, 84.0, 36.0],
                [-3.0, 99.0, 34.0],
                [25.0, 98.0, 34.0],
                [50.0, 102.0, 36.0],
                [72.0, 99.0, 36.0],
                [95.0, 100.0, 37.0],
                [4.0, 4.0, 64.0],
                [27.0, -3.0, 68.0],
                [51.0, -4.0, 67.0],
                [70.0, -5.0, 65.0],
                [103.0, 3.0, 68.0],
                [3.0, 15.0, 67.0],
                [25.0, 20.0, 70.0],
                [46.0, 18.0, 68.0],
                [78.0, 15.0, 68.0],
                [98.0, 14.0, 65.0],
                [4.0, 29.0, 70.0],
                [29.0, 31.0, 63.0],
                [47.0, 34.0, 61.0],
                [79.0, 33.0, 68.0],
                [98.0, 30.0, 63.0],
                [0.0, 52.0, 64.0],
                [23.0, 53.0, 63.0],
                [47.0, 50.0, 66.0],
                [79.0, 47.0, 67.0],
                [102.0, 45.0, 67.0],
                [-3.0, 67.0, 65.0],
                [24.0, 64.0, 68.0],
                [47.0, 68.0, 64.0],
                [74.0, 63.0, 65.0],
                [103.0, 70.0, 70.0],
                [3.0, 86.0, 69.0],
                [25.0, 84.0, 69.0],
                [51.0, 88.0, 64.0],
                [72.0, 85.0, 64.0],
                [97.0, 81.0, 64.0],
                [-4.0, 95.0, 65.0],
                [26.0, 101.0, 70.0],
                [53.0, 97.0, 63.0],
                [77.0, 95.0, 65.0],
                [95.0, 98.0, 67.0],
                [4.0, -3.0, 99.0],
                [23.0, 4.0, 101.0],
                [49.0, -3.0, 99.0],
                [73.0, 2.0, 101.0],
                [102.0, -3.0, 101.0],
                [-5.0, 20.0, 98.0],
                [27.0, 16.0, 96.0],
                [46.0, 12.0, 96.0],
                [79.0, 18.0, 100.0],
                [100.0, 16.0, 100.0],
                [1.0, 30.0, 97.0],
                [26.0, 29.0, 95.0],
                [49.0, 32.0, 101.0],
                [73.0, 28.0, 102.0],
                [104.0, 36.0, 103.0],
                [0.0, 54.0, 97.0],
                [23.0, 48.0, 97.0],
                [45.0, 47.0, 97.0],
                [78.0, 52.0, 97.0],
                [104.0, 47.0, 98.0],
                [1.0, 66.0, 102.0],
                [23.0, 68.0, 97.0],
                [54.0, 66.0, 99.0],
                [72.0, 66.0, 101.0],
                [103.0, 70.0, 97.0],
                [4.0, 87.0, 100.0],
                [22.0, 80.0, 101.0],
                [54.0, 79.0, 101.0],
                [75.0, 84.0, 100.0],
                [100.0, 79.0, 98.0],
                [-1.0, 104.0, 100.0],
                [20.0, 96.0, 98.0],
                [47.0, 104.0, 104.0],
                [73.0, 103.0, 101.0],
                [102.0, 98.0, 96.0],
            ]
        )
        basis0 = BSplineBasis(2, np.array([0.0, 0.0, 1.1, 2.2, 2.9, 4.0, 4.0]))
        basis1 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 0.7, 2.4, 2.9, 4.0, 4.0, 4.0, 4.0]))
        basis2 = BSplineBasis(2, np.array([0.0, 0.0, 1.2, 2.1, 3.0, 3.0]))
        vol = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2.mirror([2, 0, 0])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] = -pt2[..., 0]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_3D_p2_C0_periodic(self):
        controlpoints = np.array(
            [[95.0, -4.0, 2.0], [1.0, 96.0, -4.0], [-101.0, 1.0, 4.0], [4.0, -102.0, 2.0]]
        )
        basis0 = BSplineBasis(2, np.array([-0.7, 0.0, 1.4, 1.9, 3.3, 4.0, 5.4]), 0)
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 += np.array([6.2, 7.5, 1.7])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 6.200000
        pt2[..., 1] -= 7.500000
        pt2[..., 2] -= 1.700000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_3D_p2_C0_periodic(self):
        controlpoints = np.array([[103.0, -1.0, -4.0], [-53.0, 89.0, 2.0], [-46.0, -85.0, 3.0]])
        basis0 = BSplineBasis(2, np.array([-0.7, 0.0, 1.3, 2.3, 3.0, 4.3]), 0)
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 *= np.array([6.6, 11.7, 8.6])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 6.600000
        pt2[..., 1] /= 11.700000
        pt2[..., 2] /= 8.600000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_curve_3D_p3_C0_periodic(self):
        controlpoints = np.array(
            [
                [102.0, 3.0, 1.0],
                [27.0, 96.0, 1.0],
                [-83.0, 61.0, -4.0],
                [-86.0, -58.0, -1.0],
                [35.0, -92.0, -2.0],
            ]
        )
        basis0 = BSplineBasis(3, np.array([-1.0, 0.0, 0.0, 1.3, 2.2, 3.0, 4.0, 4.0, 5.3]), 0)
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2.mirror([0, 0, 2])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 2] = -pt2[..., 2]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_3D_p43_C0_periodic(self):
        controlpoints = np.array(
            [
                [56.0, 2.0, -3.0],
                [21.0, 61.0, 1.0],
                [-48.0, 37.0, 0.0],
                [-45.0, -40.0, 3.0],
                [22.0, -61.0, 3.0],
                [68.0, -3.0, 1.0],
                [18.0, 60.0, 4.0],
                [-59.0, 41.0, -5.0],
                [-58.0, -36.0, -4.0],
                [19.0, -60.0, 1.0],
                [75.0, -1.0, -5.0],
                [18.0, 71.0, -4.0],
                [-66.0, 41.0, -5.0],
                [-57.0, -47.0, -2.0],
                [25.0, -68.0, -4.0],
                [81.0, -4.0, -5.0],
                [21.0, 76.0, -5.0],
                [-63.0, 50.0, -1.0],
                [-72.0, -53.0, 3.0],
                [29.0, -79.0, -3.0],
                [92.0, 4.0, -2.0],
                [25.0, 91.0, 3.0],
                [-74.0, 54.0, -3.0],
                [-75.0, -52.0, 0.0],
                [27.0, -90.0, -1.0],
                [97.0, 3.0, -3.0],
                [30.0, 93.0, 0.0],
                [-78.0, 62.0, -2.0],
                [-78.0, -62.0, -1.0],
                [25.0, -91.0, 3.0],
            ]
        )
        basis0 = BSplineBasis(4, np.array([-1.0, 0.0, 0.0, 0.0, 0.7, 2.0, 3.0, 3.0, 3.0, 3.7]), 0)
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 0.8, 1.6, 3.0, 4.0, 4.0, 4.0]))
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 += np.array([7.2, 2.7, 2.2])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 7.200000
        pt2[..., 1] -= 2.700000
        pt2[..., 2] -= 2.200000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_surface_3D_p23_C0_periodic(self):
        controlpoints = np.array(
            [
                [62.0, -4.0, 1.0],
                [14.0, 60.0, -5.0],
                [-47.0, 38.0, 2.0],
                [-47.0, -31.0, 4.0],
                [21.0, -53.0, 2.0],
                [69.0, 3.0, -3.0],
                [19.0, 60.0, -1.0],
                [-56.0, 38.0, 4.0],
                [-51.0, -44.0, -5.0],
                [24.0, -70.0, -5.0],
                [76.0, 1.0, -5.0],
                [28.0, 74.0, 0.0],
                [-62.0, 43.0, 4.0],
                [-58.0, -41.0, -1.0],
                [20.0, -77.0, -3.0],
                [88.0, 4.0, -3.0],
                [27.0, 80.0, 0.0],
                [-69.0, 46.0, -3.0],
                [-65.0, -47.0, 0.0],
                [28.0, -83.0, -1.0],
                [94.0, -4.0, -5.0],
                [28.0, 90.0, -4.0],
                [-77.0, 50.0, 0.0],
                [-76.0, -58.0, 4.0],
                [29.0, -87.0, 1.0],
                [102.0, 2.0, -5.0],
                [31.0, 94.0, 3.0],
                [-86.0, 60.0, 3.0],
                [-85.0, -59.0, -4.0],
                [34.0, -94.0, -5.0],
            ]
        )
        basis0 = BSplineBasis(2, np.array([-1.3, 0.0, 1.2, 1.7, 3.3, 3.7, 5.0, 6.2]), 0)
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 0.7, 1.7, 2.9, 4.0, 4.0, 4.0]))
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 *= np.array([2.1, 5.0, 7.9])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 2.100000
        pt2[..., 1] /= 5.000000
        pt2[..., 2] /= 7.900000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_surface_3D_p44_C0_periodic(self):
        controlpoints = np.array(
            [
                [55.0, 0.0, 2.0],
                [35.0, 46.0, 0.0],
                [-18.0, 60.0, -4.0],
                [-56.0, 22.0, 2.0],
                [-50.0, -23.0, 1.0],
                [-13.0, -61.0, 4.0],
                [34.0, -47.0, 3.0],
                [69.0, 4.0, -3.0],
                [44.0, 46.0, -1.0],
                [-20.0, 60.0, 3.0],
                [-61.0, 30.0, -1.0],
                [-60.0, -29.0, 1.0],
                [-11.0, -67.0, 1.0],
                [41.0, -56.0, -5.0],
                [74.0, 0.0, -2.0],
                [48.0, 54.0, -5.0],
                [-15.0, 69.0, 1.0],
                [-65.0, 30.0, -5.0],
                [-63.0, -29.0, 4.0],
                [-18.0, -70.0, 2.0],
                [45.0, -52.0, 1.0],
                [72.0, 3.0, -2.0],
                [43.0, 63.0, -4.0],
                [-13.0, 76.0, -2.0],
                [-68.0, 38.0, 0.0],
                [-67.0, -31.0, -5.0],
                [-20.0, -72.0, 3.0],
                [47.0, -63.0, -3.0],
                [79.0, 2.0, 1.0],
                [52.0, 67.0, 0.0],
                [-14.0, 76.0, 4.0],
                [-74.0, 32.0, 4.0],
                [-77.0, -40.0, -5.0],
                [-22.0, -80.0, 1.0],
                [51.0, -65.0, 4.0],
                [86.0, -5.0, -4.0],
                [54.0, 71.0, -2.0],
                [-23.0, 85.0, 0.0],
                [-80.0, 42.0, 4.0],
                [-84.0, -38.0, 1.0],
                [-24.0, -91.0, 0.0],
                [59.0, -73.0, 2.0],
                [93.0, 3.0, -3.0],
                [58.0, 72.0, 1.0],
                [-21.0, 88.0, 0.0],
                [-81.0, 42.0, 1.0],
                [-82.0, -42.0, -4.0],
                [-20.0, -92.0, 4.0],
                [63.0, -78.0, 2.0],
                [104.0, 4.0, 0.0],
                [61.0, 73.0, 0.0],
                [-23.0, 98.0, -2.0],
                [-91.0, 41.0, 0.0],
                [-94.0, -45.0, -2.0],
                [-24.0, -100.0, -4.0],
                [64.0, -74.0, 3.0],
            ]
        )
        basis0 = BSplineBasis(4, np.array([-0.8, 0.0, 0.0, 0.0, 0.7, 1.9, 3.1, 4.2, 5.0, 5.0, 5.0, 5.7]), 0)
        basis1 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.2, 1.7, 3.2, 4.0, 5.0, 5.0, 5.0, 5.0]))
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2.mirror([0, 1, 0])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 1] = -pt2[..., 1]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_volume_3D_p323_C0_periodic(self):
        controlpoints = np.array(
            [
                [47.0, -2.0, -3.0],
                [23.0, 41.0, -2.0],
                [-23.0, 45.0, -1.0],
                [-52.0, 2.0, -4.0],
                [-26.0, -41.0, 1.0],
                [20.0, -40.0, -1.0],
                [62.0, -3.0, 1.0],
                [33.0, 51.0, -3.0],
                [-30.0, 52.0, 1.0],
                [-65.0, 4.0, -5.0],
                [-35.0, -57.0, 1.0],
                [30.0, -49.0, 0.0],
                [70.0, 2.0, 1.0],
                [39.0, 58.0, 2.0],
                [-38.0, 60.0, -4.0],
                [-68.0, 0.0, 0.0],
                [-31.0, -63.0, -1.0],
                [33.0, -58.0, -3.0],
                [84.0, -3.0, -1.0],
                [41.0, 69.0, 2.0],
                [-36.0, 65.0, 0.0],
                [-79.0, -3.0, -5.0],
                [-37.0, -65.0, -2.0],
                [42.0, -72.0, -1.0],
                [94.0, -3.0, 4.0],
                [42.0, 75.0, -5.0],
                [-45.0, 82.0, -5.0],
                [-86.0, 3.0, -5.0],
                [-48.0, -77.0, -5.0],
                [47.0, -78.0, 3.0],
                [100.0, -1.0, 3.0],
                [47.0, 88.0, 2.0],
                [-52.0, 88.0, -5.0],
                [-105.0, -5.0, -1.0],
                [-47.0, -84.0, 0.0],
                [47.0, -83.0, 1.0],
                [50.0, -4.0, 5.0],
                [27.0, 44.0, 11.0],
                [-29.0, 39.0, 6.0],
                [-55.0, 2.0, 3.0],
                [-22.0, -43.0, 11.0],
                [28.0, -40.0, 6.0],
                [56.0, -4.0, 10.0],
                [25.0, 49.0, 12.0],
                [-34.0, 50.0, 8.0],
                [-61.0, 2.0, 5.0],
                [-26.0, -50.0, 5.0],
                [31.0, -56.0, 5.0],
                [69.0, 3.0, 4.0],
                [34.0, 61.0, 4.0],
                [-31.0, 56.0, 12.0],
                [-70.0, -5.0, 9.0],
                [-40.0, -65.0, 6.0],
                [37.0, -56.0, 6.0],
                [80.0, 4.0, 8.0],
                [35.0, 72.0, 10.0],
                [-41.0, 71.0, 10.0],
                [-77.0, 0.0, 12.0],
                [-43.0, -66.0, 11.0],
                [37.0, -74.0, 3.0],
                [91.0, 1.0, 12.0],
                [45.0, 75.0, 8.0],
                [-48.0, 79.0, 9.0],
                [-90.0, -2.0, 10.0],
                [-42.0, -80.0, 8.0],
                [45.0, -77.0, 8.0],
                [101.0, -5.0, 11.0],
                [52.0, 88.0, 3.0],
                [-49.0, 83.0, 7.0],
                [-98.0, 1.0, 10.0],
                [-50.0, -83.0, 4.0],
                [54.0, -87.0, 10.0],
                [54.0, 3.0, 18.0],
                [26.0, 47.0, 18.0],
                [-29.0, 44.0, 12.0],
                [-47.0, -2.0, 12.0],
                [-29.0, -44.0, 16.0],
                [26.0, -45.0, 20.0],
                [59.0, -1.0, 17.0],
                [33.0, 51.0, 16.0],
                [-33.0, 49.0, 16.0],
                [-65.0, 0.0, 17.0],
                [-26.0, -54.0, 20.0],
                [26.0, -53.0, 16.0],
                [73.0, 0.0, 19.0],
                [31.0, 63.0, 13.0],
                [-34.0, 58.0, 13.0],
                [-69.0, 1.0, 13.0],
                [-37.0, -58.0, 20.0],
                [37.0, -56.0, 16.0],
                [79.0, -5.0, 17.0],
                [37.0, 64.0, 18.0],
                [-38.0, 70.0, 19.0],
                [-80.0, 0.0, 13.0],
                [-44.0, -74.0, 17.0],
                [40.0, -69.0, 12.0],
                [90.0, -1.0, 14.0],
                [40.0, 78.0, 17.0],
                [-46.0, 76.0, 11.0],
                [-95.0, 0.0, 14.0],
                [-42.0, -78.0, 14.0],
                [48.0, -76.0, 18.0],
                [95.0, -3.0, 13.0],
                [49.0, 83.0, 15.0],
                [-47.0, 91.0, 18.0],
                [-104.0, 4.0, 18.0],
                [-51.0, -84.0, 16.0],
                [52.0, -88.0, 15.0],
                [53.0, -1.0, 27.0],
                [20.0, 41.0, 26.0],
                [-25.0, 42.0, 20.0],
                [-54.0, -3.0, 21.0],
                [-28.0, -45.0, 21.0],
                [24.0, -43.0, 21.0],
                [62.0, 2.0, 23.0],
                [29.0, 47.0, 25.0],
                [-33.0, 50.0, 22.0],
                [-60.0, -3.0, 24.0],
                [-32.0, -50.0, 28.0],
                [28.0, -52.0, 21.0],
                [70.0, -2.0, 20.0],
                [39.0, 55.0, 27.0],
                [-35.0, 60.0, 26.0],
                [-69.0, -4.0, 26.0],
                [-39.0, -63.0, 27.0],
                [38.0, -60.0, 28.0],
                [78.0, -1.0, 25.0],
                [43.0, 71.0, 24.0],
                [-40.0, 70.0, 24.0],
                [-85.0, -2.0, 25.0],
                [-41.0, -70.0, 24.0],
                [36.0, -65.0, 28.0],
                [88.0, 4.0, 25.0],
                [49.0, 76.0, 28.0],
                [-46.0, 82.0, 20.0],
                [-87.0, 1.0, 20.0],
                [-49.0, -79.0, 28.0],
                [49.0, -80.0, 20.0],
                [95.0, 3.0, 25.0],
                [51.0, 86.0, 22.0],
                [-55.0, 88.0, 20.0],
                [-103.0, 1.0, 27.0],
                [-49.0, -91.0, 20.0],
                [48.0, -92.0, 21.0],
                [48.0, 4.0, 30.0],
                [23.0, 41.0, 29.0],
                [-21.0, 42.0, 36.0],
                [-53.0, 4.0, 35.0],
                [-28.0, -44.0, 32.0],
                [20.0, -45.0, 36.0],
                [64.0, -1.0, 35.0],
                [34.0, 53.0, 35.0],
                [-29.0, 53.0, 30.0],
                [-59.0, -1.0, 35.0],
                [-35.0, -57.0, 29.0],
                [25.0, -56.0, 35.0],
                [70.0, -5.0, 29.0],
                [30.0, 56.0, 28.0],
                [-31.0, 65.0, 34.0],
                [-70.0, 3.0, 32.0],
                [-40.0, -62.0, 31.0],
                [35.0, -62.0, 36.0],
                [77.0, 1.0, 28.0],
                [35.0, 66.0, 35.0],
                [-44.0, 71.0, 28.0],
                [-76.0, 4.0, 31.0],
                [-38.0, -73.0, 33.0],
                [38.0, -72.0, 36.0],
                [85.0, 2.0, 28.0],
                [43.0, 78.0, 35.0],
                [-50.0, 76.0, 36.0],
                [-94.0, 0.0, 36.0],
                [-45.0, -77.0, 33.0],
                [43.0, -83.0, 32.0],
                [98.0, 3.0, 36.0],
                [45.0, 91.0, 29.0],
                [-48.0, 85.0, 30.0],
                [-103.0, -3.0, 31.0],
                [-54.0, -84.0, 36.0],
                [48.0, -92.0, 27.0],
                [51.0, 0.0, 36.0],
                [25.0, 39.0, 42.0],
                [-22.0, 48.0, 38.0],
                [-47.0, 0.0, 36.0],
                [-22.0, -45.0, 36.0],
                [25.0, -40.0, 35.0],
                [58.0, -3.0, 44.0],
                [25.0, 50.0, 36.0],
                [-30.0, 52.0, 39.0],
                [-65.0, 1.0, 44.0],
                [-28.0, -56.0, 40.0],
                [27.0, -52.0, 42.0],
                [73.0, -1.0, 40.0],
                [32.0, 59.0, 39.0],
                [-38.0, 55.0, 37.0],
                [-69.0, 3.0, 36.0],
                [-36.0, -61.0, 37.0],
                [37.0, -62.0, 37.0],
                [78.0, 3.0, 37.0],
                [35.0, 64.0, 36.0],
                [-42.0, 67.0, 40.0],
                [-79.0, -5.0, 43.0],
                [-44.0, -73.0, 35.0],
                [39.0, -70.0, 37.0],
                [89.0, -3.0, 36.0],
                [40.0, 75.0, 41.0],
                [-41.0, 79.0, 41.0],
                [-94.0, -1.0, 44.0],
                [-41.0, -77.0, 37.0],
                [47.0, -77.0, 37.0],
                [100.0, 3.0, 44.0],
                [54.0, 91.0, 43.0],
                [-49.0, 86.0, 35.0],
                [-102.0, -5.0, 39.0],
                [-54.0, -83.0, 44.0],
                [50.0, -89.0, 36.0],
            ]
        )
        basis0 = BSplineBasis(3, np.array([-0.9, 0.0, 0.0, 0.6, 2.2, 2.8, 4.1, 5.0, 5.0, 5.6]), 0)
        basis1 = BSplineBasis(2, np.array([0.0, 0.0, 0.9, 1.7, 2.8, 3.9, 5.0, 5.0]))
        basis2 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.0, 2.4, 3.1, 4.0, 4.0, 4.0]))
        vol = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2 += np.array([3.6, 4.1, 9.1])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] -= 3.600000
        pt2[..., 1] -= 4.100000
        pt2[..., 2] -= 9.100000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_volume_3D_p322_C0_periodic(self):
        controlpoints = np.array(
            [
                [45.0, -4.0, -4.0],
                [-3.0, 48.0, 2.0],
                [-52.0, -4.0, -1.0],
                [-1.0, -54.0, -1.0],
                [61.0, 3.0, 0.0],
                [4.0, 58.0, 2.0],
                [-59.0, 0.0, 2.0],
                [-2.0, -67.0, -2.0],
                [77.0, 4.0, 2.0],
                [-2.0, 76.0, -4.0],
                [-79.0, 0.0, 0.0],
                [2.0, -79.0, 0.0],
                [86.0, -2.0, -4.0],
                [-3.0, 86.0, 1.0],
                [-89.0, 4.0, -1.0],
                [-2.0, -87.0, 4.0],
                [100.0, 4.0, 0.0],
                [3.0, 100.0, -5.0],
                [-103.0, 3.0, 3.0],
                [2.0, -99.0, 4.0],
                [50.0, 4.0, 14.0],
                [-5.0, 54.0, 11.0],
                [-55.0, 1.0, 11.0],
                [-2.0, -53.0, 10.0],
                [62.0, 4.0, 10.0],
                [1.0, 59.0, 14.0],
                [-60.0, -1.0, 14.0],
                [-5.0, -64.0, 11.0],
                [78.0, 0.0, 15.0],
                [1.0, 72.0, 12.0],
                [-80.0, 0.0, 17.0],
                [4.0, -77.0, 9.0],
                [84.0, 0.0, 15.0],
                [-4.0, 89.0, 13.0],
                [-90.0, 0.0, 11.0],
                [2.0, -86.0, 12.0],
                [102.0, 4.0, 9.0],
                [4.0, 100.0, 15.0],
                [-96.0, -4.0, 10.0],
                [-3.0, -100.0, 9.0],
                [46.0, -1.0, 26.0],
                [-2.0, 52.0, 26.0],
                [-54.0, 1.0, 26.0],
                [0.0, -49.0, 22.0],
                [65.0, -5.0, 27.0],
                [4.0, 57.0, 23.0],
                [-62.0, 0.0, 24.0],
                [1.0, -62.0, 21.0],
                [77.0, 0.0, 21.0],
                [1.0, 70.0, 21.0],
                [-76.0, 1.0, 23.0],
                [-5.0, -73.0, 31.0],
                [87.0, -5.0, 22.0],
                [2.0, 92.0, 26.0],
                [-83.0, 0.0, 22.0],
                [-3.0, -87.0, 23.0],
                [101.0, 2.0, 26.0],
                [4.0, 95.0, 27.0],
                [-103.0, -4.0, 27.0],
                [0.0, -101.0, 28.0],
                [54.0, 0.0, 42.0],
                [4.0, 50.0, 40.0],
                [-48.0, -5.0, 36.0],
                [1.0, -51.0, 38.0],
                [59.0, -2.0, 42.0],
                [3.0, 58.0, 42.0],
                [-66.0, 0.0, 44.0],
                [-2.0, -66.0, 40.0],
                [76.0, 1.0, 39.0],
                [-3.0, 77.0, 44.0],
                [-78.0, 0.0, 40.0],
                [4.0, -71.0, 37.0],
                [91.0, -3.0, 39.0],
                [-3.0, 83.0, 44.0],
                [-87.0, 1.0, 41.0],
                [-1.0, -90.0, 44.0],
                [101.0, -1.0, 35.0],
                [-4.0, 101.0, 38.0],
                [-100.0, 4.0, 36.0],
                [-4.0, -97.0, 41.0],
            ]
        )
        basis0 = BSplineBasis(3, np.array([-1.3, 0.0, 0.0, 0.6, 1.7, 3.0, 3.0, 3.6]), 0)
        basis1 = BSplineBasis(2, np.array([0.0, 0.0, 1.4, 1.8, 2.9, 4.0, 4.0]))
        basis2 = BSplineBasis(2, np.array([0.0, 0.0, 0.9, 2.4, 3.0, 3.0]))
        vol = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2 *= np.array([2.7, 8.2, 5.2])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] /= 2.700000
        pt2[..., 1] /= 8.200000
        pt2[..., 2] /= 5.200000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_volume_3D_p333_C0_periodic(self):
        controlpoints = np.array(
            [
                [45.0, -5.0, 4.0],
                [15.0, 43.0, 4.0],
                [-40.0, 33.0, 4.0],
                [-42.0, -28.0, 3.0],
                [20.0, -53.0, -1.0],
                [61.0, 1.0, -3.0],
                [22.0, 56.0, -5.0],
                [-47.0, 29.0, 1.0],
                [-43.0, -33.0, 2.0],
                [22.0, -51.0, 0.0],
                [66.0, -4.0, -1.0],
                [18.0, 65.0, 1.0],
                [-57.0, 37.0, -4.0],
                [-50.0, -41.0, -3.0],
                [15.0, -66.0, -5.0],
                [74.0, 3.0, 2.0],
                [18.0, 64.0, 4.0],
                [-62.0, 37.0, -4.0],
                [-57.0, -44.0, -2.0],
                [19.0, -69.0, 4.0],
                [75.0, -1.0, -1.0],
                [19.0, 78.0, -2.0],
                [-64.0, 49.0, -4.0],
                [-65.0, -44.0, 1.0],
                [20.0, -78.0, 1.0],
                [85.0, 1.0, 1.0],
                [26.0, 85.0, 2.0],
                [-74.0, 45.0, 2.0],
                [-72.0, -54.0, 3.0],
                [27.0, -83.0, -5.0],
                [89.0, -2.0, 2.0],
                [31.0, 91.0, -3.0],
                [-72.0, 51.0, 0.0],
                [-79.0, -54.0, 4.0],
                [30.0, -93.0, 1.0],
                [101.0, -5.0, 3.0],
                [27.0, 91.0, -3.0],
                [-80.0, 62.0, 1.0],
                [-79.0, -62.0, 1.0],
                [35.0, -95.0, -5.0],
                [52.0, -4.0, 6.0],
                [17.0, 49.0, 6.0],
                [-39.0, 28.0, 4.0],
                [-44.0, -29.0, 1.0],
                [19.0, -47.0, 2.0],
                [55.0, -2.0, 8.0],
                [15.0, 53.0, 5.0],
                [-47.0, 38.0, 9.0],
                [-46.0, -35.0, 5.0],
                [19.0, -52.0, 3.0],
                [66.0, 3.0, 5.0],
                [18.0, 63.0, 6.0],
                [-50.0, 35.0, 5.0],
                [-55.0, -41.0, 5.0],
                [15.0, -64.0, 5.0],
                [72.0, -4.0, 0.0],
                [22.0, 65.0, 3.0],
                [-61.0, 46.0, 6.0],
                [-58.0, -43.0, 3.0],
                [25.0, -66.0, 4.0],
                [76.0, 3.0, 4.0],
                [22.0, 70.0, 2.0],
                [-61.0, 46.0, 9.0],
                [-68.0, -50.0, 2.0],
                [24.0, -73.0, 8.0],
                [84.0, -3.0, 7.0],
                [26.0, 84.0, 9.0],
                [-65.0, 54.0, 9.0],
                [-69.0, -51.0, 2.0],
                [31.0, -86.0, 6.0],
                [88.0, 4.0, 4.0],
                [27.0, 89.0, 1.0],
                [-71.0, 56.0, 6.0],
                [-77.0, -53.0, 4.0],
                [32.0, -90.0, 8.0],
                [99.0, 2.0, 5.0],
                [33.0, 91.0, 9.0],
                [-78.0, 59.0, 8.0],
                [-82.0, -58.0, 2.0],
                [28.0, -96.0, 8.0],
                [46.0, -4.0, 13.0],
                [13.0, 45.0, 15.0],
                [-38.0, 24.0, 9.0],
                [-41.0, -29.0, 7.0],
                [19.0, -43.0, 10.0],
                [55.0, 3.0, 9.0],
                [18.0, 55.0, 13.0],
                [-46.0, 37.0, 9.0],
                [-45.0, -37.0, 12.0],
                [15.0, -56.0, 8.0],
                [60.0, -3.0, 8.0],
                [18.0, 65.0, 6.0],
                [-53.0, 34.0, 10.0],
                [-53.0, -43.0, 11.0],
                [19.0, -63.0, 13.0],
                [71.0, -3.0, 10.0],
                [19.0, 63.0, 8.0],
                [-60.0, 44.0, 14.0],
                [-56.0, -42.0, 6.0],
                [22.0, -66.0, 10.0],
                [74.0, -4.0, 8.0],
                [25.0, 76.0, 14.0],
                [-69.0, 45.0, 7.0],
                [-63.0, -45.0, 9.0],
                [23.0, -76.0, 14.0],
                [86.0, -2.0, 10.0],
                [24.0, 77.0, 6.0],
                [-67.0, 53.0, 9.0],
                [-69.0, -53.0, 11.0],
                [25.0, -82.0, 9.0],
                [96.0, 2.0, 9.0],
                [24.0, 86.0, 6.0],
                [-73.0, 56.0, 16.0],
                [-71.0, -57.0, 9.0],
                [29.0, -90.0, 9.0],
                [101.0, -5.0, 7.0],
                [34.0, 94.0, 13.0],
                [-83.0, 55.0, 11.0],
                [-85.0, -63.0, 15.0],
                [33.0, -99.0, 13.0],
                [50.0, -3.0, 16.0],
                [12.0, 49.0, 12.0],
                [-45.0, 28.0, 19.0],
                [-39.0, -31.0, 14.0],
                [18.0, -51.0, 12.0],
                [61.0, 4.0, 12.0],
                [14.0, 54.0, 19.0],
                [-47.0, 33.0, 15.0],
                [-49.0, -32.0, 17.0],
                [17.0, -54.0, 19.0],
                [68.0, 0.0, 22.0],
                [21.0, 59.0, 15.0],
                [-49.0, 41.0, 18.0],
                [-56.0, -35.0, 15.0],
                [23.0, -62.0, 20.0],
                [68.0, 3.0, 16.0],
                [18.0, 65.0, 17.0],
                [-62.0, 41.0, 12.0],
                [-61.0, -45.0, 21.0],
                [21.0, -71.0, 15.0],
                [81.0, -4.0, 20.0],
                [28.0, 76.0, 17.0],
                [-59.0, 43.0, 13.0],
                [-61.0, -44.0, 12.0],
                [25.0, -72.0, 14.0],
                [83.0, 2.0, 12.0],
                [26.0, 77.0, 14.0],
                [-72.0, 48.0, 19.0],
                [-72.0, -47.0, 21.0],
                [24.0, -85.0, 21.0],
                [93.0, 4.0, 12.0],
                [32.0, 84.0, 20.0],
                [-79.0, 51.0, 13.0],
                [-72.0, -59.0, 15.0],
                [25.0, -87.0, 17.0],
                [103.0, -5.0, 21.0],
                [28.0, 95.0, 16.0],
                [-83.0, 57.0, 20.0],
                [-79.0, -63.0, 19.0],
                [35.0, -100.0, 15.0],
                [46.0, -1.0, 22.0],
                [12.0, 51.0, 19.0],
                [-40.0, 28.0, 18.0],
                [-42.0, -25.0, 19.0],
                [16.0, -43.0, 26.0],
                [57.0, 3.0, 17.0],
                [15.0, 56.0, 21.0],
                [-43.0, 37.0, 23.0],
                [-51.0, -34.0, 20.0],
                [12.0, -57.0, 23.0],
                [68.0, -1.0, 23.0],
                [15.0, 59.0, 20.0],
                [-53.0, 35.0, 25.0],
                [-57.0, -41.0, 18.0],
                [19.0, -60.0, 24.0],
                [72.0, -3.0, 20.0],
                [22.0, 66.0, 20.0],
                [-61.0, 45.0, 19.0],
                [-58.0, -38.0, 25.0],
                [19.0, -73.0, 23.0],
                [78.0, 1.0, 27.0],
                [29.0, 78.0, 25.0],
                [-68.0, 45.0, 20.0],
                [-65.0, -46.0, 20.0],
                [25.0, -74.0, 18.0],
                [80.0, -4.0, 24.0],
                [27.0, 85.0, 25.0],
                [-71.0, 46.0, 26.0],
                [-67.0, -52.0, 23.0],
                [30.0, -83.0, 25.0],
                [95.0, 1.0, 23.0],
                [32.0, 87.0, 18.0],
                [-73.0, 54.0, 25.0],
                [-79.0, -57.0, 19.0],
                [24.0, -92.0, 20.0],
                [99.0, 2.0, 22.0],
                [32.0, 93.0, 23.0],
                [-81.0, 53.0, 21.0],
                [-85.0, -57.0, 20.0],
                [28.0, -95.0, 22.0],
                [49.0, -3.0, 31.0],
                [11.0, 49.0, 25.0],
                [-42.0, 29.0, 27.0],
                [-43.0, -34.0, 27.0],
                [19.0, -49.0, 25.0],
                [59.0, -2.0, 26.0],
                [21.0, 53.0, 26.0],
                [-44.0, 30.0, 32.0],
                [-44.0, -35.0, 33.0],
                [19.0, -51.0, 31.0],
                [63.0, -3.0, 25.0],
                [16.0, 64.0, 24.0],
                [-53.0, 36.0, 31.0],
                [-48.0, -34.0, 32.0],
                [17.0, -61.0, 29.0],
                [68.0, -3.0, 29.0],
                [23.0, 71.0, 31.0],
                [-56.0, 38.0, 27.0],
                [-58.0, -44.0, 24.0],
                [22.0, -67.0, 28.0],
                [75.0, 1.0, 27.0],
                [23.0, 72.0, 33.0],
                [-59.0, 47.0, 30.0],
                [-62.0, -51.0, 26.0],
                [21.0, -79.0, 31.0],
                [82.0, -2.0, 30.0],
                [22.0, 77.0, 28.0],
                [-75.0, 52.0, 26.0],
                [-70.0, -50.0, 25.0],
                [24.0, -82.0, 32.0],
                [89.0, -2.0, 27.0],
                [27.0, 89.0, 33.0],
                [-75.0, 57.0, 30.0],
                [-75.0, -59.0, 30.0],
                [29.0, -91.0, 26.0],
                [99.0, -2.0, 28.0],
                [35.0, 99.0, 33.0],
                [-81.0, 54.0, 24.0],
                [-78.0, -55.0, 29.0],
                [31.0, -98.0, 26.0],
                [50.0, -1.0, 35.0],
                [17.0, 48.0, 32.0],
                [-40.0, 32.0, 34.0],
                [-44.0, -35.0, 32.0],
                [14.0, -46.0, 31.0],
                [58.0, 3.0, 32.0],
                [17.0, 58.0, 34.0],
                [-49.0, 29.0, 33.0],
                [-43.0, -36.0, 35.0],
                [13.0, -56.0, 38.0],
                [61.0, 1.0, 38.0],
                [24.0, 58.0, 38.0],
                [-49.0, 37.0, 37.0],
                [-48.0, -37.0, 32.0],
                [19.0, -58.0, 31.0],
                [71.0, 3.0, 32.0],
                [20.0, 66.0, 38.0],
                [-59.0, 44.0, 36.0],
                [-56.0, -47.0, 37.0],
                [18.0, -65.0, 36.0],
                [80.0, 3.0, 35.0],
                [24.0, 71.0, 34.0],
                [-63.0, 50.0, 37.0],
                [-68.0, -45.0, 35.0],
                [27.0, -73.0, 36.0],
                [89.0, 3.0, 36.0],
                [28.0, 83.0, 30.0],
                [-69.0, 48.0, 38.0],
                [-67.0, -48.0, 29.0],
                [25.0, -83.0, 33.0],
                [94.0, -3.0, 37.0],
                [31.0, 84.0, 36.0],
                [-76.0, 55.0, 39.0],
                [-76.0, -52.0, 30.0],
                [31.0, -85.0, 29.0],
                [103.0, -1.0, 38.0],
                [29.0, 99.0, 32.0],
                [-81.0, 59.0, 33.0],
                [-79.0, -57.0, 37.0],
                [27.0, -96.0, 35.0],
                [51.0, -1.0, 40.0],
                [19.0, 43.0, 38.0],
                [-38.0, 32.0, 35.0],
                [-39.0, -33.0, 37.0],
                [10.0, -44.0, 41.0],
                [57.0, 4.0, 35.0],
                [19.0, 51.0, 42.0],
                [-47.0, 33.0, 36.0],
                [-46.0, -36.0, 41.0],
                [13.0, -52.0, 41.0],
                [66.0, -5.0, 41.0],
                [24.0, 56.0, 40.0],
                [-52.0, 37.0, 38.0],
                [-55.0, -42.0, 38.0],
                [22.0, -62.0, 40.0],
                [70.0, -2.0, 43.0],
                [18.0, 66.0, 35.0],
                [-57.0, 41.0, 39.0],
                [-59.0, -45.0, 36.0],
                [27.0, -73.0, 36.0],
                [74.0, -5.0, 35.0],
                [26.0, 79.0, 41.0],
                [-61.0, 43.0, 39.0],
                [-68.0, -47.0, 43.0],
                [25.0, -75.0, 37.0],
                [88.0, 2.0, 44.0],
                [28.0, 84.0, 39.0],
                [-74.0, 55.0, 36.0],
                [-67.0, -48.0, 44.0],
                [26.0, -81.0, 36.0],
                [87.0, -4.0, 41.0],
                [33.0, 89.0, 42.0],
                [-74.0, 58.0, 40.0],
                [-72.0, -59.0, 42.0],
                [30.0, -90.0, 43.0],
                [102.0, -1.0, 43.0],
                [34.0, 97.0, 35.0],
                [-76.0, 59.0, 37.0],
                [-86.0, -56.0, 41.0],
                [30.0, -100.0, 36.0],
            ]
        )
        basis0 = BSplineBasis(3, np.array([-1.1, 0.0, 0.0, 0.8, 2.3, 2.9, 4.0, 4.0, 4.8]), 0)
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.1, 1.7, 2.8, 4.3, 4.9, 6.0, 6.0, 6.0]))
        basis2 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.3, 2.3, 2.9, 4.4, 4.9, 6.0, 6.0, 6.0]))
        vol = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2.mirror([0, 0, 3])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 2] = -pt2[..., 2]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_3D_p4_C1_periodic(self):
        controlpoints = np.array(
            [
                [99.0, 1.0, 3.0],
                [67.0, 82.0, 3.0],
                [-20.0, 99.0, 3.0],
                [-94.0, 42.0, -1.0],
                [-95.0, -45.0, 4.0],
                [-26.0, -93.0, -3.0],
                [67.0, -75.0, -4.0],
            ]
        )
        basis0 = BSplineBasis(
            4, np.array([-2.2, -0.7, 0.0, 0.0, 1.1, 2.3, 3.1, 3.8, 5.3, 6.0, 6.0, 7.1, 8.3]), 1
        )
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 *= np.array([4.7, 11.4, 11.2])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 4.700000
        pt2[..., 1] /= 11.400000
        pt2[..., 2] /= 11.200000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_3D_p42_C1_periodic(self):
        controlpoints = np.array(
            [
                [64.0, -4.0, -3.0],
                [43.0, 39.0, 2.0],
                [2.0, 61.0, 0.0],
                [-45.0, 38.0, 0.0],
                [-65.0, -2.0, -1.0],
                [-45.0, -39.0, -5.0],
                [4.0, -59.0, -3.0],
                [37.0, -42.0, -4.0],
                [73.0, 2.0, -4.0],
                [44.0, 49.0, 1.0],
                [3.0, 69.0, 1.0],
                [-52.0, 53.0, -3.0],
                [-68.0, 3.0, -4.0],
                [-52.0, -50.0, -4.0],
                [0.0, -68.0, 0.0],
                [50.0, -52.0, 4.0],
                [81.0, 2.0, -3.0],
                [58.0, 54.0, 3.0],
                [2.0, 77.0, 3.0],
                [-55.0, 58.0, -1.0],
                [-82.0, 0.0, 2.0],
                [-56.0, -60.0, 1.0],
                [-5.0, -78.0, -2.0],
                [54.0, -53.0, -3.0],
                [87.0, -4.0, -5.0],
                [62.0, 64.0, -1.0],
                [-5.0, 86.0, -5.0],
                [-68.0, 67.0, 1.0],
                [-89.0, -5.0, 3.0],
                [-66.0, -67.0, -2.0],
                [-2.0, -87.0, -3.0],
                [62.0, -66.0, -4.0],
                [97.0, 2.0, -5.0],
                [68.0, 69.0, 1.0],
                [0.0, 95.0, 0.0],
                [-68.0, 70.0, -5.0],
                [-99.0, -1.0, -3.0],
                [-67.0, -66.0, 4.0],
                [-1.0, -96.0, 3.0],
                [70.0, -72.0, -5.0],
            ]
        )
        basis0 = BSplineBasis(
            4, np.array([-2.3, -1.4, 0.0, 0.0, 0.9, 2.4, 2.7, 3.7, 4.7, 5.6, 7.0, 7.0, 7.9, 9.4]), 1
        )
        basis1 = BSplineBasis(2, np.array([0.0, 0.0, 1.0, 1.9, 3.1, 4.0, 4.0]))
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 += np.array([3.3, 5.6, 7.8])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 3.300000
        pt2[..., 1] -= 5.600000
        pt2[..., 2] -= 7.800000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_surface_3D_p44_C1_periodic(self):
        controlpoints = np.array(
            [
                [64.0, 0.0, 3.0],
                [27.0, 54.0, -5.0],
                [-28.0, 55.0, 0.0],
                [-59.0, -2.0, 2.0],
                [-29.0, -55.0, -3.0],
                [34.0, -50.0, 3.0],
                [60.0, -4.0, -5.0],
                [29.0, 61.0, -3.0],
                [-28.0, 61.0, 0.0],
                [-61.0, 3.0, -4.0],
                [-35.0, -54.0, -4.0],
                [30.0, -56.0, 1.0],
                [74.0, -2.0, 3.0],
                [32.0, 58.0, 3.0],
                [-31.0, 62.0, 2.0],
                [-66.0, -4.0, -1.0],
                [-38.0, -61.0, -1.0],
                [34.0, -62.0, 0.0],
                [75.0, -4.0, -3.0],
                [38.0, 65.0, -1.0],
                [-40.0, 66.0, 4.0],
                [-75.0, 1.0, -4.0],
                [-34.0, -62.0, 0.0],
                [40.0, -61.0, 3.0],
                [80.0, 1.0, -5.0],
                [40.0, 69.0, 4.0],
                [-36.0, 67.0, 2.0],
                [-83.0, -2.0, -3.0],
                [-39.0, -72.0, -5.0],
                [35.0, -65.0, 0.0],
                [88.0, 2.0, -2.0],
                [43.0, 78.0, -1.0],
                [-45.0, 72.0, -3.0],
                [-87.0, -3.0, -5.0],
                [-46.0, -79.0, -4.0],
                [46.0, -77.0, -5.0],
                [91.0, 4.0, -1.0],
                [49.0, 76.0, -3.0],
                [-47.0, 80.0, 3.0],
                [-95.0, -4.0, 0.0],
                [-45.0, -76.0, 0.0],
                [44.0, -75.0, -4.0],
                [97.0, 0.0, 0.0],
                [45.0, 82.0, -1.0],
                [-47.0, 87.0, -2.0],
                [-92.0, 3.0, -2.0],
                [-53.0, -86.0, -3.0],
                [50.0, -79.0, 4.0],
                [102.0, -2.0, 1.0],
                [49.0, 86.0, -1.0],
                [-51.0, 83.0, 3.0],
                [-97.0, -2.0, 2.0],
                [-53.0, -86.0, -3.0],
                [51.0, -83.0, -1.0],
            ]
        )
        basis0 = BSplineBasis(4, np.array([-2.0, -0.8, 0.0, 0.0, 0.9, 2.0, 3.0, 4.2, 5.0, 5.0, 5.9, 7.0]), 1)
        basis1 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.0, 1.7, 2.7, 4.0, 4.7, 6.0, 6.0, 6.0, 6.0]))
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2.mirror([2, 0, 0])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] = -pt2[..., 0]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_volume_3D_p344_C1_periodic(self):
        controlpoints = np.array(
            [
                [54.0, -3.0, -2.0],
                [13.0, 44.0, -4.0],
                [-38.0, 26.0, -2.0],
                [-41.0, -25.0, 0.0],
                [11.0, -44.0, 4.0],
                [61.0, -3.0, 4.0],
                [16.0, 58.0, -4.0],
                [-51.0, 32.0, 0.0],
                [-47.0, -38.0, 1.0],
                [19.0, -61.0, 0.0],
                [74.0, 0.0, 1.0],
                [25.0, 68.0, -4.0],
                [-59.0, 39.0, -4.0],
                [-54.0, -41.0, 3.0],
                [24.0, -71.0, -3.0],
                [83.0, -3.0, -4.0],
                [29.0, 77.0, -1.0],
                [-62.0, 44.0, -5.0],
                [-66.0, -52.0, 0.0],
                [22.0, -76.0, 2.0],
                [85.0, -4.0, -1.0],
                [26.0, 89.0, 4.0],
                [-72.0, 52.0, 3.0],
                [-76.0, -49.0, -3.0],
                [30.0, -84.0, -5.0],
                [97.0, -2.0, 4.0],
                [33.0, 92.0, -1.0],
                [-81.0, 57.0, -3.0],
                [-83.0, -56.0, 0.0],
                [27.0, -98.0, -2.0],
                [50.0, -1.0, 1.0],
                [19.0, 49.0, 5.0],
                [-38.0, 31.0, 8.0],
                [-42.0, -34.0, 1.0],
                [16.0, -52.0, 1.0],
                [61.0, 2.0, 8.0],
                [19.0, 55.0, 2.0],
                [-47.0, 39.0, 0.0],
                [-50.0, -32.0, 9.0],
                [17.0, -62.0, 8.0],
                [70.0, -5.0, 7.0],
                [22.0, 65.0, 1.0],
                [-60.0, 45.0, 5.0],
                [-59.0, -45.0, 2.0],
                [24.0, -68.0, 6.0],
                [77.0, 4.0, 9.0],
                [20.0, 72.0, 8.0],
                [-63.0, 44.0, 4.0],
                [-64.0, -50.0, 2.0],
                [22.0, -77.0, 7.0],
                [86.0, 0.0, 5.0],
                [23.0, 83.0, 4.0],
                [-77.0, 57.0, 2.0],
                [-76.0, -57.0, 9.0],
                [24.0, -87.0, 5.0],
                [99.0, -2.0, 7.0],
                [26.0, 99.0, 10.0],
                [-85.0, 59.0, 1.0],
                [-79.0, -60.0, 1.0],
                [27.0, -93.0, 1.0],
                [52.0, 2.0, 6.0],
                [11.0, 44.0, 11.0],
                [-45.0, 25.0, 7.0],
                [-46.0, -25.0, 7.0],
                [11.0, -52.0, 11.0],
                [61.0, 4.0, 11.0],
                [19.0, 54.0, 10.0],
                [-51.0, 35.0, 15.0],
                [-48.0, -40.0, 12.0],
                [18.0, -58.0, 16.0],
                [65.0, 1.0, 15.0],
                [18.0, 70.0, 7.0],
                [-61.0, 36.0, 6.0],
                [-53.0, -39.0, 11.0],
                [17.0, -67.0, 15.0],
                [84.0, 1.0, 8.0],
                [23.0, 74.0, 6.0],
                [-67.0, 46.0, 13.0],
                [-62.0, -44.0, 16.0],
                [20.0, -75.0, 7.0],
                [86.0, -3.0, 15.0],
                [23.0, 83.0, 14.0],
                [-74.0, 56.0, 8.0],
                [-76.0, -49.0, 6.0],
                [23.0, -88.0, 8.0],
                [101.0, 0.0, 10.0],
                [35.0, 98.0, 13.0],
                [-83.0, 61.0, 6.0],
                [-80.0, -59.0, 15.0],
                [33.0, -99.0, 11.0],
                [50.0, 3.0, 14.0],
                [12.0, 50.0, 14.0],
                [-42.0, 27.0, 12.0],
                [-38.0, -34.0, 18.0],
                [15.0, -51.0, 16.0],
                [61.0, -5.0, 12.0],
                [15.0, 54.0, 16.0],
                [-51.0, 30.0, 14.0],
                [-44.0, -32.0, 15.0],
                [18.0, -53.0, 15.0],
                [67.0, 4.0, 20.0],
                [24.0, 68.0, 14.0],
                [-58.0, 41.0, 16.0],
                [-57.0, -44.0, 19.0],
                [26.0, -68.0, 18.0],
                [76.0, -4.0, 18.0],
                [19.0, 79.0, 18.0],
                [-69.0, 47.0, 15.0],
                [-69.0, -49.0, 18.0],
                [23.0, -76.0, 17.0],
                [93.0, -1.0, 19.0],
                [26.0, 83.0, 19.0],
                [-74.0, 53.0, 19.0],
                [-75.0, -50.0, 16.0],
                [32.0, -86.0, 17.0],
                [103.0, -2.0, 14.0],
                [30.0, 94.0, 19.0],
                [-78.0, 53.0, 13.0],
                [-83.0, -59.0, 20.0],
                [34.0, -98.0, 19.0],
                [52.0, -1.0, 24.0],
                [11.0, 49.0, 20.0],
                [-39.0, 30.0, 26.0],
                [-43.0, -29.0, 26.0],
                [17.0, -49.0, 21.0],
                [58.0, -2.0, 21.0],
                [17.0, 57.0, 26.0],
                [-51.0, 38.0, 21.0],
                [-45.0, -35.0, 19.0],
                [20.0, -59.0, 20.0],
                [74.0, -3.0, 26.0],
                [18.0, 69.0, 21.0],
                [-60.0, 37.0, 21.0],
                [-53.0, -44.0, 22.0],
                [21.0, -69.0, 22.0],
                [75.0, -2.0, 25.0],
                [23.0, 74.0, 22.0],
                [-66.0, 48.0, 20.0],
                [-65.0, -48.0, 25.0],
                [26.0, -79.0, 21.0],
                [86.0, 3.0, 22.0],
                [27.0, 83.0, 18.0],
                [-70.0, 52.0, 26.0],
                [-73.0, -56.0, 26.0],
                [29.0, -88.0, 23.0],
                [101.0, -1.0, 21.0],
                [29.0, 93.0, 18.0],
                [-78.0, 61.0, 25.0],
                [-81.0, -58.0, 26.0],
                [29.0, -95.0, 25.0],
                [51.0, -2.0, 25.0],
                [10.0, 43.0, 31.0],
                [-43.0, 33.0, 30.0],
                [-45.0, -27.0, 30.0],
                [11.0, -53.0, 30.0],
                [64.0, -2.0, 28.0],
                [17.0, 52.0, 24.0],
                [-45.0, 33.0, 26.0],
                [-53.0, -36.0, 27.0],
                [18.0, -60.0, 25.0],
                [73.0, 4.0, 25.0],
                [18.0, 71.0, 26.0],
                [-61.0, 37.0, 32.0],
                [-57.0, -42.0, 26.0],
                [16.0, -62.0, 26.0],
                [81.0, 3.0, 25.0],
                [20.0, 78.0, 24.0],
                [-63.0, 43.0, 32.0],
                [-70.0, -52.0, 33.0],
                [20.0, -79.0, 31.0],
                [94.0, 1.0, 25.0],
                [23.0, 85.0, 24.0],
                [-76.0, 54.0, 30.0],
                [-71.0, -56.0, 29.0],
                [27.0, -85.0, 32.0],
                [104.0, 0.0, 31.0],
                [32.0, 94.0, 32.0],
                [-82.0, 59.0, 30.0],
                [-80.0, -60.0, 25.0],
                [27.0, -96.0, 25.0],
                [53.0, 2.0, 38.0],
                [19.0, 49.0, 38.0],
                [-44.0, 26.0, 35.0],
                [-40.0, -26.0, 35.0],
                [18.0, -45.0, 32.0],
                [62.0, 0.0, 35.0],
                [15.0, 58.0, 33.0],
                [-46.0, 31.0, 30.0],
                [-44.0, -36.0, 33.0],
                [18.0, -57.0, 38.0],
                [71.0, 2.0, 30.0],
                [21.0, 67.0, 36.0],
                [-53.0, 41.0, 37.0],
                [-54.0, -39.0, 38.0],
                [19.0, -68.0, 33.0],
                [81.0, 2.0, 32.0],
                [24.0, 75.0, 38.0],
                [-66.0, 47.0, 35.0],
                [-67.0, -50.0, 33.0],
                [24.0, -72.0, 36.0],
                [87.0, -1.0, 32.0],
                [28.0, 83.0, 38.0],
                [-70.0, 50.0, 32.0],
                [-77.0, -56.0, 30.0],
                [28.0, -83.0, 39.0],
                [102.0, -5.0, 29.0],
                [27.0, 93.0, 29.0],
                [-76.0, 62.0, 38.0],
                [-79.0, -60.0, 34.0],
                [26.0, -95.0, 32.0],
                [51.0, 1.0, 35.0],
                [19.0, 44.0, 42.0],
                [-45.0, 32.0, 36.0],
                [-39.0, -34.0, 39.0],
                [19.0, -51.0, 39.0],
                [63.0, -2.0, 41.0],
                [16.0, 59.0, 44.0],
                [-53.0, 32.0, 36.0],
                [-50.0, -31.0, 35.0],
                [15.0, -55.0, 40.0],
                [66.0, -2.0, 36.0],
                [25.0, 64.0, 36.0],
                [-54.0, 43.0, 36.0],
                [-62.0, -45.0, 41.0],
                [25.0, -63.0, 44.0],
                [78.0, 1.0, 43.0],
                [24.0, 78.0, 38.0],
                [-64.0, 47.0, 36.0],
                [-67.0, -46.0, 35.0],
                [25.0, -80.0, 41.0],
                [86.0, 1.0, 36.0],
                [29.0, 81.0, 37.0],
                [-71.0, 57.0, 38.0],
                [-70.0, -56.0, 41.0],
                [26.0, -84.0, 36.0],
                [98.0, 1.0, 36.0],
                [29.0, 94.0, 40.0],
                [-78.0, 59.0, 44.0],
                [-77.0, -60.0, 39.0],
                [32.0, -98.0, 40.0],
            ]
        )
        basis0 = BSplineBasis(3, np.array([-2.1, -1.3, 0.0, 1.2, 1.6, 2.9, 3.7, 5.0, 6.2, 6.6]), 1)
        basis1 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.1, 2.3, 3.0, 3.0, 3.0, 3.0]))
        basis2 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.3, 2.2, 3.0, 4.1, 5.0, 5.0, 5.0, 5.0]))
        vol = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2 += np.array([7.3, 6.3, 6.6])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] -= 7.300000
        pt2[..., 1] -= 6.300000
        pt2[..., 2] -= 6.600000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_volume_3D_p444_C1_periodic(self):
        controlpoints = np.array(
            [
                [52.0, 3.0, -2.0],
                [33.0, 34.0, 3.0],
                [4.0, 47.0, -2.0],
                [-36.0, 30.0, -5.0],
                [-49.0, -3.0, -5.0],
                [-37.0, -36.0, -5.0],
                [3.0, -52.0, 2.0],
                [37.0, -33.0, -3.0],
                [62.0, 4.0, -4.0],
                [44.0, 42.0, 0.0],
                [4.0, 59.0, 3.0],
                [-45.0, 37.0, -5.0],
                [-64.0, 0.0, -5.0],
                [-40.0, -39.0, 1.0],
                [-5.0, -59.0, 3.0],
                [38.0, -40.0, 0.0],
                [65.0, -5.0, 3.0],
                [42.0, 43.0, -1.0],
                [-4.0, 62.0, 4.0],
                [-43.0, 50.0, -2.0],
                [-69.0, 4.0, -1.0],
                [-46.0, -50.0, 1.0],
                [-5.0, -68.0, -5.0],
                [42.0, -45.0, 3.0],
                [78.0, 1.0, -4.0],
                [48.0, 51.0, -4.0],
                [3.0, 75.0, 3.0],
                [-53.0, 52.0, 2.0],
                [-74.0, -3.0, 0.0],
                [-52.0, -50.0, -3.0],
                [3.0, -79.0, 4.0],
                [56.0, -55.0, 1.0],
                [82.0, 0.0, 1.0],
                [61.0, 57.0, -3.0],
                [1.0, 87.0, 2.0],
                [-56.0, 57.0, -5.0],
                [-88.0, -3.0, -1.0],
                [-64.0, -58.0, 2.0],
                [4.0, -83.0, 4.0],
                [55.0, -62.0, -4.0],
                [87.0, 0.0, 4.0],
                [60.0, 61.0, -1.0],
                [3.0, 95.0, 4.0],
                [-62.0, 67.0, -4.0],
                [-95.0, 2.0, 1.0],
                [-62.0, -70.0, 4.0],
                [-3.0, -91.0, -1.0],
                [69.0, -65.0, -2.0],
                [102.0, 3.0, 2.0],
                [69.0, 73.0, 4.0],
                [4.0, 104.0, 2.0],
                [-75.0, 72.0, 3.0],
                [-101.0, 1.0, -4.0],
                [-67.0, -68.0, 1.0],
                [-2.0, -99.0, -5.0],
                [67.0, -68.0, -2.0],
                [51.0, -2.0, 3.0],
                [32.0, 37.0, 9.0],
                [2.0, 53.0, 12.0],
                [-33.0, 40.0, 3.0],
                [-49.0, -1.0, 3.0],
                [-37.0, -38.0, 11.0],
                [2.0, -47.0, 6.0],
                [33.0, -39.0, 4.0],
                [56.0, 2.0, 3.0],
                [38.0, 44.0, 6.0],
                [-5.0, 54.0, 6.0],
                [-42.0, 45.0, 4.0],
                [-56.0, 2.0, 7.0],
                [-45.0, -38.0, 8.0],
                [3.0, -62.0, 9.0],
                [42.0, -39.0, 12.0],
                [64.0, -1.0, 6.0],
                [44.0, 42.0, 8.0],
                [4.0, 66.0, 8.0],
                [-45.0, 48.0, 5.0],
                [-66.0, -5.0, 9.0],
                [-50.0, -50.0, 11.0],
                [-5.0, -64.0, 7.0],
                [42.0, -50.0, 6.0],
                [76.0, 1.0, 6.0],
                [48.0, 48.0, 6.0],
                [0.0, 70.0, 8.0],
                [-52.0, 53.0, 7.0],
                [-79.0, -3.0, 8.0],
                [-53.0, -56.0, 10.0],
                [-5.0, -73.0, 3.0],
                [52.0, -56.0, 12.0],
                [85.0, -1.0, 12.0],
                [55.0, 58.0, 6.0],
                [4.0, 83.0, 4.0],
                [-57.0, 54.0, 11.0],
                [-82.0, 1.0, 6.0],
                [-58.0, -58.0, 7.0],
                [-4.0, -83.0, 6.0],
                [61.0, -61.0, 8.0],
                [91.0, -1.0, 3.0],
                [66.0, 62.0, 4.0],
                [1.0, 92.0, 6.0],
                [-68.0, 66.0, 12.0],
                [-95.0, -2.0, 11.0],
                [-67.0, -68.0, 4.0],
                [-5.0, -89.0, 7.0],
                [68.0, -67.0, 7.0],
                [97.0, 0.0, 3.0],
                [66.0, 73.0, 9.0],
                [0.0, 103.0, 3.0],
                [-75.0, 70.0, 7.0],
                [-100.0, -2.0, 7.0],
                [-67.0, -71.0, 10.0],
                [0.0, -97.0, 8.0],
                [68.0, -69.0, 3.0],
                [50.0, 0.0, 19.0],
                [32.0, 36.0, 15.0],
                [-4.0, 48.0, 18.0],
                [-34.0, 31.0, 17.0],
                [-50.0, -3.0, 13.0],
                [-34.0, -33.0, 16.0],
                [-3.0, -48.0, 19.0],
                [39.0, -38.0, 15.0],
                [59.0, 1.0, 19.0],
                [38.0, 38.0, 12.0],
                [-1.0, 58.0, 16.0],
                [-39.0, 44.0, 19.0],
                [-60.0, 1.0, 11.0],
                [-46.0, -41.0, 18.0],
                [-2.0, -62.0, 14.0],
                [38.0, -46.0, 15.0],
                [68.0, 4.0, 17.0],
                [49.0, 42.0, 20.0],
                [-1.0, 67.0, 20.0],
                [-44.0, 47.0, 12.0],
                [-69.0, -2.0, 16.0],
                [-44.0, -49.0, 14.0],
                [4.0, -67.0, 16.0],
                [45.0, -52.0, 16.0],
                [79.0, -4.0, 19.0],
                [53.0, 49.0, 13.0],
                [-5.0, 75.0, 20.0],
                [-56.0, 51.0, 18.0],
                [-74.0, -5.0, 13.0],
                [-52.0, -55.0, 16.0],
                [-5.0, -72.0, 11.0],
                [56.0, -57.0, 15.0],
                [85.0, 3.0, 12.0],
                [61.0, 55.0, 13.0],
                [4.0, 87.0, 11.0],
                [-64.0, 57.0, 18.0],
                [-81.0, 1.0, 12.0],
                [-57.0, -55.0, 18.0],
                [-2.0, -86.0, 15.0],
                [59.0, -57.0, 14.0],
                [90.0, -3.0, 17.0],
                [59.0, 69.0, 19.0],
                [-3.0, 92.0, 12.0],
                [-68.0, 61.0, 19.0],
                [-94.0, 0.0, 13.0],
                [-69.0, -63.0, 12.0],
                [0.0, -91.0, 12.0],
                [66.0, -62.0, 18.0],
                [97.0, -3.0, 20.0],
                [71.0, 72.0, 16.0],
                [1.0, 99.0, 16.0],
                [-67.0, 75.0, 19.0],
                [-105.0, -2.0, 19.0],
                [-70.0, -75.0, 13.0],
                [-3.0, -102.0, 14.0],
                [67.0, -71.0, 14.0],
                [53.0, -3.0, 26.0],
                [35.0, 35.0, 19.0],
                [3.0, 45.0, 27.0],
                [-35.0, 36.0, 21.0],
                [-49.0, -1.0, 22.0],
                [-31.0, -37.0, 24.0],
                [3.0, -48.0, 21.0],
                [38.0, -32.0, 20.0],
                [56.0, -5.0, 25.0],
                [44.0, 42.0, 19.0],
                [0.0, 62.0, 19.0],
                [-41.0, 44.0, 23.0],
                [-60.0, 1.0, 21.0],
                [-42.0, -46.0, 19.0],
                [0.0, -55.0, 25.0],
                [44.0, -44.0, 25.0],
                [64.0, 1.0, 23.0],
                [43.0, 48.0, 25.0],
                [-2.0, 64.0, 27.0],
                [-43.0, 44.0, 26.0],
                [-70.0, 4.0, 19.0],
                [-48.0, -44.0, 19.0],
                [-4.0, -63.0, 25.0],
                [46.0, -51.0, 28.0],
                [77.0, 3.0, 26.0],
                [53.0, 56.0, 21.0],
                [-4.0, 75.0, 19.0],
                [-52.0, 54.0, 27.0],
                [-77.0, -1.0, 24.0],
                [-52.0, -54.0, 22.0],
                [-1.0, -78.0, 22.0],
                [55.0, -58.0, 25.0],
                [81.0, -3.0, 22.0],
                [62.0, 58.0, 26.0],
                [3.0, 79.0, 24.0],
                [-64.0, 63.0, 22.0],
                [-88.0, -2.0, 24.0],
                [-56.0, -58.0, 19.0],
                [-1.0, -81.0, 23.0],
                [59.0, -60.0, 21.0],
                [93.0, -4.0, 24.0],
                [61.0, 68.0, 25.0],
                [-1.0, 93.0, 28.0],
                [-70.0, 69.0, 24.0],
                [-95.0, -5.0, 22.0],
                [-68.0, -61.0, 20.0],
                [0.0, -88.0, 23.0],
                [60.0, -61.0, 27.0],
                [97.0, -1.0, 23.0],
                [74.0, 72.0, 28.0],
                [4.0, 96.0, 25.0],
                [-69.0, 73.0, 25.0],
                [-103.0, -2.0, 19.0],
                [-74.0, -67.0, 25.0],
                [4.0, -104.0, 19.0],
                [67.0, -75.0, 19.0],
                [49.0, 0.0, 32.0],
                [39.0, 30.0, 27.0],
                [-2.0, 47.0, 35.0],
                [-38.0, 37.0, 30.0],
                [-47.0, -5.0, 35.0],
                [-32.0, -36.0, 34.0],
                [-5.0, -47.0, 30.0],
                [40.0, -33.0, 36.0],
                [60.0, -5.0, 34.0],
                [36.0, 39.0, 27.0],
                [-3.0, 60.0, 27.0],
                [-46.0, 42.0, 28.0],
                [-58.0, 1.0, 33.0],
                [-41.0, -42.0, 33.0],
                [-1.0, -62.0, 27.0],
                [38.0, -41.0, 28.0],
                [67.0, -5.0, 33.0],
                [45.0, 49.0, 29.0],
                [2.0, 68.0, 33.0],
                [-50.0, 50.0, 33.0],
                [-63.0, -3.0, 31.0],
                [-44.0, -50.0, 28.0],
                [-2.0, -70.0, 34.0],
                [48.0, -50.0, 27.0],
                [77.0, -5.0, 27.0],
                [48.0, 54.0, 35.0],
                [-1.0, 70.0, 27.0],
                [-50.0, 48.0, 30.0],
                [-78.0, -1.0, 35.0],
                [-51.0, -54.0, 29.0],
                [-2.0, -73.0, 33.0],
                [50.0, -53.0, 31.0],
                [78.0, -5.0, 32.0],
                [62.0, 57.0, 28.0],
                [-3.0, 80.0, 27.0],
                [-57.0, 61.0, 36.0],
                [-88.0, 1.0, 30.0],
                [-55.0, -63.0, 30.0],
                [0.0, -82.0, 28.0],
                [62.0, -64.0, 27.0],
                [87.0, 2.0, 32.0],
                [61.0, 65.0, 32.0],
                [3.0, 87.0, 32.0],
                [-67.0, 65.0, 29.0],
                [-93.0, -2.0, 28.0],
                [-69.0, -66.0, 33.0],
                [-3.0, -94.0, 32.0],
                [69.0, -69.0, 28.0],
                [101.0, 2.0, 31.0],
                [66.0, 72.0, 27.0],
                [3.0, 97.0, 29.0],
                [-76.0, 66.0, 36.0],
                [-97.0, 2.0, 34.0],
                [-74.0, -68.0, 36.0],
                [3.0, -102.0, 35.0],
                [67.0, -69.0, 36.0],
                [54.0, 2.0, 39.0],
                [30.0, 35.0, 39.0],
                [4.0, 49.0, 42.0],
                [-31.0, 32.0, 36.0],
                [-53.0, 0.0, 36.0],
                [-37.0, -37.0, 35.0],
                [-2.0, -52.0, 38.0],
                [31.0, -39.0, 38.0],
                [57.0, -2.0, 43.0],
                [44.0, 37.0, 35.0],
                [-4.0, 63.0, 44.0],
                [-44.0, 45.0, 42.0],
                [-61.0, 4.0, 36.0],
                [-46.0, -41.0, 38.0],
                [3.0, -58.0, 44.0],
                [39.0, -42.0, 36.0],
                [63.0, 2.0, 35.0],
                [51.0, 46.0, 40.0],
                [2.0, 67.0, 38.0],
                [-49.0, 46.0, 38.0],
                [-70.0, -4.0, 43.0],
                [-52.0, -48.0, 43.0],
                [-4.0, -67.0, 42.0],
                [44.0, -51.0, 40.0],
                [76.0, -1.0, 38.0],
                [55.0, 54.0, 40.0],
                [-1.0, 79.0, 38.0],
                [-52.0, 48.0, 35.0],
                [-76.0, 3.0, 42.0],
                [-56.0, -53.0, 36.0],
                [0.0, -80.0, 35.0],
                [56.0, -57.0, 39.0],
                [78.0, 4.0, 38.0],
                [63.0, 55.0, 38.0],
                [0.0, 80.0, 43.0],
                [-60.0, 58.0, 38.0],
                [-86.0, -5.0, 38.0],
                [-63.0, -62.0, 40.0],
                [2.0, -84.0, 39.0],
                [54.0, -56.0, 41.0],
                [89.0, 2.0, 39.0],
                [69.0, 64.0, 41.0],
                [-3.0, 95.0, 36.0],
                [-67.0, 62.0, 42.0],
                [-91.0, -1.0, 43.0],
                [-69.0, -68.0, 42.0],
                [-2.0, -88.0, 37.0],
                [64.0, -70.0, 43.0],
                [100.0, -1.0, 44.0],
                [68.0, 66.0, 41.0],
                [4.0, 102.0, 41.0],
                [-74.0, 67.0, 43.0],
                [-102.0, -1.0, 41.0],
                [-68.0, -76.0, 40.0],
                [-3.0, -103.0, 36.0],
                [71.0, -73.0, 41.0],
            ]
        )
        basis0 = BSplineBasis(
            4, np.array([-2.3, -1.0, 0.0, 0.0, 1.0, 1.7, 2.7, 4.0, 4.7, 6.0, 7.0, 7.0, 8.0, 8.7]), 1
        )
        basis1 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.3, 1.9, 3.1, 4.0, 4.0, 4.0, 4.0]))
        basis2 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 0.8, 1.7, 3.0, 3.0, 3.0, 3.0]))
        vol = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2 *= np.array([4.1, 6.6, 4.0])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] /= 4.100000
        pt2[..., 1] /= 6.600000
        pt2[..., 2] /= 4.000000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_2D_p7_rational(self):
        controlpoints = np.array(
            [
                [4.0, 2.0, 1.1],
                [14.0, -2.0, 1.0],
                [26.0, 2.0, 1.0],
                [41.0, -5.0, 0.8],
                [49.0, 4.0, 0.5],
                [58.0, 1.0, 0.7],
                [78.0, -2.0, 0.7],
                [86.0, 0.0, 0.7],
                [96.0, 4.0, 1.3],
            ]
        )
        basis0 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.4, 2.3, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0])
        )
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 += np.array([1.5, 1.8])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 1.500000
        pt2[..., 1] -= 1.800000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_2D_p7_rational(self):
        controlpoints = np.array(
            [
                [0.0, -2.0, 1.2],
                [17.0, -1.0, 0.7],
                [22.0, 2.0, 0.7],
                [37.0, -3.0, 0.5],
                [54.0, -1.0, 0.8],
                [64.0, 2.0, 1.3],
                [77.0, 1.0, 0.8],
                [86.0, 2.0, 1.5],
                [95.0, 0.0, 0.7],
            ]
        )
        basis0 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 1.7, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0])
        )
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 *= np.array([7.5, 8.3])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 7.500000
        pt2[..., 1] /= 8.300000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_2D_p65_rational(self):
        controlpoints = np.array(
            [
                [0.0, -2.0, 0.7],
                [15.0, 2.0, 1.0],
                [25.0, -3.0, 1.0],
                [31.0, 4.0, 0.5],
                [41.0, 0.0, 1.3],
                [55.0, -5.0, 1.5],
                [68.0, 1.0, 1.2],
                [80.0, -4.0, 0.8],
                [90.0, 0.0, 0.9],
                [97.0, -3.0, 0.7],
                [3.0, 11.0, 1.0],
                [15.0, 11.0, 0.5],
                [19.0, 7.0, 0.8],
                [36.0, 10.0, 1.0],
                [41.0, 14.0, 0.5],
                [51.0, 15.0, 0.6],
                [69.0, 6.0, 1.1],
                [77.0, 9.0, 1.1],
                [85.0, 9.0, 1.4],
                [100.0, 13.0, 0.6],
                [-3.0, 21.0, 1.0],
                [7.0, 23.0, 1.3],
                [19.0, 25.0, 1.3],
                [31.0, 25.0, 1.2],
                [40.0, 24.0, 1.0],
                [56.0, 26.0, 1.3],
                [67.0, 18.0, 0.6],
                [76.0, 23.0, 1.3],
                [88.0, 19.0, 1.1],
                [95.0, 27.0, 0.9],
                [3.0, 30.0, 1.0],
                [12.0, 30.0, 1.2],
                [23.0, 36.0, 1.1],
                [33.0, 30.0, 0.8],
                [47.0, 32.0, 1.4],
                [55.0, 31.0, 0.8],
                [66.0, 31.0, 0.6],
                [80.0, 28.0, 1.3],
                [93.0, 31.0, 1.0],
                [104.0, 30.0, 1.1],
                [2.0, 41.0, 1.4],
                [8.0, 48.0, 1.4],
                [23.0, 48.0, 1.2],
                [28.0, 43.0, 0.9],
                [39.0, 46.0, 0.7],
                [56.0, 48.0, 1.3],
                [68.0, 43.0, 1.2],
                [74.0, 43.0, 1.4],
                [85.0, 42.0, 1.4],
                [104.0, 48.0, 1.4],
                [3.0, 54.0, 1.1],
                [9.0, 54.0, 1.4],
                [23.0, 55.0, 1.4],
                [28.0, 52.0, 0.9],
                [47.0, 53.0, 0.6],
                [59.0, 55.0, 0.8],
                [68.0, 51.0, 0.8],
                [75.0, 51.0, 1.4],
                [88.0, 51.0, 0.6],
                [104.0, 58.0, 1.4],
                [-2.0, 63.0, 0.8],
                [6.0, 67.0, 0.7],
                [25.0, 67.0, 1.1],
                [37.0, 61.0, 1.2],
                [47.0, 62.0, 0.9],
                [53.0, 64.0, 1.5],
                [69.0, 63.0, 0.5],
                [73.0, 62.0, 1.1],
                [87.0, 65.0, 1.1],
                [99.0, 66.0, 1.1],
                [1.0, 82.0, 1.1],
                [8.0, 81.0, 0.9],
                [20.0, 79.0, 1.0],
                [31.0, 73.0, 0.8],
                [47.0, 81.0, 1.3],
                [56.0, 77.0, 0.8],
                [63.0, 81.0, 1.3],
                [82.0, 79.0, 1.0],
                [87.0, 73.0, 1.3],
                [98.0, 77.0, 1.4],
                [3.0, 88.0, 1.1],
                [6.0, 92.0, 0.8],
                [17.0, 84.0, 1.1],
                [31.0, 85.0, 0.5],
                [49.0, 90.0, 1.3],
                [56.0, 93.0, 1.0],
                [71.0, 92.0, 0.5],
                [77.0, 84.0, 1.4],
                [88.0, 84.0, 0.6],
                [95.0, 84.0, 1.4],
                [2.0, 95.0, 1.1],
                [15.0, 104.0, 1.2],
                [22.0, 95.0, 0.7],
                [29.0, 100.0, 0.8],
                [47.0, 99.0, 0.9],
                [57.0, 103.0, 1.4],
                [63.0, 95.0, 1.3],
                [78.0, 100.0, 1.4],
                [89.0, 99.0, 1.2],
                [97.0, 103.0, 1.5],
            ]
        )
        basis0 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 1.8, 3.3, 3.7, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0])
        )
        basis1 = BSplineBasis(
            5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 1.1, 2.3, 2.9, 4.2, 4.7, 6.0, 6.0, 6.0, 6.0, 6.0])
        )
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 += np.array([9.6, 2.8])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 9.600000
        pt2[..., 1] -= 2.800000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_surface_2D_p75_rational(self):
        controlpoints = np.array(
            [
                [-3.0, 4.0, 0.6],
                [9.0, 0.0, 0.6],
                [28.0, -4.0, 1.3],
                [37.0, 1.0, 0.9],
                [54.0, -3.0, 1.5],
                [59.0, 3.0, 0.5],
                [70.0, 2.0, 0.6],
                [89.0, 4.0, 1.4],
                [97.0, 2.0, 0.6],
                [-1.0, 8.0, 1.2],
                [15.0, 10.0, 1.2],
                [21.0, 14.0, 0.6],
                [37.0, 9.0, 0.9],
                [49.0, 12.0, 1.4],
                [59.0, 15.0, 0.9],
                [74.0, 11.0, 0.7],
                [89.0, 8.0, 1.5],
                [103.0, 13.0, 0.7],
                [3.0, 24.0, 1.5],
                [11.0, 19.0, 0.9],
                [21.0, 22.0, 1.3],
                [39.0, 24.0, 1.2],
                [46.0, 19.0, 0.8],
                [63.0, 23.0, 1.0],
                [72.0, 23.0, 1.2],
                [86.0, 25.0, 0.8],
                [102.0, 17.0, 1.5],
                [-2.0, 29.0, 0.7],
                [10.0, 31.0, 0.8],
                [26.0, 38.0, 0.9],
                [32.0, 37.0, 0.7],
                [49.0, 33.0, 1.2],
                [58.0, 36.0, 1.0],
                [73.0, 30.0, 1.4],
                [91.0, 37.0, 0.9],
                [95.0, 29.0, 1.5],
                [-3.0, 41.0, 1.1],
                [17.0, 42.0, 0.7],
                [27.0, 44.0, 1.1],
                [33.0, 47.0, 1.2],
                [47.0, 39.0, 1.5],
                [57.0, 48.0, 0.6],
                [70.0, 39.0, 1.3],
                [91.0, 42.0, 0.7],
                [98.0, 46.0, 1.2],
                [0.0, 52.0, 1.0],
                [8.0, 60.0, 0.6],
                [23.0, 52.0, 0.6],
                [38.0, 51.0, 0.9],
                [50.0, 60.0, 0.6],
                [64.0, 52.0, 1.3],
                [76.0, 57.0, 1.4],
                [89.0, 58.0, 0.5],
                [98.0, 53.0, 1.3],
                [3.0, 66.0, 0.8],
                [8.0, 67.0, 0.6],
                [21.0, 66.0, 1.2],
                [41.0, 68.0, 1.1],
                [50.0, 68.0, 0.7],
                [64.0, 62.0, 1.2],
                [77.0, 68.0, 1.4],
                [90.0, 71.0, 0.8],
                [103.0, 69.0, 1.0],
                [2.0, 74.0, 0.8],
                [12.0, 79.0, 1.0],
                [26.0, 75.0, 1.0],
                [39.0, 76.0, 0.6],
                [48.0, 74.0, 1.2],
                [59.0, 75.0, 0.8],
                [70.0, 75.0, 0.9],
                [89.0, 75.0, 1.4],
                [101.0, 82.0, 1.2],
                [2.0, 92.0, 0.5],
                [16.0, 93.0, 1.1],
                [24.0, 86.0, 0.6],
                [41.0, 90.0, 0.6],
                [49.0, 85.0, 0.6],
                [65.0, 91.0, 0.8],
                [76.0, 89.0, 1.3],
                [82.0, 91.0, 1.2],
                [97.0, 85.0, 1.4],
                [-4.0, 99.0, 0.9],
                [13.0, 100.0, 1.4],
                [29.0, 96.0, 1.3],
                [35.0, 102.0, 0.9],
                [49.0, 102.0, 1.3],
                [62.0, 97.0, 1.1],
                [77.0, 101.0, 0.9],
                [83.0, 100.0, 1.0],
                [101.0, 100.0, 0.9],
            ]
        )
        basis0 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.2, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0])
        )
        basis1 = BSplineBasis(
            5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 1.1, 2.2, 2.7, 4.2, 4.7, 6.0, 6.0, 6.0, 6.0, 6.0])
        )
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 *= np.array([2.7, 5.2])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 2.700000
        pt2[..., 1] /= 5.200000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_2D_p6_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [104.0, 4.0, 0.8],
                [88.0, 54.0, 0.9],
                [40.0, 86.0, 0.9],
                [-18.0, 94.0, 1.1],
                [-65.0, 75.0, 1.0],
                [-96.0, 25.0, 1.4],
                [-92.0, -32.0, 1.0],
                [-64.0, -78.0, 0.9],
                [-19.0, -102.0, 1.0],
                [41.0, -91.0, 0.7],
                [80.0, -55.0, 0.6],
            ]
        )
        basis0 = BSplineBasis(
            6,
            np.array(
                [-1.3, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1, 2.0, 2.7, 4.4, 5.3, 5.7, 7.0, 7.0, 7.0, 7.0, 7.0, 8.1]
            ),
            0,
        )
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 += np.array([5.4, 4.0, 8.7])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 5.400000
        pt2[..., 1] -= 4.000000
        pt2[..., 2] -= 8.700000
        allZero = pt2
        allZero[..., :-1] -= pt
        self.assertAlmostEqual(np.linalg.norm(allZero), 0.0)

    def test_scale_curve_2D_p5_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [98.0, 0.0, 1.0],
                [77.0, 56.0, 1.5],
                [29.0, 100.0, 1.2],
                [-30.0, 97.0, 0.7],
                [-81.0, 56.0, 0.7],
                [-100.0, -1.0, 1.2],
                [-83.0, -64.0, 0.7],
                [-30.0, -93.0, 0.7],
                [27.0, -100.0, 0.8],
                [84.0, -61.0, 0.6],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([-1.0, 0.0, 0.0, 0.0, 0.0, 1.3, 2.1, 3.0, 4.1, 4.9, 6.0, 7.0, 7.0, 7.0, 7.0, 8.3]), 0
        )
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 *= np.array([5.4, 2.8])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 5.400000
        pt2[..., 1] /= 2.800000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_2D_p57_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [59.0, 4.0, 1.4],
                [41.0, 42.0, 1.5],
                [8.0, 58.0, 0.7],
                [-32.0, 47.0, 1.4],
                [-57.0, 20.0, 1.4],
                [-61.0, -24.0, 1.3],
                [-31.0, -51.0, 0.7],
                [8.0, -59.0, 1.1],
                [49.0, -38.0, 1.5],
                [67.0, -3.0, 0.6],
                [53.0, 41.0, 0.8],
                [13.0, 66.0, 1.1],
                [-30.0, 58.0, 1.1],
                [-61.0, 21.0, 1.0],
                [-61.0, -24.0, 1.0],
                [-35.0, -58.0, 0.8],
                [10.0, -64.0, 0.7],
                [48.0, -43.0, 1.0],
                [69.0, -5.0, 0.5],
                [56.0, 47.0, 1.2],
                [16.0, 71.0, 0.7],
                [-39.0, 56.0, 1.2],
                [-66.0, 22.0, 0.5],
                [-62.0, -22.0, 1.3],
                [-33.0, -60.0, 1.1],
                [11.0, -64.0, 0.5],
                [52.0, -47.0, 1.5],
                [77.0, 3.0, 0.8],
                [53.0, 50.0, 0.9],
                [11.0, 72.0, 1.3],
                [-35.0, 62.0, 0.9],
                [-68.0, 27.0, 1.0],
                [-67.0, -30.0, 1.1],
                [-42.0, -63.0, 0.9],
                [11.0, -74.0, 1.1],
                [60.0, -47.0, 1.5],
                [75.0, 0.0, 0.6],
                [60.0, 49.0, 0.8],
                [10.0, 76.0, 0.9],
                [-39.0, 64.0, 0.8],
                [-69.0, 27.0, 0.6],
                [-74.0, -32.0, 0.9],
                [-40.0, -72.0, 1.2],
                [15.0, -75.0, 1.2],
                [54.0, -47.0, 1.4],
                [80.0, 0.0, 0.6],
                [67.0, 56.0, 1.0],
                [15.0, 79.0, 1.3],
                [-46.0, 67.0, 1.2],
                [-76.0, 27.0, 0.7],
                [-80.0, -26.0, 1.1],
                [-39.0, -73.0, 1.1],
                [16.0, -85.0, 0.5],
                [62.0, -53.0, 1.3],
                [86.0, -2.0, 0.5],
                [69.0, 59.0, 1.4],
                [15.0, 89.0, 0.9],
                [-46.0, 77.0, 1.4],
                [-79.0, 32.0, 0.7],
                [-86.0, -30.0, 1.1],
                [-39.0, -75.0, 0.6],
                [18.0, -83.0, 0.7],
                [70.0, -59.0, 1.4],
                [93.0, 2.0, 1.2],
                [73.0, 58.0, 0.6],
                [11.0, 89.0, 0.6],
                [-48.0, 79.0, 1.3],
                [-86.0, 30.0, 1.5],
                [-89.0, -27.0, 1.5],
                [-43.0, -81.0, 1.3],
                [15.0, -89.0, 0.9],
                [70.0, -60.0, 0.7],
                [90.0, -3.0, 1.1],
                [72.0, 66.0, 1.0],
                [11.0, 89.0, 0.6],
                [-52.0, 86.0, 1.1],
                [-86.0, 30.0, 1.2],
                [-85.0, -30.0, 0.9],
                [-48.0, -86.0, 0.7],
                [20.0, -99.0, 0.8],
                [78.0, -57.0, 1.4],
                [96.0, -1.0, 0.8],
                [76.0, 63.0, 0.5],
                [19.0, 102.0, 1.1],
                [-47.0, 88.0, 1.1],
                [-94.0, 37.0, 1.0],
                [-92.0, -40.0, 0.5],
                [-53.0, -82.0, 1.0],
                [16.0, -102.0, 0.9],
                [72.0, -64.0, 1.2],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([-0.8, 0.0, 0.0, 0.0, 0.0, 1.4, 1.8, 3.0, 4.2, 5.2, 6.0, 6.0, 6.0, 6.0, 7.4]), 0
        )
        basis1 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.2, 2.1, 3.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 += np.array([5.7, 7.0, 9.1])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 5.700000
        pt2[..., 1] -= 7.000000
        pt2[..., 2] -= 9.100000
        allZero = pt2
        allZero[..., :-1] -= pt
        self.assertAlmostEqual(np.linalg.norm(allZero), 0.0)

    def test_scale_surface_2D_p76_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [64.0, -5.0, 1.2],
                [49.0, 37.0, 1.4],
                [23.0, 50.0, 1.1],
                [-11.0, 59.0, 1.3],
                [-43.0, 44.0, 1.0],
                [-59.0, 19.0, 0.6],
                [-62.0, -20.0, 1.4],
                [-43.0, -47.0, 1.3],
                [-7.0, -64.0, 1.2],
                [29.0, -54.0, 1.5],
                [47.0, -33.0, 1.3],
                [66.0, 4.0, 0.8],
                [59.0, 32.0, 0.6],
                [26.0, 58.0, 0.9],
                [-9.0, 62.0, 1.3],
                [-45.0, 48.0, 0.9],
                [-59.0, 16.0, 1.0],
                [-63.0, -18.0, 0.5],
                [-42.0, -47.0, 1.5],
                [-14.0, -66.0, 0.8],
                [24.0, -63.0, 0.8],
                [51.0, -39.0, 1.3],
                [66.0, -4.0, 1.5],
                [60.0, 35.0, 0.9],
                [27.0, 63.0, 0.9],
                [-8.0, 67.0, 1.3],
                [-50.0, 55.0, 0.7],
                [-72.0, 18.0, 0.5],
                [-71.0, -19.0, 1.4],
                [-43.0, -53.0, 1.4],
                [-8.0, -70.0, 1.0],
                [32.0, -68.0, 0.7],
                [56.0, -39.0, 1.1],
                [70.0, 0.0, 1.0],
                [61.0, 41.0, 0.8],
                [35.0, 66.0, 1.0],
                [-10.0, 74.0, 0.6],
                [-53.0, 59.0, 1.4],
                [-74.0, 22.0, 0.7],
                [-76.0, -24.0, 1.0],
                [-51.0, -55.0, 1.4],
                [-7.0, -74.0, 1.2],
                [26.0, -70.0, 1.2],
                [61.0, -39.0, 1.3],
                [81.0, -5.0, 0.6],
                [69.0, 47.0, 1.4],
                [33.0, 74.0, 1.2],
                [-8.0, 78.0, 0.8],
                [-58.0, 60.0, 0.5],
                [-72.0, 17.0, 1.3],
                [-77.0, -23.0, 0.6],
                [-52.0, -61.0, 0.6],
                [-13.0, -81.0, 0.5],
                [36.0, -70.0, 1.5],
                [67.0, -47.0, 0.7],
                [89.0, 3.0, 0.9],
                [68.0, 43.0, 1.4],
                [31.0, 74.0, 0.6],
                [-15.0, 83.0, 1.2],
                [-52.0, 63.0, 1.1],
                [-78.0, 20.0, 0.9],
                [-80.0, -26.0, 0.7],
                [-60.0, -69.0, 1.1],
                [-10.0, -83.0, 0.9],
                [31.0, -78.0, 1.4],
                [71.0, -42.0, 1.2],
                [94.0, 4.0, 0.8],
                [78.0, 44.0, 1.4],
                [39.0, 81.0, 0.7],
                [-14.0, 85.0, 1.1],
                [-64.0, 67.0, 1.4],
                [-85.0, 25.0, 1.3],
                [-83.0, -28.0, 0.5],
                [-59.0, -73.0, 1.2],
                [-15.0, -93.0, 1.5],
                [41.0, -81.0, 1.1],
                [76.0, -45.0, 0.6],
                [93.0, 2.0, 1.4],
                [84.0, 49.0, 0.9],
                [39.0, 86.0, 1.1],
                [-14.0, 95.0, 1.4],
                [-64.0, 69.0, 1.3],
                [-96.0, 23.0, 1.1],
                [-97.0, -32.0, 1.4],
                [-64.0, -68.0, 1.0],
                [-16.0, -95.0, 0.7],
                [38.0, -88.0, 1.1],
                [79.0, -51.0, 0.9],
                [102.0, 0.0, 1.4],
                [87.0, 53.0, 1.0],
                [44.0, 87.0, 1.0],
                [-12.0, 98.0, 0.8],
                [-63.0, 80.0, 1.4],
                [-98.0, 27.0, 1.5],
                [-96.0, -29.0, 0.6],
                [-62.0, -81.0, 0.5],
                [-14.0, -100.0, 0.7],
                [42.0, -87.0, 0.7],
                [82.0, -57.0, 1.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    -0.9,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.9,
                    1.8,
                    3.3,
                    3.7,
                    5.1,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.9,
                ]
            ),
            0,
        )
        basis1 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.9, 3.1, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 *= np.array([3.1, 4.1])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 3.100000
        pt2[..., 1] /= 4.100000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_2D_p5_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [98.0, -1.0, 1.3],
                [79.0, 65.0, 0.8],
                [16.0, 97.0, 0.6],
                [-53.0, 82.0, 0.9],
                [-93.0, 36.0, 1.0],
                [-92.0, -38.0, 1.2],
                [-55.0, -91.0, 0.9],
                [19.0, -100.0, 0.8],
                [80.0, -63.0, 0.7],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([-1.9, -1.0, 0.0, 0.0, 0.0, 1.3, 2.3, 2.9, 4.3, 5.1, 6.0, 7.0, 7.0, 7.0, 8.3, 9.3]), 1
        )
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 += np.array([0.4, 7.0])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 0.400000
        pt2[..., 1] -= 7.000000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_2D_p5_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [96.0, 0.0, 1.4],
                [60.0, 73.0, 1.2],
                [-25.0, 101.0, 1.0],
                [-91.0, 40.0, 0.8],
                [-95.0, -47.0, 0.7],
                [-20.0, -97.0, 0.7],
                [65.0, -75.0, 1.0],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([-2.1, -1.0, 0.0, 0.0, 0.0, 0.7, 2.4, 2.9, 4.0, 5.0, 5.0, 5.0, 5.7, 7.4]), 1
        )
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 *= np.array([4.6, 7.4])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 4.600000
        pt2[..., 1] /= 7.400000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_2D_p76_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [61.0, -1.0, 1.0],
                [54.0, 33.0, 1.2],
                [22.0, 50.0, 1.4],
                [-7.0, 56.0, 0.9],
                [-43.0, 41.0, 1.4],
                [-60.0, 17.0, 0.7],
                [-56.0, -19.0, 1.3],
                [-36.0, -47.0, 1.4],
                [-9.0, -63.0, 1.3],
                [21.0, -52.0, 1.0],
                [54.0, -37.0, 1.4],
                [65.0, 0.0, 0.6],
                [55.0, 37.0, 1.0],
                [29.0, 61.0, 1.3],
                [-11.0, 59.0, 1.1],
                [-48.0, 50.0, 1.4],
                [-61.0, 13.0, 1.1],
                [-64.0, -19.0, 0.8],
                [-38.0, -50.0, 1.0],
                [-14.0, -59.0, 0.6],
                [22.0, -59.0, 0.7],
                [52.0, -36.0, 0.7],
                [71.0, 0.0, 0.8],
                [59.0, 42.0, 0.8],
                [33.0, 62.0, 0.6],
                [-9.0, 68.0, 1.2],
                [-51.0, 51.0, 1.0],
                [-69.0, 19.0, 0.7],
                [-70.0, -24.0, 1.3],
                [-45.0, -55.0, 1.0],
                [-10.0, -67.0, 0.8],
                [26.0, -68.0, 1.2],
                [54.0, -39.0, 1.4],
                [77.0, 3.0, 1.0],
                [63.0, 36.0, 0.8],
                [32.0, 63.0, 1.4],
                [-12.0, 76.0, 1.0],
                [-51.0, 56.0, 1.3],
                [-73.0, 20.0, 0.7],
                [-70.0, -23.0, 1.2],
                [-52.0, -52.0, 1.4],
                [-12.0, -70.0, 0.8],
                [34.0, -71.0, 0.9],
                [60.0, -41.0, 0.9],
                [74.0, -2.0, 1.3],
                [65.0, 41.0, 1.0],
                [32.0, 73.0, 0.9],
                [-16.0, 76.0, 0.5],
                [-54.0, 54.0, 1.2],
                [-70.0, 18.0, 0.7],
                [-75.0, -20.0, 0.8],
                [-49.0, -55.0, 1.0],
                [-12.0, -76.0, 0.7],
                [27.0, -67.0, 0.9],
                [69.0, -42.0, 1.0],
                [78.0, -3.0, 1.0],
                [67.0, 44.0, 1.5],
                [37.0, 74.0, 1.0],
                [-11.0, 83.0, 0.9],
                [-58.0, 63.0, 1.1],
                [-80.0, 26.0, 0.5],
                [-83.0, -24.0, 1.3],
                [-55.0, -64.0, 1.2],
                [-13.0, -82.0, 1.3],
                [32.0, -79.0, 0.6],
                [68.0, -40.0, 1.2],
                [81.0, -3.0, 0.8],
                [73.0, 45.0, 1.4],
                [33.0, 82.0, 1.4],
                [-14.0, 87.0, 1.0],
                [-59.0, 63.0, 0.8],
                [-81.0, 25.0, 1.2],
                [-84.0, -20.0, 0.6],
                [-59.0, -63.0, 0.8],
                [-15.0, -88.0, 0.8],
                [33.0, -79.0, 1.0],
                [75.0, -51.0, 1.0],
                [95.0, 3.0, 0.9],
                [72.0, 53.0, 0.7],
                [36.0, 83.0, 1.1],
                [-11.0, 89.0, 0.9],
                [-61.0, 72.0, 0.9],
                [-91.0, 29.0, 1.3],
                [-83.0, -24.0, 0.6],
                [-63.0, -68.0, 1.3],
                [-14.0, -89.0, 1.0],
                [35.0, -87.0, 1.5],
                [73.0, -46.0, 0.5],
                [92.0, 3.0, 0.9],
                [81.0, 55.0, 0.7],
                [44.0, 88.0, 1.1],
                [-16.0, 94.0, 1.5],
                [-58.0, 72.0, 0.6],
                [-88.0, 24.0, 1.1],
                [-87.0, -24.0, 1.3],
                [-59.0, -72.0, 0.5],
                [-19.0, -99.0, 1.3],
                [35.0, -88.0, 0.6],
                [75.0, -55.0, 1.0],
                [104.0, -2.0, 1.4],
                [85.0, 49.0, 0.6],
                [36.0, 91.0, 0.8],
                [-13.0, 96.0, 0.7],
                [-61.0, 71.0, 1.4],
                [-101.0, 25.0, 1.1],
                [-98.0, -27.0, 0.6],
                [-65.0, -73.0, 0.9],
                [-13.0, -103.0, 0.9],
                [40.0, -92.0, 1.5],
                [83.0, -59.0, 0.9],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    -1.9,
                    -0.9,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.8,
                    2.2,
                    3.0,
                    3.7,
                    5.1,
                    6.1,
                    7.0,
                    7.0,
                    7.0,
                    7.0,
                    7.0,
                    7.8,
                    9.2,
                ]
            ),
            1,
        )
        basis1 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.3, 1.8, 3.0, 4.2, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0])
        )
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 += np.array([6.8, 7.5, 0.1])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 6.800000
        pt2[..., 1] -= 7.500000
        pt2[..., 2] -= 0.100000
        allZero = pt2
        allZero[..., :-1] -= pt
        self.assertAlmostEqual(np.linalg.norm(allZero), 0.0)

    def test_scale_surface_2D_p76_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [59.0, 4.0, 0.6],
                [46.0, 37.0, 1.4],
                [10.0, 56.0, 1.0],
                [-31.0, 51.0, 0.8],
                [-54.0, 17.0, 1.0],
                [-55.0, -22.0, 1.4],
                [-28.0, -54.0, 1.4],
                [15.0, -62.0, 1.1],
                [45.0, -36.0, 1.2],
                [66.0, -5.0, 0.8],
                [55.0, 41.0, 1.0],
                [8.0, 61.0, 1.3],
                [-36.0, 53.0, 0.7],
                [-59.0, 24.0, 0.7],
                [-62.0, -26.0, 0.8],
                [-29.0, -54.0, 1.2],
                [11.0, -64.0, 0.7],
                [54.0, -47.0, 1.0],
                [71.0, -1.0, 0.6],
                [54.0, 45.0, 1.0],
                [12.0, 67.0, 1.1],
                [-36.0, 58.0, 1.3],
                [-64.0, 22.0, 1.2],
                [-72.0, -26.0, 0.8],
                [-35.0, -59.0, 1.1],
                [10.0, -71.0, 1.1],
                [54.0, -44.0, 0.9],
                [79.0, -5.0, 1.5],
                [58.0, 51.0, 0.6],
                [9.0, 75.0, 1.1],
                [-38.0, 64.0, 0.8],
                [-70.0, 27.0, 0.7],
                [-75.0, -29.0, 1.4],
                [-44.0, -70.0, 0.8],
                [8.0, -76.0, 0.9],
                [61.0, -51.0, 1.2],
                [78.0, 0.0, 0.9],
                [62.0, 49.0, 0.5],
                [18.0, 76.0, 0.7],
                [-37.0, 67.0, 1.4],
                [-80.0, 25.0, 0.7],
                [-78.0, -26.0, 0.5],
                [-45.0, -72.0, 1.0],
                [9.0, -86.0, 0.9],
                [64.0, -55.0, 1.4],
                [83.0, -3.0, 0.9],
                [63.0, 56.0, 0.7],
                [14.0, 83.0, 1.2],
                [-44.0, 75.0, 1.3],
                [-79.0, 31.0, 0.9],
                [-83.0, -29.0, 1.5],
                [-46.0, -78.0, 1.4],
                [16.0, -87.0, 0.7],
                [69.0, -60.0, 0.8],
                [96.0, 2.0, 0.9],
                [76.0, 56.0, 1.4],
                [11.0, 88.0, 1.0],
                [-46.0, 77.0, 1.0],
                [-93.0, 31.0, 1.0],
                [-92.0, -28.0, 0.9],
                [-47.0, -79.0, 1.3],
                [12.0, -93.0, 1.3],
                [73.0, -58.0, 1.0],
                [96.0, 2.0, 0.7],
                [72.0, 68.0, 0.7],
                [16.0, 95.0, 1.1],
                [-49.0, 86.0, 1.4],
                [-99.0, 34.0, 1.2],
                [-97.0, -39.0, 0.7],
                [-55.0, -91.0, 0.8],
                [15.0, -96.0, 0.6],
                [74.0, -62.0, 1.2],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [-2.3, -0.9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 2.2, 2.7, 4.1, 5.0, 5.0, 5.0, 5.0, 5.0, 5.7, 7.2]
            ),
            1,
        )
        basis1 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.2, 1.9, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0])
        )
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 *= np.array([8.3, 7.4])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 8.300000
        pt2[..., 1] /= 7.400000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_2D_p6(self):
        controlpoints = np.array(
            [
                [4.0, -2.0],
                [7.0, 1.0],
                [24.0, -5.0],
                [37.0, 1.0],
                [46.0, 2.0],
                [55.0, 3.0],
                [68.0, -5.0],
                [75.0, 2.0],
                [89.0, 1.0],
                [95.0, 3.0],
            ]
        )
        basis0 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 1.7, 3.0, 3.7, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0])
        )
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 += np.array([2.1, 0.4, 4.9])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 2.100000
        pt2[..., 1] -= 0.400000
        pt2[..., 2] -= 4.900000
        allZero = pt2
        allZero[..., :-1] -= pt
        self.assertAlmostEqual(np.linalg.norm(allZero), 0.0)

    def test_scale_curve_2D_p7(self):
        controlpoints = np.array(
            [
                [2.0, -2.0],
                [14.0, 4.0],
                [17.0, 2.0],
                [22.0, -3.0],
                [40.0, -3.0],
                [44.0, 3.0],
                [57.0, -1.0],
                [66.0, -3.0],
                [71.0, 1.0],
                [79.0, 4.0],
                [94.0, 0.0],
                [102.0, -1.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.2,
                    2.1,
                    2.9,
                    4.2,
                    5.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                ]
            ),
        )
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 *= np.array([4.6, 4.1])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 4.600000
        pt2[..., 1] /= 4.100000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_2D_p66(self):
        controlpoints = np.array(
            [
                [-2.0, 0.0],
                [14.0, -2.0],
                [26.0, 4.0],
                [28.0, 2.0],
                [40.0, -5.0],
                [54.0, 1.0],
                [67.0, -2.0],
                [78.0, -4.0],
                [91.0, -2.0],
                [101.0, 2.0],
                [1.0, 18.0],
                [15.0, 13.0],
                [19.0, 10.0],
                [30.0, 12.0],
                [39.0, 17.0],
                [54.0, 9.0],
                [71.0, 9.0],
                [73.0, 14.0],
                [87.0, 18.0],
                [96.0, 10.0],
                [0.0, 24.0],
                [14.0, 26.0],
                [21.0, 24.0],
                [36.0, 26.0],
                [48.0, 25.0],
                [56.0, 30.0],
                [62.0, 32.0],
                [79.0, 30.0],
                [85.0, 25.0],
                [98.0, 27.0],
                [1.0, 41.0],
                [9.0, 45.0],
                [24.0, 38.0],
                [28.0, 41.0],
                [47.0, 39.0],
                [57.0, 40.0],
                [68.0, 39.0],
                [74.0, 43.0],
                [88.0, 45.0],
                [98.0, 39.0],
                [-1.0, 60.0],
                [8.0, 57.0],
                [19.0, 58.0],
                [35.0, 59.0],
                [40.0, 55.0],
                [57.0, 56.0],
                [64.0, 55.0],
                [75.0, 55.0],
                [89.0, 58.0],
                [103.0, 55.0],
                [0.0, 72.0],
                [13.0, 75.0],
                [21.0, 72.0],
                [31.0, 74.0],
                [48.0, 70.0],
                [50.0, 69.0],
                [68.0, 76.0],
                [78.0, 66.0],
                [93.0, 74.0],
                [102.0, 66.0],
                [-2.0, 85.0],
                [15.0, 83.0],
                [23.0, 88.0],
                [33.0, 84.0],
                [39.0, 87.0],
                [55.0, 86.0],
                [63.0, 86.0],
                [73.0, 85.0],
                [88.0, 89.0],
                [98.0, 89.0],
                [3.0, 96.0],
                [14.0, 98.0],
                [26.0, 97.0],
                [33.0, 95.0],
                [46.0, 101.0],
                [59.0, 98.0],
                [70.0, 97.0],
                [73.0, 103.0],
                [85.0, 104.0],
                [95.0, 99.0],
            ]
        )
        basis0 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1, 1.8, 2.7, 3.7, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0])
        )
        basis1 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.4, 1.6, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0])
        )
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 += np.array([3.0, 9.7])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 3.000000
        pt2[..., 1] -= 9.700000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_surface_2D_p77(self):
        controlpoints = np.array(
            [
                [3.0, 2.0],
                [10.0, 1.0],
                [19.0, 3.0],
                [26.0, 3.0],
                [39.0, 4.0],
                [50.0, -4.0],
                [56.0, -4.0],
                [63.0, -5.0],
                [68.0, -3.0],
                [82.0, -3.0],
                [93.0, -1.0],
                [102.0, -3.0],
                [4.0, 8.0],
                [10.0, 15.0],
                [19.0, 10.0],
                [26.0, 7.0],
                [37.0, 13.0],
                [45.0, 9.0],
                [55.0, 14.0],
                [64.0, 11.0],
                [72.0, 11.0],
                [80.0, 10.0],
                [86.0, 9.0],
                [103.0, 15.0],
                [-4.0, 29.0],
                [12.0, 29.0],
                [19.0, 20.0],
                [25.0, 26.0],
                [34.0, 26.0],
                [45.0, 21.0],
                [50.0, 25.0],
                [60.0, 28.0],
                [73.0, 28.0],
                [85.0, 22.0],
                [87.0, 22.0],
                [99.0, 22.0],
                [-3.0, 41.0],
                [10.0, 38.0],
                [15.0, 36.0],
                [23.0, 40.0],
                [33.0, 33.0],
                [49.0, 42.0],
                [57.0, 36.0],
                [62.0, 41.0],
                [73.0, 39.0],
                [77.0, 41.0],
                [85.0, 34.0],
                [96.0, 42.0],
                [-5.0, 46.0],
                [11.0, 54.0],
                [18.0, 50.0],
                [23.0, 47.0],
                [34.0, 47.0],
                [43.0, 47.0],
                [53.0, 46.0],
                [68.0, 47.0],
                [70.0, 53.0],
                [83.0, 54.0],
                [87.0, 53.0],
                [96.0, 52.0],
                [-1.0, 64.0],
                [12.0, 66.0],
                [16.0, 63.0],
                [22.0, 66.0],
                [33.0, 58.0],
                [43.0, 58.0],
                [54.0, 62.0],
                [58.0, 65.0],
                [72.0, 59.0],
                [77.0, 60.0],
                [92.0, 63.0],
                [99.0, 60.0],
                [1.0, 74.0],
                [13.0, 79.0],
                [21.0, 74.0],
                [23.0, 79.0],
                [31.0, 73.0],
                [45.0, 77.0],
                [57.0, 77.0],
                [68.0, 70.0],
                [77.0, 77.0],
                [78.0, 79.0],
                [89.0, 70.0],
                [98.0, 75.0],
                [-1.0, 85.0],
                [5.0, 82.0],
                [20.0, 83.0],
                [23.0, 83.0],
                [36.0, 90.0],
                [41.0, 88.0],
                [52.0, 90.0],
                [59.0, 89.0],
                [75.0, 91.0],
                [82.0, 83.0],
                [88.0, 82.0],
                [97.0, 85.0],
                [1.0, 98.0],
                [6.0, 102.0],
                [19.0, 100.0],
                [22.0, 100.0],
                [40.0, 101.0],
                [41.0, 99.0],
                [58.0, 96.0],
                [59.0, 96.0],
                [72.0, 102.0],
                [85.0, 96.0],
                [88.0, 97.0],
                [97.0, 104.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.7,
                    1.9,
                    3.1,
                    3.8,
                    4.8,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                ]
            ),
        )
        basis1 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.2, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0])
        )
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 *= np.array([11.7, 5.8])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 11.700000
        pt2[..., 1] /= 5.800000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_2D_p7_C0_periodic(self):
        controlpoints = np.array(
            [
                [104.0, 0.0],
                [81.0, 66.0],
                [12.0, 98.0],
                [-49.0, 85.0],
                [-98.0, 36.0],
                [-96.0, -32.0],
                [-52.0, -91.0],
                [16.0, -103.0],
                [77.0, -70.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array([-1.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9, 2.0, 2.8, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.9]),
            0,
        )
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 += np.array([6.0, 5.9])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 6.000000
        pt2[..., 1] -= 5.900000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_2D_p6_C0_periodic(self):
        controlpoints = np.array(
            [
                [95.0, 4.0],
                [82.0, 62.0],
                [34.0, 92.0],
                [-27.0, 90.0],
                [-81.0, 55.0],
                [-105.0, -3.0],
                [-79.0, -56.0],
                [-29.0, -101.0],
                [33.0, -91.0],
                [84.0, -58.0],
            ]
        )
        basis0 = BSplineBasis(
            6,
            np.array([-1.1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 1.8, 2.7, 4.2, 4.9, 6.0, 6.0, 6.0, 6.0, 6.0, 6.8]),
            0,
        )
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 *= np.array([2.7, 2.7])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 2.700000
        pt2[..., 1] /= 2.700000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_2D_p56_C0_periodic(self):
        controlpoints = np.array(
            [
                [61.0, -2.0],
                [44.0, 35.0],
                [12.0, 56.0],
                [-33.0, 52.0],
                [-59.0, 21.0],
                [-56.0, -20.0],
                [-31.0, -52.0],
                [14.0, -55.0],
                [47.0, -41.0],
                [63.0, 4.0],
                [52.0, 47.0],
                [14.0, 61.0],
                [-33.0, 54.0],
                [-68.0, 23.0],
                [-67.0, -21.0],
                [-29.0, -56.0],
                [8.0, -68.0],
                [50.0, -47.0],
                [70.0, -5.0],
                [54.0, 50.0],
                [10.0, 72.0],
                [-32.0, 59.0],
                [-65.0, 25.0],
                [-72.0, -23.0],
                [-33.0, -65.0],
                [10.0, -68.0],
                [52.0, -48.0],
                [81.0, 1.0],
                [57.0, 53.0],
                [16.0, 75.0],
                [-43.0, 65.0],
                [-78.0, 27.0],
                [-79.0, -25.0],
                [-40.0, -67.0],
                [14.0, -82.0],
                [57.0, -47.0],
                [88.0, -3.0],
                [64.0, 59.0],
                [18.0, 86.0],
                [-42.0, 77.0],
                [-82.0, 28.0],
                [-84.0, -32.0],
                [-42.0, -76.0],
                [14.0, -85.0],
                [64.0, -56.0],
                [96.0, 0.0],
                [72.0, 62.0],
                [12.0, 89.0],
                [-48.0, 78.0],
                [-86.0, 27.0],
                [-92.0, -36.0],
                [-46.0, -83.0],
                [16.0, -96.0],
                [72.0, -63.0],
                [98.0, 2.0],
                [79.0, 59.0],
                [17.0, 101.0],
                [-53.0, 88.0],
                [-90.0, 33.0],
                [-99.0, -33.0],
                [-53.0, -88.0],
                [18.0, -94.0],
                [75.0, -63.0],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([-1.4, 0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 3.0, 4.2, 4.6, 6.0, 6.0, 6.0, 6.0, 7.0]), 0
        )
        basis1 = BSplineBasis(6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.2, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0]))
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 += np.array([6.3, 6.2, 9.4])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 6.300000
        pt2[..., 1] -= 6.200000
        pt2[..., 2] -= 9.400000
        allZero = pt2
        allZero[..., :-1] -= pt
        self.assertAlmostEqual(np.linalg.norm(allZero), 0.0)

    def test_scale_surface_2D_p67_C0_periodic(self):
        controlpoints = np.array(
            [
                [61.0, 4.0],
                [37.0, 39.0],
                [3.0, 56.0],
                [-43.0, 43.0],
                [-58.0, 1.0],
                [-41.0, -43.0],
                [-1.0, -63.0],
                [44.0, -47.0],
                [66.0, 1.0],
                [44.0, 49.0],
                [0.0, 63.0],
                [-46.0, 40.0],
                [-62.0, -4.0],
                [-42.0, -45.0],
                [1.0, -69.0],
                [48.0, -48.0],
                [66.0, 3.0],
                [49.0, 52.0],
                [-3.0, 70.0],
                [-51.0, 45.0],
                [-72.0, 2.0],
                [-49.0, -46.0],
                [0.0, -66.0],
                [50.0, -52.0],
                [76.0, 2.0],
                [55.0, 51.0],
                [-2.0, 75.0],
                [-48.0, 53.0],
                [-76.0, 3.0],
                [-48.0, -50.0],
                [4.0, -71.0],
                [55.0, -52.0],
                [79.0, -5.0],
                [51.0, 56.0],
                [-4.0, 80.0],
                [-53.0, 52.0],
                [-75.0, 0.0],
                [-59.0, -52.0],
                [2.0, -72.0],
                [50.0, -59.0],
                [77.0, 1.0],
                [59.0, 55.0],
                [-5.0, 78.0],
                [-60.0, 53.0],
                [-82.0, -3.0],
                [-59.0, -60.0],
                [3.0, -80.0],
                [54.0, -59.0],
                [88.0, -2.0],
                [55.0, 61.0],
                [-2.0, 87.0],
                [-64.0, 57.0],
                [-81.0, -3.0],
                [-60.0, -61.0],
                [-3.0, -88.0],
                [57.0, -57.0],
                [85.0, -3.0],
                [62.0, 60.0],
                [3.0, 86.0],
                [-58.0, 58.0],
                [-92.0, 4.0],
                [-66.0, -63.0],
                [-4.0, -92.0],
                [65.0, -68.0],
                [89.0, 4.0],
                [62.0, 63.0],
                [-3.0, 88.0],
                [-63.0, 66.0],
                [-89.0, 4.0],
                [-65.0, -69.0],
                [-2.0, -90.0],
                [63.0, -68.0],
                [95.0, 3.0],
                [68.0, 68.0],
                [-4.0, 99.0],
                [-65.0, 70.0],
                [-95.0, -2.0],
                [-70.0, -71.0],
                [2.0, -101.0],
                [69.0, -72.0],
                [103.0, 4.0],
                [72.0, 70.0],
                [0.0, 101.0],
                [-75.0, 73.0],
                [-97.0, 1.0],
                [-76.0, -70.0],
                [-1.0, -97.0],
                [69.0, -75.0],
            ]
        )
        basis0 = BSplineBasis(
            6, np.array([-1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 2.1, 3.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.7]), 0
        )
        basis1 = BSplineBasis(
            7,
            np.array(
                [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 2.0, 3.0, 4.4, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0]
            ),
        )
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 *= np.array([4.4, 11.4])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 4.400000
        pt2[..., 1] /= 11.400000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_2D_p5_C1_periodic(self):
        controlpoints = np.array(
            [
                [103.0, -5.0],
                [78.0, 60.0],
                [19.0, 96.0],
                [-51.0, 84.0],
                [-97.0, 36.0],
                [-99.0, -39.0],
                [-46.0, -84.0],
                [16.0, -95.0],
                [73.0, -62.0],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([-1.7, -0.9, 0.0, 0.0, 0.0, 0.8, 2.1, 3.2, 4.4, 5.3, 6.1, 7.0, 7.0, 7.0, 7.8, 9.1]), 1
        )
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 += np.array([5.0, 0.8])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 5.000000
        pt2[..., 1] -= 0.800000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_2D_p5_C1_periodic(self):
        controlpoints = np.array(
            [
                [99.0, -5.0],
                [58.0, 80.0],
                [-22.0, 97.0],
                [-86.0, 43.0],
                [-91.0, -39.0],
                [-18.0, -93.0],
                [65.0, -83.0],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([-2.0, -1.0, 0.0, 0.0, 0.0, 0.6, 2.4, 3.0, 4.0, 5.0, 5.0, 5.0, 5.6, 7.4]), 1
        )
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 *= np.array([10.2, 5.7])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 10.200000
        pt2[..., 1] /= 5.700000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_2D_p76_C1_periodic(self):
        controlpoints = np.array(
            [
                [64.0, -4.0],
                [42.0, 39.0],
                [13.0, 57.0],
                [-28.0, 47.0],
                [-59.0, 24.0],
                [-59.0, -23.0],
                [-32.0, -57.0],
                [6.0, -60.0],
                [49.0, -37.0],
                [69.0, -2.0],
                [51.0, 44.0],
                [9.0, 59.0],
                [-29.0, 53.0],
                [-58.0, 23.0],
                [-61.0, -19.0],
                [-28.0, -59.0],
                [16.0, -60.0],
                [50.0, -39.0],
                [67.0, 1.0],
                [52.0, 44.0],
                [13.0, 65.0],
                [-32.0, 64.0],
                [-63.0, 27.0],
                [-64.0, -20.0],
                [-31.0, -59.0],
                [11.0, -72.0],
                [57.0, -48.0],
                [69.0, -5.0],
                [58.0, 51.0],
                [16.0, 75.0],
                [-38.0, 66.0],
                [-66.0, 29.0],
                [-73.0, -23.0],
                [-42.0, -63.0],
                [12.0, -77.0],
                [57.0, -44.0],
                [75.0, -4.0],
                [56.0, 47.0],
                [10.0, 79.0],
                [-38.0, 63.0],
                [-73.0, 28.0],
                [-69.0, -27.0],
                [-43.0, -69.0],
                [18.0, -77.0],
                [60.0, -50.0],
                [86.0, -3.0],
                [60.0, 57.0],
                [11.0, 80.0],
                [-41.0, 67.0],
                [-73.0, 29.0],
                [-82.0, -24.0],
                [-43.0, -76.0],
                [14.0, -83.0],
                [59.0, -57.0],
                [85.0, -2.0],
                [63.0, 60.0],
                [12.0, 82.0],
                [-41.0, 76.0],
                [-84.0, 34.0],
                [-84.0, -30.0],
                [-40.0, -76.0],
                [15.0, -83.0],
                [62.0, -56.0],
                [93.0, 3.0],
                [68.0, 55.0],
                [18.0, 92.0],
                [-50.0, 79.0],
                [-86.0, 33.0],
                [-87.0, -36.0],
                [-49.0, -77.0],
                [11.0, -90.0],
                [67.0, -64.0],
                [91.0, 2.0],
                [77.0, 60.0],
                [14.0, 99.0],
                [-47.0, 80.0],
                [-88.0, 33.0],
                [-90.0, -33.0],
                [-51.0, -78.0],
                [18.0, -90.0],
                [70.0, -66.0],
                [96.0, 2.0],
                [77.0, 60.0],
                [20.0, 102.0],
                [-47.0, 87.0],
                [-96.0, 32.0],
                [-91.0, -31.0],
                [-52.0, -90.0],
                [21.0, -96.0],
                [78.0, -64.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [-2.0, -1.1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 1.6, 3.0, 3.9, 5.0, 5.0, 5.0, 5.0, 5.0, 5.8, 6.6]
            ),
            1,
        )
        basis1 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 2.0, 3.0, 4.2, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0])
        )
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 += np.array([0.6, 0.8])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 0.600000
        pt2[..., 1] -= 0.800000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_surface_2D_p55_C1_periodic(self):
        controlpoints = np.array(
            [
                [63.0, 2.0],
                [26.0, 49.0],
                [-32.0, 53.0],
                [-56.0, -3.0],
                [-31.0, -52.0],
                [28.0, -48.0],
                [68.0, -2.0],
                [32.0, 57.0],
                [-35.0, 50.0],
                [-67.0, 0.0],
                [-32.0, -59.0],
                [31.0, -60.0],
                [70.0, 1.0],
                [39.0, 56.0],
                [-34.0, 56.0],
                [-71.0, -3.0],
                [-39.0, -58.0],
                [31.0, -61.0],
                [73.0, -3.0],
                [41.0, 67.0],
                [-41.0, 62.0],
                [-71.0, 4.0],
                [-32.0, -60.0],
                [35.0, -60.0],
                [72.0, -1.0],
                [40.0, 63.0],
                [-37.0, 65.0],
                [-79.0, 0.0],
                [-40.0, -70.0],
                [39.0, -71.0],
                [82.0, 4.0],
                [45.0, 68.0],
                [-41.0, 73.0],
                [-85.0, 2.0],
                [-43.0, -72.0],
                [43.0, -68.0],
                [90.0, 1.0],
                [41.0, 78.0],
                [-43.0, 75.0],
                [-82.0, -5.0],
                [-41.0, -71.0],
                [42.0, -78.0],
                [92.0, 4.0],
                [42.0, 76.0],
                [-50.0, 82.0],
                [-93.0, 0.0],
                [-49.0, -80.0],
                [49.0, -76.0],
                [92.0, -5.0],
                [46.0, 85.0],
                [-50.0, 77.0],
                [-91.0, -2.0],
                [-45.0, -83.0],
                [45.0, -82.0],
                [99.0, 3.0],
                [53.0, 83.0],
                [-51.0, 91.0],
                [-102.0, -3.0],
                [-49.0, -86.0],
                [51.0, -82.0],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([-2.0, -1.0, 0.0, 0.0, 0.0, 0.9, 2.0, 3.0, 4.0, 4.0, 4.0, 4.9, 6.0]), 1
        )
        basis1 = BSplineBasis(
            5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.8, 2.9, 4.0, 5.3, 6.0, 6.0, 6.0, 6.0, 6.0])
        )
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 *= np.array([2.9, 4.5])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 2.900000
        pt2[..., 1] /= 4.500000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_3D_p5_rational(self):
        controlpoints = np.array(
            [
                [0.0, 1.0, 3.0, 1.4],
                [23.0, -4.0, -2.0, 0.9],
                [41.0, -3.0, -1.0, 1.2],
                [60.0, -4.0, 1.0, 1.1],
                [81.0, 4.0, 4.0, 0.6],
                [100.0, -1.0, -2.0, 1.1],
            ]
        )
        basis0 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.9, 2.0, 2.0, 2.0, 2.0, 2.0]))
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 += np.array([5.9, 6.5, 9.2])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 5.900000
        pt2[..., 1] -= 6.500000
        pt2[..., 2] -= 9.200000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_3D_p5_rational(self):
        controlpoints = np.array(
            [
                [3.0, -3.0, -1.0, 1.5],
                [13.0, -5.0, -4.0, 1.4],
                [27.0, -4.0, -1.0, 0.8],
                [44.0, -3.0, 1.0, 1.2],
                [61.0, 2.0, -1.0, 0.7],
                [71.0, 4.0, 2.0, 0.6],
                [87.0, -1.0, 2.0, 0.9],
                [96.0, -5.0, -3.0, 0.7],
            ]
        )
        basis0 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 1.7, 3.0, 4.0, 4.0, 4.0, 4.0, 4.0]))
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 *= np.array([8.4, 2.2, 5.8])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 8.400000
        pt2[..., 1] /= 2.200000
        pt2[..., 2] /= 5.800000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_curve_3D_p6_rational(self):
        controlpoints = np.array(
            [
                [-3.0, 1.0, 3.0, 0.6],
                [15.0, 4.0, -1.0, 1.4],
                [22.0, 4.0, 3.0, 1.2],
                [36.0, 4.0, -2.0, 0.9],
                [40.0, -1.0, 3.0, 1.2],
                [54.0, -2.0, -1.0, 0.9],
                [61.0, -5.0, 4.0, 1.5],
                [75.0, -1.0, -1.0, 0.6],
                [93.0, 4.0, 2.0, 0.5],
                [104.0, 0.0, -4.0, 1.4],
            ]
        )
        basis0 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 1.8, 2.6, 4.3, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0])
        )
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2.mirror([0, 0, 3])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 2] = -pt2[..., 2]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_3D_p76_rational(self):
        controlpoints = np.array(
            [
                [-4.0, 3.0, -1.0, 1.4],
                [17.0, 2.0, 4.0, 0.6],
                [27.0, -3.0, -5.0, 0.7],
                [41.0, -4.0, 2.0, 0.5],
                [49.0, 0.0, -1.0, 0.7],
                [59.0, -1.0, 3.0, 1.1],
                [70.0, 2.0, -3.0, 0.6],
                [86.0, 2.0, 3.0, 1.4],
                [102.0, -3.0, 0.0, 0.6],
                [2.0, 11.0, -1.0, 0.9],
                [11.0, 16.0, 0.0, 1.3],
                [29.0, 15.0, 2.0, 0.8],
                [40.0, 15.0, -1.0, 1.0],
                [53.0, 19.0, -4.0, 1.2],
                [62.0, 13.0, 4.0, 0.5],
                [70.0, 18.0, -2.0, 0.6],
                [82.0, 15.0, -5.0, 0.8],
                [100.0, 10.0, 3.0, 1.2],
                [3.0, 32.0, -4.0, 1.1],
                [13.0, 26.0, 0.0, 1.1],
                [24.0, 32.0, 1.0, 1.4],
                [34.0, 32.0, -5.0, 0.9],
                [54.0, 25.0, 0.0, 0.9],
                [65.0, 32.0, -2.0, 1.2],
                [74.0, 24.0, -4.0, 0.6],
                [90.0, 32.0, 0.0, 0.7],
                [95.0, 29.0, -5.0, 0.6],
                [0.0, 39.0, 0.0, 1.3],
                [14.0, 46.0, -3.0, 1.2],
                [23.0, 46.0, 4.0, 0.9],
                [40.0, 41.0, 0.0, 1.5],
                [46.0, 44.0, -1.0, 1.0],
                [67.0, 43.0, 1.0, 1.2],
                [74.0, 42.0, 0.0, 0.8],
                [83.0, 47.0, 4.0, 0.8],
                [98.0, 46.0, -3.0, 0.9],
                [-2.0, 57.0, -2.0, 1.1],
                [16.0, 60.0, -3.0, 0.7],
                [25.0, 53.0, 2.0, 1.5],
                [41.0, 52.0, -5.0, 0.6],
                [54.0, 60.0, 0.0, 0.6],
                [59.0, 54.0, 4.0, 1.3],
                [77.0, 55.0, -5.0, 1.0],
                [91.0, 60.0, 1.0, 0.5],
                [100.0, 55.0, -3.0, 0.5],
                [2.0, 67.0, -3.0, 1.4],
                [16.0, 74.0, 1.0, 1.0],
                [21.0, 69.0, -4.0, 0.9],
                [37.0, 74.0, 2.0, 1.2],
                [52.0, 67.0, -5.0, 1.0],
                [66.0, 72.0, -5.0, 1.2],
                [78.0, 73.0, -5.0, 0.9],
                [86.0, 67.0, -1.0, 1.1],
                [97.0, 73.0, -3.0, 0.9],
                [1.0, 86.0, 0.0, 0.8],
                [10.0, 85.0, -3.0, 1.0],
                [22.0, 88.0, 4.0, 1.3],
                [41.0, 83.0, 0.0, 1.1],
                [52.0, 88.0, 2.0, 0.9],
                [58.0, 89.0, 0.0, 1.3],
                [73.0, 89.0, 0.0, 1.3],
                [82.0, 89.0, -5.0, 1.0],
                [103.0, 81.0, 3.0, 1.0],
                [-3.0, 103.0, 1.0, 0.6],
                [12.0, 100.0, -4.0, 0.5],
                [26.0, 99.0, 3.0, 1.1],
                [41.0, 103.0, 2.0, 1.1],
                [50.0, 102.0, -5.0, 1.0],
                [62.0, 97.0, -5.0, 0.9],
                [78.0, 103.0, -4.0, 1.0],
                [89.0, 103.0, -4.0, 0.8],
                [99.0, 97.0, -3.0, 1.0],
            ]
        )
        basis0 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 2.3, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0])
        )
        basis1 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.3, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0])
        )
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 += np.array([9.8, 0.0, 3.2])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 9.800000
        pt2[..., 1] -= 0.000000
        pt2[..., 2] -= 3.200000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_surface_3D_p76_rational(self):
        controlpoints = np.array(
            [
                [-4.0, -4.0, 1.0, 0.9],
                [11.0, 0.0, -2.0, 0.6],
                [15.0, -5.0, -1.0, 1.4],
                [33.0, 4.0, 0.0, 0.8],
                [40.0, -2.0, -3.0, 0.7],
                [54.0, 1.0, 3.0, 1.1],
                [64.0, 0.0, -5.0, 1.2],
                [66.0, 0.0, 0.0, 1.5],
                [80.0, -3.0, 1.0, 1.0],
                [93.0, -2.0, 3.0, 0.8],
                [96.0, 3.0, 3.0, 1.4],
                [2.0, 7.0, -4.0, 0.8],
                [13.0, 8.0, -5.0, 0.9],
                [22.0, 12.0, 2.0, 1.0],
                [32.0, 9.0, -2.0, 0.6],
                [38.0, 6.0, 3.0, 1.1],
                [49.0, 11.0, -3.0, 0.7],
                [55.0, 5.0, 4.0, 1.2],
                [71.0, 9.0, 0.0, 1.3],
                [84.0, 13.0, -3.0, 1.1],
                [93.0, 7.0, -3.0, 1.1],
                [97.0, 10.0, 3.0, 1.0],
                [4.0, 21.0, -5.0, 1.4],
                [6.0, 24.0, 3.0, 0.5],
                [22.0, 20.0, 4.0, 0.6],
                [29.0, 22.0, -2.0, 1.1],
                [38.0, 20.0, 4.0, 0.9],
                [54.0, 15.0, 3.0, 0.6],
                [57.0, 16.0, 1.0, 1.1],
                [65.0, 20.0, 1.0, 1.3],
                [77.0, 17.0, 3.0, 1.3],
                [85.0, 20.0, -2.0, 1.1],
                [102.0, 16.0, -4.0, 1.5],
                [-2.0, 29.0, 3.0, 0.8],
                [8.0, 33.0, 3.0, 0.6],
                [16.0, 34.0, -5.0, 0.8],
                [32.0, 32.0, -5.0, 0.8],
                [39.0, 32.0, 4.0, 0.9],
                [49.0, 32.0, -3.0, 1.2],
                [61.0, 32.0, -1.0, 1.2],
                [67.0, 25.0, 1.0, 1.2],
                [81.0, 32.0, -5.0, 0.6],
                [93.0, 32.0, -2.0, 0.5],
                [98.0, 29.0, -3.0, 0.8],
                [3.0, 40.0, 3.0, 1.2],
                [8.0, 36.0, 1.0, 0.7],
                [16.0, 42.0, -5.0, 0.9],
                [28.0, 40.0, -5.0, 1.2],
                [42.0, 42.0, 3.0, 0.8],
                [51.0, 40.0, 3.0, 0.7],
                [57.0, 36.0, 4.0, 1.4],
                [72.0, 43.0, 4.0, 1.5],
                [82.0, 42.0, 1.0, 0.7],
                [92.0, 39.0, -4.0, 0.8],
                [104.0, 35.0, -5.0, 0.5],
                [-2.0, 51.0, -2.0, 0.8],
                [13.0, 53.0, -5.0, 0.8],
                [24.0, 46.0, 3.0, 1.1],
                [32.0, 48.0, 1.0, 1.0],
                [37.0, 52.0, 4.0, 0.7],
                [51.0, 54.0, 3.0, 0.7],
                [61.0, 51.0, -3.0, 1.0],
                [74.0, 47.0, 4.0, 1.2],
                [75.0, 45.0, -2.0, 1.1],
                [90.0, 54.0, 3.0, 1.0],
                [101.0, 47.0, 4.0, 1.3],
                [1.0, 62.0, -2.0, 0.6],
                [14.0, 57.0, -5.0, 1.1],
                [24.0, 55.0, -1.0, 1.0],
                [29.0, 55.0, -3.0, 1.2],
                [38.0, 55.0, -1.0, 0.6],
                [47.0, 55.0, -1.0, 1.1],
                [58.0, 55.0, 2.0, 0.7],
                [72.0, 56.0, 3.0, 1.1],
                [76.0, 64.0, -1.0, 0.6],
                [92.0, 55.0, 0.0, 1.4],
                [101.0, 62.0, -2.0, 1.2],
                [2.0, 70.0, -5.0, 0.7],
                [6.0, 71.0, 0.0, 0.8],
                [18.0, 72.0, 4.0, 1.3],
                [30.0, 65.0, -2.0, 0.7],
                [41.0, 67.0, -4.0, 1.1],
                [47.0, 73.0, -3.0, 1.0],
                [63.0, 66.0, -3.0, 1.4],
                [69.0, 68.0, 0.0, 1.0],
                [78.0, 67.0, 4.0, 0.8],
                [85.0, 70.0, 4.0, 1.4],
                [102.0, 70.0, 1.0, 1.1],
                [-1.0, 75.0, -5.0, 1.3],
                [7.0, 81.0, 2.0, 1.3],
                [19.0, 84.0, 2.0, 1.1],
                [27.0, 80.0, 1.0, 1.3],
                [39.0, 82.0, 4.0, 1.2],
                [54.0, 84.0, -2.0, 0.9],
                [60.0, 76.0, -4.0, 1.4],
                [67.0, 79.0, -4.0, 1.4],
                [83.0, 81.0, -5.0, 1.0],
                [90.0, 79.0, -4.0, 1.0],
                [98.0, 79.0, 3.0, 0.9],
                [0.0, 89.0, -5.0, 0.8],
                [5.0, 85.0, -4.0, 1.0],
                [23.0, 90.0, 0.0, 0.6],
                [33.0, 87.0, -5.0, 0.9],
                [36.0, 87.0, 2.0, 1.5],
                [51.0, 85.0, -3.0, 0.8],
                [56.0, 90.0, 2.0, 0.7],
                [70.0, 90.0, 0.0, 1.1],
                [79.0, 93.0, -5.0, 0.7],
                [88.0, 88.0, -3.0, 0.6],
                [97.0, 85.0, -1.0, 1.4],
                [-5.0, 101.0, 4.0, 1.5],
                [13.0, 100.0, 3.0, 0.6],
                [17.0, 103.0, -3.0, 1.3],
                [34.0, 95.0, 0.0, 1.3],
                [40.0, 99.0, 3.0, 0.7],
                [49.0, 104.0, 0.0, 1.2],
                [58.0, 103.0, 2.0, 1.1],
                [74.0, 95.0, -5.0, 0.6],
                [77.0, 95.0, -2.0, 0.5],
                [90.0, 103.0, 0.0, 0.6],
                [97.0, 95.0, 3.0, 1.3],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1, 1.6, 2.7, 3.9, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0]
            ),
        )
        basis1 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.2, 2.2, 2.9, 4.3, 5.2, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0])
        )
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 *= np.array([6.7, 4.9, 5.8])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 6.700000
        pt2[..., 1] /= 4.900000
        pt2[..., 2] /= 5.800000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_surface_3D_p76_rational(self):
        controlpoints = np.array(
            [
                [-2.0, -1.0, 0.0, 0.6],
                [6.0, -1.0, 2.0, 0.9],
                [27.0, -3.0, 2.0, 0.8],
                [34.0, -4.0, 0.0, 0.9],
                [43.0, 4.0, -4.0, 1.1],
                [53.0, 1.0, -2.0, 0.8],
                [65.0, 3.0, -1.0, 1.0],
                [79.0, -1.0, 0.0, 0.5],
                [89.0, 4.0, -5.0, 1.0],
                [102.0, -2.0, -4.0, 0.7],
                [-4.0, 15.0, -4.0, 0.8],
                [9.0, 12.0, -3.0, 1.3],
                [18.0, 13.0, 3.0, 1.4],
                [33.0, 12.0, 0.0, 1.4],
                [44.0, 9.0, 3.0, 1.2],
                [55.0, 10.0, -4.0, 1.2],
                [71.0, 12.0, 2.0, 0.6],
                [82.0, 9.0, 3.0, 1.2],
                [86.0, 15.0, 3.0, 1.1],
                [104.0, 12.0, 0.0, 1.1],
                [-3.0, 27.0, -4.0, 1.1],
                [6.0, 21.0, -5.0, 0.6],
                [22.0, 24.0, 0.0, 1.4],
                [34.0, 25.0, 4.0, 0.9],
                [43.0, 22.0, 4.0, 1.3],
                [58.0, 26.0, 1.0, 0.9],
                [68.0, 24.0, -3.0, 0.6],
                [80.0, 25.0, -3.0, 0.7],
                [90.0, 28.0, 3.0, 1.2],
                [97.0, 28.0, 0.0, 0.6],
                [-5.0, 37.0, -5.0, 1.4],
                [7.0, 36.0, -5.0, 1.1],
                [22.0, 34.0, -2.0, 1.0],
                [34.0, 41.0, -4.0, 1.4],
                [47.0, 32.0, -1.0, 1.0],
                [58.0, 33.0, -4.0, 1.2],
                [67.0, 38.0, -4.0, 0.7],
                [74.0, 40.0, 3.0, 1.4],
                [86.0, 34.0, -1.0, 1.1],
                [99.0, 42.0, -5.0, 0.7],
                [-1.0, 52.0, 2.0, 0.8],
                [13.0, 47.0, 0.0, 1.2],
                [20.0, 47.0, -2.0, 0.8],
                [29.0, 50.0, -4.0, 0.7],
                [42.0, 50.0, 3.0, 1.3],
                [56.0, 50.0, 2.0, 0.5],
                [68.0, 46.0, 4.0, 1.0],
                [81.0, 47.0, 1.0, 0.5],
                [90.0, 51.0, -5.0, 1.3],
                [95.0, 45.0, 1.0, 0.6],
                [-1.0, 65.0, 1.0, 0.8],
                [9.0, 62.0, -2.0, 0.6],
                [26.0, 60.0, -3.0, 1.1],
                [28.0, 66.0, 3.0, 0.6],
                [42.0, 62.0, 3.0, 1.3],
                [52.0, 57.0, 1.0, 1.1],
                [63.0, 67.0, -3.0, 1.1],
                [80.0, 65.0, -3.0, 0.9],
                [86.0, 63.0, 1.0, 0.8],
                [95.0, 63.0, -4.0, 1.5],
                [-4.0, 70.0, 1.0, 1.4],
                [9.0, 74.0, -1.0, 1.2],
                [25.0, 70.0, 0.0, 1.4],
                [31.0, 79.0, 3.0, 0.9],
                [49.0, 79.0, 0.0, 1.3],
                [51.0, 71.0, 0.0, 1.5],
                [66.0, 70.0, 4.0, 0.7],
                [74.0, 79.0, -1.0, 1.5],
                [93.0, 77.0, 3.0, 1.4],
                [96.0, 70.0, -4.0, 1.1],
                [3.0, 84.0, -4.0, 1.3],
                [7.0, 84.0, 2.0, 0.9],
                [22.0, 82.0, 4.0, 1.4],
                [36.0, 90.0, -3.0, 1.1],
                [41.0, 86.0, -5.0, 0.7],
                [59.0, 91.0, 1.0, 0.6],
                [70.0, 83.0, -4.0, 0.9],
                [75.0, 89.0, -3.0, 0.6],
                [85.0, 85.0, 1.0, 0.7],
                [101.0, 83.0, 4.0, 0.6],
                [-3.0, 97.0, -3.0, 1.0],
                [11.0, 101.0, -4.0, 0.7],
                [24.0, 101.0, 4.0, 0.5],
                [29.0, 102.0, 3.0, 0.8],
                [41.0, 97.0, -2.0, 1.3],
                [57.0, 99.0, 1.0, 0.6],
                [71.0, 95.0, 4.0, 0.7],
                [82.0, 100.0, -4.0, 0.9],
                [93.0, 103.0, 0.0, 0.7],
                [101.0, 99.0, 4.0, 0.9],
            ]
        )
        basis0 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.2, 2.2, 2.9, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        basis1 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.7, 3.3, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2.mirror([0, 0, 2])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 2] = -pt2[..., 2]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_volume_3D_p676_rational(self):
        controlpoints = np.array(
            [
                [2.0, -1.0, -4.0, 0.9],
                [11.0, -4.0, -1.0, 1.5],
                [28.0, 0.0, -5.0, 0.9],
                [39.0, -2.0, -1.0, 1.4],
                [54.0, -5.0, 3.0, 0.9],
                [59.0, -1.0, 3.0, 0.6],
                [78.0, 3.0, -1.0, 0.7],
                [89.0, -2.0, 0.0, 1.2],
                [104.0, 0.0, 4.0, 0.9],
                [1.0, 16.0, 0.0, 1.1],
                [11.0, 13.0, 2.0, 1.1],
                [26.0, 9.0, -2.0, 1.0],
                [40.0, 8.0, -2.0, 1.1],
                [46.0, 16.0, -1.0, 0.9],
                [66.0, 11.0, 1.0, 1.0],
                [73.0, 12.0, -1.0, 1.1],
                [87.0, 10.0, -4.0, 0.7],
                [102.0, 13.0, 1.0, 1.3],
                [-2.0, 23.0, -5.0, 1.3],
                [14.0, 22.0, -3.0, 1.4],
                [24.0, 21.0, 3.0, 1.3],
                [39.0, 26.0, 1.0, 1.3],
                [45.0, 28.0, -4.0, 1.3],
                [63.0, 27.0, -1.0, 1.2],
                [71.0, 27.0, -2.0, 0.7],
                [91.0, 26.0, 4.0, 1.5],
                [100.0, 21.0, 0.0, 0.7],
                [0.0, 37.0, -1.0, 0.9],
                [11.0, 38.0, -5.0, 1.2],
                [21.0, 39.0, 4.0, 1.4],
                [39.0, 37.0, 1.0, 0.7],
                [53.0, 35.0, -2.0, 0.9],
                [65.0, 38.0, -4.0, 1.1],
                [73.0, 41.0, 1.0, 0.7],
                [90.0, 40.0, 1.0, 0.7],
                [96.0, 37.0, -3.0, 1.0],
                [-3.0, 45.0, -4.0, 1.4],
                [10.0, 45.0, -3.0, 1.4],
                [24.0, 49.0, -2.0, 0.6],
                [35.0, 45.0, -3.0, 1.4],
                [46.0, 54.0, -3.0, 1.2],
                [61.0, 53.0, -1.0, 1.0],
                [73.0, 46.0, -1.0, 1.0],
                [88.0, 48.0, -4.0, 0.6],
                [95.0, 51.0, 3.0, 1.4],
                [-4.0, 65.0, -5.0, 0.8],
                [15.0, 61.0, 2.0, 1.0],
                [26.0, 61.0, -5.0, 0.9],
                [39.0, 62.0, 3.0, 1.3],
                [46.0, 63.0, -2.0, 0.9],
                [60.0, 65.0, -4.0, 1.2],
                [73.0, 61.0, 3.0, 0.9],
                [83.0, 63.0, 2.0, 1.0],
                [102.0, 60.0, 1.0, 0.9],
                [-3.0, 70.0, -3.0, 0.9],
                [9.0, 78.0, 3.0, 1.5],
                [28.0, 75.0, -4.0, 0.6],
                [34.0, 73.0, 4.0, 0.6],
                [45.0, 74.0, 2.0, 1.1],
                [65.0, 73.0, 2.0, 0.5],
                [71.0, 71.0, 2.0, 1.2],
                [90.0, 70.0, 2.0, 0.6],
                [101.0, 78.0, -5.0, 0.9],
                [-4.0, 83.0, -4.0, 1.4],
                [16.0, 86.0, 0.0, 1.1],
                [24.0, 92.0, 3.0, 0.7],
                [37.0, 87.0, -5.0, 1.2],
                [45.0, 92.0, 0.0, 1.2],
                [59.0, 92.0, 3.0, 1.4],
                [79.0, 90.0, -3.0, 1.0],
                [89.0, 86.0, -2.0, 0.7],
                [98.0, 83.0, 0.0, 0.8],
                [-5.0, 101.0, 1.0, 1.3],
                [10.0, 104.0, 4.0, 1.2],
                [23.0, 104.0, -4.0, 1.4],
                [36.0, 98.0, 0.0, 0.9],
                [54.0, 98.0, -3.0, 0.8],
                [58.0, 96.0, 0.0, 1.0],
                [74.0, 104.0, 1.0, 0.6],
                [87.0, 99.0, -4.0, 1.4],
                [102.0, 104.0, 4.0, 0.5],
                [1.0, 3.0, 6.0, 0.6],
                [17.0, -5.0, 7.0, 1.0],
                [23.0, 0.0, 5.0, 0.6],
                [41.0, 3.0, 9.0, 1.4],
                [49.0, 1.0, 6.0, 1.2],
                [59.0, 2.0, 9.0, 1.0],
                [73.0, -1.0, 9.0, 1.2],
                [89.0, 2.0, 10.0, 0.9],
                [99.0, -1.0, 10.0, 1.1],
                [-3.0, 8.0, 10.0, 1.3],
                [17.0, 8.0, 5.0, 0.7],
                [25.0, 13.0, 6.0, 0.6],
                [36.0, 10.0, 14.0, 1.4],
                [45.0, 17.0, 6.0, 1.5],
                [66.0, 8.0, 13.0, 0.7],
                [73.0, 8.0, 8.0, 0.9],
                [90.0, 12.0, 6.0, 1.4],
                [95.0, 12.0, 11.0, 1.5],
                [3.0, 26.0, 13.0, 1.5],
                [15.0, 26.0, 11.0, 0.8],
                [23.0, 27.0, 14.0, 1.3],
                [41.0, 20.0, 6.0, 1.4],
                [54.0, 27.0, 9.0, 1.2],
                [63.0, 26.0, 13.0, 1.4],
                [76.0, 26.0, 14.0, 0.7],
                [83.0, 25.0, 11.0, 1.2],
                [95.0, 20.0, 13.0, 0.8],
                [-3.0, 39.0, 5.0, 1.5],
                [12.0, 41.0, 14.0, 0.6],
                [22.0, 35.0, 9.0, 0.9],
                [33.0, 33.0, 11.0, 0.9],
                [49.0, 38.0, 11.0, 1.3],
                [63.0, 37.0, 6.0, 0.9],
                [71.0, 37.0, 12.0, 1.2],
                [89.0, 32.0, 13.0, 0.9],
                [104.0, 34.0, 13.0, 1.4],
                [-3.0, 48.0, 7.0, 1.3],
                [7.0, 46.0, 6.0, 1.4],
                [24.0, 48.0, 9.0, 0.7],
                [37.0, 50.0, 6.0, 1.4],
                [51.0, 49.0, 11.0, 0.5],
                [62.0, 48.0, 13.0, 1.4],
                [78.0, 45.0, 10.0, 0.5],
                [92.0, 47.0, 5.0, 0.6],
                [103.0, 46.0, 10.0, 1.3],
                [-1.0, 61.0, 12.0, 0.6],
                [14.0, 65.0, 5.0, 0.6],
                [20.0, 65.0, 5.0, 0.9],
                [41.0, 61.0, 9.0, 1.3],
                [53.0, 62.0, 11.0, 0.8],
                [61.0, 64.0, 10.0, 0.8],
                [72.0, 59.0, 10.0, 0.7],
                [88.0, 62.0, 6.0, 1.1],
                [101.0, 59.0, 14.0, 1.3],
                [-3.0, 71.0, 6.0, 1.5],
                [15.0, 72.0, 7.0, 1.5],
                [26.0, 74.0, 11.0, 0.8],
                [38.0, 77.0, 11.0, 1.2],
                [54.0, 74.0, 12.0, 0.7],
                [57.0, 78.0, 5.0, 0.8],
                [70.0, 71.0, 10.0, 0.7],
                [88.0, 79.0, 9.0, 1.3],
                [95.0, 74.0, 14.0, 1.3],
                [-1.0, 91.0, 12.0, 1.1],
                [10.0, 91.0, 9.0, 0.8],
                [23.0, 91.0, 11.0, 0.7],
                [37.0, 88.0, 5.0, 0.8],
                [51.0, 90.0, 6.0, 0.9],
                [58.0, 86.0, 8.0, 0.8],
                [76.0, 89.0, 13.0, 1.0],
                [89.0, 85.0, 6.0, 1.1],
                [96.0, 87.0, 12.0, 0.8],
                [0.0, 97.0, 8.0, 0.6],
                [14.0, 104.0, 9.0, 1.0],
                [21.0, 97.0, 9.0, 0.6],
                [33.0, 98.0, 11.0, 0.8],
                [49.0, 97.0, 7.0, 1.1],
                [65.0, 99.0, 12.0, 1.1],
                [72.0, 95.0, 11.0, 0.8],
                [85.0, 97.0, 11.0, 0.8],
                [101.0, 98.0, 8.0, 0.6],
                [2.0, -2.0, 21.0, 1.3],
                [14.0, 1.0, 15.0, 0.9],
                [20.0, 2.0, 19.0, 1.4],
                [38.0, -1.0, 24.0, 1.5],
                [46.0, -5.0, 21.0, 0.9],
                [64.0, -2.0, 15.0, 1.3],
                [71.0, -1.0, 18.0, 1.4],
                [89.0, 3.0, 20.0, 1.3],
                [96.0, -1.0, 23.0, 1.2],
                [3.0, 16.0, 18.0, 1.5],
                [9.0, 12.0, 18.0, 1.3],
                [22.0, 15.0, 19.0, 1.1],
                [32.0, 15.0, 17.0, 1.4],
                [51.0, 14.0, 15.0, 0.9],
                [64.0, 8.0, 18.0, 0.9],
                [73.0, 7.0, 22.0, 0.5],
                [84.0, 8.0, 21.0, 1.4],
                [96.0, 15.0, 20.0, 1.0],
                [2.0, 27.0, 19.0, 1.2],
                [16.0, 20.0, 16.0, 0.9],
                [25.0, 28.0, 21.0, 1.2],
                [40.0, 22.0, 17.0, 0.6],
                [47.0, 27.0, 22.0, 0.5],
                [63.0, 28.0, 23.0, 1.0],
                [77.0, 20.0, 17.0, 1.1],
                [89.0, 20.0, 23.0, 1.0],
                [98.0, 29.0, 19.0, 1.3],
                [2.0, 37.0, 22.0, 0.5],
                [13.0, 40.0, 16.0, 0.7],
                [23.0, 38.0, 15.0, 1.5],
                [33.0, 34.0, 21.0, 1.4],
                [47.0, 38.0, 19.0, 1.2],
                [67.0, 42.0, 19.0, 0.9],
                [78.0, 33.0, 22.0, 0.8],
                [84.0, 40.0, 18.0, 1.4],
                [97.0, 38.0, 20.0, 0.9],
                [-3.0, 53.0, 24.0, 0.6],
                [15.0, 50.0, 20.0, 1.2],
                [21.0, 52.0, 17.0, 0.9],
                [34.0, 49.0, 20.0, 1.1],
                [46.0, 52.0, 16.0, 1.1],
                [59.0, 47.0, 22.0, 1.2],
                [73.0, 53.0, 20.0, 0.7],
                [92.0, 53.0, 15.0, 1.4],
                [99.0, 50.0, 20.0, 1.1],
                [3.0, 57.0, 15.0, 1.1],
                [11.0, 61.0, 17.0, 0.6],
                [20.0, 62.0, 19.0, 1.1],
                [33.0, 63.0, 20.0, 1.2],
                [49.0, 59.0, 15.0, 0.9],
                [65.0, 57.0, 15.0, 0.9],
                [74.0, 65.0, 15.0, 1.3],
                [86.0, 67.0, 23.0, 0.5],
                [97.0, 60.0, 20.0, 0.9],
                [1.0, 79.0, 19.0, 1.3],
                [16.0, 76.0, 23.0, 1.1],
                [28.0, 70.0, 22.0, 1.0],
                [40.0, 71.0, 20.0, 0.5],
                [50.0, 79.0, 23.0, 1.5],
                [60.0, 79.0, 22.0, 1.2],
                [74.0, 75.0, 15.0, 0.8],
                [89.0, 73.0, 15.0, 1.3],
                [104.0, 79.0, 16.0, 0.8],
                [2.0, 83.0, 15.0, 0.8],
                [9.0, 91.0, 21.0, 0.9],
                [27.0, 91.0, 24.0, 1.3],
                [40.0, 83.0, 21.0, 1.1],
                [45.0, 88.0, 22.0, 1.4],
                [65.0, 83.0, 20.0, 1.4],
                [78.0, 87.0, 17.0, 1.0],
                [82.0, 84.0, 20.0, 1.0],
                [100.0, 90.0, 21.0, 1.2],
                [-1.0, 98.0, 15.0, 0.9],
                [10.0, 100.0, 17.0, 1.5],
                [25.0, 104.0, 24.0, 0.8],
                [38.0, 104.0, 15.0, 1.0],
                [53.0, 100.0, 24.0, 1.4],
                [62.0, 99.0, 21.0, 1.4],
                [71.0, 103.0, 23.0, 1.3],
                [83.0, 104.0, 15.0, 1.1],
                [97.0, 103.0, 24.0, 0.6],
                [-1.0, -5.0, 32.0, 0.7],
                [7.0, -5.0, 34.0, 1.1],
                [26.0, 2.0, 34.0, 0.8],
                [34.0, 1.0, 32.0, 0.8],
                [45.0, -3.0, 30.0, 1.4],
                [65.0, -5.0, 25.0, 0.5],
                [75.0, -2.0, 33.0, 1.3],
                [88.0, -1.0, 26.0, 0.7],
                [100.0, 0.0, 33.0, 0.9],
                [-3.0, 17.0, 30.0, 1.5],
                [9.0, 17.0, 31.0, 1.3],
                [24.0, 10.0, 31.0, 0.8],
                [42.0, 10.0, 30.0, 1.1],
                [53.0, 15.0, 26.0, 0.8],
                [58.0, 16.0, 28.0, 1.0],
                [73.0, 17.0, 30.0, 1.2],
                [82.0, 17.0, 29.0, 0.9],
                [103.0, 16.0, 33.0, 0.9],
                [-4.0, 28.0, 25.0, 1.1],
                [16.0, 29.0, 34.0, 1.2],
                [26.0, 23.0, 25.0, 0.8],
                [39.0, 27.0, 33.0, 1.2],
                [49.0, 20.0, 27.0, 0.9],
                [64.0, 25.0, 25.0, 1.1],
                [75.0, 29.0, 33.0, 1.0],
                [85.0, 25.0, 29.0, 0.5],
                [99.0, 28.0, 25.0, 1.5],
                [-5.0, 35.0, 31.0, 1.4],
                [9.0, 35.0, 29.0, 0.6],
                [27.0, 34.0, 32.0, 0.5],
                [40.0, 41.0, 25.0, 0.9],
                [47.0, 34.0, 31.0, 0.7],
                [60.0, 34.0, 25.0, 0.7],
                [78.0, 32.0, 25.0, 0.8],
                [83.0, 35.0, 29.0, 0.8],
                [103.0, 36.0, 29.0, 1.1],
                [3.0, 53.0, 33.0, 0.7],
                [11.0, 45.0, 34.0, 0.9],
                [20.0, 50.0, 29.0, 1.1],
                [40.0, 52.0, 28.0, 1.1],
                [45.0, 47.0, 25.0, 0.5],
                [60.0, 52.0, 34.0, 0.6],
                [76.0, 45.0, 34.0, 1.1],
                [82.0, 46.0, 31.0, 1.0],
                [99.0, 47.0, 28.0, 0.6],
                [4.0, 63.0, 27.0, 1.2],
                [14.0, 58.0, 29.0, 0.6],
                [20.0, 59.0, 25.0, 1.2],
                [35.0, 60.0, 31.0, 1.4],
                [51.0, 67.0, 25.0, 0.9],
                [65.0, 67.0, 27.0, 1.1],
                [78.0, 60.0, 28.0, 0.6],
                [86.0, 58.0, 32.0, 0.9],
                [102.0, 60.0, 32.0, 1.2],
                [-3.0, 76.0, 32.0, 1.2],
                [15.0, 71.0, 33.0, 0.7],
                [21.0, 79.0, 30.0, 0.6],
                [40.0, 73.0, 33.0, 1.1],
                [46.0, 74.0, 29.0, 0.7],
                [64.0, 77.0, 25.0, 1.0],
                [79.0, 77.0, 26.0, 1.4],
                [90.0, 78.0, 26.0, 1.2],
                [99.0, 73.0, 26.0, 0.5],
                [4.0, 88.0, 25.0, 0.6],
                [14.0, 83.0, 29.0, 0.7],
                [25.0, 84.0, 28.0, 1.5],
                [38.0, 87.0, 31.0, 0.6],
                [46.0, 83.0, 25.0, 1.0],
                [59.0, 90.0, 33.0, 1.2],
                [77.0, 90.0, 32.0, 1.2],
                [89.0, 87.0, 28.0, 1.2],
                [103.0, 86.0, 29.0, 1.5],
                [-5.0, 96.0, 31.0, 1.1],
                [15.0, 103.0, 28.0, 0.9],
                [27.0, 96.0, 32.0, 1.0],
                [34.0, 99.0, 30.0, 1.0],
                [54.0, 100.0, 26.0, 1.4],
                [61.0, 103.0, 33.0, 1.3],
                [78.0, 95.0, 34.0, 0.8],
                [89.0, 102.0, 25.0, 1.1],
                [103.0, 98.0, 28.0, 1.0],
                [-2.0, -2.0, 40.0, 0.8],
                [8.0, 1.0, 35.0, 1.2],
                [24.0, 2.0, 44.0, 0.9],
                [37.0, -2.0, 40.0, 1.1],
                [45.0, 2.0, 43.0, 1.1],
                [60.0, -3.0, 43.0, 0.6],
                [72.0, 1.0, 37.0, 1.4],
                [84.0, 3.0, 35.0, 1.4],
                [104.0, 3.0, 37.0, 1.4],
                [-1.0, 15.0, 36.0, 1.2],
                [7.0, 8.0, 42.0, 0.9],
                [21.0, 10.0, 36.0, 0.9],
                [36.0, 9.0, 36.0, 1.1],
                [46.0, 17.0, 35.0, 0.9],
                [61.0, 13.0, 35.0, 1.4],
                [71.0, 8.0, 36.0, 1.5],
                [87.0, 15.0, 37.0, 0.6],
                [97.0, 16.0, 37.0, 1.3],
                [-1.0, 20.0, 41.0, 0.9],
                [13.0, 22.0, 39.0, 0.8],
                [27.0, 25.0, 43.0, 1.2],
                [37.0, 29.0, 43.0, 1.4],
                [52.0, 24.0, 42.0, 1.4],
                [60.0, 27.0, 36.0, 1.0],
                [75.0, 21.0, 41.0, 1.3],
                [87.0, 25.0, 36.0, 0.9],
                [100.0, 21.0, 35.0, 1.3],
                [-2.0, 38.0, 39.0, 1.4],
                [10.0, 38.0, 37.0, 0.9],
                [21.0, 38.0, 39.0, 1.0],
                [40.0, 35.0, 36.0, 0.7],
                [46.0, 37.0, 44.0, 1.4],
                [58.0, 37.0, 42.0, 1.4],
                [79.0, 38.0, 36.0, 0.7],
                [91.0, 36.0, 43.0, 0.8],
                [103.0, 36.0, 37.0, 0.5],
                [-1.0, 48.0, 35.0, 0.7],
                [10.0, 53.0, 36.0, 1.1],
                [27.0, 49.0, 41.0, 0.9],
                [34.0, 52.0, 35.0, 1.4],
                [46.0, 51.0, 39.0, 1.3],
                [64.0, 50.0, 44.0, 1.1],
                [77.0, 48.0, 41.0, 0.7],
                [86.0, 51.0, 43.0, 1.0],
                [98.0, 45.0, 38.0, 1.4],
                [-4.0, 65.0, 42.0, 0.8],
                [8.0, 60.0, 39.0, 1.2],
                [20.0, 63.0, 35.0, 0.5],
                [37.0, 67.0, 35.0, 1.0],
                [54.0, 66.0, 39.0, 1.1],
                [62.0, 67.0, 41.0, 0.7],
                [70.0, 61.0, 37.0, 1.3],
                [91.0, 58.0, 36.0, 1.4],
                [96.0, 61.0, 38.0, 0.9],
                [-1.0, 79.0, 35.0, 1.2],
                [13.0, 73.0, 40.0, 1.2],
                [21.0, 73.0, 38.0, 1.3],
                [38.0, 74.0, 38.0, 0.9],
                [48.0, 74.0, 36.0, 1.0],
                [62.0, 78.0, 35.0, 1.5],
                [70.0, 79.0, 35.0, 1.3],
                [82.0, 76.0, 40.0, 1.5],
                [95.0, 73.0, 42.0, 1.0],
                [2.0, 83.0, 38.0, 1.4],
                [10.0, 92.0, 41.0, 0.6],
                [21.0, 84.0, 40.0, 0.8],
                [34.0, 84.0, 40.0, 1.5],
                [46.0, 88.0, 41.0, 1.4],
                [66.0, 90.0, 35.0, 0.7],
                [79.0, 88.0, 36.0, 1.0],
                [87.0, 84.0, 36.0, 1.2],
                [96.0, 84.0, 35.0, 0.9],
                [0.0, 95.0, 42.0, 1.5],
                [16.0, 103.0, 36.0, 0.9],
                [28.0, 101.0, 38.0, 1.4],
                [39.0, 101.0, 41.0, 1.4],
                [48.0, 102.0, 42.0, 1.3],
                [67.0, 103.0, 42.0, 0.9],
                [72.0, 102.0, 35.0, 0.6],
                [83.0, 96.0, 39.0, 0.9],
                [100.0, 101.0, 39.0, 1.1],
                [-1.0, 1.0, 50.0, 0.6],
                [16.0, -1.0, 50.0, 0.9],
                [28.0, 2.0, 47.0, 1.5],
                [34.0, 1.0, 48.0, 1.3],
                [53.0, 1.0, 50.0, 1.4],
                [57.0, -4.0, 51.0, 1.2],
                [77.0, 3.0, 48.0, 0.7],
                [87.0, -1.0, 47.0, 0.9],
                [96.0, -4.0, 51.0, 0.9],
                [4.0, 13.0, 45.0, 0.6],
                [13.0, 8.0, 51.0, 1.4],
                [25.0, 13.0, 53.0, 0.8],
                [39.0, 15.0, 48.0, 1.5],
                [51.0, 16.0, 50.0, 0.9],
                [63.0, 14.0, 52.0, 1.0],
                [78.0, 8.0, 50.0, 0.8],
                [85.0, 17.0, 52.0, 0.5],
                [104.0, 13.0, 52.0, 1.1],
                [-5.0, 21.0, 49.0, 1.0],
                [10.0, 25.0, 52.0, 1.2],
                [22.0, 27.0, 51.0, 1.1],
                [38.0, 24.0, 47.0, 0.7],
                [54.0, 20.0, 54.0, 0.8],
                [59.0, 28.0, 50.0, 0.5],
                [73.0, 29.0, 47.0, 1.2],
                [88.0, 25.0, 54.0, 1.1],
                [101.0, 29.0, 53.0, 0.7],
                [0.0, 38.0, 46.0, 0.8],
                [14.0, 32.0, 54.0, 1.1],
                [20.0, 33.0, 50.0, 0.7],
                [38.0, 34.0, 46.0, 1.4],
                [47.0, 41.0, 47.0, 0.9],
                [58.0, 41.0, 47.0, 1.4],
                [75.0, 39.0, 45.0, 1.3],
                [92.0, 34.0, 46.0, 0.8],
                [104.0, 34.0, 52.0, 0.7],
                [-1.0, 49.0, 54.0, 0.9],
                [15.0, 49.0, 49.0, 1.5],
                [29.0, 51.0, 52.0, 0.8],
                [38.0, 53.0, 45.0, 1.0],
                [48.0, 47.0, 52.0, 1.3],
                [64.0, 51.0, 49.0, 0.7],
                [79.0, 54.0, 50.0, 1.5],
                [90.0, 47.0, 50.0, 1.4],
                [102.0, 52.0, 50.0, 0.8],
                [-2.0, 64.0, 53.0, 1.4],
                [17.0, 65.0, 46.0, 0.8],
                [28.0, 61.0, 46.0, 1.4],
                [40.0, 62.0, 51.0, 1.4],
                [48.0, 60.0, 45.0, 0.6],
                [58.0, 61.0, 51.0, 1.5],
                [75.0, 60.0, 49.0, 1.0],
                [82.0, 62.0, 48.0, 1.0],
                [100.0, 59.0, 49.0, 1.2],
                [-5.0, 72.0, 49.0, 0.5],
                [11.0, 75.0, 46.0, 0.5],
                [25.0, 77.0, 51.0, 1.2],
                [32.0, 74.0, 45.0, 1.2],
                [53.0, 79.0, 50.0, 0.6],
                [67.0, 79.0, 52.0, 1.3],
                [75.0, 70.0, 49.0, 0.6],
                [83.0, 75.0, 45.0, 1.1],
                [97.0, 73.0, 46.0, 1.3],
                [-2.0, 87.0, 54.0, 0.6],
                [9.0, 82.0, 45.0, 1.2],
                [21.0, 87.0, 54.0, 1.5],
                [35.0, 83.0, 50.0, 0.6],
                [53.0, 83.0, 45.0, 0.5],
                [59.0, 91.0, 45.0, 1.5],
                [79.0, 86.0, 46.0, 0.6],
                [82.0, 86.0, 53.0, 0.5],
                [100.0, 89.0, 49.0, 1.1],
                [1.0, 97.0, 52.0, 1.2],
                [8.0, 102.0, 54.0, 0.5],
                [22.0, 100.0, 47.0, 0.9],
                [40.0, 101.0, 46.0, 1.4],
                [50.0, 95.0, 45.0, 1.1],
                [57.0, 102.0, 46.0, 0.7],
                [74.0, 97.0, 51.0, 0.8],
                [86.0, 100.0, 48.0, 1.2],
                [101.0, 99.0, 47.0, 1.3],
                [-3.0, -4.0, 62.0, 0.8],
                [11.0, 4.0, 59.0, 1.0],
                [25.0, -3.0, 55.0, 0.7],
                [37.0, 4.0, 59.0, 1.4],
                [50.0, -2.0, 61.0, 1.3],
                [62.0, -5.0, 58.0, 1.5],
                [71.0, -1.0, 64.0, 1.2],
                [83.0, 3.0, 61.0, 1.4],
                [104.0, -2.0, 63.0, 1.0],
                [-4.0, 9.0, 63.0, 0.7],
                [9.0, 15.0, 64.0, 1.3],
                [27.0, 16.0, 64.0, 1.3],
                [39.0, 14.0, 57.0, 1.3],
                [53.0, 13.0, 64.0, 1.4],
                [60.0, 13.0, 62.0, 0.7],
                [75.0, 15.0, 63.0, 1.0],
                [86.0, 12.0, 62.0, 1.4],
                [104.0, 14.0, 57.0, 1.0],
                [0.0, 22.0, 60.0, 0.6],
                [12.0, 28.0, 62.0, 1.5],
                [26.0, 22.0, 58.0, 1.5],
                [39.0, 29.0, 57.0, 1.2],
                [49.0, 22.0, 59.0, 1.4],
                [65.0, 21.0, 57.0, 0.7],
                [74.0, 28.0, 56.0, 0.6],
                [87.0, 23.0, 63.0, 1.0],
                [104.0, 25.0, 58.0, 0.9],
                [-3.0, 36.0, 57.0, 0.7],
                [13.0, 34.0, 64.0, 0.7],
                [29.0, 32.0, 55.0, 0.8],
                [35.0, 32.0, 59.0, 1.4],
                [45.0, 32.0, 55.0, 0.6],
                [61.0, 39.0, 63.0, 1.1],
                [77.0, 37.0, 63.0, 0.6],
                [86.0, 42.0, 60.0, 1.2],
                [96.0, 34.0, 55.0, 1.2],
                [-4.0, 45.0, 58.0, 1.2],
                [7.0, 45.0, 55.0, 1.2],
                [26.0, 47.0, 60.0, 1.2],
                [34.0, 48.0, 62.0, 1.5],
                [48.0, 47.0, 59.0, 1.3],
                [58.0, 50.0, 61.0, 0.6],
                [78.0, 52.0, 60.0, 0.8],
                [84.0, 47.0, 61.0, 1.0],
                [104.0, 53.0, 56.0, 0.7],
                [-1.0, 59.0, 63.0, 1.3],
                [14.0, 66.0, 55.0, 1.3],
                [28.0, 65.0, 64.0, 1.0],
                [38.0, 66.0, 55.0, 1.2],
                [51.0, 65.0, 57.0, 1.2],
                [62.0, 67.0, 56.0, 1.4],
                [76.0, 65.0, 56.0, 1.3],
                [86.0, 63.0, 62.0, 1.1],
                [101.0, 58.0, 61.0, 1.4],
                [-2.0, 76.0, 62.0, 0.6],
                [16.0, 77.0, 57.0, 1.2],
                [20.0, 76.0, 62.0, 1.3],
                [33.0, 71.0, 56.0, 1.0],
                [45.0, 78.0, 62.0, 1.3],
                [65.0, 74.0, 63.0, 0.6],
                [70.0, 77.0, 64.0, 1.1],
                [90.0, 78.0, 62.0, 1.0],
                [98.0, 78.0, 56.0, 0.9],
                [4.0, 89.0, 55.0, 1.5],
                [15.0, 89.0, 56.0, 0.6],
                [25.0, 85.0, 56.0, 1.2],
                [35.0, 87.0, 60.0, 1.2],
                [54.0, 85.0, 63.0, 1.5],
                [65.0, 87.0, 64.0, 1.5],
                [74.0, 87.0, 58.0, 1.0],
                [87.0, 91.0, 61.0, 1.1],
                [99.0, 83.0, 63.0, 0.7],
                [1.0, 104.0, 60.0, 1.3],
                [11.0, 101.0, 56.0, 1.0],
                [25.0, 104.0, 64.0, 1.5],
                [35.0, 101.0, 64.0, 1.2],
                [47.0, 101.0, 58.0, 0.7],
                [62.0, 96.0, 63.0, 1.2],
                [78.0, 102.0, 60.0, 0.8],
                [91.0, 98.0, 61.0, 0.7],
                [99.0, 101.0, 60.0, 0.9],
                [1.0, -5.0, 73.0, 1.1],
                [11.0, -5.0, 66.0, 0.8],
                [26.0, -1.0, 68.0, 0.6],
                [35.0, -1.0, 70.0, 1.5],
                [54.0, -5.0, 69.0, 1.4],
                [63.0, 2.0, 70.0, 0.9],
                [74.0, -5.0, 74.0, 0.7],
                [88.0, 1.0, 70.0, 1.1],
                [102.0, 0.0, 66.0, 0.6],
                [0.0, 9.0, 74.0, 1.1],
                [10.0, 16.0, 67.0, 0.9],
                [28.0, 11.0, 70.0, 0.7],
                [32.0, 8.0, 71.0, 1.0],
                [47.0, 8.0, 65.0, 1.4],
                [60.0, 14.0, 67.0, 1.3],
                [78.0, 10.0, 66.0, 1.1],
                [90.0, 15.0, 65.0, 1.1],
                [95.0, 11.0, 68.0, 0.6],
                [-5.0, 29.0, 69.0, 0.7],
                [12.0, 21.0, 72.0, 1.2],
                [25.0, 28.0, 69.0, 1.4],
                [37.0, 28.0, 66.0, 1.4],
                [46.0, 25.0, 74.0, 1.3],
                [65.0, 21.0, 72.0, 1.1],
                [71.0, 27.0, 70.0, 1.4],
                [90.0, 22.0, 68.0, 1.3],
                [104.0, 28.0, 69.0, 0.5],
                [-5.0, 39.0, 74.0, 1.3],
                [10.0, 42.0, 71.0, 1.1],
                [28.0, 33.0, 70.0, 1.4],
                [35.0, 40.0, 74.0, 0.6],
                [53.0, 41.0, 68.0, 0.6],
                [61.0, 34.0, 73.0, 0.5],
                [74.0, 36.0, 74.0, 0.6],
                [88.0, 32.0, 69.0, 0.6],
                [97.0, 35.0, 69.0, 1.4],
                [-3.0, 51.0, 68.0, 1.2],
                [8.0, 51.0, 69.0, 0.6],
                [21.0, 53.0, 66.0, 1.2],
                [36.0, 52.0, 70.0, 1.3],
                [47.0, 54.0, 66.0, 0.8],
                [57.0, 48.0, 74.0, 0.9],
                [70.0, 47.0, 70.0, 0.9],
                [85.0, 50.0, 71.0, 1.0],
                [100.0, 52.0, 66.0, 1.4],
                [-4.0, 59.0, 68.0, 0.6],
                [9.0, 60.0, 66.0, 0.7],
                [24.0, 58.0, 69.0, 0.7],
                [36.0, 67.0, 69.0, 1.0],
                [51.0, 63.0, 66.0, 1.2],
                [64.0, 63.0, 72.0, 1.1],
                [70.0, 63.0, 70.0, 1.1],
                [91.0, 63.0, 69.0, 1.0],
                [103.0, 66.0, 70.0, 0.6],
                [-4.0, 71.0, 73.0, 1.2],
                [17.0, 78.0, 72.0, 1.1],
                [24.0, 74.0, 72.0, 0.9],
                [33.0, 76.0, 74.0, 1.4],
                [50.0, 79.0, 70.0, 1.2],
                [60.0, 71.0, 72.0, 1.4],
                [78.0, 74.0, 70.0, 1.1],
                [86.0, 75.0, 72.0, 1.3],
                [98.0, 75.0, 69.0, 1.1],
                [-3.0, 91.0, 73.0, 1.3],
                [16.0, 90.0, 69.0, 1.0],
                [28.0, 85.0, 73.0, 1.2],
                [35.0, 92.0, 65.0, 1.0],
                [45.0, 89.0, 66.0, 0.5],
                [59.0, 88.0, 71.0, 0.5],
                [79.0, 85.0, 73.0, 1.2],
                [84.0, 86.0, 72.0, 1.3],
                [101.0, 89.0, 65.0, 1.0],
                [-1.0, 99.0, 74.0, 1.2],
                [16.0, 100.0, 65.0, 1.5],
                [20.0, 102.0, 68.0, 0.6],
                [38.0, 102.0, 69.0, 1.3],
                [53.0, 96.0, 74.0, 1.3],
                [67.0, 101.0, 66.0, 0.9],
                [74.0, 95.0, 72.0, 1.1],
                [89.0, 102.0, 72.0, 0.6],
                [98.0, 104.0, 70.0, 1.2],
                [1.0, 2.0, 75.0, 0.7],
                [15.0, -5.0, 80.0, 1.1],
                [25.0, 1.0, 76.0, 1.1],
                [36.0, -2.0, 79.0, 1.0],
                [46.0, -3.0, 82.0, 1.4],
                [57.0, -4.0, 75.0, 0.7],
                [79.0, 1.0, 77.0, 0.9],
                [83.0, 0.0, 81.0, 0.9],
                [96.0, -2.0, 79.0, 1.2],
                [4.0, 16.0, 79.0, 1.0],
                [14.0, 10.0, 80.0, 0.6],
                [27.0, 8.0, 78.0, 1.2],
                [40.0, 11.0, 80.0, 0.5],
                [49.0, 9.0, 81.0, 1.2],
                [57.0, 8.0, 82.0, 1.4],
                [75.0, 14.0, 82.0, 1.4],
                [86.0, 15.0, 84.0, 0.6],
                [97.0, 16.0, 75.0, 1.1],
                [-2.0, 22.0, 82.0, 0.8],
                [11.0, 20.0, 77.0, 0.7],
                [20.0, 26.0, 83.0, 0.9],
                [34.0, 22.0, 75.0, 1.5],
                [53.0, 20.0, 76.0, 0.6],
                [61.0, 25.0, 82.0, 1.0],
                [77.0, 28.0, 83.0, 0.9],
                [85.0, 29.0, 78.0, 1.1],
                [101.0, 27.0, 84.0, 1.2],
                [-3.0, 38.0, 82.0, 1.2],
                [11.0, 38.0, 83.0, 0.5],
                [23.0, 36.0, 82.0, 0.7],
                [37.0, 33.0, 81.0, 1.2],
                [51.0, 39.0, 83.0, 1.2],
                [60.0, 36.0, 80.0, 1.0],
                [72.0, 36.0, 80.0, 0.9],
                [84.0, 36.0, 76.0, 0.6],
                [97.0, 35.0, 84.0, 1.4],
                [3.0, 52.0, 80.0, 1.4],
                [13.0, 47.0, 81.0, 0.9],
                [27.0, 54.0, 75.0, 1.0],
                [41.0, 51.0, 82.0, 1.4],
                [50.0, 47.0, 75.0, 0.5],
                [60.0, 50.0, 75.0, 1.0],
                [77.0, 45.0, 76.0, 1.0],
                [86.0, 48.0, 79.0, 1.2],
                [103.0, 50.0, 75.0, 0.6],
                [-1.0, 58.0, 81.0, 1.4],
                [15.0, 61.0, 82.0, 1.2],
                [26.0, 61.0, 75.0, 0.5],
                [37.0, 62.0, 76.0, 1.1],
                [49.0, 63.0, 82.0, 0.5],
                [65.0, 66.0, 79.0, 1.3],
                [73.0, 66.0, 76.0, 0.9],
                [82.0, 58.0, 78.0, 0.8],
                [101.0, 58.0, 79.0, 1.3],
                [-4.0, 75.0, 78.0, 0.6],
                [9.0, 73.0, 82.0, 1.1],
                [29.0, 77.0, 83.0, 0.9],
                [32.0, 77.0, 84.0, 0.9],
                [51.0, 78.0, 83.0, 1.3],
                [65.0, 78.0, 84.0, 0.6],
                [79.0, 77.0, 76.0, 1.2],
                [84.0, 76.0, 84.0, 1.5],
                [101.0, 79.0, 79.0, 1.1],
                [-2.0, 86.0, 84.0, 0.7],
                [16.0, 90.0, 80.0, 0.7],
                [20.0, 89.0, 83.0, 1.3],
                [33.0, 92.0, 75.0, 0.9],
                [49.0, 86.0, 78.0, 0.6],
                [65.0, 84.0, 78.0, 0.8],
                [73.0, 83.0, 82.0, 0.9],
                [88.0, 88.0, 75.0, 1.2],
                [100.0, 88.0, 75.0, 1.0],
                [-3.0, 99.0, 75.0, 1.1],
                [8.0, 101.0, 84.0, 1.5],
                [26.0, 103.0, 79.0, 1.3],
                [36.0, 102.0, 80.0, 0.9],
                [52.0, 102.0, 78.0, 0.6],
                [60.0, 98.0, 81.0, 1.4],
                [77.0, 100.0, 77.0, 1.3],
                [90.0, 102.0, 77.0, 0.6],
                [100.0, 97.0, 76.0, 1.2],
                [-4.0, 3.0, 90.0, 1.4],
                [17.0, -5.0, 91.0, 1.2],
                [23.0, 2.0, 93.0, 1.0],
                [37.0, 4.0, 86.0, 1.1],
                [52.0, -1.0, 89.0, 1.1],
                [64.0, 2.0, 85.0, 1.5],
                [74.0, -5.0, 86.0, 0.6],
                [90.0, -4.0, 86.0, 0.9],
                [100.0, -5.0, 86.0, 1.0],
                [-1.0, 11.0, 86.0, 1.4],
                [10.0, 17.0, 87.0, 0.9],
                [25.0, 10.0, 87.0, 0.7],
                [33.0, 15.0, 94.0, 1.1],
                [50.0, 10.0, 85.0, 1.0],
                [59.0, 17.0, 87.0, 0.8],
                [74.0, 9.0, 94.0, 1.1],
                [89.0, 15.0, 88.0, 0.8],
                [99.0, 15.0, 86.0, 0.9],
                [-2.0, 22.0, 94.0, 1.1],
                [12.0, 29.0, 89.0, 0.9],
                [21.0, 29.0, 85.0, 1.4],
                [36.0, 22.0, 94.0, 1.3],
                [50.0, 28.0, 86.0, 0.6],
                [65.0, 26.0, 92.0, 1.3],
                [71.0, 21.0, 93.0, 1.0],
                [90.0, 28.0, 85.0, 0.7],
                [101.0, 20.0, 93.0, 0.6],
                [4.0, 37.0, 94.0, 1.2],
                [13.0, 33.0, 93.0, 1.1],
                [29.0, 32.0, 92.0, 0.8],
                [40.0, 37.0, 86.0, 1.2],
                [51.0, 37.0, 94.0, 1.4],
                [59.0, 40.0, 94.0, 0.5],
                [73.0, 42.0, 94.0, 0.7],
                [90.0, 41.0, 91.0, 1.4],
                [103.0, 37.0, 93.0, 1.3],
                [3.0, 53.0, 91.0, 0.8],
                [7.0, 45.0, 86.0, 1.5],
                [20.0, 54.0, 87.0, 0.8],
                [39.0, 46.0, 93.0, 1.0],
                [50.0, 52.0, 93.0, 0.7],
                [58.0, 52.0, 87.0, 1.3],
                [78.0, 54.0, 86.0, 1.1],
                [84.0, 46.0, 87.0, 0.5],
                [97.0, 54.0, 88.0, 1.1],
                [-2.0, 66.0, 85.0, 1.5],
                [9.0, 59.0, 94.0, 1.5],
                [22.0, 61.0, 87.0, 1.2],
                [40.0, 60.0, 88.0, 0.8],
                [45.0, 65.0, 90.0, 1.4],
                [64.0, 63.0, 87.0, 1.5],
                [77.0, 64.0, 90.0, 0.7],
                [82.0, 65.0, 91.0, 1.5],
                [96.0, 65.0, 85.0, 0.7],
                [-4.0, 78.0, 94.0, 0.8],
                [14.0, 79.0, 92.0, 1.0],
                [29.0, 78.0, 91.0, 1.4],
                [35.0, 72.0, 85.0, 0.6],
                [45.0, 78.0, 90.0, 1.3],
                [63.0, 76.0, 91.0, 0.5],
                [71.0, 77.0, 87.0, 1.2],
                [84.0, 77.0, 89.0, 1.0],
                [104.0, 76.0, 93.0, 0.7],
                [2.0, 82.0, 86.0, 0.8],
                [11.0, 85.0, 93.0, 1.1],
                [24.0, 89.0, 85.0, 1.0],
                [35.0, 86.0, 87.0, 0.7],
                [46.0, 86.0, 91.0, 1.4],
                [66.0, 83.0, 87.0, 1.1],
                [74.0, 89.0, 91.0, 1.0],
                [89.0, 88.0, 87.0, 0.7],
                [96.0, 84.0, 92.0, 1.3],
                [-3.0, 100.0, 90.0, 0.9],
                [11.0, 96.0, 90.0, 0.7],
                [25.0, 103.0, 89.0, 1.0],
                [35.0, 95.0, 86.0, 1.3],
                [49.0, 103.0, 88.0, 0.5],
                [61.0, 99.0, 90.0, 1.0],
                [79.0, 95.0, 91.0, 1.4],
                [92.0, 103.0, 92.0, 1.0],
                [99.0, 101.0, 85.0, 1.3],
                [0.0, -1.0, 104.0, 0.5],
                [15.0, 0.0, 99.0, 0.6],
                [20.0, -1.0, 104.0, 1.2],
                [40.0, -3.0, 104.0, 1.5],
                [48.0, 4.0, 104.0, 0.7],
                [57.0, -1.0, 95.0, 0.7],
                [77.0, 0.0, 97.0, 0.9],
                [91.0, -1.0, 102.0, 0.6],
                [102.0, -2.0, 97.0, 1.3],
                [-1.0, 15.0, 101.0, 0.9],
                [16.0, 13.0, 99.0, 1.0],
                [21.0, 14.0, 99.0, 0.6],
                [35.0, 11.0, 98.0, 1.3],
                [52.0, 17.0, 96.0, 0.7],
                [64.0, 13.0, 104.0, 1.5],
                [70.0, 9.0, 97.0, 0.8],
                [83.0, 9.0, 95.0, 0.9],
                [104.0, 7.0, 99.0, 1.5],
                [0.0, 27.0, 96.0, 1.3],
                [16.0, 24.0, 95.0, 1.2],
                [27.0, 27.0, 100.0, 1.1],
                [34.0, 20.0, 104.0, 0.6],
                [50.0, 29.0, 96.0, 0.8],
                [59.0, 23.0, 97.0, 1.0],
                [79.0, 23.0, 95.0, 0.7],
                [84.0, 28.0, 102.0, 0.9],
                [103.0, 29.0, 100.0, 1.1],
                [-2.0, 37.0, 100.0, 0.7],
                [10.0, 37.0, 104.0, 1.1],
                [23.0, 38.0, 101.0, 0.6],
                [37.0, 34.0, 100.0, 0.8],
                [49.0, 41.0, 98.0, 1.1],
                [63.0, 40.0, 99.0, 0.7],
                [75.0, 34.0, 102.0, 0.7],
                [87.0, 40.0, 96.0, 0.5],
                [95.0, 33.0, 101.0, 0.8],
                [-3.0, 50.0, 101.0, 1.3],
                [10.0, 51.0, 104.0, 1.1],
                [26.0, 48.0, 102.0, 1.2],
                [36.0, 52.0, 103.0, 0.8],
                [50.0, 49.0, 103.0, 1.4],
                [61.0, 53.0, 104.0, 0.6],
                [79.0, 49.0, 102.0, 1.1],
                [88.0, 52.0, 100.0, 0.8],
                [103.0, 51.0, 97.0, 0.7],
                [2.0, 57.0, 95.0, 1.2],
                [13.0, 59.0, 104.0, 1.5],
                [24.0, 59.0, 104.0, 1.3],
                [41.0, 58.0, 99.0, 1.5],
                [46.0, 63.0, 96.0, 0.6],
                [62.0, 59.0, 95.0, 0.6],
                [77.0, 59.0, 102.0, 0.8],
                [85.0, 62.0, 103.0, 0.9],
                [100.0, 67.0, 100.0, 1.4],
                [-2.0, 79.0, 97.0, 1.4],
                [14.0, 73.0, 102.0, 1.4],
                [20.0, 74.0, 101.0, 1.5],
                [41.0, 76.0, 97.0, 0.8],
                [54.0, 77.0, 103.0, 1.1],
                [64.0, 79.0, 97.0, 1.1],
                [78.0, 74.0, 102.0, 0.6],
                [91.0, 73.0, 95.0, 0.8],
                [103.0, 75.0, 99.0, 1.3],
                [4.0, 90.0, 95.0, 0.9],
                [15.0, 84.0, 100.0, 1.0],
                [22.0, 88.0, 97.0, 0.8],
                [37.0, 86.0, 104.0, 0.7],
                [46.0, 86.0, 97.0, 1.0],
                [58.0, 89.0, 96.0, 0.6],
                [72.0, 82.0, 102.0, 1.3],
                [90.0, 88.0, 101.0, 1.1],
                [100.0, 87.0, 96.0, 0.9],
                [4.0, 97.0, 100.0, 0.8],
                [11.0, 99.0, 98.0, 0.6],
                [29.0, 100.0, 95.0, 0.7],
                [33.0, 104.0, 95.0, 0.7],
                [48.0, 96.0, 104.0, 1.3],
                [60.0, 97.0, 97.0, 1.0],
                [70.0, 103.0, 95.0, 0.6],
                [88.0, 98.0, 103.0, 1.2],
                [103.0, 100.0, 99.0, 0.9],
            ]
        )
        basis0 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6, 1.8, 3.1, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        basis1 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9, 2.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0])
        )
        basis2 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9, 2.3, 2.6, 4.2, 5.3, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0])
        )
        vol = Volume(basis0, basis1, basis2, controlpoints, True)
        vol2 = vol.clone()
        vol2 += np.array([3.4, 1.3, 5.2])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] -= 3.400000
        pt2[..., 1] -= 1.300000
        pt2[..., 2] -= 5.200000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_volume_3D_p577_rational(self):
        controlpoints = np.array(
            [
                [-1.0, 3.0, -1.0, 1.3],
                [21.0, -3.0, -1.0, 0.9],
                [41.0, 4.0, -2.0, 0.8],
                [60.0, 2.0, -1.0, 1.3],
                [79.0, 4.0, 0.0, 0.9],
                [103.0, 4.0, 1.0, 0.5],
                [-5.0, 9.0, 4.0, 1.4],
                [17.0, 16.0, -4.0, 0.9],
                [38.0, 13.0, -3.0, 1.1],
                [63.0, 16.0, -2.0, 0.6],
                [76.0, 11.0, 1.0, 0.7],
                [104.0, 16.0, 4.0, 1.2],
                [-3.0, 29.0, -3.0, 1.0],
                [20.0, 31.0, -3.0, 0.9],
                [44.0, 28.0, -3.0, 1.5],
                [64.0, 31.0, -5.0, 0.5],
                [75.0, 33.0, -5.0, 0.6],
                [100.0, 31.0, 2.0, 1.4],
                [0.0, 43.0, -3.0, 1.4],
                [20.0, 42.0, -1.0, 0.5],
                [37.0, 47.0, 0.0, 0.9],
                [56.0, 46.0, -2.0, 1.2],
                [84.0, 42.0, -3.0, 0.6],
                [103.0, 42.0, -1.0, 1.0],
                [4.0, 61.0, 1.0, 1.4],
                [15.0, 59.0, -1.0, 1.2],
                [39.0, 57.0, 1.0, 0.6],
                [60.0, 54.0, -4.0, 1.0],
                [78.0, 60.0, -5.0, 1.4],
                [100.0, 61.0, -5.0, 1.1],
                [3.0, 68.0, 4.0, 0.7],
                [16.0, 75.0, 3.0, 0.9],
                [37.0, 68.0, 1.0, 0.6],
                [56.0, 70.0, 0.0, 0.7],
                [77.0, 67.0, 4.0, 1.5],
                [99.0, 67.0, 2.0, 1.5],
                [3.0, 86.0, 4.0, 0.6],
                [17.0, 90.0, -4.0, 1.0],
                [39.0, 86.0, 3.0, 0.8],
                [55.0, 87.0, 1.0, 0.7],
                [81.0, 88.0, 2.0, 0.7],
                [95.0, 85.0, 3.0, 1.3],
                [-5.0, 101.0, 0.0, 1.2],
                [17.0, 98.0, 4.0, 0.9],
                [40.0, 98.0, -1.0, 0.5],
                [55.0, 98.0, -3.0, 0.6],
                [77.0, 97.0, 0.0, 0.7],
                [95.0, 100.0, 1.0, 0.6],
                [-4.0, -3.0, 7.0, 1.1],
                [20.0, 3.0, 15.0, 1.4],
                [35.0, 0.0, 13.0, 1.3],
                [56.0, -3.0, 7.0, 0.9],
                [76.0, -2.0, 15.0, 0.9],
                [99.0, -1.0, 7.0, 1.3],
                [-3.0, 12.0, 6.0, 0.6],
                [15.0, 12.0, 7.0, 1.1],
                [44.0, 15.0, 8.0, 0.5],
                [64.0, 12.0, 9.0, 0.8],
                [77.0, 13.0, 9.0, 0.9],
                [95.0, 13.0, 11.0, 0.5],
                [-4.0, 24.0, 8.0, 0.8],
                [24.0, 27.0, 10.0, 1.5],
                [40.0, 32.0, 11.0, 0.5],
                [59.0, 27.0, 6.0, 1.1],
                [84.0, 30.0, 8.0, 1.2],
                [97.0, 25.0, 13.0, 1.0],
                [1.0, 43.0, 7.0, 0.8],
                [22.0, 38.0, 9.0, 1.2],
                [41.0, 46.0, 15.0, 1.2],
                [64.0, 42.0, 10.0, 1.5],
                [76.0, 39.0, 8.0, 0.7],
                [95.0, 40.0, 8.0, 1.3],
                [-2.0, 54.0, 13.0, 0.9],
                [21.0, 52.0, 15.0, 0.6],
                [35.0, 59.0, 15.0, 1.0],
                [59.0, 60.0, 16.0, 0.9],
                [84.0, 59.0, 14.0, 1.5],
                [100.0, 55.0, 12.0, 0.5],
                [3.0, 73.0, 12.0, 1.3],
                [23.0, 70.0, 13.0, 0.8],
                [36.0, 72.0, 8.0, 1.1],
                [56.0, 71.0, 7.0, 0.7],
                [81.0, 68.0, 9.0, 1.1],
                [100.0, 69.0, 12.0, 1.1],
                [1.0, 84.0, 13.0, 1.3],
                [20.0, 80.0, 9.0, 0.9],
                [38.0, 90.0, 8.0, 0.7],
                [63.0, 90.0, 9.0, 1.0],
                [81.0, 84.0, 13.0, 0.8],
                [95.0, 88.0, 13.0, 1.0],
                [1.0, 96.0, 14.0, 1.5],
                [19.0, 104.0, 11.0, 1.0],
                [42.0, 104.0, 6.0, 0.6],
                [59.0, 95.0, 9.0, 1.4],
                [80.0, 101.0, 7.0, 1.2],
                [103.0, 102.0, 14.0, 1.2],
                [4.0, 3.0, 20.0, 0.5],
                [23.0, -3.0, 20.0, 1.4],
                [44.0, -1.0, 20.0, 0.5],
                [55.0, -4.0, 17.0, 0.6],
                [76.0, 0.0, 24.0, 0.8],
                [96.0, -2.0, 24.0, 0.8],
                [-3.0, 14.0, 23.0, 0.5],
                [22.0, 15.0, 20.0, 1.3],
                [41.0, 10.0, 22.0, 1.1],
                [63.0, 19.0, 23.0, 0.5],
                [75.0, 10.0, 25.0, 1.0],
                [99.0, 17.0, 21.0, 0.9],
                [2.0, 23.0, 24.0, 1.0],
                [22.0, 32.0, 26.0, 1.4],
                [38.0, 31.0, 24.0, 0.7],
                [59.0, 29.0, 22.0, 0.7],
                [80.0, 27.0, 26.0, 1.3],
                [104.0, 26.0, 18.0, 0.8],
                [-4.0, 41.0, 26.0, 1.4],
                [18.0, 42.0, 25.0, 0.8],
                [37.0, 39.0, 17.0, 1.3],
                [62.0, 40.0, 22.0, 0.9],
                [82.0, 41.0, 23.0, 1.0],
                [95.0, 47.0, 23.0, 0.8],
                [-4.0, 54.0, 17.0, 0.8],
                [18.0, 55.0, 19.0, 1.0],
                [42.0, 52.0, 20.0, 1.2],
                [60.0, 59.0, 24.0, 1.2],
                [77.0, 54.0, 17.0, 1.5],
                [100.0, 52.0, 23.0, 0.8],
                [3.0, 72.0, 20.0, 1.4],
                [24.0, 74.0, 26.0, 0.8],
                [41.0, 71.0, 25.0, 0.7],
                [64.0, 68.0, 24.0, 1.2],
                [78.0, 71.0, 23.0, 1.0],
                [101.0, 68.0, 24.0, 1.1],
                [3.0, 86.0, 25.0, 1.2],
                [19.0, 86.0, 26.0, 1.2],
                [43.0, 90.0, 20.0, 1.1],
                [59.0, 86.0, 20.0, 0.9],
                [76.0, 84.0, 22.0, 1.2],
                [101.0, 88.0, 22.0, 0.8],
                [1.0, 99.0, 22.0, 1.1],
                [21.0, 99.0, 25.0, 1.2],
                [35.0, 95.0, 26.0, 1.5],
                [57.0, 103.0, 18.0, 1.2],
                [80.0, 98.0, 20.0, 1.1],
                [101.0, 100.0, 21.0, 1.5],
                [-4.0, -2.0, 29.0, 0.6],
                [21.0, -4.0, 37.0, 1.2],
                [37.0, -4.0, 36.0, 0.8],
                [64.0, 4.0, 33.0, 0.5],
                [81.0, -1.0, 32.0, 1.0],
                [99.0, -1.0, 32.0, 0.8],
                [4.0, 17.0, 28.0, 1.1],
                [24.0, 9.0, 35.0, 0.5],
                [41.0, 18.0, 28.0, 1.3],
                [64.0, 18.0, 33.0, 0.8],
                [76.0, 12.0, 28.0, 0.8],
                [98.0, 18.0, 28.0, 1.0],
                [-4.0, 31.0, 34.0, 0.5],
                [24.0, 31.0, 36.0, 0.6],
                [35.0, 30.0, 36.0, 0.8],
                [55.0, 33.0, 34.0, 1.1],
                [83.0, 31.0, 30.0, 0.5],
                [103.0, 32.0, 36.0, 0.7],
                [-4.0, 47.0, 34.0, 0.7],
                [15.0, 42.0, 33.0, 0.6],
                [44.0, 41.0, 36.0, 0.8],
                [57.0, 45.0, 37.0, 1.3],
                [76.0, 38.0, 32.0, 0.8],
                [102.0, 46.0, 36.0, 1.4],
                [-2.0, 59.0, 30.0, 0.6],
                [15.0, 53.0, 28.0, 1.1],
                [41.0, 60.0, 31.0, 1.0],
                [59.0, 55.0, 31.0, 0.9],
                [76.0, 61.0, 29.0, 1.1],
                [98.0, 53.0, 34.0, 1.1],
                [-4.0, 67.0, 37.0, 1.2],
                [23.0, 67.0, 30.0, 0.7],
                [42.0, 73.0, 35.0, 1.4],
                [55.0, 70.0, 37.0, 1.1],
                [78.0, 71.0, 34.0, 1.0],
                [101.0, 75.0, 30.0, 1.0],
                [-1.0, 81.0, 34.0, 1.2],
                [16.0, 82.0, 34.0, 0.9],
                [36.0, 82.0, 34.0, 1.4],
                [56.0, 85.0, 29.0, 1.5],
                [79.0, 85.0, 35.0, 0.8],
                [99.0, 81.0, 29.0, 0.5],
                [-5.0, 98.0, 30.0, 1.1],
                [20.0, 97.0, 32.0, 1.5],
                [38.0, 96.0, 30.0, 0.9],
                [60.0, 95.0, 34.0, 1.2],
                [83.0, 104.0, 32.0, 1.0],
                [96.0, 104.0, 31.0, 1.2],
                [-2.0, 1.0, 44.0, 1.3],
                [24.0, 4.0, 41.0, 0.9],
                [40.0, 0.0, 45.0, 0.6],
                [62.0, 4.0, 42.0, 0.8],
                [78.0, -4.0, 49.0, 1.3],
                [100.0, 1.0, 49.0, 1.3],
                [-1.0, 18.0, 45.0, 0.6],
                [16.0, 11.0, 39.0, 1.1],
                [44.0, 14.0, 44.0, 1.2],
                [64.0, 14.0, 40.0, 1.0],
                [79.0, 11.0, 46.0, 1.2],
                [102.0, 14.0, 44.0, 1.0],
                [3.0, 30.0, 49.0, 0.8],
                [19.0, 28.0, 45.0, 0.8],
                [36.0, 25.0, 49.0, 1.0],
                [57.0, 29.0, 45.0, 1.3],
                [84.0, 29.0, 43.0, 0.5],
                [98.0, 26.0, 44.0, 0.7],
                [4.0, 47.0, 41.0, 1.0],
                [17.0, 40.0, 45.0, 1.0],
                [40.0, 44.0, 44.0, 1.3],
                [57.0, 38.0, 41.0, 1.3],
                [80.0, 44.0, 45.0, 0.8],
                [104.0, 41.0, 45.0, 0.8],
                [2.0, 54.0, 47.0, 0.8],
                [21.0, 57.0, 40.0, 0.6],
                [39.0, 61.0, 43.0, 0.8],
                [61.0, 54.0, 42.0, 0.6],
                [83.0, 52.0, 41.0, 1.3],
                [103.0, 55.0, 47.0, 0.8],
                [-2.0, 74.0, 47.0, 1.0],
                [17.0, 68.0, 42.0, 0.7],
                [35.0, 74.0, 46.0, 1.2],
                [58.0, 69.0, 43.0, 1.1],
                [78.0, 72.0, 41.0, 1.5],
                [101.0, 67.0, 40.0, 1.1],
                [3.0, 87.0, 49.0, 1.3],
                [19.0, 85.0, 48.0, 1.2],
                [35.0, 84.0, 42.0, 0.8],
                [60.0, 82.0, 45.0, 1.4],
                [76.0, 84.0, 47.0, 0.8],
                [97.0, 89.0, 48.0, 1.1],
                [-3.0, 99.0, 43.0, 0.5],
                [22.0, 102.0, 47.0, 1.4],
                [44.0, 100.0, 41.0, 0.7],
                [58.0, 101.0, 47.0, 1.3],
                [78.0, 99.0, 41.0, 1.1],
                [100.0, 99.0, 45.0, 0.6],
                [-5.0, 1.0, 55.0, 0.5],
                [19.0, -4.0, 56.0, 0.7],
                [44.0, -5.0, 53.0, 1.3],
                [61.0, -3.0, 53.0, 0.8],
                [81.0, 0.0, 51.0, 1.4],
                [102.0, 4.0, 57.0, 0.6],
                [0.0, 10.0, 56.0, 1.3],
                [21.0, 13.0, 59.0, 1.0],
                [35.0, 17.0, 53.0, 0.7],
                [62.0, 17.0, 60.0, 0.6],
                [81.0, 12.0, 54.0, 1.4],
                [95.0, 9.0, 57.0, 0.8],
                [-2.0, 32.0, 54.0, 0.9],
                [18.0, 26.0, 52.0, 1.1],
                [42.0, 32.0, 54.0, 1.4],
                [55.0, 29.0, 52.0, 0.6],
                [77.0, 31.0, 58.0, 0.8],
                [104.0, 33.0, 54.0, 1.0],
                [-5.0, 39.0, 53.0, 0.7],
                [22.0, 44.0, 55.0, 1.2],
                [35.0, 38.0, 54.0, 0.6],
                [58.0, 40.0, 55.0, 1.4],
                [75.0, 43.0, 53.0, 1.4],
                [95.0, 44.0, 57.0, 1.0],
                [2.0, 53.0, 58.0, 1.2],
                [15.0, 54.0, 57.0, 0.8],
                [43.0, 60.0, 58.0, 0.6],
                [63.0, 60.0, 53.0, 1.1],
                [77.0, 53.0, 53.0, 1.0],
                [96.0, 60.0, 59.0, 1.0],
                [0.0, 75.0, 55.0, 1.2],
                [22.0, 68.0, 51.0, 0.7],
                [44.0, 73.0, 52.0, 1.0],
                [61.0, 73.0, 56.0, 0.6],
                [77.0, 72.0, 58.0, 0.6],
                [96.0, 73.0, 51.0, 1.2],
                [-2.0, 83.0, 59.0, 1.3],
                [16.0, 86.0, 58.0, 0.8],
                [39.0, 88.0, 53.0, 0.5],
                [55.0, 89.0, 51.0, 1.4],
                [82.0, 89.0, 54.0, 1.4],
                [95.0, 85.0, 58.0, 0.6],
                [-2.0, 97.0, 53.0, 1.4],
                [20.0, 99.0, 51.0, 0.6],
                [39.0, 103.0, 56.0, 1.2],
                [63.0, 100.0, 51.0, 0.8],
                [76.0, 104.0, 58.0, 1.0],
                [95.0, 103.0, 52.0, 1.0],
                [0.0, -5.0, 66.0, 0.5],
                [20.0, 3.0, 66.0, 0.8],
                [40.0, -3.0, 62.0, 0.8],
                [58.0, -2.0, 68.0, 0.6],
                [83.0, -4.0, 65.0, 1.1],
                [103.0, 3.0, 70.0, 0.6],
                [-2.0, 14.0, 65.0, 0.5],
                [15.0, 14.0, 68.0, 1.1],
                [36.0, 11.0, 69.0, 1.1],
                [61.0, 11.0, 68.0, 1.5],
                [80.0, 14.0, 65.0, 1.3],
                [102.0, 10.0, 71.0, 0.6],
                [2.0, 28.0, 68.0, 0.6],
                [20.0, 31.0, 66.0, 1.5],
                [43.0, 25.0, 65.0, 0.9],
                [61.0, 32.0, 64.0, 0.6],
                [80.0, 31.0, 71.0, 1.2],
                [101.0, 28.0, 70.0, 1.3],
                [3.0, 39.0, 65.0, 1.4],
                [15.0, 40.0, 71.0, 0.7],
                [42.0, 47.0, 64.0, 1.1],
                [57.0, 41.0, 63.0, 0.9],
                [82.0, 42.0, 70.0, 0.7],
                [101.0, 43.0, 65.0, 1.3],
                [3.0, 56.0, 63.0, 0.8],
                [19.0, 56.0, 68.0, 0.9],
                [39.0, 58.0, 68.0, 1.4],
                [58.0, 54.0, 64.0, 1.0],
                [84.0, 57.0, 63.0, 0.7],
                [95.0, 52.0, 66.0, 1.4],
                [1.0, 69.0, 61.0, 0.6],
                [16.0, 74.0, 62.0, 1.2],
                [44.0, 74.0, 64.0, 0.9],
                [58.0, 66.0, 70.0, 0.6],
                [76.0, 72.0, 68.0, 0.6],
                [100.0, 68.0, 62.0, 0.9],
                [0.0, 85.0, 63.0, 0.9],
                [16.0, 89.0, 65.0, 1.3],
                [44.0, 82.0, 66.0, 0.5],
                [63.0, 85.0, 68.0, 0.9],
                [78.0, 82.0, 61.0, 0.6],
                [102.0, 82.0, 66.0, 0.5],
                [3.0, 103.0, 67.0, 0.8],
                [17.0, 97.0, 69.0, 1.5],
                [40.0, 98.0, 64.0, 1.1],
                [55.0, 96.0, 61.0, 1.2],
                [76.0, 97.0, 68.0, 1.3],
                [102.0, 102.0, 64.0, 1.4],
                [0.0, 4.0, 79.0, 0.9],
                [19.0, -5.0, 78.0, 0.9],
                [39.0, -2.0, 82.0, 1.1],
                [63.0, 3.0, 78.0, 1.1],
                [82.0, -2.0, 78.0, 0.9],
                [96.0, -1.0, 82.0, 0.5],
                [-3.0, 11.0, 82.0, 1.1],
                [22.0, 13.0, 73.0, 1.0],
                [40.0, 18.0, 72.0, 0.9],
                [58.0, 12.0, 75.0, 1.0],
                [81.0, 14.0, 75.0, 1.4],
                [99.0, 10.0, 75.0, 0.5],
                [3.0, 29.0, 79.0, 1.1],
                [18.0, 24.0, 77.0, 1.5],
                [44.0, 28.0, 75.0, 0.8],
                [61.0, 30.0, 76.0, 1.2],
                [83.0, 25.0, 72.0, 1.5],
                [95.0, 26.0, 80.0, 1.3],
                [3.0, 39.0, 80.0, 1.0],
                [16.0, 46.0, 81.0, 0.7],
                [42.0, 41.0, 79.0, 0.8],
                [55.0, 39.0, 81.0, 1.3],
                [80.0, 45.0, 76.0, 0.5],
                [96.0, 43.0, 77.0, 1.2],
                [-3.0, 56.0, 79.0, 0.9],
                [18.0, 57.0, 79.0, 0.6],
                [36.0, 58.0, 80.0, 1.1],
                [55.0, 60.0, 76.0, 0.6],
                [78.0, 54.0, 79.0, 1.0],
                [104.0, 59.0, 81.0, 1.4],
                [1.0, 72.0, 80.0, 0.7],
                [21.0, 68.0, 74.0, 0.5],
                [38.0, 75.0, 78.0, 0.9],
                [64.0, 71.0, 77.0, 0.9],
                [78.0, 66.0, 78.0, 1.4],
                [104.0, 66.0, 74.0, 1.2],
                [3.0, 80.0, 82.0, 0.8],
                [22.0, 89.0, 76.0, 1.4],
                [37.0, 84.0, 74.0, 1.3],
                [59.0, 86.0, 79.0, 0.6],
                [76.0, 81.0, 80.0, 1.1],
                [98.0, 88.0, 73.0, 0.6],
                [1.0, 101.0, 74.0, 0.9],
                [21.0, 98.0, 80.0, 0.6],
                [42.0, 99.0, 72.0, 1.5],
                [55.0, 99.0, 80.0, 0.6],
                [79.0, 95.0, 79.0, 1.0],
                [97.0, 101.0, 73.0, 1.0],
                [2.0, 1.0, 88.0, 1.4],
                [17.0, 1.0, 87.0, 1.5],
                [36.0, 0.0, 86.0, 0.5],
                [62.0, 2.0, 84.0, 1.0],
                [83.0, -4.0, 91.0, 1.2],
                [98.0, 3.0, 83.0, 1.2],
                [-1.0, 11.0, 87.0, 1.5],
                [24.0, 13.0, 85.0, 1.0],
                [37.0, 12.0, 91.0, 1.4],
                [59.0, 17.0, 85.0, 1.0],
                [77.0, 14.0, 87.0, 1.2],
                [100.0, 18.0, 91.0, 0.5],
                [-1.0, 28.0, 89.0, 0.7],
                [24.0, 31.0, 85.0, 0.6],
                [44.0, 29.0, 93.0, 0.6],
                [56.0, 31.0, 93.0, 1.3],
                [76.0, 30.0, 86.0, 0.8],
                [104.0, 29.0, 84.0, 0.6],
                [3.0, 47.0, 85.0, 1.3],
                [22.0, 47.0, 83.0, 1.2],
                [42.0, 40.0, 90.0, 1.4],
                [63.0, 42.0, 84.0, 1.1],
                [84.0, 45.0, 93.0, 1.4],
                [103.0, 44.0, 86.0, 1.4],
                [-4.0, 60.0, 85.0, 1.2],
                [24.0, 61.0, 89.0, 1.4],
                [37.0, 57.0, 91.0, 1.2],
                [58.0, 56.0, 84.0, 0.6],
                [78.0, 60.0, 89.0, 1.3],
                [98.0, 56.0, 92.0, 0.5],
                [-3.0, 75.0, 85.0, 1.0],
                [19.0, 75.0, 87.0, 1.4],
                [43.0, 73.0, 85.0, 0.6],
                [64.0, 69.0, 90.0, 1.0],
                [76.0, 73.0, 87.0, 1.1],
                [104.0, 74.0, 86.0, 1.2],
                [-2.0, 81.0, 86.0, 1.0],
                [16.0, 82.0, 93.0, 0.6],
                [36.0, 81.0, 85.0, 0.9],
                [63.0, 84.0, 92.0, 1.3],
                [80.0, 88.0, 89.0, 0.5],
                [102.0, 82.0, 85.0, 0.6],
                [0.0, 103.0, 87.0, 0.9],
                [18.0, 98.0, 84.0, 0.9],
                [44.0, 104.0, 87.0, 0.6],
                [61.0, 101.0, 91.0, 0.5],
                [79.0, 97.0, 88.0, 1.0],
                [100.0, 95.0, 90.0, 1.4],
                [3.0, -3.0, 97.0, 0.5],
                [22.0, -4.0, 104.0, 0.5],
                [35.0, -3.0, 104.0, 0.5],
                [56.0, 4.0, 96.0, 0.7],
                [77.0, 4.0, 100.0, 1.0],
                [101.0, -2.0, 103.0, 0.5],
                [2.0, 19.0, 95.0, 1.4],
                [20.0, 18.0, 97.0, 1.0],
                [38.0, 18.0, 104.0, 0.8],
                [59.0, 17.0, 104.0, 1.4],
                [77.0, 18.0, 99.0, 1.2],
                [104.0, 17.0, 102.0, 0.8],
                [4.0, 27.0, 96.0, 1.5],
                [18.0, 24.0, 98.0, 1.3],
                [43.0, 30.0, 97.0, 0.5],
                [59.0, 27.0, 101.0, 0.6],
                [78.0, 24.0, 95.0, 0.5],
                [101.0, 23.0, 95.0, 1.1],
                [4.0, 44.0, 96.0, 1.5],
                [15.0, 47.0, 103.0, 1.1],
                [41.0, 42.0, 99.0, 1.3],
                [60.0, 46.0, 95.0, 1.1],
                [83.0, 41.0, 103.0, 0.7],
                [104.0, 40.0, 97.0, 1.1],
                [3.0, 55.0, 95.0, 0.5],
                [23.0, 57.0, 99.0, 1.4],
                [38.0, 54.0, 97.0, 1.2],
                [60.0, 59.0, 104.0, 1.4],
                [77.0, 55.0, 98.0, 1.4],
                [102.0, 53.0, 96.0, 0.9],
                [-2.0, 74.0, 100.0, 1.4],
                [21.0, 69.0, 98.0, 1.5],
                [42.0, 71.0, 102.0, 1.4],
                [61.0, 69.0, 97.0, 0.8],
                [78.0, 73.0, 103.0, 1.3],
                [102.0, 69.0, 101.0, 1.5],
                [2.0, 87.0, 96.0, 0.9],
                [20.0, 87.0, 101.0, 0.5],
                [39.0, 89.0, 104.0, 0.8],
                [62.0, 88.0, 103.0, 0.7],
                [76.0, 89.0, 102.0, 1.2],
                [103.0, 85.0, 97.0, 1.5],
                [0.0, 98.0, 98.0, 1.5],
                [21.0, 96.0, 98.0, 1.3],
                [41.0, 95.0, 97.0, 1.1],
                [56.0, 96.0, 97.0, 1.0],
                [84.0, 102.0, 99.0, 0.9],
                [97.0, 103.0, 103.0, 1.1],
            ]
        )
        basis0 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 1.2, 2.0, 2.0, 2.0, 2.0, 2.0]))
        basis1 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0])
        )
        basis2 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 2.3, 3.1, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        vol = Volume(basis0, basis1, basis2, controlpoints, True)
        vol2 = vol.clone()
        vol2 *= np.array([7.8, 3.5, 4.3])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] /= 7.800000
        pt2[..., 1] /= 3.500000
        pt2[..., 2] /= 4.300000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_volume_3D_p577_rational(self):
        controlpoints = np.array(
            [
                [4.0, 1.0, 0.0, 1.3],
                [8.0, 0.0, -1.0, 0.6],
                [23.0, -2.0, -4.0, 1.0],
                [35.0, -1.0, 0.0, 1.3],
                [50.0, -3.0, -4.0, 0.6],
                [57.0, -5.0, 2.0, 1.0],
                [73.0, -4.0, -1.0, 1.3],
                [85.0, -4.0, -5.0, 0.9],
                [103.0, 2.0, 3.0, 0.7],
                [4.0, 11.0, 4.0, 1.2],
                [8.0, 14.0, -4.0, 1.2],
                [27.0, 12.0, 3.0, 1.0],
                [39.0, 9.0, 3.0, 0.8],
                [47.0, 7.0, 3.0, 1.5],
                [64.0, 14.0, -4.0, 0.5],
                [71.0, 15.0, -2.0, 1.3],
                [88.0, 15.0, 3.0, 1.2],
                [102.0, 13.0, 0.0, 0.6],
                [0.0, 17.0, -2.0, 0.9],
                [10.0, 22.0, -4.0, 0.5],
                [25.0, 27.0, -3.0, 1.1],
                [40.0, 23.0, 4.0, 1.5],
                [49.0, 22.0, -1.0, 0.7],
                [59.0, 21.0, -3.0, 0.8],
                [71.0, 18.0, 3.0, 0.6],
                [90.0, 21.0, -3.0, 0.8],
                [103.0, 21.0, 4.0, 1.1],
                [4.0, 33.0, 4.0, 1.1],
                [16.0, 33.0, -4.0, 0.8],
                [20.0, 31.0, -4.0, 1.1],
                [39.0, 31.0, 2.0, 1.4],
                [48.0, 34.0, -1.0, 0.6],
                [66.0, 34.0, 2.0, 0.5],
                [75.0, 34.0, -1.0, 1.4],
                [89.0, 32.0, -4.0, 1.4],
                [100.0, 34.0, -5.0, 1.1],
                [4.0, 46.0, -2.0, 1.2],
                [15.0, 43.0, -2.0, 1.5],
                [26.0, 44.0, 2.0, 1.5],
                [40.0, 41.0, 3.0, 1.4],
                [52.0, 40.0, 2.0, 1.4],
                [65.0, 46.0, 1.0, 1.1],
                [72.0, 39.0, 0.0, 1.3],
                [84.0, 45.0, -4.0, 1.1],
                [101.0, 40.0, 2.0, 1.2],
                [1.0, 53.0, 1.0, 1.2],
                [10.0, 57.0, 4.0, 0.6],
                [23.0, 55.0, -3.0, 1.4],
                [36.0, 54.0, -5.0, 0.5],
                [46.0, 53.0, 2.0, 0.7],
                [62.0, 52.0, 1.0, 1.4],
                [72.0, 53.0, -1.0, 1.0],
                [88.0, 55.0, 1.0, 0.5],
                [99.0, 51.0, 3.0, 0.5],
                [4.0, 61.0, -2.0, 1.0],
                [9.0, 70.0, 2.0, 0.9],
                [28.0, 68.0, -1.0, 1.1],
                [40.0, 66.0, -1.0, 0.8],
                [48.0, 66.0, 4.0, 0.8],
                [60.0, 64.0, -2.0, 0.9],
                [75.0, 67.0, -4.0, 0.9],
                [90.0, 64.0, -3.0, 0.7],
                [101.0, 65.0, -5.0, 1.1],
                [-5.0, 74.0, -1.0, 1.1],
                [8.0, 79.0, 0.0, 0.9],
                [22.0, 73.0, 1.0, 1.4],
                [38.0, 79.0, 4.0, 0.5],
                [45.0, 75.0, -3.0, 0.9],
                [65.0, 77.0, 4.0, 1.0],
                [73.0, 73.0, -3.0, 0.9],
                [84.0, 77.0, 2.0, 1.4],
                [104.0, 73.0, -1.0, 1.1],
                [-1.0, 87.0, 1.0, 1.1],
                [13.0, 90.0, -5.0, 1.1],
                [26.0, 88.0, 1.0, 1.4],
                [37.0, 84.0, 3.0, 0.6],
                [48.0, 92.0, -1.0, 0.7],
                [62.0, 93.0, 0.0, 0.5],
                [70.0, 90.0, 2.0, 0.9],
                [91.0, 85.0, 1.0, 0.9],
                [104.0, 86.0, -4.0, 0.6],
                [-3.0, 100.0, 1.0, 0.9],
                [14.0, 97.0, -1.0, 0.8],
                [29.0, 101.0, -4.0, 1.2],
                [34.0, 95.0, -4.0, 1.2],
                [47.0, 100.0, 0.0, 1.5],
                [57.0, 97.0, -2.0, 0.9],
                [73.0, 100.0, 3.0, 0.5],
                [86.0, 97.0, -4.0, 1.0],
                [101.0, 104.0, 4.0, 0.5],
                [-1.0, 2.0, 7.0, 1.0],
                [10.0, 0.0, 13.0, 1.0],
                [26.0, -1.0, 10.0, 0.6],
                [40.0, -4.0, 12.0, 0.8],
                [50.0, -4.0, 11.0, 0.7],
                [58.0, -3.0, 5.0, 0.5],
                [79.0, 3.0, 4.0, 0.8],
                [92.0, 0.0, 5.0, 0.6],
                [100.0, 1.0, 7.0, 1.4],
                [-1.0, 11.0, 8.0, 0.5],
                [8.0, 13.0, 11.0, 1.4],
                [22.0, 14.0, 12.0, 0.9],
                [38.0, 9.0, 4.0, 1.3],
                [45.0, 9.0, 8.0, 0.7],
                [59.0, 10.0, 7.0, 1.3],
                [77.0, 11.0, 5.0, 1.1],
                [88.0, 14.0, 5.0, 1.1],
                [101.0, 9.0, 4.0, 1.3],
                [2.0, 20.0, 7.0, 0.9],
                [12.0, 27.0, 11.0, 0.9],
                [25.0, 24.0, 4.0, 1.3],
                [33.0, 26.0, 7.0, 1.4],
                [51.0, 23.0, 6.0, 1.1],
                [63.0, 25.0, 10.0, 1.2],
                [71.0, 26.0, 7.0, 1.3],
                [90.0, 23.0, 9.0, 1.4],
                [97.0, 21.0, 11.0, 1.4],
                [0.0, 36.0, 10.0, 1.3],
                [12.0, 37.0, 10.0, 0.7],
                [24.0, 33.0, 4.0, 0.6],
                [32.0, 31.0, 6.0, 0.8],
                [51.0, 31.0, 6.0, 0.8],
                [59.0, 31.0, 8.0, 1.2],
                [77.0, 35.0, 8.0, 1.1],
                [91.0, 29.0, 7.0, 1.3],
                [99.0, 32.0, 12.0, 1.2],
                [-3.0, 40.0, 10.0, 1.2],
                [14.0, 48.0, 9.0, 0.9],
                [26.0, 48.0, 4.0, 0.5],
                [39.0, 47.0, 12.0, 0.6],
                [52.0, 48.0, 9.0, 0.7],
                [61.0, 48.0, 8.0, 0.6],
                [76.0, 43.0, 4.0, 0.5],
                [88.0, 42.0, 7.0, 0.8],
                [103.0, 46.0, 13.0, 0.9],
                [1.0, 55.0, 7.0, 0.8],
                [13.0, 52.0, 5.0, 1.3],
                [27.0, 52.0, 8.0, 1.2],
                [40.0, 59.0, 5.0, 0.5],
                [47.0, 52.0, 6.0, 0.8],
                [58.0, 56.0, 6.0, 0.8],
                [75.0, 60.0, 5.0, 1.2],
                [88.0, 55.0, 12.0, 1.5],
                [98.0, 53.0, 9.0, 0.9],
                [2.0, 65.0, 8.0, 1.3],
                [15.0, 61.0, 10.0, 0.6],
                [20.0, 65.0, 4.0, 1.1],
                [41.0, 64.0, 10.0, 0.7],
                [51.0, 62.0, 6.0, 0.7],
                [66.0, 69.0, 8.0, 0.9],
                [72.0, 67.0, 9.0, 1.3],
                [88.0, 66.0, 5.0, 1.5],
                [95.0, 63.0, 6.0, 0.7],
                [1.0, 79.0, 9.0, 0.6],
                [16.0, 75.0, 7.0, 0.6],
                [24.0, 73.0, 6.0, 1.1],
                [33.0, 81.0, 5.0, 0.6],
                [53.0, 82.0, 6.0, 0.7],
                [58.0, 79.0, 9.0, 1.3],
                [72.0, 78.0, 6.0, 1.5],
                [86.0, 72.0, 7.0, 0.9],
                [99.0, 80.0, 12.0, 1.2],
                [-4.0, 84.0, 7.0, 0.6],
                [12.0, 92.0, 7.0, 1.4],
                [29.0, 86.0, 4.0, 1.1],
                [33.0, 86.0, 4.0, 0.7],
                [46.0, 91.0, 4.0, 0.8],
                [62.0, 92.0, 9.0, 0.6],
                [78.0, 84.0, 11.0, 1.2],
                [89.0, 86.0, 7.0, 1.0],
                [100.0, 89.0, 9.0, 0.9],
                [-2.0, 101.0, 9.0, 1.3],
                [7.0, 101.0, 10.0, 1.2],
                [21.0, 98.0, 9.0, 1.3],
                [32.0, 100.0, 5.0, 1.4],
                [48.0, 97.0, 13.0, 0.6],
                [60.0, 104.0, 11.0, 1.4],
                [70.0, 96.0, 12.0, 1.4],
                [86.0, 101.0, 12.0, 1.1],
                [100.0, 95.0, 4.0, 1.0],
                [0.0, -4.0, 18.0, 1.2],
                [10.0, 1.0, 19.0, 1.2],
                [24.0, -1.0, 16.0, 1.0],
                [37.0, -1.0, 21.0, 0.7],
                [54.0, -3.0, 17.0, 0.6],
                [59.0, -1.0, 14.0, 1.2],
                [72.0, -3.0, 14.0, 0.6],
                [88.0, 1.0, 22.0, 1.1],
                [104.0, 4.0, 22.0, 1.4],
                [-4.0, 10.0, 20.0, 0.8],
                [8.0, 13.0, 18.0, 0.6],
                [21.0, 10.0, 21.0, 0.8],
                [34.0, 13.0, 22.0, 0.8],
                [45.0, 13.0, 13.0, 0.7],
                [57.0, 14.0, 20.0, 0.7],
                [77.0, 15.0, 20.0, 1.3],
                [88.0, 12.0, 15.0, 1.1],
                [103.0, 14.0, 22.0, 1.2],
                [-1.0, 18.0, 22.0, 1.4],
                [13.0, 18.0, 16.0, 1.4],
                [26.0, 26.0, 17.0, 1.1],
                [33.0, 21.0, 20.0, 0.6],
                [45.0, 17.0, 21.0, 1.2],
                [61.0, 26.0, 22.0, 1.2],
                [74.0, 24.0, 19.0, 0.5],
                [91.0, 22.0, 20.0, 0.6],
                [95.0, 24.0, 15.0, 1.1],
                [-2.0, 29.0, 19.0, 1.3],
                [14.0, 34.0, 20.0, 1.4],
                [23.0, 32.0, 14.0, 0.8],
                [40.0, 38.0, 17.0, 0.5],
                [52.0, 34.0, 20.0, 1.1],
                [64.0, 36.0, 18.0, 0.7],
                [77.0, 38.0, 16.0, 1.0],
                [84.0, 37.0, 16.0, 0.9],
                [96.0, 32.0, 19.0, 0.9],
                [-3.0, 46.0, 13.0, 0.8],
                [10.0, 44.0, 17.0, 0.8],
                [29.0, 43.0, 16.0, 0.8],
                [42.0, 44.0, 19.0, 0.7],
                [53.0, 43.0, 14.0, 1.3],
                [61.0, 43.0, 14.0, 0.7],
                [77.0, 43.0, 22.0, 1.4],
                [89.0, 49.0, 16.0, 1.4],
                [104.0, 45.0, 17.0, 0.9],
                [-5.0, 57.0, 14.0, 1.0],
                [10.0, 51.0, 16.0, 0.7],
                [21.0, 50.0, 15.0, 1.0],
                [39.0, 55.0, 15.0, 1.2],
                [53.0, 59.0, 18.0, 0.8],
                [63.0, 53.0, 23.0, 1.1],
                [77.0, 59.0, 15.0, 1.1],
                [86.0, 52.0, 15.0, 0.6],
                [101.0, 57.0, 16.0, 1.3],
                [4.0, 64.0, 16.0, 1.3],
                [15.0, 65.0, 18.0, 0.8],
                [25.0, 64.0, 19.0, 1.3],
                [40.0, 66.0, 16.0, 0.7],
                [50.0, 71.0, 15.0, 0.5],
                [62.0, 70.0, 21.0, 1.4],
                [79.0, 66.0, 15.0, 0.9],
                [91.0, 62.0, 17.0, 0.6],
                [101.0, 71.0, 18.0, 1.1],
                [1.0, 76.0, 20.0, 1.2],
                [8.0, 76.0, 22.0, 1.2],
                [22.0, 82.0, 22.0, 1.0],
                [38.0, 78.0, 13.0, 1.0],
                [45.0, 75.0, 16.0, 0.7],
                [59.0, 77.0, 18.0, 0.9],
                [71.0, 75.0, 20.0, 1.0],
                [83.0, 75.0, 21.0, 1.3],
                [98.0, 79.0, 20.0, 1.3],
                [1.0, 88.0, 20.0, 1.4],
                [8.0, 91.0, 21.0, 0.7],
                [23.0, 85.0, 19.0, 1.2],
                [40.0, 84.0, 20.0, 1.2],
                [46.0, 92.0, 20.0, 1.0],
                [59.0, 84.0, 17.0, 0.7],
                [78.0, 85.0, 20.0, 1.2],
                [88.0, 93.0, 22.0, 1.4],
                [98.0, 85.0, 20.0, 0.6],
                [-4.0, 96.0, 13.0, 1.5],
                [12.0, 103.0, 22.0, 1.0],
                [27.0, 99.0, 19.0, 1.5],
                [33.0, 101.0, 21.0, 1.0],
                [50.0, 104.0, 15.0, 0.9],
                [59.0, 97.0, 17.0, 0.6],
                [74.0, 95.0, 22.0, 1.2],
                [89.0, 102.0, 20.0, 1.3],
                [95.0, 103.0, 19.0, 1.3],
                [-3.0, 1.0, 25.0, 1.3],
                [10.0, 2.0, 24.0, 1.0],
                [25.0, 4.0, 23.0, 1.5],
                [38.0, 0.0, 31.0, 0.7],
                [49.0, 2.0, 30.0, 0.6],
                [60.0, -2.0, 29.0, 0.8],
                [79.0, 3.0, 25.0, 1.4],
                [92.0, 1.0, 27.0, 0.8],
                [101.0, 0.0, 29.0, 0.8],
                [-3.0, 9.0, 29.0, 1.4],
                [12.0, 11.0, 23.0, 0.9],
                [22.0, 8.0, 28.0, 0.7],
                [34.0, 11.0, 23.0, 1.3],
                [45.0, 15.0, 23.0, 1.3],
                [58.0, 8.0, 27.0, 1.5],
                [71.0, 9.0, 28.0, 0.7],
                [87.0, 13.0, 25.0, 0.6],
                [104.0, 9.0, 31.0, 1.0],
                [0.0, 26.0, 25.0, 0.6],
                [14.0, 25.0, 22.0, 0.8],
                [29.0, 27.0, 30.0, 1.1],
                [39.0, 17.0, 24.0, 1.2],
                [54.0, 25.0, 30.0, 1.5],
                [67.0, 25.0, 22.0, 0.7],
                [73.0, 25.0, 25.0, 1.4],
                [87.0, 25.0, 25.0, 1.4],
                [102.0, 20.0, 24.0, 0.6],
                [2.0, 37.0, 23.0, 1.3],
                [9.0, 37.0, 23.0, 1.0],
                [28.0, 37.0, 22.0, 1.2],
                [40.0, 30.0, 26.0, 1.1],
                [45.0, 28.0, 29.0, 0.6],
                [57.0, 32.0, 26.0, 0.7],
                [78.0, 31.0, 25.0, 1.0],
                [87.0, 34.0, 26.0, 1.1],
                [102.0, 36.0, 28.0, 1.3],
                [-1.0, 46.0, 23.0, 1.0],
                [8.0, 41.0, 23.0, 1.3],
                [21.0, 45.0, 26.0, 0.7],
                [38.0, 45.0, 27.0, 0.6],
                [48.0, 48.0, 30.0, 0.9],
                [63.0, 42.0, 24.0, 0.8],
                [70.0, 41.0, 30.0, 0.8],
                [89.0, 39.0, 25.0, 1.1],
                [96.0, 47.0, 28.0, 0.7],
                [-1.0, 54.0, 30.0, 0.9],
                [9.0, 56.0, 24.0, 1.5],
                [20.0, 52.0, 32.0, 0.8],
                [38.0, 51.0, 23.0, 0.9],
                [54.0, 55.0, 27.0, 1.1],
                [62.0, 51.0, 30.0, 0.9],
                [78.0, 56.0, 30.0, 1.4],
                [89.0, 51.0, 31.0, 0.8],
                [100.0, 57.0, 25.0, 0.6],
                [2.0, 61.0, 26.0, 1.1],
                [10.0, 67.0, 23.0, 0.9],
                [23.0, 71.0, 23.0, 1.5],
                [37.0, 64.0, 31.0, 0.5],
                [47.0, 62.0, 22.0, 1.0],
                [62.0, 71.0, 24.0, 1.2],
                [71.0, 71.0, 22.0, 1.2],
                [88.0, 61.0, 30.0, 0.9],
                [103.0, 66.0, 22.0, 0.7],
                [-5.0, 76.0, 31.0, 1.1],
                [14.0, 79.0, 25.0, 0.8],
                [24.0, 74.0, 31.0, 0.8],
                [32.0, 79.0, 27.0, 1.3],
                [51.0, 72.0, 30.0, 0.8],
                [67.0, 74.0, 26.0, 1.4],
                [79.0, 74.0, 23.0, 1.0],
                [86.0, 81.0, 24.0, 1.4],
                [100.0, 82.0, 28.0, 1.1],
                [2.0, 92.0, 25.0, 0.9],
                [11.0, 89.0, 30.0, 0.6],
                [21.0, 86.0, 23.0, 1.5],
                [34.0, 91.0, 31.0, 1.5],
                [54.0, 92.0, 29.0, 1.1],
                [61.0, 89.0, 26.0, 1.0],
                [72.0, 89.0, 24.0, 1.2],
                [89.0, 91.0, 23.0, 1.2],
                [103.0, 90.0, 23.0, 0.6],
                [-1.0, 99.0, 25.0, 1.0],
                [13.0, 103.0, 26.0, 1.1],
                [29.0, 100.0, 29.0, 0.9],
                [36.0, 104.0, 22.0, 1.1],
                [47.0, 97.0, 25.0, 1.5],
                [63.0, 95.0, 30.0, 0.9],
                [70.0, 98.0, 27.0, 0.7],
                [86.0, 102.0, 29.0, 0.8],
                [97.0, 100.0, 25.0, 1.5],
                [-2.0, 3.0, 32.0, 1.3],
                [15.0, 3.0, 35.0, 1.1],
                [28.0, -5.0, 36.0, 0.5],
                [37.0, -1.0, 36.0, 0.8],
                [45.0, 3.0, 33.0, 1.3],
                [66.0, -2.0, 36.0, 1.0],
                [74.0, -3.0, 37.0, 1.1],
                [84.0, -2.0, 33.0, 1.4],
                [99.0, 3.0, 34.0, 1.3],
                [-2.0, 6.0, 37.0, 0.6],
                [11.0, 15.0, 41.0, 1.0],
                [25.0, 11.0, 36.0, 1.1],
                [41.0, 9.0, 39.0, 1.0],
                [50.0, 13.0, 32.0, 1.4],
                [59.0, 8.0, 36.0, 1.0],
                [74.0, 12.0, 31.0, 0.5],
                [90.0, 7.0, 34.0, 1.4],
                [101.0, 13.0, 33.0, 1.2],
                [-5.0, 25.0, 34.0, 1.3],
                [10.0, 26.0, 35.0, 1.4],
                [28.0, 25.0, 32.0, 1.2],
                [41.0, 22.0, 41.0, 0.8],
                [53.0, 26.0, 40.0, 1.0],
                [59.0, 20.0, 39.0, 1.1],
                [77.0, 23.0, 37.0, 0.9],
                [87.0, 24.0, 31.0, 0.6],
                [104.0, 23.0, 34.0, 1.2],
                [1.0, 29.0, 39.0, 0.6],
                [15.0, 30.0, 41.0, 1.0],
                [27.0, 31.0, 39.0, 1.2],
                [41.0, 34.0, 40.0, 0.7],
                [53.0, 34.0, 34.0, 1.0],
                [58.0, 28.0, 36.0, 1.3],
                [71.0, 35.0, 35.0, 1.0],
                [85.0, 32.0, 34.0, 0.7],
                [102.0, 32.0, 33.0, 1.0],
                [0.0, 41.0, 34.0, 0.6],
                [11.0, 43.0, 35.0, 0.8],
                [22.0, 42.0, 38.0, 1.0],
                [35.0, 43.0, 32.0, 0.6],
                [53.0, 43.0, 36.0, 0.8],
                [65.0, 45.0, 31.0, 0.9],
                [75.0, 41.0, 37.0, 1.1],
                [83.0, 44.0, 37.0, 1.5],
                [102.0, 44.0, 33.0, 1.4],
                [1.0, 55.0, 38.0, 0.8],
                [12.0, 51.0, 32.0, 0.9],
                [20.0, 55.0, 35.0, 1.1],
                [39.0, 57.0, 38.0, 1.1],
                [52.0, 56.0, 35.0, 0.6],
                [63.0, 51.0, 38.0, 0.8],
                [76.0, 51.0, 35.0, 1.4],
                [85.0, 56.0, 37.0, 0.9],
                [98.0, 59.0, 37.0, 0.8],
                [4.0, 67.0, 31.0, 1.4],
                [15.0, 70.0, 41.0, 0.6],
                [28.0, 67.0, 38.0, 0.7],
                [36.0, 70.0, 32.0, 1.4],
                [47.0, 67.0, 35.0, 1.1],
                [65.0, 68.0, 41.0, 1.0],
                [77.0, 68.0, 36.0, 1.4],
                [90.0, 70.0, 32.0, 1.3],
                [100.0, 70.0, 36.0, 0.5],
                [-4.0, 81.0, 32.0, 0.9],
                [14.0, 79.0, 39.0, 1.5],
                [26.0, 79.0, 33.0, 0.9],
                [34.0, 73.0, 40.0, 0.6],
                [47.0, 75.0, 37.0, 0.6],
                [60.0, 81.0, 40.0, 1.2],
                [74.0, 80.0, 37.0, 1.5],
                [88.0, 78.0, 31.0, 1.4],
                [97.0, 82.0, 40.0, 0.8],
                [-5.0, 92.0, 32.0, 1.2],
                [15.0, 88.0, 34.0, 0.8],
                [21.0, 89.0, 31.0, 1.2],
                [42.0, 93.0, 40.0, 0.7],
                [49.0, 90.0, 37.0, 1.3],
                [62.0, 85.0, 38.0, 1.1],
                [71.0, 84.0, 33.0, 0.7],
                [83.0, 90.0, 32.0, 1.1],
                [100.0, 87.0, 33.0, 0.8],
                [-1.0, 100.0, 35.0, 1.5],
                [11.0, 104.0, 32.0, 0.7],
                [23.0, 95.0, 40.0, 1.3],
                [33.0, 103.0, 36.0, 0.7],
                [45.0, 95.0, 35.0, 0.6],
                [58.0, 97.0, 39.0, 0.8],
                [79.0, 104.0, 35.0, 1.1],
                [83.0, 104.0, 38.0, 0.9],
                [97.0, 100.0, 37.0, 0.6],
                [2.0, -2.0, 47.0, 1.3],
                [16.0, -3.0, 46.0, 1.4],
                [23.0, 4.0, 49.0, 0.9],
                [42.0, -5.0, 48.0, 0.7],
                [48.0, -2.0, 45.0, 1.5],
                [59.0, 2.0, 48.0, 1.5],
                [75.0, 1.0, 47.0, 0.7],
                [84.0, 1.0, 42.0, 0.7],
                [103.0, -3.0, 43.0, 0.6],
                [0.0, 8.0, 48.0, 1.0],
                [8.0, 8.0, 48.0, 1.1],
                [22.0, 9.0, 46.0, 0.6],
                [36.0, 10.0, 40.0, 0.6],
                [46.0, 6.0, 50.0, 0.8],
                [60.0, 12.0, 47.0, 1.5],
                [78.0, 7.0, 46.0, 0.7],
                [90.0, 12.0, 46.0, 0.7],
                [95.0, 14.0, 48.0, 0.6],
                [-5.0, 20.0, 40.0, 1.0],
                [8.0, 20.0, 43.0, 1.4],
                [28.0, 22.0, 42.0, 0.7],
                [38.0, 19.0, 46.0, 0.9],
                [47.0, 27.0, 46.0, 0.6],
                [59.0, 22.0, 45.0, 0.9],
                [79.0, 22.0, 43.0, 0.8],
                [85.0, 26.0, 41.0, 0.7],
                [99.0, 22.0, 44.0, 1.2],
                [3.0, 33.0, 44.0, 0.5],
                [11.0, 33.0, 40.0, 0.7],
                [24.0, 28.0, 45.0, 0.8],
                [37.0, 30.0, 48.0, 1.4],
                [47.0, 34.0, 48.0, 0.7],
                [59.0, 36.0, 48.0, 0.8],
                [76.0, 30.0, 42.0, 1.2],
                [87.0, 37.0, 43.0, 0.7],
                [104.0, 37.0, 47.0, 0.8],
                [-5.0, 42.0, 44.0, 1.4],
                [13.0, 42.0, 44.0, 0.9],
                [29.0, 45.0, 44.0, 0.5],
                [41.0, 44.0, 41.0, 0.8],
                [46.0, 44.0, 43.0, 0.6],
                [63.0, 41.0, 45.0, 0.7],
                [70.0, 40.0, 41.0, 0.6],
                [88.0, 40.0, 46.0, 1.1],
                [102.0, 42.0, 40.0, 1.4],
                [-2.0, 59.0, 49.0, 1.4],
                [8.0, 52.0, 45.0, 1.4],
                [29.0, 57.0, 44.0, 0.7],
                [34.0, 56.0, 47.0, 0.5],
                [50.0, 52.0, 46.0, 1.5],
                [61.0, 54.0, 41.0, 1.4],
                [77.0, 51.0, 47.0, 0.7],
                [84.0, 56.0, 42.0, 1.1],
                [102.0, 56.0, 50.0, 1.1],
                [-3.0, 69.0, 43.0, 1.4],
                [8.0, 63.0, 49.0, 0.8],
                [25.0, 71.0, 49.0, 0.8],
                [34.0, 70.0, 48.0, 0.9],
                [54.0, 69.0, 44.0, 1.5],
                [65.0, 67.0, 41.0, 1.2],
                [73.0, 62.0, 42.0, 1.1],
                [86.0, 61.0, 40.0, 1.1],
                [98.0, 63.0, 42.0, 1.1],
                [3.0, 81.0, 43.0, 1.3],
                [14.0, 76.0, 41.0, 1.3],
                [21.0, 82.0, 42.0, 0.7],
                [41.0, 75.0, 43.0, 0.8],
                [46.0, 74.0, 47.0, 0.6],
                [62.0, 73.0, 40.0, 1.4],
                [74.0, 79.0, 43.0, 1.2],
                [90.0, 80.0, 42.0, 0.6],
                [95.0, 77.0, 50.0, 1.0],
                [4.0, 89.0, 42.0, 0.7],
                [10.0, 89.0, 49.0, 1.2],
                [25.0, 92.0, 46.0, 1.0],
                [37.0, 91.0, 45.0, 0.6],
                [54.0, 85.0, 49.0, 1.3],
                [62.0, 88.0, 50.0, 0.6],
                [78.0, 86.0, 42.0, 0.5],
                [85.0, 86.0, 40.0, 1.1],
                [100.0, 90.0, 44.0, 1.0],
                [-3.0, 101.0, 48.0, 0.6],
                [9.0, 101.0, 46.0, 1.3],
                [20.0, 95.0, 43.0, 0.9],
                [37.0, 98.0, 50.0, 1.4],
                [54.0, 97.0, 49.0, 1.0],
                [60.0, 104.0, 49.0, 1.5],
                [74.0, 100.0, 48.0, 1.2],
                [87.0, 96.0, 42.0, 0.8],
                [104.0, 103.0, 46.0, 1.2],
                [-5.0, -3.0, 56.0, 0.9],
                [9.0, 4.0, 58.0, 1.2],
                [22.0, -5.0, 52.0, 1.4],
                [34.0, -3.0, 55.0, 1.1],
                [53.0, -4.0, 52.0, 1.1],
                [60.0, -4.0, 55.0, 0.7],
                [78.0, -2.0, 50.0, 1.1],
                [89.0, 0.0, 57.0, 0.6],
                [97.0, 1.0, 54.0, 0.6],
                [4.0, 14.0, 51.0, 1.1],
                [10.0, 15.0, 54.0, 1.3],
                [24.0, 13.0, 52.0, 0.7],
                [42.0, 10.0, 53.0, 1.4],
                [45.0, 15.0, 58.0, 0.6],
                [62.0, 9.0, 58.0, 1.3],
                [74.0, 15.0, 55.0, 1.4],
                [92.0, 13.0, 52.0, 1.4],
                [99.0, 9.0, 54.0, 0.8],
                [-1.0, 25.0, 57.0, 1.4],
                [7.0, 20.0, 52.0, 1.0],
                [27.0, 22.0, 58.0, 1.1],
                [36.0, 27.0, 53.0, 0.5],
                [51.0, 25.0, 58.0, 0.9],
                [59.0, 18.0, 54.0, 1.4],
                [72.0, 25.0, 54.0, 0.7],
                [83.0, 23.0, 53.0, 1.4],
                [97.0, 19.0, 53.0, 0.7],
                [4.0, 37.0, 55.0, 1.3],
                [16.0, 36.0, 52.0, 1.0],
                [23.0, 37.0, 50.0, 1.0],
                [33.0, 37.0, 55.0, 1.2],
                [48.0, 35.0, 56.0, 0.8],
                [63.0, 29.0, 50.0, 0.6],
                [79.0, 30.0, 54.0, 1.2],
                [90.0, 30.0, 49.0, 0.9],
                [97.0, 36.0, 53.0, 1.4],
                [3.0, 45.0, 54.0, 1.2],
                [17.0, 47.0, 50.0, 1.4],
                [23.0, 45.0, 50.0, 0.7],
                [41.0, 48.0, 56.0, 1.2],
                [53.0, 42.0, 52.0, 0.7],
                [58.0, 42.0, 54.0, 1.1],
                [74.0, 41.0, 57.0, 0.8],
                [91.0, 40.0, 51.0, 0.6],
                [97.0, 47.0, 54.0, 1.1],
                [1.0, 59.0, 51.0, 0.5],
                [10.0, 55.0, 58.0, 1.4],
                [21.0, 57.0, 49.0, 1.2],
                [38.0, 54.0, 56.0, 1.4],
                [49.0, 56.0, 55.0, 1.0],
                [59.0, 53.0, 51.0, 1.4],
                [78.0, 52.0, 59.0, 1.3],
                [90.0, 59.0, 53.0, 0.5],
                [97.0, 57.0, 50.0, 1.1],
                [0.0, 70.0, 52.0, 1.3],
                [15.0, 66.0, 51.0, 1.4],
                [26.0, 70.0, 49.0, 0.6],
                [37.0, 64.0, 52.0, 0.6],
                [47.0, 69.0, 54.0, 1.1],
                [60.0, 65.0, 49.0, 1.4],
                [76.0, 66.0, 59.0, 1.2],
                [86.0, 68.0, 58.0, 0.5],
                [101.0, 63.0, 58.0, 0.6],
                [2.0, 75.0, 52.0, 0.9],
                [11.0, 73.0, 53.0, 0.6],
                [22.0, 80.0, 52.0, 0.6],
                [40.0, 78.0, 52.0, 1.3],
                [52.0, 77.0, 51.0, 0.6],
                [65.0, 77.0, 54.0, 1.0],
                [73.0, 79.0, 58.0, 1.2],
                [88.0, 73.0, 50.0, 0.7],
                [102.0, 80.0, 57.0, 1.5],
                [4.0, 85.0, 58.0, 0.6],
                [10.0, 88.0, 57.0, 1.4],
                [24.0, 90.0, 58.0, 1.2],
                [39.0, 86.0, 55.0, 1.1],
                [50.0, 88.0, 51.0, 1.2],
                [61.0, 91.0, 58.0, 1.5],
                [70.0, 89.0, 50.0, 0.8],
                [86.0, 88.0, 57.0, 1.4],
                [100.0, 87.0, 54.0, 0.9],
                [3.0, 98.0, 59.0, 0.9],
                [16.0, 96.0, 53.0, 1.4],
                [29.0, 98.0, 55.0, 1.0],
                [34.0, 100.0, 54.0, 1.4],
                [54.0, 97.0, 52.0, 1.0],
                [67.0, 96.0, 52.0, 1.0],
                [74.0, 99.0, 52.0, 1.2],
                [88.0, 99.0, 58.0, 1.0],
                [97.0, 98.0, 50.0, 1.5],
                [-2.0, -1.0, 64.0, 1.0],
                [16.0, -1.0, 66.0, 0.9],
                [20.0, 1.0, 63.0, 1.0],
                [37.0, 1.0, 64.0, 0.9],
                [50.0, 4.0, 65.0, 1.5],
                [62.0, -2.0, 61.0, 0.8],
                [72.0, 3.0, 58.0, 1.1],
                [84.0, -5.0, 59.0, 1.4],
                [97.0, -5.0, 58.0, 0.7],
                [-4.0, 6.0, 63.0, 1.2],
                [14.0, 11.0, 68.0, 0.9],
                [22.0, 12.0, 63.0, 1.5],
                [35.0, 10.0, 68.0, 1.0],
                [45.0, 15.0, 62.0, 0.7],
                [60.0, 14.0, 66.0, 0.5],
                [75.0, 12.0, 61.0, 0.8],
                [84.0, 11.0, 61.0, 1.1],
                [104.0, 15.0, 65.0, 0.8],
                [3.0, 19.0, 66.0, 0.6],
                [9.0, 25.0, 64.0, 1.5],
                [28.0, 22.0, 61.0, 0.9],
                [33.0, 23.0, 65.0, 0.6],
                [46.0, 22.0, 60.0, 1.2],
                [66.0, 24.0, 66.0, 1.0],
                [76.0, 24.0, 67.0, 1.3],
                [83.0, 22.0, 67.0, 0.5],
                [103.0, 18.0, 59.0, 0.7],
                [-5.0, 30.0, 65.0, 0.6],
                [12.0, 29.0, 61.0, 0.5],
                [27.0, 32.0, 61.0, 1.3],
                [38.0, 30.0, 60.0, 1.2],
                [49.0, 36.0, 63.0, 1.2],
                [63.0, 34.0, 63.0, 1.0],
                [73.0, 35.0, 64.0, 0.9],
                [86.0, 34.0, 62.0, 0.7],
                [96.0, 37.0, 61.0, 1.2],
                [0.0, 41.0, 63.0, 0.9],
                [13.0, 48.0, 65.0, 0.8],
                [28.0, 47.0, 62.0, 1.0],
                [37.0, 45.0, 63.0, 0.9],
                [53.0, 42.0, 67.0, 1.0],
                [61.0, 39.0, 65.0, 0.9],
                [71.0, 45.0, 64.0, 1.3],
                [88.0, 40.0, 65.0, 1.4],
                [104.0, 42.0, 64.0, 1.4],
                [-5.0, 54.0, 60.0, 0.9],
                [10.0, 58.0, 61.0, 0.8],
                [25.0, 52.0, 61.0, 0.9],
                [40.0, 57.0, 67.0, 1.2],
                [50.0, 58.0, 61.0, 0.8],
                [61.0, 55.0, 59.0, 0.7],
                [70.0, 53.0, 63.0, 1.0],
                [88.0, 53.0, 65.0, 0.7],
                [95.0, 54.0, 65.0, 1.3],
                [-1.0, 64.0, 62.0, 1.1],
                [10.0, 70.0, 67.0, 0.9],
                [28.0, 64.0, 66.0, 0.6],
                [39.0, 70.0, 66.0, 0.6],
                [52.0, 70.0, 65.0, 1.2],
                [58.0, 62.0, 63.0, 1.3],
                [74.0, 66.0, 68.0, 1.2],
                [83.0, 65.0, 61.0, 0.7],
                [96.0, 67.0, 67.0, 0.6],
                [3.0, 79.0, 63.0, 1.3],
                [14.0, 76.0, 59.0, 1.2],
                [26.0, 77.0, 65.0, 0.6],
                [41.0, 76.0, 67.0, 0.8],
                [51.0, 79.0, 64.0, 0.6],
                [60.0, 80.0, 60.0, 1.3],
                [79.0, 74.0, 63.0, 1.3],
                [88.0, 80.0, 65.0, 1.4],
                [95.0, 76.0, 60.0, 1.3],
                [-5.0, 89.0, 61.0, 0.9],
                [10.0, 85.0, 64.0, 1.1],
                [21.0, 87.0, 64.0, 0.9],
                [39.0, 84.0, 66.0, 1.2],
                [48.0, 86.0, 63.0, 0.5],
                [57.0, 91.0, 60.0, 0.7],
                [73.0, 93.0, 66.0, 0.8],
                [84.0, 89.0, 65.0, 1.4],
                [102.0, 92.0, 63.0, 1.0],
                [-1.0, 98.0, 64.0, 1.4],
                [13.0, 102.0, 59.0, 0.5],
                [23.0, 101.0, 64.0, 1.4],
                [40.0, 96.0, 61.0, 1.2],
                [45.0, 95.0, 60.0, 0.9],
                [66.0, 99.0, 64.0, 1.3],
                [70.0, 97.0, 64.0, 0.7],
                [83.0, 99.0, 63.0, 0.8],
                [98.0, 99.0, 63.0, 1.2],
                [-3.0, 4.0, 69.0, 0.8],
                [11.0, 0.0, 68.0, 1.4],
                [27.0, -2.0, 73.0, 1.3],
                [33.0, -5.0, 68.0, 0.8],
                [48.0, 2.0, 69.0, 1.3],
                [61.0, -2.0, 69.0, 1.0],
                [78.0, -1.0, 70.0, 1.2],
                [84.0, -5.0, 73.0, 1.3],
                [102.0, 2.0, 74.0, 1.2],
                [0.0, 14.0, 69.0, 1.5],
                [14.0, 9.0, 75.0, 1.1],
                [21.0, 14.0, 72.0, 0.8],
                [33.0, 8.0, 73.0, 1.5],
                [46.0, 8.0, 77.0, 1.1],
                [66.0, 10.0, 71.0, 1.1],
                [72.0, 8.0, 72.0, 0.7],
                [84.0, 14.0, 74.0, 1.0],
                [102.0, 15.0, 69.0, 1.1],
                [1.0, 23.0, 69.0, 0.8],
                [7.0, 18.0, 67.0, 1.1],
                [22.0, 25.0, 73.0, 1.1],
                [38.0, 22.0, 75.0, 1.5],
                [50.0, 22.0, 73.0, 0.9],
                [63.0, 22.0, 76.0, 1.3],
                [76.0, 26.0, 74.0, 1.0],
                [83.0, 18.0, 74.0, 1.5],
                [101.0, 23.0, 70.0, 0.9],
                [-4.0, 37.0, 72.0, 0.7],
                [15.0, 38.0, 73.0, 0.9],
                [29.0, 36.0, 76.0, 1.1],
                [35.0, 32.0, 76.0, 1.1],
                [45.0, 32.0, 71.0, 1.0],
                [66.0, 36.0, 73.0, 0.6],
                [72.0, 32.0, 72.0, 0.8],
                [83.0, 35.0, 68.0, 0.8],
                [98.0, 30.0, 70.0, 1.0],
                [4.0, 42.0, 72.0, 1.0],
                [12.0, 39.0, 70.0, 1.2],
                [27.0, 48.0, 76.0, 1.2],
                [33.0, 49.0, 72.0, 1.0],
                [47.0, 44.0, 74.0, 1.5],
                [64.0, 40.0, 68.0, 0.9],
                [73.0, 47.0, 70.0, 1.3],
                [86.0, 47.0, 72.0, 0.6],
                [95.0, 43.0, 67.0, 0.9],
                [-3.0, 54.0, 71.0, 0.6],
                [13.0, 51.0, 75.0, 0.5],
                [25.0, 52.0, 67.0, 1.2],
                [41.0, 50.0, 69.0, 0.6],
                [45.0, 58.0, 68.0, 1.2],
                [64.0, 59.0, 73.0, 1.1],
                [72.0, 56.0, 71.0, 1.2],
                [92.0, 59.0, 76.0, 1.0],
                [104.0, 51.0, 69.0, 0.5],
                [-2.0, 61.0, 75.0, 1.4],
                [9.0, 65.0, 76.0, 0.7],
                [29.0, 65.0, 72.0, 1.0],
                [40.0, 63.0, 72.0, 1.3],
                [50.0, 68.0, 72.0, 1.3],
                [61.0, 62.0, 72.0, 0.8],
                [70.0, 65.0, 73.0, 1.1],
                [87.0, 69.0, 69.0, 0.8],
                [102.0, 64.0, 69.0, 1.1],
                [1.0, 76.0, 73.0, 0.5],
                [16.0, 79.0, 77.0, 0.9],
                [23.0, 79.0, 77.0, 1.4],
                [37.0, 78.0, 71.0, 1.3],
                [54.0, 77.0, 76.0, 1.3],
                [66.0, 76.0, 68.0, 1.1],
                [76.0, 77.0, 74.0, 1.1],
                [91.0, 78.0, 68.0, 1.4],
                [98.0, 76.0, 74.0, 1.3],
                [-4.0, 86.0, 73.0, 1.1],
                [11.0, 93.0, 73.0, 1.2],
                [23.0, 87.0, 68.0, 1.3],
                [36.0, 92.0, 77.0, 1.1],
                [51.0, 91.0, 73.0, 1.5],
                [64.0, 93.0, 70.0, 1.4],
                [73.0, 90.0, 70.0, 0.5],
                [85.0, 93.0, 75.0, 0.6],
                [97.0, 87.0, 71.0, 0.5],
                [-5.0, 98.0, 71.0, 1.4],
                [11.0, 99.0, 73.0, 1.1],
                [28.0, 98.0, 70.0, 0.9],
                [35.0, 102.0, 76.0, 0.7],
                [47.0, 98.0, 70.0, 0.7],
                [65.0, 96.0, 74.0, 0.7],
                [76.0, 100.0, 68.0, 1.0],
                [84.0, 101.0, 74.0, 1.0],
                [95.0, 100.0, 71.0, 1.0],
                [-3.0, 0.0, 84.0, 0.8],
                [16.0, 2.0, 82.0, 1.1],
                [27.0, 0.0, 80.0, 1.5],
                [33.0, 0.0, 81.0, 1.4],
                [47.0, 3.0, 86.0, 0.9],
                [65.0, -4.0, 82.0, 1.2],
                [77.0, -3.0, 80.0, 0.6],
                [90.0, -1.0, 79.0, 1.1],
                [95.0, 4.0, 79.0, 1.5],
                [1.0, 10.0, 86.0, 1.2],
                [10.0, 10.0, 86.0, 1.3],
                [24.0, 11.0, 84.0, 1.2],
                [33.0, 10.0, 84.0, 1.4],
                [46.0, 16.0, 77.0, 1.1],
                [66.0, 11.0, 79.0, 0.7],
                [77.0, 14.0, 86.0, 1.2],
                [83.0, 6.0, 82.0, 0.9],
                [98.0, 10.0, 83.0, 1.1],
                [-3.0, 21.0, 80.0, 1.4],
                [12.0, 20.0, 80.0, 0.9],
                [21.0, 22.0, 79.0, 0.9],
                [42.0, 18.0, 79.0, 0.9],
                [54.0, 25.0, 84.0, 0.8],
                [62.0, 24.0, 79.0, 1.5],
                [70.0, 20.0, 81.0, 1.0],
                [83.0, 20.0, 79.0, 0.7],
                [99.0, 20.0, 78.0, 1.0],
                [-5.0, 34.0, 77.0, 1.3],
                [11.0, 32.0, 77.0, 1.0],
                [22.0, 35.0, 84.0, 1.2],
                [35.0, 34.0, 86.0, 1.5],
                [49.0, 35.0, 85.0, 1.0],
                [67.0, 37.0, 83.0, 0.6],
                [70.0, 36.0, 86.0, 0.7],
                [90.0, 30.0, 78.0, 0.7],
                [104.0, 37.0, 86.0, 1.5],
                [-4.0, 44.0, 83.0, 0.8],
                [12.0, 48.0, 86.0, 1.1],
                [25.0, 41.0, 76.0, 1.2],
                [39.0, 47.0, 78.0, 1.4],
                [54.0, 39.0, 83.0, 1.1],
                [63.0, 42.0, 79.0, 1.2],
                [73.0, 43.0, 86.0, 0.6],
                [92.0, 40.0, 79.0, 0.7],
                [100.0, 45.0, 84.0, 1.2],
                [-2.0, 56.0, 83.0, 0.9],
                [16.0, 56.0, 82.0, 1.2],
                [23.0, 58.0, 83.0, 0.6],
                [35.0, 51.0, 82.0, 0.8],
                [46.0, 54.0, 84.0, 0.7],
                [67.0, 55.0, 84.0, 0.8],
                [74.0, 54.0, 84.0, 1.2],
                [84.0, 51.0, 79.0, 1.2],
                [99.0, 58.0, 85.0, 0.9],
                [-5.0, 69.0, 79.0, 0.9],
                [14.0, 61.0, 82.0, 1.5],
                [27.0, 67.0, 77.0, 0.5],
                [38.0, 69.0, 86.0, 1.5],
                [50.0, 65.0, 77.0, 1.0],
                [60.0, 66.0, 86.0, 1.5],
                [70.0, 63.0, 82.0, 0.5],
                [90.0, 67.0, 83.0, 0.6],
                [100.0, 64.0, 80.0, 1.0],
                [2.0, 77.0, 82.0, 1.1],
                [9.0, 74.0, 79.0, 1.0],
                [20.0, 82.0, 77.0, 0.8],
                [35.0, 78.0, 83.0, 0.7],
                [45.0, 76.0, 78.0, 0.9],
                [57.0, 76.0, 77.0, 1.0],
                [73.0, 77.0, 85.0, 1.4],
                [89.0, 78.0, 84.0, 0.9],
                [102.0, 75.0, 83.0, 1.4],
                [4.0, 90.0, 80.0, 0.8],
                [10.0, 85.0, 81.0, 1.5],
                [23.0, 90.0, 85.0, 0.8],
                [33.0, 86.0, 77.0, 1.4],
                [49.0, 84.0, 84.0, 0.6],
                [64.0, 84.0, 81.0, 0.9],
                [73.0, 92.0, 79.0, 0.6],
                [88.0, 91.0, 81.0, 1.3],
                [102.0, 89.0, 79.0, 0.9],
                [-3.0, 100.0, 81.0, 1.5],
                [12.0, 99.0, 80.0, 1.2],
                [23.0, 95.0, 84.0, 0.5],
                [33.0, 98.0, 77.0, 1.2],
                [45.0, 97.0, 85.0, 1.1],
                [63.0, 102.0, 79.0, 1.5],
                [74.0, 95.0, 80.0, 1.2],
                [83.0, 99.0, 78.0, 1.3],
                [104.0, 100.0, 79.0, 1.0],
                [-5.0, -4.0, 94.0, 1.3],
                [11.0, -3.0, 94.0, 1.3],
                [21.0, -2.0, 95.0, 1.4],
                [37.0, -4.0, 92.0, 1.3],
                [52.0, -1.0, 93.0, 1.0],
                [62.0, -4.0, 93.0, 1.3],
                [74.0, -4.0, 86.0, 1.4],
                [82.0, 4.0, 85.0, 0.9],
                [104.0, -2.0, 89.0, 0.8],
                [0.0, 15.0, 87.0, 1.4],
                [16.0, 6.0, 91.0, 1.4],
                [22.0, 7.0, 89.0, 0.6],
                [35.0, 8.0, 87.0, 1.3],
                [45.0, 6.0, 95.0, 1.1],
                [62.0, 15.0, 95.0, 0.9],
                [74.0, 13.0, 86.0, 0.8],
                [91.0, 8.0, 93.0, 0.8],
                [97.0, 11.0, 92.0, 1.4],
                [-2.0, 24.0, 91.0, 1.1],
                [16.0, 17.0, 92.0, 0.9],
                [23.0, 22.0, 90.0, 1.1],
                [41.0, 22.0, 86.0, 0.7],
                [50.0, 19.0, 88.0, 0.7],
                [61.0, 25.0, 89.0, 1.3],
                [79.0, 19.0, 88.0, 1.3],
                [90.0, 18.0, 95.0, 0.6],
                [96.0, 23.0, 94.0, 1.0],
                [-1.0, 37.0, 93.0, 1.0],
                [13.0, 30.0, 86.0, 0.8],
                [23.0, 29.0, 90.0, 0.5],
                [32.0, 34.0, 91.0, 1.2],
                [46.0, 32.0, 86.0, 1.4],
                [61.0, 32.0, 90.0, 0.7],
                [74.0, 37.0, 86.0, 1.1],
                [87.0, 32.0, 88.0, 1.5],
                [98.0, 35.0, 94.0, 1.1],
                [3.0, 48.0, 92.0, 0.6],
                [9.0, 44.0, 89.0, 1.0],
                [25.0, 46.0, 85.0, 1.3],
                [41.0, 45.0, 91.0, 1.0],
                [52.0, 42.0, 88.0, 1.0],
                [58.0, 41.0, 85.0, 1.5],
                [76.0, 39.0, 95.0, 0.7],
                [90.0, 44.0, 92.0, 0.7],
                [96.0, 49.0, 89.0, 1.0],
                [-1.0, 54.0, 88.0, 0.7],
                [15.0, 57.0, 95.0, 1.3],
                [28.0, 54.0, 90.0, 1.5],
                [40.0, 53.0, 95.0, 1.2],
                [48.0, 56.0, 89.0, 1.0],
                [60.0, 56.0, 88.0, 0.6],
                [73.0, 51.0, 88.0, 1.5],
                [89.0, 51.0, 87.0, 1.2],
                [95.0, 52.0, 89.0, 1.4],
                [4.0, 62.0, 95.0, 0.6],
                [13.0, 63.0, 92.0, 1.1],
                [20.0, 69.0, 91.0, 0.9],
                [38.0, 67.0, 86.0, 1.4],
                [50.0, 64.0, 95.0, 0.6],
                [63.0, 68.0, 91.0, 1.4],
                [78.0, 66.0, 92.0, 0.5],
                [91.0, 65.0, 87.0, 1.0],
                [100.0, 70.0, 88.0, 1.4],
                [0.0, 79.0, 88.0, 1.4],
                [8.0, 77.0, 91.0, 1.2],
                [29.0, 74.0, 91.0, 1.0],
                [39.0, 81.0, 88.0, 1.0],
                [48.0, 75.0, 91.0, 1.3],
                [65.0, 77.0, 93.0, 0.8],
                [74.0, 74.0, 87.0, 1.0],
                [92.0, 81.0, 87.0, 1.1],
                [96.0, 73.0, 90.0, 0.8],
                [0.0, 93.0, 93.0, 0.9],
                [12.0, 88.0, 92.0, 1.3],
                [29.0, 87.0, 90.0, 1.2],
                [34.0, 93.0, 91.0, 0.8],
                [47.0, 90.0, 92.0, 0.8],
                [59.0, 93.0, 91.0, 1.5],
                [70.0, 89.0, 92.0, 0.7],
                [91.0, 93.0, 90.0, 1.3],
                [98.0, 87.0, 87.0, 0.8],
                [-4.0, 96.0, 95.0, 1.0],
                [9.0, 104.0, 86.0, 1.1],
                [27.0, 103.0, 86.0, 1.4],
                [39.0, 104.0, 89.0, 1.3],
                [46.0, 100.0, 95.0, 0.5],
                [59.0, 104.0, 88.0, 0.8],
                [75.0, 101.0, 94.0, 1.5],
                [82.0, 97.0, 95.0, 1.1],
                [98.0, 100.0, 93.0, 1.1],
                [1.0, 0.0, 104.0, 1.0],
                [10.0, -5.0, 95.0, 1.0],
                [23.0, -3.0, 102.0, 1.1],
                [40.0, -1.0, 97.0, 1.1],
                [46.0, 2.0, 98.0, 0.6],
                [66.0, 2.0, 103.0, 0.9],
                [75.0, 3.0, 103.0, 1.0],
                [91.0, 2.0, 102.0, 0.9],
                [104.0, -2.0, 103.0, 1.1],
                [1.0, 10.0, 99.0, 0.8],
                [12.0, 9.0, 99.0, 0.8],
                [24.0, 9.0, 95.0, 0.7],
                [37.0, 14.0, 103.0, 0.7],
                [51.0, 6.0, 104.0, 1.1],
                [67.0, 7.0, 99.0, 0.7],
                [72.0, 15.0, 98.0, 0.9],
                [85.0, 11.0, 101.0, 0.9],
                [99.0, 11.0, 97.0, 1.3],
                [0.0, 18.0, 103.0, 1.2],
                [9.0, 26.0, 97.0, 1.4],
                [20.0, 22.0, 100.0, 1.1],
                [35.0, 17.0, 97.0, 0.7],
                [50.0, 24.0, 98.0, 1.0],
                [64.0, 20.0, 95.0, 1.1],
                [74.0, 23.0, 101.0, 0.9],
                [84.0, 19.0, 97.0, 1.2],
                [97.0, 18.0, 99.0, 0.8],
                [-4.0, 30.0, 96.0, 0.5],
                [16.0, 30.0, 95.0, 1.2],
                [24.0, 34.0, 104.0, 1.0],
                [35.0, 38.0, 100.0, 0.7],
                [52.0, 36.0, 95.0, 0.6],
                [59.0, 31.0, 99.0, 1.2],
                [74.0, 34.0, 99.0, 1.1],
                [92.0, 37.0, 95.0, 1.3],
                [96.0, 34.0, 97.0, 1.4],
                [1.0, 48.0, 98.0, 0.6],
                [9.0, 48.0, 96.0, 1.4],
                [22.0, 45.0, 99.0, 0.9],
                [38.0, 39.0, 95.0, 1.4],
                [47.0, 40.0, 96.0, 1.4],
                [67.0, 46.0, 104.0, 0.6],
                [75.0, 42.0, 96.0, 0.8],
                [85.0, 47.0, 98.0, 0.7],
                [99.0, 46.0, 100.0, 1.0],
                [-5.0, 58.0, 95.0, 0.9],
                [8.0, 54.0, 102.0, 1.4],
                [23.0, 58.0, 95.0, 1.3],
                [36.0, 56.0, 101.0, 1.1],
                [54.0, 52.0, 100.0, 0.8],
                [64.0, 54.0, 100.0, 1.0],
                [71.0, 57.0, 99.0, 1.3],
                [88.0, 51.0, 97.0, 1.4],
                [96.0, 54.0, 104.0, 0.8],
                [-5.0, 68.0, 98.0, 1.2],
                [12.0, 68.0, 99.0, 1.2],
                [24.0, 66.0, 95.0, 1.0],
                [39.0, 61.0, 101.0, 1.5],
                [46.0, 66.0, 97.0, 0.7],
                [61.0, 63.0, 100.0, 1.4],
                [73.0, 70.0, 95.0, 0.6],
                [85.0, 67.0, 102.0, 0.6],
                [103.0, 68.0, 102.0, 0.7],
                [2.0, 81.0, 96.0, 1.4],
                [14.0, 82.0, 103.0, 0.8],
                [23.0, 74.0, 102.0, 1.5],
                [41.0, 80.0, 97.0, 0.8],
                [46.0, 77.0, 99.0, 0.9],
                [64.0, 82.0, 102.0, 0.8],
                [75.0, 76.0, 104.0, 1.4],
                [86.0, 81.0, 100.0, 0.6],
                [102.0, 74.0, 101.0, 1.0],
                [-5.0, 90.0, 97.0, 0.7],
                [11.0, 88.0, 100.0, 1.1],
                [29.0, 87.0, 96.0, 1.3],
                [38.0, 85.0, 101.0, 0.5],
                [49.0, 91.0, 99.0, 1.3],
                [66.0, 87.0, 101.0, 1.3],
                [77.0, 91.0, 95.0, 0.7],
                [87.0, 89.0, 103.0, 0.8],
                [96.0, 92.0, 101.0, 0.6],
                [-5.0, 101.0, 95.0, 1.0],
                [8.0, 100.0, 97.0, 0.8],
                [23.0, 99.0, 95.0, 1.0],
                [41.0, 103.0, 95.0, 0.7],
                [45.0, 103.0, 103.0, 1.3],
                [60.0, 101.0, 100.0, 1.2],
                [79.0, 99.0, 98.0, 1.0],
                [83.0, 95.0, 100.0, 0.9],
                [100.0, 98.0, 96.0, 0.6],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 2.3, 2.7, 4.3, 5.0, 5.0, 5.0, 5.0, 5.0])
        )
        basis1 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.4, 1.9, 3.1, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        basis2 = BSplineBasis(
            7,
            np.array(
                [
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.9,
                    1.9,
                    3.3,
                    4.2,
                    5.2,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                ]
            ),
        )
        vol = Volume(basis0, basis1, basis2, controlpoints, True)
        vol2 = vol.clone()
        vol2.mirror([3, 0, 0])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] = -pt2[..., 0]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_3D_p5_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [102.0, 4.0, -4.0, 0.5],
                [69.0, 73.0, 4.0, 0.8],
                [-4.0, 99.0, -5.0, 0.7],
                [-74.0, 67.0, 4.0, 1.1],
                [-99.0, 0.0, -5.0, 1.3],
                [-73.0, -71.0, -1.0, 1.2],
                [0.0, -102.0, 1.0, 1.2],
                [67.0, -70.0, -4.0, 0.8],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([-1.1, 0.0, 0.0, 0.0, 0.0, 1.0, 2.1, 2.8, 3.9, 5.0, 5.0, 5.0, 5.0, 6.0]), 0
        )
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 += np.array([0.7, 1.0, 8.0])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 0.700000
        pt2[..., 1] -= 1.000000
        pt2[..., 2] -= 8.000000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_3D_p6_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [100.0, 3.0, -4.0, 1.4],
                [88.0, 53.0, 4.0, 0.6],
                [44.0, 88.0, 0.0, 1.2],
                [-11.0, 99.0, 4.0, 1.1],
                [-70.0, 75.0, -1.0, 1.1],
                [-92.0, 24.0, 4.0, 1.0],
                [-93.0, -30.0, 2.0, 1.5],
                [-68.0, -79.0, 0.0, 0.5],
                [-17.0, -99.0, -2.0, 1.3],
                [37.0, -95.0, -3.0, 1.4],
                [81.0, -55.0, 2.0, 1.3],
            ]
        )
        basis0 = BSplineBasis(
            6,
            np.array(
                [-0.9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 1.7, 2.7, 4.4, 5.3, 6.1, 7.0, 7.0, 7.0, 7.0, 7.0, 7.7]
            ),
            0,
        )
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 *= np.array([4.0, 7.5, 7.5])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 4.000000
        pt2[..., 1] /= 7.500000
        pt2[..., 2] /= 7.500000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_curve_3D_p7_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [104.0, -3.0, 3.0, 1.2],
                [70.0, 75.0, -1.0, 0.7],
                [-2.0, 95.0, 1.0, 0.6],
                [-70.0, 67.0, 0.0, 0.9],
                [-104.0, -2.0, -1.0, 0.7],
                [-70.0, -71.0, -1.0, 1.3],
                [-2.0, -97.0, 3.0, 1.5],
                [70.0, -68.0, 3.0, 1.3],
            ]
        )
        basis0 = BSplineBasis(
            7, np.array([-0.7, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1, 2.3, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 4.1]), 0
        )
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2.mirror([0, 0, 2])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 2] = -pt2[..., 2]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_3D_p66_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [59.0, -4.0, 2.0, 1.0],
                [39.0, 41.0, -5.0, 0.6],
                [3.0, 61.0, 4.0, 0.7],
                [-47.0, 38.0, -4.0, 0.7],
                [-64.0, -4.0, -1.0, 0.9],
                [-38.0, -43.0, -4.0, 0.9],
                [-5.0, -64.0, 3.0, 0.8],
                [38.0, -44.0, -3.0, 0.5],
                [62.0, -4.0, -2.0, 0.7],
                [44.0, 48.0, 0.0, 1.3],
                [-2.0, 68.0, 2.0, 1.2],
                [-50.0, 48.0, -1.0, 1.4],
                [-63.0, -5.0, -2.0, 1.0],
                [-48.0, -47.0, 2.0, 1.3],
                [-5.0, -66.0, 2.0, 1.1],
                [44.0, -47.0, 0.0, 1.3],
                [70.0, -5.0, 3.0, 0.8],
                [52.0, 50.0, 1.0, 0.7],
                [-3.0, 66.0, 4.0, 1.2],
                [-54.0, 52.0, 4.0, 0.9],
                [-76.0, 3.0, 1.0, 1.1],
                [-48.0, -51.0, 4.0, 0.8],
                [-2.0, -69.0, -2.0, 0.6],
                [54.0, -50.0, -3.0, 1.0],
                [75.0, 1.0, -2.0, 1.5],
                [55.0, 56.0, 0.0, 1.0],
                [4.0, 76.0, -1.0, 1.2],
                [-54.0, 59.0, -4.0, 1.4],
                [-82.0, 4.0, 4.0, 1.3],
                [-53.0, -58.0, 2.0, 1.2],
                [-3.0, -82.0, -1.0, 1.5],
                [54.0, -53.0, -1.0, 0.7],
                [79.0, 4.0, 1.0, 1.3],
                [54.0, 57.0, 4.0, 0.9],
                [-4.0, 79.0, -4.0, 1.5],
                [-59.0, 58.0, -4.0, 1.2],
                [-88.0, 3.0, -1.0, 1.0],
                [-57.0, -60.0, 4.0, 0.9],
                [-1.0, -79.0, 3.0, 1.0],
                [54.0, -58.0, -4.0, 1.1],
                [88.0, -4.0, 1.0, 1.1],
                [58.0, 60.0, -1.0, 0.6],
                [1.0, 92.0, -3.0, 0.6],
                [-58.0, 60.0, 0.0, 1.4],
                [-88.0, 2.0, 4.0, 0.9],
                [-62.0, -66.0, -5.0, 0.7],
                [3.0, -88.0, 4.0, 1.2],
                [62.0, -66.0, 2.0, 0.6],
                [94.0, 3.0, 4.0, 1.1],
                [65.0, 69.0, -4.0, 0.7],
                [-2.0, 91.0, 3.0, 1.2],
                [-72.0, 65.0, -4.0, 0.7],
                [-93.0, -2.0, -2.0, 1.3],
                [-65.0, -70.0, 4.0, 1.3],
                [3.0, -91.0, 3.0, 0.8],
                [70.0, -70.0, 2.0, 1.3],
                [98.0, -2.0, -2.0, 1.2],
                [72.0, 73.0, -5.0, 0.9],
                [-2.0, 96.0, -3.0, 1.1],
                [-75.0, 66.0, 0.0, 0.6],
                [-98.0, 2.0, 4.0, 0.8],
                [-71.0, -73.0, -1.0, 0.9],
                [2.0, -104.0, -4.0, 0.6],
                [74.0, -70.0, 1.0, 1.0],
            ]
        )
        basis0 = BSplineBasis(
            6, np.array([-1.3, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.3, 2.7, 4.0, 4.0, 4.0, 4.0, 4.0, 5.0]), 0
        )
        basis1 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 2.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0])
        )
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 += np.array([7.9, 8.4, 2.5])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 7.900000
        pt2[..., 1] -= 8.400000
        pt2[..., 2] -= 2.500000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_surface_3D_p75_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [59.0, 1.0, 3.0, 1.1],
                [45.0, 40.0, 0.0, 1.1],
                [20.0, 55.0, -5.0, 0.6],
                [-21.0, 54.0, 1.0, 0.7],
                [-53.0, 39.0, -5.0, 0.7],
                [-61.0, -3.0, 1.0, 0.8],
                [-54.0, -36.0, -1.0, 0.9],
                [-21.0, -56.0, -2.0, 1.0],
                [19.0, -59.0, 4.0, 0.9],
                [47.0, -35.0, -3.0, 0.9],
                [68.0, -2.0, -3.0, 1.0],
                [49.0, 39.0, 0.0, 1.3],
                [19.0, 62.0, 2.0, 1.1],
                [-20.0, 58.0, -5.0, 1.0],
                [-52.0, 37.0, 4.0, 1.1],
                [-69.0, 0.0, 4.0, 1.3],
                [-52.0, -35.0, 2.0, 0.7],
                [-19.0, -61.0, -2.0, 1.3],
                [15.0, -61.0, 0.0, 1.1],
                [49.0, -43.0, -1.0, 1.2],
                [66.0, 1.0, -4.0, 0.8],
                [58.0, 36.0, -1.0, 0.8],
                [16.0, 62.0, 3.0, 1.0],
                [-25.0, 67.0, -1.0, 0.8],
                [-58.0, 35.0, -5.0, 1.3],
                [-66.0, -2.0, -3.0, 1.0],
                [-57.0, -41.0, 3.0, 1.1],
                [-19.0, -70.0, 3.0, 1.3],
                [16.0, -64.0, 3.0, 1.4],
                [60.0, -38.0, -4.0, 1.5],
                [77.0, -1.0, -3.0, 0.7],
                [55.0, 44.0, 2.0, 0.9],
                [25.0, 72.0, 2.0, 0.8],
                [-25.0, 66.0, -5.0, 1.2],
                [-64.0, 39.0, 3.0, 0.7],
                [-76.0, -1.0, -5.0, 0.8],
                [-58.0, -41.0, 1.0, 1.0],
                [-20.0, -71.0, -4.0, 0.5],
                [27.0, -74.0, -2.0, 0.5],
                [61.0, -49.0, 0.0, 1.4],
                [81.0, 4.0, 0.0, 0.7],
                [63.0, 50.0, 0.0, 0.7],
                [28.0, 69.0, 2.0, 1.3],
                [-26.0, 78.0, -4.0, 0.8],
                [-67.0, 47.0, -2.0, 0.8],
                [-82.0, -2.0, 4.0, 0.7],
                [-65.0, -49.0, 2.0, 0.7],
                [-26.0, -79.0, -4.0, 1.4],
                [20.0, -78.0, -1.0, 0.6],
                [66.0, -45.0, -2.0, 0.8],
                [80.0, -3.0, -1.0, 0.7],
                [69.0, 45.0, 0.0, 0.6],
                [26.0, 78.0, -4.0, 1.0],
                [-24.0, 78.0, -2.0, 1.3],
                [-64.0, 50.0, -4.0, 0.8],
                [-78.0, 1.0, 3.0, 0.7],
                [-63.0, -48.0, -5.0, 1.3],
                [-30.0, -75.0, -5.0, 0.7],
                [27.0, -75.0, 1.0, 0.6],
                [66.0, -45.0, 2.0, 0.7],
                [85.0, 1.0, 4.0, 1.5],
                [69.0, 51.0, 4.0, 0.6],
                [30.0, 84.0, -2.0, 0.6],
                [-32.0, 79.0, 0.0, 1.2],
                [-67.0, 51.0, -2.0, 0.7],
                [-87.0, 2.0, 1.0, 0.5],
                [-72.0, -54.0, 0.0, 1.0],
                [-25.0, -82.0, -5.0, 0.9],
                [31.0, -79.0, -2.0, 1.0],
                [69.0, -53.0, -2.0, 0.7],
                [94.0, 4.0, -4.0, 0.6],
                [77.0, 50.0, 0.0, 1.1],
                [24.0, 82.0, -2.0, 1.0],
                [-28.0, 85.0, -1.0, 1.5],
                [-77.0, 56.0, -5.0, 0.7],
                [-96.0, -1.0, -2.0, 0.7],
                [-70.0, -51.0, -3.0, 1.1],
                [-32.0, -86.0, 4.0, 1.5],
                [32.0, -83.0, 1.0, 1.3],
                [72.0, -50.0, -3.0, 1.2],
                [97.0, 4.0, -5.0, 0.9],
                [75.0, 51.0, 1.0, 0.9],
                [24.0, 86.0, 3.0, 0.9],
                [-26.0, 85.0, -4.0, 1.2],
                [-82.0, 52.0, 3.0, 1.2],
                [-95.0, 1.0, -2.0, 0.8],
                [-73.0, -58.0, -1.0, 0.8],
                [-33.0, -96.0, 2.0, 1.5],
                [31.0, -95.0, 4.0, 0.9],
                [77.0, -53.0, -2.0, 1.1],
                [100.0, -3.0, -1.0, 0.7],
                [76.0, 62.0, 4.0, 0.7],
                [30.0, 90.0, 3.0, 0.7],
                [-32.0, 94.0, -5.0, 0.6],
                [-82.0, 61.0, -4.0, 0.8],
                [-103.0, -1.0, 1.0, 0.6],
                [-86.0, -64.0, 3.0, 0.6],
                [-34.0, -95.0, -2.0, 0.5],
                [27.0, -97.0, -1.0, 1.3],
                [84.0, -57.0, 0.0, 0.9],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [-0.7, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 1.8, 2.9, 4.3, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.7]
            ),
            0,
        )
        basis1 = BSplineBasis(
            5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.3, 3.3, 4.0, 5.0, 6.0, 6.0, 6.0, 6.0, 6.0])
        )
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 *= np.array([3.9, 2.5, 7.5])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 3.900000
        pt2[..., 1] /= 2.500000
        pt2[..., 2] /= 7.500000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_surface_3D_p76_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [58.0, -2.0, 0.0, 1.3],
                [52.0, 29.0, -3.0, 1.4],
                [25.0, 55.0, 3.0, 0.5],
                [-11.0, 60.0, -5.0, 0.7],
                [-43.0, 47.0, 2.0, 1.1],
                [-56.0, 14.0, -2.0, 0.9],
                [-57.0, -22.0, -3.0, 0.7],
                [-42.0, -44.0, -1.0, 0.6],
                [-7.0, -58.0, 2.0, 1.2],
                [20.0, -51.0, 0.0, 0.6],
                [53.0, -36.0, -4.0, 0.5],
                [62.0, 3.0, -3.0, 1.3],
                [57.0, 35.0, -4.0, 1.5],
                [30.0, 61.0, 3.0, 1.5],
                [-6.0, 65.0, 1.0, 1.5],
                [-41.0, 52.0, 3.0, 0.6],
                [-62.0, 21.0, 4.0, 0.9],
                [-69.0, -21.0, -5.0, 0.7],
                [-41.0, -48.0, 4.0, 1.2],
                [-13.0, -62.0, -4.0, 1.1],
                [30.0, -57.0, -5.0, 1.0],
                [56.0, -40.0, 3.0, 0.7],
                [70.0, 0.0, -5.0, 0.5],
                [64.0, 42.0, 1.0, 1.3],
                [26.0, 70.0, -5.0, 0.8],
                [-14.0, 75.0, 3.0, 0.6],
                [-49.0, 59.0, 2.0, 1.2],
                [-71.0, 19.0, -5.0, 1.2],
                [-75.0, -21.0, 4.0, 0.5],
                [-47.0, -55.0, 1.0, 1.1],
                [-15.0, -71.0, 0.0, 1.1],
                [31.0, -69.0, 1.0, 1.3],
                [60.0, -36.0, -2.0, 0.9],
                [82.0, 0.0, 2.0, 1.2],
                [71.0, 41.0, 3.0, 1.5],
                [30.0, 76.0, -2.0, 1.1],
                [-15.0, 74.0, 0.0, 1.1],
                [-49.0, 58.0, -5.0, 0.5],
                [-75.0, 25.0, -4.0, 0.8],
                [-79.0, -20.0, -1.0, 0.8],
                [-54.0, -65.0, -2.0, 0.6],
                [-7.0, -82.0, 2.0, 1.3],
                [36.0, -77.0, 0.0, 0.9],
                [62.0, -47.0, 0.0, 1.0],
                [83.0, -3.0, -4.0, 1.3],
                [68.0, 50.0, 1.0, 0.9],
                [37.0, 74.0, 1.0, 1.5],
                [-17.0, 81.0, -1.0, 1.0],
                [-55.0, 65.0, -4.0, 0.7],
                [-88.0, 19.0, 0.0, 1.1],
                [-88.0, -28.0, 3.0, 0.6],
                [-58.0, -69.0, -4.0, 0.6],
                [-9.0, -90.0, 3.0, 1.0],
                [38.0, -82.0, 3.0, 0.7],
                [74.0, -43.0, 3.0, 0.9],
                [97.0, 0.0, -1.0, 1.2],
                [74.0, 48.0, 0.0, 1.0],
                [42.0, 84.0, 2.0, 0.8],
                [-15.0, 88.0, -3.0, 0.5],
                [-57.0, 66.0, 0.0, 0.8],
                [-91.0, 30.0, -3.0, 1.5],
                [-94.0, -22.0, -4.0, 0.6],
                [-62.0, -70.0, -3.0, 0.6],
                [-13.0, -89.0, -1.0, 1.3],
                [43.0, -82.0, 1.0, 1.2],
                [74.0, -46.0, -1.0, 1.1],
                [101.0, -2.0, -2.0, 0.6],
                [80.0, 57.0, -2.0, 0.6],
                [39.0, 92.0, 1.0, 0.8],
                [-11.0, 95.0, -2.0, 0.5],
                [-66.0, 77.0, -5.0, 1.0],
                [-94.0, 26.0, 4.0, 1.5],
                [-92.0, -24.0, -1.0, 0.8],
                [-63.0, -76.0, -3.0, 1.3],
                [-14.0, -97.0, 3.0, 1.4],
                [46.0, -95.0, -3.0, 0.7],
                [82.0, -51.0, -2.0, 1.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    -1.3,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.0,
                    2.2,
                    3.3,
                    4.1,
                    4.7,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    7.0,
                ]
            ),
            0,
        )
        basis1 = BSplineBasis(6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0]))
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2.mirror([0, 2, 0])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 1] = -pt2[..., 1]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_volume_3D_p777_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [46.0, -3.0, -4.0, 0.6],
                [45.0, 27.0, 0.0, 1.5],
                [24.0, 49.0, -4.0, 1.1],
                [-7.0, 45.0, -2.0, 1.2],
                [-34.0, 37.0, -1.0, 1.4],
                [-45.0, 13.0, -5.0, 1.2],
                [-45.0, -10.0, 1.0, 0.9],
                [-31.0, -39.0, -3.0, 1.1],
                [-7.0, -50.0, 0.0, 0.8],
                [18.0, -51.0, -3.0, 1.0],
                [46.0, -23.0, 3.0, 0.6],
                [54.0, 4.0, -4.0, 0.5],
                [48.0, 32.0, 4.0, 1.1],
                [24.0, 49.0, 3.0, 0.9],
                [-12.0, 58.0, -2.0, 0.6],
                [-42.0, 40.0, 2.0, 1.4],
                [-53.0, 17.0, -2.0, 1.4],
                [-54.0, -17.0, 4.0, 0.6],
                [-42.0, -43.0, 2.0, 0.8],
                [-4.0, -61.0, -5.0, 0.9],
                [20.0, -55.0, -4.0, 1.2],
                [46.0, -36.0, 2.0, 1.4],
                [66.0, 4.0, -2.0, 1.1],
                [49.0, 33.0, -2.0, 0.9],
                [22.0, 59.0, 0.0, 0.8],
                [-6.0, 60.0, 2.0, 1.2],
                [-46.0, 48.0, -1.0, 1.2],
                [-62.0, 13.0, -4.0, 0.8],
                [-62.0, -20.0, -4.0, 1.3],
                [-44.0, -47.0, -4.0, 0.7],
                [-9.0, -69.0, -5.0, 1.0],
                [30.0, -58.0, 4.0, 1.1],
                [55.0, -34.0, 3.0, 1.5],
                [67.0, -5.0, -1.0, 1.4],
                [61.0, 39.0, 1.0, 1.0],
                [31.0, 64.0, 2.0, 1.1],
                [-7.0, 75.0, -4.0, 1.5],
                [-49.0, 55.0, 3.0, 1.2],
                [-71.0, 17.0, 2.0, 0.6],
                [-73.0, -19.0, -5.0, 1.1],
                [-50.0, -51.0, -4.0, 1.3],
                [-10.0, -66.0, 2.0, 0.6],
                [27.0, -63.0, -4.0, 0.6],
                [62.0, -38.0, -2.0, 1.1],
                [74.0, -3.0, 4.0, 1.3],
                [71.0, 46.0, 0.0, 1.1],
                [35.0, 71.0, 2.0, 1.5],
                [-8.0, 78.0, 1.0, 1.0],
                [-47.0, 61.0, 3.0, 0.9],
                [-78.0, 23.0, 1.0, 0.6],
                [-79.0, -22.0, -1.0, 0.9],
                [-55.0, -64.0, 0.0, 0.7],
                [-16.0, -83.0, -1.0, 0.7],
                [28.0, -69.0, -3.0, 1.5],
                [64.0, -38.0, 1.0, 0.7],
                [84.0, 0.0, -5.0, 1.3],
                [73.0, 42.0, -1.0, 0.9],
                [40.0, 76.0, 3.0, 1.1],
                [-16.0, 85.0, 0.0, 1.5],
                [-56.0, 63.0, -5.0, 1.0],
                [-79.0, 28.0, 3.0, 1.5],
                [-87.0, -29.0, -5.0, 1.2],
                [-55.0, -63.0, 4.0, 0.7],
                [-9.0, -81.0, 1.0, 1.0],
                [30.0, -80.0, -5.0, 1.3],
                [67.0, -43.0, 1.0, 1.0],
                [95.0, 0.0, 2.0, 1.4],
                [79.0, 54.0, -5.0, 1.3],
                [43.0, 89.0, 1.0, 1.5],
                [-9.0, 87.0, -1.0, 1.0],
                [-58.0, 68.0, -4.0, 1.5],
                [-94.0, 26.0, 4.0, 1.3],
                [-87.0, -26.0, -2.0, 0.7],
                [-58.0, -68.0, -1.0, 0.8],
                [-18.0, -89.0, 3.0, 0.7],
                [39.0, -85.0, 3.0, 0.8],
                [74.0, -46.0, 3.0, 1.0],
                [96.0, 3.0, 3.0, 1.0],
                [88.0, 53.0, 0.0, 0.9],
                [39.0, 93.0, 1.0, 1.2],
                [-19.0, 100.0, -2.0, 1.0],
                [-62.0, 74.0, -3.0, 0.7],
                [-101.0, 28.0, 4.0, 1.2],
                [-96.0, -25.0, -1.0, 0.8],
                [-61.0, -72.0, -1.0, 1.1],
                [-16.0, -97.0, -4.0, 1.0],
                [40.0, -93.0, -5.0, 0.5],
                [80.0, -53.0, 3.0, 1.2],
                [48.0, -1.0, 3.0, 1.5],
                [42.0, 25.0, 0.0, 1.3],
                [19.0, 40.0, 6.0, 1.5],
                [-7.0, 47.0, 0.0, 0.7],
                [-38.0, 36.0, 7.0, 1.3],
                [-51.0, 14.0, 5.0, 0.5],
                [-46.0, -10.0, 5.0, 1.1],
                [-36.0, -42.0, 7.0, 1.0],
                [-8.0, -47.0, 6.0, 0.9],
                [18.0, -41.0, -2.0, 0.8],
                [44.0, -24.0, 5.0, 0.7],
                [56.0, 3.0, 7.0, 0.7],
                [44.0, 32.0, 5.0, 1.1],
                [21.0, 47.0, 6.0, 0.9],
                [-12.0, 52.0, -1.0, 1.4],
                [-34.0, 47.0, 2.0, 0.5],
                [-55.0, 20.0, -1.0, 0.5],
                [-52.0, -21.0, 4.0, 1.4],
                [-42.0, -45.0, 2.0, 0.6],
                [-10.0, -58.0, 5.0, 1.1],
                [27.0, -57.0, 8.0, 1.1],
                [44.0, -31.0, -2.0, 1.0],
                [65.0, 3.0, 7.0, 1.4],
                [56.0, 31.0, 7.0, 1.2],
                [27.0, 56.0, 6.0, 1.5],
                [-13.0, 60.0, 0.0, 1.4],
                [-40.0, 47.0, 4.0, 0.8],
                [-62.0, 21.0, 7.0, 1.5],
                [-59.0, -16.0, 7.0, 0.5],
                [-40.0, -46.0, -2.0, 0.6],
                [-6.0, -69.0, 3.0, 1.4],
                [25.0, -55.0, 2.0, 1.1],
                [55.0, -38.0, -1.0, 1.3],
                [71.0, 1.0, 2.0, 0.9],
                [65.0, 39.0, 8.0, 0.7],
                [27.0, 60.0, -2.0, 1.1],
                [-9.0, 68.0, 4.0, 0.9],
                [-45.0, 53.0, 4.0, 1.1],
                [-70.0, 25.0, 6.0, 1.1],
                [-68.0, -21.0, 4.0, 0.8],
                [-48.0, -57.0, -1.0, 1.0],
                [-15.0, -69.0, 8.0, 0.9],
                [25.0, -68.0, 7.0, 1.4],
                [58.0, -39.0, 5.0, 0.6],
                [77.0, -3.0, 4.0, 1.0],
                [61.0, 42.0, 7.0, 0.8],
                [32.0, 72.0, 8.0, 0.8],
                [-16.0, 78.0, 3.0, 0.8],
                [-55.0, 58.0, 7.0, 0.8],
                [-78.0, 18.0, 2.0, 0.6],
                [-80.0, -18.0, 8.0, 1.1],
                [-52.0, -59.0, -2.0, 1.3],
                [-8.0, -77.0, 0.0, 0.5],
                [37.0, -70.0, 6.0, 1.0],
                [67.0, -42.0, 6.0, 0.9],
                [82.0, -1.0, 0.0, 1.3],
                [75.0, 50.0, -1.0, 1.3],
                [31.0, 79.0, 8.0, 0.6],
                [-15.0, 87.0, 7.0, 0.6],
                [-57.0, 64.0, 6.0, 1.2],
                [-78.0, 27.0, -1.0, 1.5],
                [-87.0, -24.0, 7.0, 0.9],
                [-55.0, -64.0, 7.0, 0.7],
                [-12.0, -90.0, 7.0, 1.3],
                [35.0, -79.0, 7.0, 0.7],
                [73.0, -44.0, 6.0, 1.2],
                [89.0, -2.0, -2.0, 1.3],
                [76.0, 49.0, 1.0, 0.6],
                [36.0, 88.0, 5.0, 0.5],
                [-13.0, 89.0, 6.0, 0.6],
                [-59.0, 66.0, 8.0, 1.1],
                [-89.0, 28.0, 2.0, 0.9],
                [-88.0, -22.0, 7.0, 1.0],
                [-58.0, -66.0, 3.0, 0.7],
                [-18.0, -93.0, 2.0, 0.6],
                [37.0, -88.0, 2.0, 1.3],
                [78.0, -50.0, 0.0, 0.7],
                [98.0, -4.0, -1.0, 0.9],
                [88.0, 49.0, 1.0, 0.7],
                [37.0, 86.0, 3.0, 0.7],
                [-15.0, 102.0, 4.0, 1.1],
                [-68.0, 70.0, -2.0, 1.3],
                [-97.0, 30.0, 2.0, 1.3],
                [-96.0, -32.0, -1.0, 0.8],
                [-68.0, -79.0, 6.0, 1.4],
                [-13.0, -97.0, 2.0, 0.9],
                [37.0, -93.0, -1.0, 0.8],
                [87.0, -54.0, -1.0, 0.8],
                [49.0, 0.0, 7.0, 1.4],
                [46.0, 31.0, 10.0, 0.6],
                [17.0, 49.0, 7.0, 1.3],
                [-5.0, 45.0, 8.0, 1.5],
                [-37.0, 38.0, 11.0, 0.7],
                [-48.0, 13.0, 3.0, 1.2],
                [-47.0, -11.0, 10.0, 0.7],
                [-38.0, -36.0, 5.0, 0.8],
                [-11.0, -48.0, 2.0, 0.9],
                [19.0, -42.0, 3.0, 0.5],
                [46.0, -25.0, 8.0, 1.3],
                [58.0, 0.0, 12.0, 1.1],
                [50.0, 31.0, 2.0, 0.7],
                [24.0, 48.0, 2.0, 0.8],
                [-10.0, 60.0, 11.0, 1.4],
                [-37.0, 42.0, 4.0, 1.3],
                [-55.0, 11.0, 10.0, 0.6],
                [-53.0, -14.0, 2.0, 1.3],
                [-40.0, -42.0, 9.0, 0.9],
                [-6.0, -53.0, 8.0, 0.6],
                [22.0, -53.0, 12.0, 1.5],
                [48.0, -35.0, 5.0, 1.4],
                [63.0, 3.0, 9.0, 1.3],
                [54.0, 37.0, 3.0, 1.3],
                [22.0, 57.0, 8.0, 1.5],
                [-12.0, 64.0, 9.0, 1.0],
                [-39.0, 48.0, 11.0, 1.4],
                [-67.0, 20.0, 5.0, 0.6],
                [-64.0, -19.0, 11.0, 0.5],
                [-38.0, -51.0, 7.0, 0.8],
                [-14.0, -62.0, 3.0, 1.3],
                [25.0, -61.0, 4.0, 0.6],
                [53.0, -39.0, 11.0, 0.8],
                [69.0, 2.0, 2.0, 1.1],
                [56.0, 41.0, 4.0, 0.6],
                [30.0, 63.0, 10.0, 1.3],
                [-10.0, 74.0, 4.0, 1.1],
                [-44.0, 51.0, 8.0, 0.8],
                [-65.0, 22.0, 7.0, 1.0],
                [-69.0, -16.0, 5.0, 1.2],
                [-45.0, -54.0, 6.0, 1.0],
                [-13.0, -70.0, 4.0, 0.5],
                [31.0, -62.0, 4.0, 1.3],
                [61.0, -36.0, 6.0, 0.9],
                [78.0, -5.0, 7.0, 0.5],
                [67.0, 39.0, 8.0, 0.9],
                [28.0, 74.0, 3.0, 0.7],
                [-12.0, 77.0, 7.0, 1.5],
                [-55.0, 55.0, 10.0, 0.7],
                [-74.0, 24.0, 8.0, 1.1],
                [-77.0, -24.0, 8.0, 0.8],
                [-52.0, -60.0, 10.0, 1.3],
                [-10.0, -73.0, 4.0, 1.0],
                [27.0, -72.0, 6.0, 0.9],
                [70.0, -46.0, 11.0, 0.5],
                [87.0, -5.0, 9.0, 0.9],
                [71.0, 41.0, 5.0, 1.0],
                [36.0, 82.0, 12.0, 1.2],
                [-8.0, 86.0, 2.0, 0.9],
                [-60.0, 62.0, 9.0, 0.6],
                [-78.0, 21.0, 6.0, 0.8],
                [-84.0, -28.0, 10.0, 1.3],
                [-59.0, -62.0, 3.0, 1.2],
                [-18.0, -80.0, 10.0, 1.5],
                [38.0, -78.0, 10.0, 1.0],
                [76.0, -48.0, 7.0, 0.8],
                [88.0, 1.0, 7.0, 1.0],
                [75.0, 55.0, 4.0, 1.0],
                [43.0, 82.0, 3.0, 1.1],
                [-18.0, 92.0, 10.0, 0.5],
                [-61.0, 72.0, 4.0, 0.9],
                [-86.0, 30.0, 5.0, 1.5],
                [-90.0, -26.0, 5.0, 1.4],
                [-65.0, -69.0, 11.0, 0.7],
                [-9.0, -94.0, 9.0, 1.4],
                [40.0, -89.0, 7.0, 0.9],
                [81.0, -48.0, 7.0, 1.4],
                [101.0, -1.0, 3.0, 0.5],
                [79.0, 58.0, 7.0, 1.5],
                [46.0, 89.0, 8.0, 1.3],
                [-17.0, 97.0, 6.0, 0.5],
                [-67.0, 73.0, 8.0, 1.1],
                [-93.0, 28.0, 2.0, 1.5],
                [-93.0, -25.0, 2.0, 1.1],
                [-66.0, -73.0, 4.0, 0.8],
                [-18.0, -96.0, 9.0, 0.7],
                [43.0, -96.0, 2.0, 1.4],
                [86.0, -58.0, 9.0, 0.5],
                [47.0, -5.0, 9.0, 1.2],
                [40.0, 29.0, 9.0, 1.1],
                [16.0, 43.0, 6.0, 1.3],
                [-8.0, 51.0, 11.0, 0.9],
                [-38.0, 35.0, 6.0, 0.6],
                [-51.0, 17.0, 14.0, 1.1],
                [-51.0, -16.0, 6.0, 0.8],
                [-32.0, -37.0, 7.0, 1.2],
                [-3.0, -54.0, 12.0, 1.0],
                [22.0, -41.0, 14.0, 0.7],
                [46.0, -30.0, 11.0, 1.1],
                [52.0, -1.0, 6.0, 0.8],
                [50.0, 26.0, 7.0, 1.4],
                [19.0, 56.0, 11.0, 0.8],
                [-4.0, 57.0, 6.0, 1.1],
                [-37.0, 44.0, 8.0, 0.9],
                [-52.0, 12.0, 12.0, 0.8],
                [-55.0, -18.0, 11.0, 1.2],
                [-39.0, -46.0, 7.0, 0.8],
                [-13.0, -61.0, 12.0, 1.4],
                [26.0, -56.0, 12.0, 0.7],
                [43.0, -27.0, 6.0, 1.2],
                [65.0, 2.0, 6.0, 0.9],
                [57.0, 33.0, 11.0, 0.5],
                [23.0, 54.0, 7.0, 1.4],
                [-13.0, 64.0, 9.0, 0.6],
                [-39.0, 52.0, 10.0, 0.7],
                [-64.0, 22.0, 15.0, 1.0],
                [-66.0, -19.0, 10.0, 0.6],
                [-38.0, -48.0, 9.0, 1.1],
                [-13.0, -67.0, 12.0, 1.3],
                [31.0, -63.0, 5.0, 0.8],
                [49.0, -38.0, 9.0, 1.1],
                [73.0, 4.0, 9.0, 0.9],
                [61.0, 35.0, 7.0, 0.9],
                [31.0, 62.0, 12.0, 1.4],
                [-9.0, 73.0, 10.0, 1.2],
                [-49.0, 50.0, 15.0, 0.7],
                [-64.0, 16.0, 10.0, 1.1],
                [-66.0, -16.0, 12.0, 0.8],
                [-51.0, -50.0, 14.0, 1.3],
                [-7.0, -69.0, 10.0, 1.2],
                [33.0, -61.0, 5.0, 1.2],
                [64.0, -41.0, 6.0, 1.1],
                [83.0, -1.0, 9.0, 0.8],
                [69.0, 45.0, 11.0, 0.5],
                [28.0, 69.0, 12.0, 1.3],
                [-15.0, 78.0, 15.0, 0.7],
                [-53.0, 59.0, 7.0, 0.7],
                [-76.0, 24.0, 6.0, 1.4],
                [-76.0, -24.0, 7.0, 1.4],
                [-49.0, -58.0, 9.0, 1.3],
                [-14.0, -76.0, 9.0, 1.1],
                [35.0, -73.0, 14.0, 1.4],
                [62.0, -40.0, 6.0, 1.1],
                [82.0, -2.0, 14.0, 1.2],
                [67.0, 46.0, 15.0, 1.5],
                [38.0, 80.0, 6.0, 0.8],
                [-11.0, 82.0, 8.0, 1.4],
                [-52.0, 67.0, 7.0, 1.3],
                [-80.0, 25.0, 14.0, 0.7],
                [-82.0, -27.0, 7.0, 1.1],
                [-56.0, -62.0, 6.0, 1.2],
                [-8.0, -84.0, 9.0, 0.8],
                [31.0, -77.0, 14.0, 1.3],
                [67.0, -48.0, 13.0, 1.1],
                [95.0, 3.0, 12.0, 1.0],
                [76.0, 51.0, 14.0, 0.7],
                [42.0, 86.0, 10.0, 1.3],
                [-13.0, 94.0, 11.0, 0.9],
                [-59.0, 73.0, 14.0, 0.6],
                [-94.0, 22.0, 12.0, 0.9],
                [-89.0, -31.0, 15.0, 1.1],
                [-57.0, -69.0, 7.0, 1.5],
                [-16.0, -97.0, 15.0, 0.9],
                [33.0, -87.0, 13.0, 0.6],
                [77.0, -47.0, 7.0, 0.9],
                [102.0, 2.0, 9.0, 0.8],
                [87.0, 49.0, 12.0, 0.7],
                [40.0, 87.0, 6.0, 1.0],
                [-17.0, 99.0, 8.0, 1.2],
                [-70.0, 74.0, 9.0, 0.9],
                [-93.0, 28.0, 7.0, 1.1],
                [-100.0, -29.0, 10.0, 1.4],
                [-71.0, -79.0, 12.0, 1.1],
                [-17.0, -98.0, 15.0, 1.2],
                [43.0, -88.0, 11.0, 0.9],
                [80.0, -52.0, 10.0, 0.9],
                [49.0, -1.0, 15.0, 1.3],
                [41.0, 29.0, 11.0, 1.0],
                [25.0, 43.0, 10.0, 1.1],
                [-10.0, 52.0, 17.0, 0.8],
                [-35.0, 37.0, 19.0, 0.6],
                [-50.0, 12.0, 13.0, 1.0],
                [-48.0, -18.0, 11.0, 1.5],
                [-31.0, -40.0, 17.0, 0.5],
                [-6.0, -54.0, 17.0, 1.2],
                [15.0, -46.0, 16.0, 1.0],
                [46.0, -24.0, 18.0, 1.3],
                [57.0, 0.0, 15.0, 0.7],
                [52.0, 29.0, 10.0, 1.4],
                [27.0, 56.0, 17.0, 1.3],
                [-12.0, 59.0, 11.0, 1.2],
                [-36.0, 46.0, 15.0, 1.4],
                [-51.0, 13.0, 10.0, 1.1],
                [-58.0, -18.0, 16.0, 1.4],
                [-35.0, -44.0, 15.0, 1.1],
                [-12.0, -54.0, 14.0, 0.6],
                [21.0, -54.0, 10.0, 0.6],
                [45.0, -29.0, 18.0, 0.9],
                [64.0, 2.0, 11.0, 0.8],
                [54.0, 38.0, 16.0, 0.9],
                [21.0, 54.0, 17.0, 1.0],
                [-13.0, 58.0, 12.0, 1.0],
                [-39.0, 48.0, 13.0, 1.4],
                [-61.0, 13.0, 10.0, 0.9],
                [-58.0, -23.0, 10.0, 1.5],
                [-47.0, -47.0, 13.0, 1.1],
                [-7.0, -67.0, 13.0, 1.0],
                [30.0, -56.0, 12.0, 1.1],
                [50.0, -40.0, 15.0, 1.0],
                [75.0, -3.0, 9.0, 1.1],
                [55.0, 41.0, 10.0, 1.1],
                [28.0, 65.0, 15.0, 0.9],
                [-7.0, 69.0, 12.0, 1.1],
                [-43.0, 51.0, 18.0, 1.0],
                [-68.0, 25.0, 18.0, 1.0],
                [-66.0, -22.0, 11.0, 1.4],
                [-48.0, -54.0, 17.0, 1.4],
                [-14.0, -76.0, 15.0, 1.3],
                [25.0, -65.0, 18.0, 0.7],
                [57.0, -42.0, 14.0, 0.8],
                [80.0, 2.0, 12.0, 1.0],
                [67.0, 46.0, 18.0, 0.9],
                [29.0, 73.0, 16.0, 1.3],
                [-14.0, 76.0, 15.0, 0.9],
                [-54.0, 64.0, 15.0, 0.9],
                [-77.0, 18.0, 10.0, 0.7],
                [-78.0, -25.0, 16.0, 1.5],
                [-54.0, -56.0, 18.0, 0.6],
                [-8.0, -78.0, 11.0, 1.1],
                [34.0, -75.0, 13.0, 1.1],
                [70.0, -47.0, 14.0, 0.8],
                [84.0, 4.0, 14.0, 1.5],
                [71.0, 46.0, 11.0, 0.9],
                [32.0, 77.0, 17.0, 0.6],
                [-11.0, 80.0, 18.0, 0.7],
                [-52.0, 67.0, 19.0, 1.0],
                [-84.0, 24.0, 19.0, 0.7],
                [-83.0, -28.0, 13.0, 1.1],
                [-54.0, -67.0, 16.0, 0.5],
                [-11.0, -89.0, 19.0, 0.9],
                [32.0, -76.0, 10.0, 0.6],
                [70.0, -45.0, 10.0, 1.4],
                [92.0, 3.0, 13.0, 0.8],
                [79.0, 51.0, 17.0, 0.6],
                [35.0, 82.0, 17.0, 0.9],
                [-12.0, 90.0, 15.0, 0.8],
                [-65.0, 72.0, 16.0, 0.5],
                [-89.0, 28.0, 10.0, 0.9],
                [-94.0, -27.0, 13.0, 1.0],
                [-56.0, -70.0, 16.0, 1.5],
                [-13.0, -88.0, 15.0, 1.4],
                [34.0, -81.0, 12.0, 1.4],
                [73.0, -46.0, 18.0, 1.1],
                [103.0, -2.0, 16.0, 1.5],
                [80.0, 56.0, 14.0, 1.0],
                [44.0, 94.0, 12.0, 1.0],
                [-17.0, 94.0, 15.0, 0.7],
                [-68.0, 71.0, 15.0, 0.7],
                [-95.0, 27.0, 10.0, 1.2],
                [-93.0, -25.0, 13.0, 1.0],
                [-71.0, -75.0, 18.0, 1.3],
                [-12.0, -95.0, 14.0, 1.3],
                [39.0, -94.0, 13.0, 0.9],
                [81.0, -59.0, 16.0, 1.5],
                [46.0, -2.0, 17.0, 1.4],
                [40.0, 28.0, 16.0, 1.1],
                [16.0, 41.0, 20.0, 1.3],
                [-10.0, 47.0, 19.0, 1.3],
                [-36.0, 34.0, 18.0, 0.7],
                [-47.0, 15.0, 15.0, 1.3],
                [-47.0, -18.0, 18.0, 1.0],
                [-28.0, -43.0, 15.0, 1.4],
                [-8.0, -51.0, 14.0, 0.6],
                [17.0, -48.0, 15.0, 1.3],
                [39.0, -31.0, 14.0, 0.7],
                [59.0, 2.0, 16.0, 0.6],
                [51.0, 32.0, 18.0, 1.0],
                [23.0, 55.0, 22.0, 1.1],
                [-8.0, 58.0, 14.0, 0.6],
                [-42.0, 38.0, 18.0, 0.7],
                [-54.0, 14.0, 17.0, 1.3],
                [-52.0, -19.0, 18.0, 0.8],
                [-37.0, -45.0, 21.0, 1.2],
                [-4.0, -59.0, 22.0, 0.5],
                [22.0, -51.0, 21.0, 0.7],
                [45.0, -30.0, 21.0, 1.4],
                [60.0, 4.0, 16.0, 0.9],
                [53.0, 37.0, 15.0, 1.0],
                [30.0, 55.0, 17.0, 0.7],
                [-10.0, 68.0, 17.0, 1.2],
                [-43.0, 49.0, 14.0, 1.1],
                [-64.0, 17.0, 20.0, 1.2],
                [-66.0, -18.0, 13.0, 1.4],
                [-45.0, -52.0, 20.0, 0.7],
                [-8.0, -65.0, 20.0, 0.9],
                [23.0, -56.0, 14.0, 0.9],
                [51.0, -36.0, 16.0, 0.8],
                [71.0, 1.0, 20.0, 0.9],
                [60.0, 38.0, 14.0, 1.3],
                [29.0, 68.0, 18.0, 1.5],
                [-12.0, 69.0, 21.0, 1.1],
                [-52.0, 52.0, 13.0, 0.6],
                [-73.0, 20.0, 18.0, 0.7],
                [-73.0, -18.0, 15.0, 1.1],
                [-47.0, -57.0, 20.0, 0.8],
                [-8.0, -71.0, 13.0, 1.2],
                [28.0, -68.0, 16.0, 0.9],
                [56.0, -41.0, 20.0, 1.1],
                [77.0, 2.0, 15.0, 1.4],
                [68.0, 40.0, 14.0, 1.2],
                [31.0, 72.0, 20.0, 1.2],
                [-15.0, 75.0, 13.0, 0.9],
                [-55.0, 61.0, 20.0, 1.2],
                [-80.0, 23.0, 22.0, 1.4],
                [-73.0, -26.0, 14.0, 1.0],
                [-53.0, -64.0, 22.0, 1.4],
                [-13.0, -75.0, 18.0, 1.5],
                [32.0, -70.0, 19.0, 1.2],
                [69.0, -40.0, 19.0, 0.7],
                [86.0, -3.0, 19.0, 0.9],
                [76.0, 47.0, 13.0, 1.3],
                [33.0, 74.0, 17.0, 1.4],
                [-15.0, 82.0, 21.0, 0.9],
                [-56.0, 65.0, 21.0, 1.2],
                [-81.0, 23.0, 20.0, 0.8],
                [-88.0, -25.0, 14.0, 0.8],
                [-58.0, -70.0, 18.0, 1.0],
                [-17.0, -88.0, 14.0, 0.7],
                [39.0, -77.0, 16.0, 1.1],
                [70.0, -42.0, 14.0, 0.9],
                [92.0, -3.0, 20.0, 0.7],
                [79.0, 54.0, 18.0, 1.3],
                [33.0, 83.0, 16.0, 1.0],
                [-15.0, 87.0, 19.0, 0.5],
                [-65.0, 66.0, 14.0, 1.0],
                [-95.0, 27.0, 21.0, 0.7],
                [-85.0, -25.0, 19.0, 1.2],
                [-64.0, -68.0, 16.0, 1.0],
                [-15.0, -95.0, 15.0, 1.3],
                [35.0, -88.0, 20.0, 1.3],
                [76.0, -55.0, 14.0, 0.6],
                [98.0, -5.0, 15.0, 1.0],
                [81.0, 57.0, 22.0, 1.2],
                [37.0, 89.0, 21.0, 1.0],
                [-17.0, 100.0, 14.0, 1.2],
                [-65.0, 75.0, 16.0, 1.2],
                [-94.0, 25.0, 20.0, 1.5],
                [-95.0, -28.0, 21.0, 0.5],
                [-69.0, -80.0, 21.0, 0.9],
                [-11.0, -95.0, 13.0, 1.1],
                [37.0, -92.0, 21.0, 1.3],
                [83.0, -59.0, 17.0, 1.2],
                [45.0, 1.0, 19.0, 0.9],
                [42.0, 31.0, 23.0, 1.3],
                [19.0, 48.0, 22.0, 0.5],
                [-6.0, 51.0, 23.0, 1.3],
                [-34.0, 34.0, 20.0, 1.5],
                [-46.0, 10.0, 24.0, 1.1],
                [-46.0, -13.0, 24.0, 0.5],
                [-31.0, -42.0, 24.0, 1.1],
                [-7.0, -46.0, 23.0, 0.9],
                [17.0, -46.0, 19.0, 1.5],
                [37.0, -29.0, 18.0, 0.8],
                [54.0, 2.0, 23.0, 0.9],
                [47.0, 29.0, 19.0, 0.7],
                [26.0, 53.0, 24.0, 0.6],
                [-13.0, 54.0, 24.0, 1.3],
                [-42.0, 44.0, 17.0, 0.6],
                [-52.0, 17.0, 23.0, 1.0],
                [-56.0, -19.0, 24.0, 0.9],
                [-36.0, -45.0, 18.0, 0.8],
                [-6.0, -56.0, 24.0, 0.5],
                [20.0, -56.0, 17.0, 0.5],
                [45.0, -35.0, 23.0, 1.4],
                [68.0, -4.0, 17.0, 1.1],
                [54.0, 33.0, 19.0, 0.6],
                [30.0, 55.0, 25.0, 0.6],
                [-11.0, 67.0, 20.0, 1.0],
                [-44.0, 45.0, 17.0, 0.9],
                [-59.0, 20.0, 26.0, 1.5],
                [-60.0, -15.0, 25.0, 0.9],
                [-46.0, -53.0, 25.0, 1.4],
                [-14.0, -63.0, 25.0, 1.4],
                [21.0, -58.0, 22.0, 1.5],
                [55.0, -40.0, 20.0, 0.7],
                [74.0, -1.0, 24.0, 1.0],
                [64.0, 35.0, 23.0, 1.2],
                [25.0, 63.0, 23.0, 0.6],
                [-7.0, 68.0, 26.0, 0.8],
                [-44.0, 51.0, 21.0, 0.8],
                [-71.0, 21.0, 22.0, 1.2],
                [-68.0, -23.0, 22.0, 0.7],
                [-46.0, -52.0, 23.0, 0.8],
                [-10.0, -69.0, 26.0, 1.4],
                [32.0, -70.0, 17.0, 1.4],
                [64.0, -38.0, 22.0, 0.9],
                [75.0, 1.0, 18.0, 1.4],
                [67.0, 37.0, 21.0, 0.9],
                [31.0, 72.0, 26.0, 1.4],
                [-14.0, 80.0, 18.0, 1.4],
                [-51.0, 57.0, 21.0, 1.3],
                [-77.0, 25.0, 18.0, 1.1],
                [-72.0, -19.0, 23.0, 1.1],
                [-53.0, -57.0, 26.0, 0.7],
                [-15.0, -75.0, 20.0, 1.1],
                [30.0, -67.0, 25.0, 0.8],
                [66.0, -47.0, 22.0, 1.2],
                [82.0, -3.0, 20.0, 1.0],
                [68.0, 50.0, 23.0, 0.6],
                [33.0, 77.0, 21.0, 0.9],
                [-10.0, 81.0, 20.0, 1.3],
                [-54.0, 67.0, 21.0, 1.0],
                [-87.0, 25.0, 18.0, 1.2],
                [-79.0, -21.0, 18.0, 1.3],
                [-61.0, -70.0, 24.0, 1.4],
                [-9.0, -87.0, 25.0, 1.1],
                [35.0, -75.0, 24.0, 1.5],
                [76.0, -51.0, 22.0, 1.1],
                [91.0, 1.0, 18.0, 0.9],
                [77.0, 48.0, 24.0, 0.6],
                [41.0, 82.0, 24.0, 0.8],
                [-12.0, 96.0, 19.0, 0.6],
                [-57.0, 68.0, 19.0, 0.8],
                [-86.0, 21.0, 16.0, 1.2],
                [-89.0, -25.0, 20.0, 1.2],
                [-62.0, -72.0, 25.0, 0.8],
                [-13.0, -87.0, 18.0, 1.0],
                [36.0, -89.0, 25.0, 0.9],
                [81.0, -55.0, 24.0, 1.0],
                [99.0, 2.0, 23.0, 0.6],
                [81.0, 49.0, 17.0, 1.3],
                [40.0, 93.0, 23.0, 1.5],
                [-17.0, 95.0, 24.0, 0.8],
                [-61.0, 73.0, 22.0, 0.6],
                [-92.0, 32.0, 26.0, 1.3],
                [-99.0, -30.0, 18.0, 0.9],
                [-65.0, -80.0, 20.0, 0.7],
                [-18.0, -97.0, 23.0, 1.1],
                [42.0, -90.0, 24.0, 1.2],
                [79.0, -53.0, 25.0, 1.1],
                [50.0, 4.0, 23.0, 0.9],
                [38.0, 30.0, 28.0, 0.9],
                [16.0, 46.0, 22.0, 0.9],
                [-4.0, 51.0, 20.0, 0.5],
                [-38.0, 34.0, 20.0, 0.6],
                [-44.0, 11.0, 30.0, 1.4],
                [-46.0, -18.0, 27.0, 1.0],
                [-33.0, -38.0, 22.0, 1.0],
                [-5.0, -47.0, 28.0, 0.9],
                [24.0, -50.0, 22.0, 0.6],
                [38.0, -26.0, 21.0, 1.1],
                [56.0, 2.0, 26.0, 1.4],
                [50.0, 29.0, 20.0, 1.4],
                [21.0, 48.0, 24.0, 1.4],
                [-11.0, 56.0, 23.0, 0.9],
                [-37.0, 39.0, 26.0, 1.1],
                [-51.0, 16.0, 20.0, 1.4],
                [-57.0, -12.0, 20.0, 0.9],
                [-42.0, -43.0, 22.0, 0.6],
                [-5.0, -54.0, 29.0, 1.1],
                [23.0, -56.0, 25.0, 1.1],
                [49.0, -32.0, 26.0, 0.7],
                [67.0, 2.0, 22.0, 1.0],
                [52.0, 39.0, 29.0, 1.0],
                [29.0, 61.0, 28.0, 1.1],
                [-5.0, 65.0, 24.0, 1.2],
                [-46.0, 50.0, 21.0, 1.1],
                [-58.0, 14.0, 21.0, 0.6],
                [-61.0, -20.0, 26.0, 1.1],
                [-40.0, -47.0, 29.0, 1.3],
                [-8.0, -63.0, 21.0, 1.0],
                [29.0, -61.0, 28.0, 0.8],
                [49.0, -36.0, 25.0, 1.5],
                [72.0, 4.0, 22.0, 1.3],
                [57.0, 34.0, 21.0, 0.9],
                [33.0, 63.0, 29.0, 1.2],
                [-15.0, 74.0, 22.0, 0.8],
                [-50.0, 53.0, 25.0, 1.0],
                [-65.0, 18.0, 27.0, 0.8],
                [-70.0, -20.0, 24.0, 0.8],
                [-49.0, -51.0, 27.0, 1.4],
                [-8.0, -69.0, 22.0, 1.1],
                [29.0, -68.0, 27.0, 1.3],
                [61.0, -38.0, 21.0, 1.4],
                [81.0, -5.0, 23.0, 1.5],
                [63.0, 37.0, 30.0, 0.7],
                [34.0, 73.0, 26.0, 1.5],
                [-12.0, 76.0, 25.0, 1.2],
                [-52.0, 60.0, 21.0, 1.2],
                [-73.0, 18.0, 23.0, 1.2],
                [-72.0, -27.0, 29.0, 1.0],
                [-50.0, -61.0, 20.0, 0.8],
                [-7.0, -74.0, 24.0, 1.0],
                [29.0, -70.0, 30.0, 1.4],
                [68.0, -41.0, 25.0, 1.5],
                [87.0, -1.0, 24.0, 0.6],
                [72.0, 48.0, 24.0, 1.1],
                [40.0, 73.0, 20.0, 1.5],
                [-8.0, 86.0, 23.0, 1.2],
                [-53.0, 64.0, 23.0, 1.1],
                [-86.0, 20.0, 24.0, 0.7],
                [-86.0, -27.0, 20.0, 1.2],
                [-61.0, -69.0, 26.0, 0.9],
                [-14.0, -87.0, 27.0, 0.7],
                [31.0, -76.0, 29.0, 0.6],
                [73.0, -44.0, 23.0, 1.1],
                [88.0, -3.0, 21.0, 1.3],
                [81.0, 49.0, 26.0, 0.9],
                [38.0, 79.0, 24.0, 1.2],
                [-16.0, 96.0, 22.0, 0.7],
                [-66.0, 72.0, 21.0, 1.4],
                [-92.0, 24.0, 25.0, 0.9],
                [-93.0, -22.0, 29.0, 0.7],
                [-65.0, -73.0, 30.0, 0.9],
                [-11.0, -92.0, 22.0, 0.9],
                [37.0, -82.0, 28.0, 1.3],
                [80.0, -47.0, 25.0, 0.6],
                [102.0, 2.0, 25.0, 1.0],
                [85.0, 54.0, 24.0, 1.4],
                [42.0, 91.0, 21.0, 1.4],
                [-11.0, 101.0, 21.0, 1.5],
                [-66.0, 74.0, 26.0, 0.6],
                [-97.0, 32.0, 20.0, 0.8],
                [-101.0, -27.0, 27.0, 0.7],
                [-61.0, -75.0, 24.0, 1.5],
                [-15.0, -100.0, 27.0, 1.4],
                [37.0, -89.0, 23.0, 1.2],
                [86.0, -53.0, 27.0, 0.5],
                [51.0, 3.0, 28.0, 0.9],
                [41.0, 28.0, 33.0, 0.8],
                [19.0, 45.0, 30.0, 1.3],
                [-6.0, 51.0, 28.0, 1.1],
                [-30.0, 33.0, 32.0, 1.3],
                [-49.0, 13.0, 24.0, 0.7],
                [-45.0, -17.0, 31.0, 0.8],
                [-31.0, -33.0, 30.0, 1.0],
                [-8.0, -55.0, 27.0, 1.1],
                [25.0, -49.0, 32.0, 1.1],
                [41.0, -26.0, 25.0, 1.1],
                [60.0, -4.0, 31.0, 0.7],
                [51.0, 34.0, 28.0, 0.8],
                [23.0, 54.0, 26.0, 1.5],
                [-5.0, 55.0, 30.0, 0.5],
                [-42.0, 44.0, 25.0, 0.8],
                [-57.0, 20.0, 32.0, 0.5],
                [-60.0, -17.0, 32.0, 1.4],
                [-39.0, -45.0, 28.0, 1.1],
                [-9.0, -55.0, 31.0, 1.0],
                [26.0, -55.0, 31.0, 1.4],
                [49.0, -28.0, 26.0, 1.2],
                [61.0, 1.0, 28.0, 1.1],
                [57.0, 33.0, 27.0, 0.6],
                [22.0, 56.0, 31.0, 0.6],
                [-12.0, 60.0, 25.0, 0.5],
                [-39.0, 44.0, 27.0, 1.4],
                [-58.0, 20.0, 26.0, 1.0],
                [-63.0, -14.0, 28.0, 0.8],
                [-42.0, -47.0, 30.0, 0.7],
                [-5.0, -65.0, 26.0, 0.9],
                [23.0, -60.0, 32.0, 1.3],
                [52.0, -40.0, 27.0, 1.2],
                [74.0, 0.0, 33.0, 1.2],
                [62.0, 37.0, 27.0, 0.8],
                [25.0, 61.0, 29.0, 1.3],
                [-7.0, 74.0, 32.0, 1.1],
                [-45.0, 55.0, 28.0, 1.2],
                [-67.0, 16.0, 26.0, 0.8],
                [-70.0, -21.0, 24.0, 1.1],
                [-48.0, -57.0, 33.0, 0.8],
                [-9.0, -71.0, 29.0, 1.3],
                [32.0, -67.0, 31.0, 1.2],
                [64.0, -44.0, 33.0, 0.9],
                [80.0, 0.0, 31.0, 1.2],
                [63.0, 43.0, 32.0, 1.3],
                [28.0, 69.0, 31.0, 0.9],
                [-15.0, 80.0, 29.0, 1.5],
                [-53.0, 58.0, 31.0, 1.2],
                [-79.0, 23.0, 33.0, 0.9],
                [-73.0, -25.0, 33.0, 0.9],
                [-55.0, -62.0, 30.0, 0.6],
                [-11.0, -81.0, 28.0, 1.2],
                [29.0, -67.0, 25.0, 1.0],
                [62.0, -41.0, 26.0, 0.9],
                [85.0, 4.0, 32.0, 1.0],
                [72.0, 42.0, 27.0, 1.1],
                [35.0, 80.0, 27.0, 0.6],
                [-12.0, 88.0, 30.0, 1.2],
                [-60.0, 61.0, 28.0, 0.8],
                [-82.0, 27.0, 25.0, 1.1],
                [-80.0, -28.0, 29.0, 0.7],
                [-60.0, -61.0, 28.0, 0.7],
                [-13.0, -85.0, 31.0, 0.7],
                [30.0, -81.0, 28.0, 0.9],
                [74.0, -48.0, 24.0, 1.3],
                [91.0, 2.0, 30.0, 1.0],
                [80.0, 53.0, 32.0, 0.5],
                [39.0, 83.0, 24.0, 1.1],
                [-13.0, 92.0, 34.0, 0.6],
                [-66.0, 67.0, 33.0, 1.0],
                [-90.0, 28.0, 26.0, 1.3],
                [-87.0, -23.0, 33.0, 1.2],
                [-60.0, -72.0, 28.0, 1.5],
                [-12.0, -92.0, 26.0, 1.0],
                [34.0, -86.0, 26.0, 1.1],
                [75.0, -52.0, 25.0, 1.4],
                [103.0, 3.0, 30.0, 1.0],
                [80.0, 55.0, 28.0, 0.6],
                [42.0, 89.0, 26.0, 1.1],
                [-14.0, 94.0, 26.0, 1.2],
                [-68.0, 71.0, 28.0, 1.2],
                [-95.0, 32.0, 26.0, 0.8],
                [-92.0, -25.0, 32.0, 1.1],
                [-71.0, -76.0, 27.0, 1.1],
                [-14.0, -101.0, 28.0, 0.6],
                [40.0, -88.0, 25.0, 1.1],
                [88.0, -59.0, 28.0, 0.7],
                [45.0, -4.0, 36.0, 1.0],
                [38.0, 24.0, 28.0, 0.8],
                [25.0, 41.0, 33.0, 0.9],
                [-7.0, 49.0, 29.0, 1.1],
                [-30.0, 33.0, 31.0, 1.4],
                [-44.0, 16.0, 27.0, 1.5],
                [-48.0, -19.0, 31.0, 1.2],
                [-34.0, -41.0, 29.0, 1.1],
                [-9.0, -47.0, 36.0, 0.8],
                [16.0, -46.0, 32.0, 0.8],
                [46.0, -25.0, 34.0, 1.2],
                [59.0, 1.0, 37.0, 0.9],
                [46.0, 28.0, 30.0, 0.8],
                [24.0, 50.0, 36.0, 0.8],
                [-6.0, 52.0, 29.0, 1.1],
                [-35.0, 46.0, 32.0, 1.4],
                [-59.0, 14.0, 36.0, 1.5],
                [-51.0, -19.0, 32.0, 1.2],
                [-38.0, -43.0, 32.0, 1.2],
                [-7.0, -53.0, 34.0, 0.7],
                [23.0, -49.0, 35.0, 1.1],
                [44.0, -32.0, 35.0, 0.8],
                [63.0, 0.0, 33.0, 1.3],
                [56.0, 29.0, 30.0, 1.3],
                [23.0, 55.0, 30.0, 0.6],
                [-6.0, 59.0, 27.0, 1.0],
                [-40.0, 51.0, 28.0, 1.0],
                [-61.0, 19.0, 34.0, 0.7],
                [-58.0, -15.0, 37.0, 1.3],
                [-38.0, -52.0, 32.0, 0.7],
                [-7.0, -67.0, 28.0, 0.6],
                [25.0, -57.0, 28.0, 0.7],
                [52.0, -35.0, 29.0, 1.4],
                [74.0, -2.0, 37.0, 1.4],
                [56.0, 40.0, 35.0, 1.2],
                [34.0, 61.0, 28.0, 0.7],
                [-7.0, 67.0, 34.0, 0.8],
                [-50.0, 55.0, 34.0, 1.1],
                [-72.0, 16.0, 33.0, 1.0],
                [-72.0, -16.0, 27.0, 0.7],
                [-43.0, -52.0, 32.0, 1.4],
                [-8.0, -69.0, 33.0, 0.5],
                [27.0, -63.0, 31.0, 1.4],
                [62.0, -40.0, 31.0, 0.8],
                [83.0, -3.0, 28.0, 1.0],
                [62.0, 37.0, 31.0, 0.9],
                [33.0, 66.0, 27.0, 0.8],
                [-16.0, 79.0, 33.0, 1.2],
                [-51.0, 60.0, 33.0, 0.9],
                [-79.0, 24.0, 35.0, 0.6],
                [-73.0, -24.0, 35.0, 1.3],
                [-49.0, -58.0, 32.0, 0.5],
                [-9.0, -78.0, 35.0, 0.7],
                [33.0, -76.0, 27.0, 1.2],
                [64.0, -45.0, 28.0, 1.0],
                [88.0, 3.0, 36.0, 1.3],
                [71.0, 43.0, 36.0, 1.3],
                [34.0, 75.0, 36.0, 0.6],
                [-12.0, 80.0, 31.0, 1.1],
                [-52.0, 59.0, 35.0, 0.7],
                [-84.0, 26.0, 28.0, 1.2],
                [-87.0, -28.0, 34.0, 0.7],
                [-57.0, -64.0, 32.0, 0.7],
                [-17.0, -84.0, 29.0, 0.8],
                [38.0, -77.0, 36.0, 0.6],
                [72.0, -51.0, 30.0, 0.7],
                [91.0, 4.0, 29.0, 0.8],
                [81.0, 51.0, 32.0, 1.2],
                [40.0, 86.0, 31.0, 1.3],
                [-12.0, 88.0, 37.0, 0.7],
                [-62.0, 71.0, 32.0, 0.6],
                [-92.0, 23.0, 28.0, 0.8],
                [-89.0, -25.0, 32.0, 1.3],
                [-62.0, -68.0, 36.0, 1.2],
                [-11.0, -93.0, 37.0, 1.5],
                [36.0, -90.0, 31.0, 0.9],
                [77.0, -54.0, 33.0, 1.4],
                [102.0, -5.0, 35.0, 1.2],
                [84.0, 51.0, 31.0, 1.4],
                [45.0, 87.0, 35.0, 0.5],
                [-10.0, 97.0, 29.0, 0.6],
                [-65.0, 74.0, 33.0, 1.1],
                [-95.0, 23.0, 31.0, 0.8],
                [-97.0, -26.0, 32.0, 1.3],
                [-71.0, -79.0, 35.0, 1.3],
                [-20.0, -97.0, 29.0, 0.7],
                [42.0, -96.0, 30.0, 1.2],
                [85.0, -54.0, 32.0, 0.6],
                [54.0, -4.0, 38.0, 1.2],
                [45.0, 30.0, 33.0, 1.0],
                [25.0, 43.0, 39.0, 0.8],
                [-11.0, 51.0, 33.0, 0.7],
                [-31.0, 41.0, 32.0, 1.1],
                [-48.0, 10.0, 36.0, 0.5],
                [-51.0, -14.0, 38.0, 1.0],
                [-32.0, -40.0, 32.0, 0.9],
                [-7.0, -45.0, 38.0, 0.8],
                [21.0, -48.0, 40.0, 0.5],
                [44.0, -28.0, 41.0, 1.3],
                [53.0, -3.0, 31.0, 1.1],
                [51.0, 28.0, 32.0, 0.7],
                [22.0, 51.0, 38.0, 0.7],
                [-12.0, 56.0, 33.0, 1.2],
                [-37.0, 47.0, 37.0, 1.0],
                [-58.0, 13.0, 33.0, 0.7],
                [-54.0, -16.0, 35.0, 0.6],
                [-41.0, -39.0, 31.0, 1.3],
                [-10.0, -54.0, 41.0, 0.9],
                [27.0, -57.0, 34.0, 1.2],
                [43.0, -36.0, 35.0, 1.4],
                [59.0, -1.0, 34.0, 0.8],
                [49.0, 33.0, 35.0, 1.3],
                [31.0, 62.0, 40.0, 1.1],
                [-11.0, 62.0, 37.0, 1.4],
                [-39.0, 50.0, 36.0, 1.4],
                [-61.0, 16.0, 38.0, 1.2],
                [-62.0, -19.0, 39.0, 0.7],
                [-43.0, -48.0, 32.0, 0.7],
                [-13.0, -63.0, 35.0, 1.5],
                [29.0, -63.0, 31.0, 1.4],
                [49.0, -31.0, 40.0, 1.5],
                [73.0, 1.0, 36.0, 1.2],
                [60.0, 40.0, 36.0, 1.3],
                [26.0, 60.0, 37.0, 0.9],
                [-14.0, 67.0, 32.0, 1.1],
                [-46.0, 57.0, 40.0, 0.6],
                [-74.0, 15.0, 32.0, 1.2],
                [-66.0, -17.0, 36.0, 0.7],
                [-44.0, -53.0, 38.0, 1.4],
                [-7.0, -68.0, 34.0, 0.5],
                [27.0, -69.0, 40.0, 1.3],
                [61.0, -42.0, 37.0, 0.8],
                [75.0, -5.0, 38.0, 1.2],
                [61.0, 42.0, 31.0, 0.7],
                [37.0, 67.0, 35.0, 0.6],
                [-7.0, 73.0, 33.0, 0.8],
                [-54.0, 57.0, 41.0, 0.8],
                [-74.0, 24.0, 35.0, 1.5],
                [-81.0, -22.0, 31.0, 1.3],
                [-48.0, -58.0, 40.0, 0.7],
                [-9.0, -76.0, 39.0, 0.9],
                [36.0, -76.0, 32.0, 0.7],
                [66.0, -39.0, 33.0, 1.0],
                [86.0, 3.0, 31.0, 0.7],
                [70.0, 42.0, 40.0, 1.2],
                [33.0, 81.0, 38.0, 0.9],
                [-17.0, 81.0, 35.0, 1.1],
                [-53.0, 60.0, 40.0, 0.9],
                [-80.0, 20.0, 35.0, 1.3],
                [-81.0, -27.0, 39.0, 0.6],
                [-56.0, -65.0, 32.0, 0.8],
                [-16.0, -87.0, 33.0, 1.0],
                [35.0, -79.0, 35.0, 1.2],
                [68.0, -48.0, 35.0, 1.5],
                [96.0, -4.0, 32.0, 0.7],
                [73.0, 46.0, 39.0, 0.7],
                [38.0, 86.0, 32.0, 1.3],
                [-14.0, 96.0, 34.0, 1.4],
                [-66.0, 73.0, 37.0, 1.4],
                [-88.0, 25.0, 32.0, 1.5],
                [-89.0, -27.0, 40.0, 1.0],
                [-63.0, -66.0, 40.0, 0.7],
                [-14.0, -97.0, 37.0, 0.7],
                [42.0, -86.0, 38.0, 1.2],
                [78.0, -52.0, 36.0, 0.6],
                [103.0, -5.0, 31.0, 1.3],
                [85.0, 49.0, 33.0, 1.2],
                [39.0, 91.0, 37.0, 0.8],
                [-11.0, 94.0, 36.0, 1.0],
                [-65.0, 73.0, 33.0, 1.4],
                [-94.0, 25.0, 40.0, 1.4],
                [-94.0, -24.0, 32.0, 1.3],
                [-65.0, -81.0, 39.0, 1.1],
                [-11.0, -95.0, 33.0, 0.7],
                [44.0, -95.0, 40.0, 1.1],
                [82.0, -59.0, 32.0, 0.7],
                [52.0, 2.0, 36.0, 0.5],
                [40.0, 23.0, 43.0, 1.0],
                [19.0, 40.0, 39.0, 0.9],
                [-3.0, 54.0, 42.0, 1.5],
                [-29.0, 37.0, 44.0, 1.4],
                [-51.0, 9.0, 38.0, 0.8],
                [-47.0, -18.0, 37.0, 0.7],
                [-37.0, -36.0, 39.0, 0.7],
                [-11.0, -53.0, 37.0, 1.0],
                [19.0, -45.0, 36.0, 0.7],
                [46.0, -24.0, 44.0, 1.0],
                [54.0, -2.0, 42.0, 1.2],
                [45.0, 34.0, 37.0, 1.0],
                [26.0, 49.0, 41.0, 1.0],
                [-10.0, 53.0, 43.0, 1.2],
                [-42.0, 45.0, 38.0, 0.9],
                [-54.0, 16.0, 44.0, 0.6],
                [-56.0, -15.0, 37.0, 0.6],
                [-40.0, -46.0, 35.0, 1.0],
                [-7.0, -60.0, 36.0, 0.6],
                [25.0, -55.0, 37.0, 1.0],
                [47.0, -28.0, 38.0, 1.0],
                [63.0, -3.0, 44.0, 0.9],
                [51.0, 32.0, 35.0, 1.3],
                [26.0, 56.0, 41.0, 0.7],
                [-8.0, 66.0, 41.0, 0.6],
                [-46.0, 45.0, 43.0, 0.7],
                [-62.0, 14.0, 44.0, 0.9],
                [-67.0, -16.0, 40.0, 0.6],
                [-38.0, -46.0, 42.0, 1.3],
                [-10.0, -64.0, 36.0, 1.0],
                [29.0, -59.0, 36.0, 1.5],
                [58.0, -32.0, 39.0, 1.4],
                [75.0, -4.0, 43.0, 1.4],
                [58.0, 41.0, 40.0, 1.3],
                [30.0, 65.0, 41.0, 1.5],
                [-16.0, 67.0, 36.0, 1.0],
                [-46.0, 55.0, 40.0, 1.1],
                [-68.0, 23.0, 38.0, 0.6],
                [-69.0, -24.0, 41.0, 1.2],
                [-45.0, -50.0, 40.0, 1.4],
                [-13.0, -71.0, 41.0, 0.6],
                [34.0, -65.0, 44.0, 0.8],
                [59.0, -39.0, 38.0, 1.4],
                [82.0, -3.0, 37.0, 1.1],
                [70.0, 39.0, 37.0, 1.5],
                [32.0, 69.0, 38.0, 1.3],
                [-11.0, 73.0, 38.0, 0.7],
                [-52.0, 60.0, 38.0, 0.8],
                [-72.0, 23.0, 38.0, 0.9],
                [-78.0, -20.0, 43.0, 1.0],
                [-54.0, -59.0, 40.0, 1.0],
                [-7.0, -80.0, 35.0, 1.1],
                [35.0, -72.0, 43.0, 1.4],
                [63.0, -42.0, 38.0, 1.1],
                [90.0, 4.0, 40.0, 1.0],
                [73.0, 45.0, 41.0, 0.9],
                [39.0, 82.0, 37.0, 1.0],
                [-10.0, 86.0, 37.0, 1.1],
                [-57.0, 65.0, 42.0, 0.9],
                [-87.0, 21.0, 41.0, 1.4],
                [-82.0, -28.0, 35.0, 1.4],
                [-56.0, -68.0, 41.0, 0.9],
                [-17.0, -84.0, 44.0, 0.6],
                [35.0, -83.0, 40.0, 0.8],
                [74.0, -49.0, 37.0, 0.9],
                [96.0, 1.0, 41.0, 1.1],
                [78.0, 48.0, 37.0, 1.2],
                [39.0, 85.0, 37.0, 1.3],
                [-17.0, 90.0, 43.0, 1.0],
                [-61.0, 65.0, 42.0, 1.4],
                [-94.0, 30.0, 36.0, 1.3],
                [-89.0, -26.0, 38.0, 1.2],
                [-63.0, -71.0, 41.0, 1.1],
                [-18.0, -90.0, 37.0, 0.7],
                [38.0, -83.0, 41.0, 0.8],
                [75.0, -55.0, 36.0, 0.6],
                [98.0, 1.0, 42.0, 0.8],
                [81.0, 55.0, 38.0, 0.6],
                [40.0, 90.0, 38.0, 1.4],
                [-19.0, 103.0, 35.0, 1.1],
                [-62.0, 73.0, 36.0, 0.7],
                [-98.0, 32.0, 37.0, 0.7],
                [-99.0, -32.0, 36.0, 0.8],
                [-62.0, -77.0, 41.0, 1.0],
                [-13.0, -103.0, 40.0, 0.9],
                [37.0, -88.0, 40.0, 1.3],
                [89.0, -50.0, 38.0, 0.6],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    -1.1,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.4,
                    1.6,
                    3.1,
                    4.0,
                    4.9,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    7.4,
                ]
            ),
            0,
        )
        basis1 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0])
        )
        basis2 = BSplineBasis(
            7,
            np.array(
                [
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.7,
                    2.1,
                    3.3,
                    4.4,
                    5.2,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                ]
            ),
        )
        vol = Volume(basis0, basis1, basis2, controlpoints, True)
        vol2 = vol.clone()
        vol2 += np.array([7.8, 5.3, 5.5])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] -= 7.800000
        pt2[..., 1] -= 5.300000
        pt2[..., 2] -= 5.500000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_volume_3D_p565_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [49.0, -3.0, 3.0, 1.4],
                [31.0, 40.0, 0.0, 1.2],
                [-4.0, 54.0, 1.0, 1.2],
                [-32.0, 35.0, -2.0, 1.4],
                [-46.0, -5.0, -2.0, 1.2],
                [-33.0, -35.0, -3.0, 0.6],
                [-2.0, -47.0, -2.0, 0.5],
                [34.0, -35.0, 1.0, 1.4],
                [51.0, 0.0, -2.0, 1.3],
                [39.0, 34.0, 3.0, 1.2],
                [4.0, 52.0, 0.0, 1.3],
                [-39.0, 37.0, 1.0, 1.1],
                [-58.0, -2.0, -2.0, 1.3],
                [-45.0, -40.0, -1.0, 0.8],
                [4.0, -55.0, 0.0, 0.9],
                [41.0, -40.0, 3.0, 0.7],
                [58.0, -4.0, -3.0, 0.5],
                [47.0, 42.0, 1.0, 0.7],
                [0.0, 64.0, -4.0, 1.0],
                [-45.0, 39.0, 1.0, 0.8],
                [-61.0, -2.0, 2.0, 1.4],
                [-44.0, -40.0, 3.0, 0.7],
                [-4.0, -65.0, 1.0, 1.5],
                [39.0, -47.0, 0.0, 1.0],
                [71.0, 0.0, 2.0, 0.5],
                [48.0, 50.0, -5.0, 1.2],
                [-2.0, 67.0, -4.0, 0.7],
                [-45.0, 47.0, -5.0, 1.2],
                [-68.0, 4.0, 0.0, 0.8],
                [-46.0, -48.0, 0.0, 1.0],
                [-4.0, -71.0, 1.0, 1.0],
                [43.0, -46.0, -4.0, 0.9],
                [75.0, -1.0, 3.0, 1.2],
                [49.0, 51.0, -4.0, 1.2],
                [-5.0, 70.0, 0.0, 0.6],
                [-52.0, 46.0, 1.0, 1.4],
                [-76.0, -3.0, -3.0, 1.0],
                [-54.0, -56.0, 4.0, 1.4],
                [3.0, -77.0, 4.0, 1.2],
                [48.0, -47.0, -5.0, 1.2],
                [76.0, -1.0, 3.0, 0.7],
                [55.0, 55.0, 4.0, 1.3],
                [0.0, 81.0, -1.0, 1.1],
                [-60.0, 59.0, 1.0, 1.0],
                [-74.0, -1.0, -5.0, 1.2],
                [-57.0, -55.0, 0.0, 0.6],
                [-5.0, -82.0, 3.0, 1.4],
                [56.0, -58.0, 4.0, 1.0],
                [88.0, 3.0, 0.0, 0.8],
                [60.0, 59.0, -2.0, 0.7],
                [-3.0, 79.0, -3.0, 1.3],
                [-56.0, 62.0, -3.0, 1.2],
                [-79.0, -2.0, 1.0, 1.1],
                [-62.0, -61.0, 3.0, 0.9],
                [4.0, -83.0, 0.0, 0.6],
                [58.0, -64.0, 3.0, 1.1],
                [88.0, -4.0, 3.0, 1.4],
                [62.0, 60.0, 1.0, 1.0],
                [0.0, 86.0, -5.0, 1.2],
                [-59.0, 64.0, 4.0, 0.5],
                [-88.0, 2.0, -4.0, 0.6],
                [-67.0, -65.0, -3.0, 0.6],
                [3.0, -85.0, 3.0, 1.3],
                [59.0, -64.0, 0.0, 1.4],
                [94.0, -1.0, -1.0, 0.9],
                [71.0, 64.0, -5.0, 0.8],
                [4.0, 97.0, 0.0, 1.1],
                [-63.0, 65.0, 1.0, 1.1],
                [-100.0, 1.0, 4.0, 0.6],
                [-63.0, -71.0, -2.0, 0.6],
                [4.0, -98.0, 0.0, 1.5],
                [62.0, -69.0, -2.0, 1.3],
                [100.0, 2.0, -4.0, 1.3],
                [69.0, 69.0, 3.0, 0.6],
                [1.0, 104.0, 0.0, 1.1],
                [-66.0, 68.0, 0.0, 1.5],
                [-104.0, -2.0, 0.0, 1.0],
                [-72.0, -68.0, 3.0, 0.6],
                [3.0, -99.0, -5.0, 1.2],
                [73.0, -71.0, 2.0, 1.2],
                [54.0, 0.0, 4.0, 1.3],
                [36.0, 32.0, 5.0, 1.3],
                [-4.0, 54.0, 9.0, 1.0],
                [-41.0, 37.0, 7.0, 1.2],
                [-46.0, 1.0, 5.0, 1.4],
                [-32.0, -39.0, 2.0, 1.4],
                [-3.0, -47.0, 7.0, 1.4],
                [31.0, -33.0, 9.0, 0.9],
                [59.0, -3.0, 8.0, 1.2],
                [42.0, 35.0, 7.0, 1.2],
                [1.0, 56.0, 1.0, 1.1],
                [-38.0, 34.0, 3.0, 1.4],
                [-57.0, 2.0, 8.0, 0.7],
                [-39.0, -40.0, 5.0, 1.1],
                [3.0, -57.0, 7.0, 1.3],
                [39.0, -42.0, 6.0, 0.7],
                [60.0, -5.0, 9.0, 0.6],
                [38.0, 43.0, 9.0, 0.9],
                [4.0, 58.0, 9.0, 0.7],
                [-43.0, 38.0, 9.0, 1.3],
                [-59.0, 1.0, 7.0, 0.6],
                [-44.0, -41.0, 0.0, 1.2],
                [0.0, -66.0, 10.0, 1.3],
                [41.0, -46.0, 0.0, 1.5],
                [68.0, -4.0, 2.0, 1.0],
                [48.0, 43.0, 3.0, 1.3],
                [-5.0, 66.0, 7.0, 0.6],
                [-43.0, 42.0, 1.0, 0.5],
                [-65.0, -2.0, 10.0, 1.2],
                [-51.0, -43.0, 10.0, 0.7],
                [-5.0, -63.0, 6.0, 0.7],
                [51.0, -46.0, 9.0, 1.3],
                [69.0, 4.0, 1.0, 1.3],
                [53.0, 53.0, 6.0, 1.5],
                [-4.0, 73.0, 7.0, 0.6],
                [-52.0, 52.0, 2.0, 0.9],
                [-72.0, -1.0, 10.0, 1.0],
                [-50.0, -49.0, 5.0, 0.8],
                [-3.0, -76.0, 3.0, 0.6],
                [50.0, -56.0, 5.0, 0.6],
                [76.0, -2.0, 2.0, 1.1],
                [53.0, 54.0, 8.0, 1.4],
                [-5.0, 73.0, 3.0, 1.1],
                [-60.0, 58.0, 2.0, 1.3],
                [-75.0, -4.0, 1.0, 0.6],
                [-51.0, -51.0, 4.0, 1.0],
                [4.0, -75.0, 7.0, 0.7],
                [53.0, -55.0, 6.0, 0.8],
                [85.0, 2.0, 7.0, 1.5],
                [62.0, 61.0, 9.0, 1.0],
                [-3.0, 87.0, 10.0, 1.2],
                [-57.0, 58.0, 2.0, 1.2],
                [-81.0, -4.0, 7.0, 0.8],
                [-59.0, -60.0, 5.0, 1.0],
                [-2.0, -87.0, 10.0, 1.2],
                [63.0, -63.0, 9.0, 1.1],
                [87.0, -4.0, 0.0, 0.6],
                [63.0, 60.0, 9.0, 0.6],
                [-2.0, 90.0, 2.0, 1.4],
                [-59.0, 67.0, 8.0, 1.0],
                [-89.0, 2.0, 5.0, 0.5],
                [-58.0, -64.0, 6.0, 0.8],
                [1.0, -91.0, 8.0, 1.2],
                [65.0, -62.0, 10.0, 1.3],
                [93.0, 1.0, 0.0, 0.6],
                [66.0, 65.0, 9.0, 0.8],
                [1.0, 94.0, 7.0, 1.0],
                [-71.0, 70.0, 3.0, 0.7],
                [-96.0, -2.0, 3.0, 1.4],
                [-68.0, -71.0, 4.0, 1.2],
                [2.0, -93.0, 3.0, 0.7],
                [65.0, -71.0, 2.0, 1.4],
                [96.0, -5.0, 8.0, 1.4],
                [72.0, 68.0, 9.0, 0.8],
                [-1.0, 95.0, 3.0, 1.0],
                [-72.0, 69.0, 6.0, 1.5],
                [-96.0, 4.0, 1.0, 0.6],
                [-71.0, -73.0, 1.0, 0.9],
                [3.0, -102.0, 6.0, 0.9],
                [69.0, -72.0, 2.0, 1.3],
                [53.0, -1.0, 11.0, 0.8],
                [38.0, 31.0, 12.0, 1.0],
                [-2.0, 46.0, 12.0, 1.0],
                [-40.0, 35.0, 11.0, 1.1],
                [-50.0, -2.0, 11.0, 1.1],
                [-33.0, -36.0, 15.0, 1.3],
                [1.0, -48.0, 11.0, 1.4],
                [34.0, -37.0, 13.0, 1.4],
                [55.0, 1.0, 10.0, 0.9],
                [36.0, 42.0, 8.0, 1.1],
                [-4.0, 60.0, 16.0, 0.6],
                [-36.0, 40.0, 14.0, 0.7],
                [-58.0, -2.0, 12.0, 0.8],
                [-40.0, -42.0, 15.0, 1.0],
                [4.0, -57.0, 15.0, 0.8],
                [34.0, -38.0, 14.0, 1.3],
                [57.0, 0.0, 15.0, 0.6],
                [46.0, 46.0, 15.0, 1.1],
                [-2.0, 62.0, 12.0, 1.1],
                [-46.0, 43.0, 13.0, 0.9],
                [-65.0, 2.0, 12.0, 1.3],
                [-48.0, -46.0, 12.0, 1.4],
                [-3.0, -60.0, 8.0, 1.1],
                [47.0, -43.0, 15.0, 0.9],
                [63.0, 4.0, 14.0, 1.2],
                [43.0, 48.0, 8.0, 0.9],
                [2.0, 63.0, 8.0, 1.1],
                [-43.0, 46.0, 15.0, 1.5],
                [-71.0, -4.0, 9.0, 0.6],
                [-43.0, -50.0, 9.0, 1.1],
                [-3.0, -64.0, 12.0, 0.9],
                [49.0, -46.0, 8.0, 1.4],
                [72.0, -4.0, 11.0, 1.5],
                [53.0, 47.0, 9.0, 1.3],
                [-3.0, 71.0, 14.0, 1.3],
                [-49.0, 50.0, 12.0, 0.6],
                [-76.0, 1.0, 6.0, 1.4],
                [-51.0, -52.0, 13.0, 1.5],
                [2.0, -72.0, 11.0, 0.9],
                [48.0, -47.0, 11.0, 1.3],
                [78.0, -5.0, 8.0, 1.2],
                [50.0, 51.0, 16.0, 1.1],
                [2.0, 79.0, 8.0, 0.8],
                [-59.0, 56.0, 7.0, 1.1],
                [-81.0, 2.0, 11.0, 1.4],
                [-55.0, -55.0, 16.0, 1.0],
                [4.0, -81.0, 12.0, 1.2],
                [51.0, -54.0, 8.0, 0.6],
                [83.0, 0.0, 6.0, 0.6],
                [63.0, 59.0, 15.0, 1.4],
                [-4.0, 87.0, 13.0, 0.7],
                [-58.0, 54.0, 11.0, 1.0],
                [-84.0, 3.0, 9.0, 1.0],
                [-55.0, -63.0, 15.0, 0.8],
                [2.0, -88.0, 10.0, 1.0],
                [60.0, -58.0, 11.0, 0.5],
                [92.0, 2.0, 7.0, 1.3],
                [66.0, 65.0, 9.0, 1.4],
                [4.0, 92.0, 7.0, 0.5],
                [-67.0, 65.0, 10.0, 0.8],
                [-87.0, 4.0, 13.0, 1.2],
                [-60.0, -65.0, 15.0, 1.3],
                [0.0, -92.0, 6.0, 0.9],
                [64.0, -67.0, 6.0, 1.0],
                [91.0, -2.0, 10.0, 1.3],
                [65.0, 65.0, 16.0, 1.0],
                [-3.0, 98.0, 10.0, 1.3],
                [-69.0, 69.0, 9.0, 1.0],
                [-92.0, -2.0, 10.0, 0.9],
                [-69.0, -66.0, 11.0, 1.0],
                [0.0, -98.0, 15.0, 0.8],
                [62.0, -66.0, 11.0, 0.8],
                [103.0, -4.0, 8.0, 0.7],
                [68.0, 71.0, 9.0, 0.6],
                [1.0, 103.0, 14.0, 0.7],
                [-73.0, 68.0, 12.0, 1.0],
                [-96.0, 4.0, 14.0, 1.2],
                [-74.0, -69.0, 13.0, 1.2],
                [-5.0, -102.0, 9.0, 0.8],
                [68.0, -72.0, 7.0, 0.8],
                [50.0, -5.0, 21.0, 1.1],
                [31.0, 34.0, 15.0, 1.1],
                [2.0, 50.0, 21.0, 1.4],
                [-40.0, 35.0, 17.0, 0.6],
                [-49.0, 4.0, 12.0, 1.3],
                [-31.0, -32.0, 20.0, 0.5],
                [-4.0, -47.0, 12.0, 1.3],
                [35.0, -34.0, 13.0, 1.1],
                [53.0, 0.0, 13.0, 1.2],
                [43.0, 39.0, 22.0, 0.6],
                [0.0, 56.0, 13.0, 1.0],
                [-38.0, 36.0, 19.0, 1.1],
                [-54.0, -3.0, 13.0, 1.3],
                [-44.0, -38.0, 12.0, 1.3],
                [4.0, -53.0, 14.0, 1.0],
                [42.0, -43.0, 16.0, 0.7],
                [56.0, 2.0, 19.0, 1.4],
                [47.0, 47.0, 20.0, 0.8],
                [4.0, 59.0, 20.0, 0.8],
                [-40.0, 40.0, 19.0, 0.9],
                [-66.0, 2.0, 22.0, 0.5],
                [-45.0, -48.0, 16.0, 0.5],
                [3.0, -60.0, 19.0, 0.7],
                [41.0, -49.0, 22.0, 1.0],
                [62.0, 0.0, 20.0, 0.7],
                [47.0, 50.0, 16.0, 0.8],
                [2.0, 70.0, 14.0, 1.0],
                [-50.0, 50.0, 13.0, 1.0],
                [-63.0, 3.0, 16.0, 0.8],
                [-46.0, -51.0, 17.0, 0.9],
                [3.0, -66.0, 19.0, 1.0],
                [49.0, -48.0, 18.0, 1.1],
                [68.0, -2.0, 16.0, 1.5],
                [46.0, 54.0, 12.0, 1.1],
                [4.0, 72.0, 19.0, 1.3],
                [-48.0, 54.0, 12.0, 0.7],
                [-74.0, -1.0, 13.0, 1.2],
                [-54.0, -53.0, 16.0, 0.6],
                [-3.0, -71.0, 15.0, 0.9],
                [51.0, -52.0, 13.0, 0.9],
                [79.0, -5.0, 12.0, 1.3],
                [58.0, 56.0, 16.0, 0.8],
                [-3.0, 79.0, 19.0, 1.5],
                [-52.0, 53.0, 15.0, 1.1],
                [-75.0, 2.0, 14.0, 0.5],
                [-53.0, -60.0, 14.0, 1.4],
                [4.0, -82.0, 18.0, 0.6],
                [58.0, -56.0, 18.0, 0.7],
                [88.0, 1.0, 12.0, 0.9],
                [55.0, 58.0, 15.0, 1.3],
                [-1.0, 87.0, 13.0, 1.0],
                [-55.0, 56.0, 14.0, 1.4],
                [-79.0, -3.0, 19.0, 1.4],
                [-55.0, -61.0, 20.0, 1.2],
                [3.0, -81.0, 12.0, 0.9],
                [60.0, -64.0, 21.0, 0.6],
                [91.0, -2.0, 21.0, 1.5],
                [58.0, 63.0, 18.0, 0.7],
                [-5.0, 85.0, 17.0, 0.9],
                [-65.0, 66.0, 21.0, 1.3],
                [-87.0, 2.0, 17.0, 1.4],
                [-63.0, -66.0, 12.0, 1.3],
                [-3.0, -85.0, 20.0, 0.7],
                [60.0, -62.0, 16.0, 0.8],
                [90.0, -5.0, 12.0, 1.4],
                [62.0, 64.0, 20.0, 1.4],
                [0.0, 92.0, 20.0, 0.6],
                [-67.0, 62.0, 16.0, 0.5],
                [-94.0, -3.0, 15.0, 0.9],
                [-63.0, -65.0, 17.0, 0.6],
                [0.0, -92.0, 19.0, 0.8],
                [66.0, -64.0, 14.0, 0.6],
                [103.0, -4.0, 17.0, 0.6],
                [66.0, 73.0, 21.0, 0.8],
                [1.0, 99.0, 12.0, 1.3],
                [-67.0, 75.0, 12.0, 1.0],
                [-99.0, 1.0, 12.0, 0.7],
                [-73.0, -74.0, 12.0, 1.2],
                [1.0, -105.0, 17.0, 1.4],
                [72.0, -76.0, 19.0, 0.8],
                [50.0, 4.0, 25.0, 1.1],
                [34.0, 33.0, 19.0, 0.8],
                [2.0, 46.0, 25.0, 1.0],
                [-35.0, 32.0, 18.0, 1.2],
                [-55.0, -1.0, 26.0, 1.2],
                [-40.0, -34.0, 21.0, 0.7],
                [3.0, -53.0, 22.0, 0.6],
                [34.0, -36.0, 26.0, 1.3],
                [56.0, 3.0, 25.0, 1.2],
                [41.0, 35.0, 27.0, 0.6],
                [-3.0, 56.0, 18.0, 1.0],
                [-40.0, 34.0, 22.0, 1.2],
                [-57.0, -5.0, 20.0, 1.3],
                [-39.0, -44.0, 21.0, 0.6],
                [1.0, -61.0, 23.0, 0.7],
                [44.0, -35.0, 22.0, 0.9],
                [61.0, 4.0, 18.0, 0.9],
                [43.0, 40.0, 25.0, 1.2],
                [-2.0, 60.0, 23.0, 0.8],
                [-45.0, 39.0, 18.0, 0.6],
                [-58.0, -1.0, 20.0, 1.1],
                [-43.0, -48.0, 21.0, 1.4],
                [-2.0, -64.0, 19.0, 0.8],
                [46.0, -39.0, 25.0, 1.1],
                [66.0, -2.0, 24.0, 1.1],
                [45.0, 47.0, 27.0, 0.5],
                [4.0, 69.0, 17.0, 0.6],
                [-49.0, 47.0, 21.0, 0.9],
                [-67.0, -4.0, 26.0, 0.8],
                [-46.0, -47.0, 24.0, 0.7],
                [4.0, -68.0, 26.0, 0.8],
                [49.0, -46.0, 26.0, 0.7],
                [67.0, 4.0, 18.0, 0.6],
                [50.0, 52.0, 21.0, 1.3],
                [-5.0, 70.0, 22.0, 0.6],
                [-50.0, 51.0, 20.0, 1.1],
                [-72.0, -3.0, 24.0, 1.2],
                [-54.0, -53.0, 19.0, 1.0],
                [-4.0, -72.0, 26.0, 0.9],
                [52.0, -56.0, 19.0, 1.3],
                [78.0, -5.0, 25.0, 1.3],
                [58.0, 51.0, 18.0, 1.0],
                [-5.0, 73.0, 18.0, 1.3],
                [-55.0, 50.0, 19.0, 1.4],
                [-82.0, -1.0, 21.0, 1.2],
                [-52.0, -56.0, 21.0, 1.4],
                [0.0, -81.0, 26.0, 1.2],
                [54.0, -54.0, 21.0, 0.7],
                [82.0, 3.0, 21.0, 0.8],
                [58.0, 60.0, 24.0, 1.4],
                [1.0, 86.0, 23.0, 0.8],
                [-59.0, 60.0, 26.0, 1.3],
                [-79.0, -4.0, 27.0, 1.2],
                [-56.0, -59.0, 23.0, 1.0],
                [-4.0, -86.0, 23.0, 1.0],
                [58.0, -59.0, 26.0, 0.9],
                [89.0, 0.0, 21.0, 0.9],
                [62.0, 60.0, 22.0, 1.4],
                [0.0, 87.0, 20.0, 1.1],
                [-65.0, 64.0, 19.0, 0.6],
                [-90.0, 2.0, 19.0, 0.9],
                [-63.0, -65.0, 19.0, 1.3],
                [4.0, -92.0, 24.0, 0.6],
                [66.0, -67.0, 27.0, 0.6],
                [93.0, -3.0, 20.0, 1.0],
                [70.0, 63.0, 22.0, 1.5],
                [1.0, 89.0, 23.0, 1.1],
                [-72.0, 62.0, 21.0, 1.0],
                [-95.0, -5.0, 18.0, 0.6],
                [-66.0, -70.0, 20.0, 0.7],
                [4.0, -92.0, 26.0, 1.2],
                [69.0, -67.0, 26.0, 0.6],
                [95.0, 0.0, 18.0, 1.4],
                [67.0, 67.0, 23.0, 0.7],
                [4.0, 98.0, 26.0, 1.2],
                [-70.0, 66.0, 24.0, 0.6],
                [-104.0, 1.0, 23.0, 1.3],
                [-68.0, -71.0, 27.0, 0.6],
                [4.0, -105.0, 19.0, 1.2],
                [71.0, -69.0, 25.0, 1.4],
                [47.0, -1.0, 24.0, 0.9],
                [39.0, 33.0, 32.0, 0.8],
                [-3.0, 45.0, 29.0, 1.2],
                [-32.0, 35.0, 27.0, 1.4],
                [-55.0, 2.0, 31.0, 1.1],
                [-40.0, -37.0, 24.0, 1.3],
                [4.0, -52.0, 24.0, 1.0],
                [31.0, -31.0, 32.0, 0.8],
                [50.0, 1.0, 24.0, 0.8],
                [43.0, 41.0, 26.0, 1.3],
                [-3.0, 56.0, 24.0, 1.2],
                [-36.0, 34.0, 25.0, 0.9],
                [-53.0, 1.0, 25.0, 1.2],
                [-44.0, -43.0, 27.0, 1.3],
                [0.0, -58.0, 28.0, 1.4],
                [40.0, -44.0, 31.0, 1.1],
                [64.0, -2.0, 28.0, 1.1],
                [41.0, 47.0, 27.0, 0.5],
                [3.0, 59.0, 30.0, 1.0],
                [-40.0, 44.0, 25.0, 1.1],
                [-65.0, 3.0, 25.0, 1.1],
                [-45.0, -46.0, 32.0, 1.0],
                [-1.0, -57.0, 25.0, 1.0],
                [44.0, -47.0, 26.0, 0.7],
                [71.0, -5.0, 31.0, 0.8],
                [48.0, 48.0, 23.0, 0.9],
                [-2.0, 65.0, 26.0, 0.9],
                [-49.0, 50.0, 27.0, 0.9],
                [-71.0, 4.0, 29.0, 1.1],
                [-47.0, -49.0, 32.0, 1.1],
                [-4.0, -63.0, 27.0, 0.6],
                [48.0, -45.0, 25.0, 1.1],
                [76.0, 2.0, 26.0, 1.3],
                [51.0, 49.0, 24.0, 0.6],
                [-4.0, 71.0, 29.0, 1.4],
                [-47.0, 48.0, 29.0, 1.2],
                [-72.0, 0.0, 28.0, 1.3],
                [-50.0, -54.0, 28.0, 0.5],
                [-2.0, -73.0, 33.0, 0.6],
                [48.0, -53.0, 33.0, 1.2],
                [79.0, -4.0, 27.0, 0.6],
                [55.0, 59.0, 24.0, 0.7],
                [0.0, 73.0, 32.0, 0.8],
                [-51.0, 58.0, 25.0, 0.6],
                [-83.0, 0.0, 24.0, 0.9],
                [-51.0, -53.0, 33.0, 1.4],
                [-2.0, -80.0, 30.0, 1.4],
                [51.0, -60.0, 27.0, 0.7],
                [82.0, -3.0, 27.0, 0.8],
                [57.0, 56.0, 33.0, 0.5],
                [-1.0, 87.0, 31.0, 1.3],
                [-61.0, 60.0, 28.0, 1.2],
                [-81.0, 4.0, 24.0, 1.0],
                [-61.0, -57.0, 33.0, 1.3],
                [-4.0, -85.0, 27.0, 1.0],
                [61.0, -61.0, 32.0, 1.0],
                [86.0, 0.0, 32.0, 0.8],
                [59.0, 62.0, 27.0, 1.4],
                [-4.0, 87.0, 27.0, 0.6],
                [-66.0, 62.0, 31.0, 1.2],
                [-92.0, -1.0, 30.0, 0.5],
                [-59.0, -66.0, 24.0, 0.6],
                [-2.0, -89.0, 28.0, 1.0],
                [60.0, -61.0, 25.0, 0.8],
                [89.0, 3.0, 30.0, 0.5],
                [64.0, 66.0, 31.0, 1.1],
                [3.0, 95.0, 29.0, 0.8],
                [-70.0, 65.0, 33.0, 0.7],
                [-98.0, 3.0, 29.0, 1.4],
                [-70.0, -69.0, 27.0, 1.3],
                [2.0, -98.0, 29.0, 0.8],
                [64.0, -69.0, 28.0, 0.7],
                [99.0, 3.0, 29.0, 1.3],
                [67.0, 73.0, 25.0, 1.3],
                [0.0, 100.0, 24.0, 0.5],
                [-76.0, 73.0, 32.0, 0.6],
                [-99.0, 2.0, 24.0, 0.5],
                [-70.0, -69.0, 28.0, 0.6],
                [0.0, -105.0, 24.0, 0.9],
                [72.0, -71.0, 27.0, 1.2],
                [51.0, -4.0, 39.0, 0.6],
                [39.0, 34.0, 33.0, 0.7],
                [2.0, 45.0, 31.0, 1.3],
                [-36.0, 31.0, 29.0, 0.9],
                [-49.0, -5.0, 30.0, 0.9],
                [-41.0, -32.0, 34.0, 1.2],
                [-5.0, -47.0, 30.0, 1.5],
                [32.0, -34.0, 36.0, 0.7],
                [56.0, -5.0, 35.0, 0.6],
                [39.0, 36.0, 32.0, 0.9],
                [-5.0, 57.0, 32.0, 0.5],
                [-41.0, 36.0, 32.0, 0.9],
                [-61.0, -3.0, 31.0, 1.0],
                [-43.0, -38.0, 38.0, 1.0],
                [-1.0, -56.0, 37.0, 1.5],
                [36.0, -38.0, 29.0, 1.3],
                [57.0, 1.0, 29.0, 0.5],
                [40.0, 40.0, 29.0, 0.7],
                [-1.0, 60.0, 29.0, 0.8],
                [-48.0, 47.0, 30.0, 1.1],
                [-61.0, 4.0, 30.0, 1.1],
                [-43.0, -46.0, 30.0, 1.0],
                [-2.0, -61.0, 32.0, 1.4],
                [47.0, -47.0, 37.0, 0.6],
                [62.0, 1.0, 34.0, 0.7],
                [51.0, 49.0, 35.0, 0.6],
                [3.0, 68.0, 35.0, 0.5],
                [-47.0, 51.0, 34.0, 0.9],
                [-63.0, 1.0, 32.0, 0.9],
                [-49.0, -52.0, 35.0, 0.8],
                [3.0, -64.0, 30.0, 1.4],
                [47.0, -49.0, 32.0, 1.4],
                [73.0, -3.0, 34.0, 0.6],
                [50.0, 52.0, 31.0, 0.6],
                [3.0, 75.0, 31.0, 1.2],
                [-54.0, 50.0, 36.0, 1.2],
                [-71.0, 0.0, 31.0, 1.3],
                [-51.0, -47.0, 31.0, 1.4],
                [-4.0, -70.0, 39.0, 0.6],
                [46.0, -54.0, 36.0, 1.4],
                [73.0, 3.0, 30.0, 1.0],
                [59.0, 53.0, 33.0, 1.5],
                [0.0, 78.0, 30.0, 0.8],
                [-56.0, 59.0, 32.0, 1.1],
                [-77.0, 0.0, 32.0, 1.2],
                [-51.0, -56.0, 35.0, 1.3],
                [-3.0, -77.0, 37.0, 1.1],
                [52.0, -55.0, 34.0, 0.5],
                [86.0, 3.0, 34.0, 1.2],
                [56.0, 63.0, 37.0, 0.9],
                [-1.0, 84.0, 34.0, 0.6],
                [-56.0, 59.0, 31.0, 0.5],
                [-80.0, 2.0, 37.0, 1.1],
                [-60.0, -64.0, 31.0, 0.8],
                [2.0, -84.0, 31.0, 1.2],
                [61.0, -63.0, 34.0, 0.9],
                [85.0, -4.0, 38.0, 1.3],
                [62.0, 59.0, 29.0, 1.3],
                [1.0, 84.0, 36.0, 1.4],
                [-62.0, 59.0, 33.0, 0.8],
                [-88.0, 2.0, 29.0, 1.1],
                [-65.0, -60.0, 32.0, 1.2],
                [-3.0, -87.0, 33.0, 0.9],
                [66.0, -68.0, 37.0, 1.0],
                [98.0, 2.0, 36.0, 1.1],
                [65.0, 70.0, 29.0, 1.1],
                [-3.0, 94.0, 38.0, 1.3],
                [-66.0, 66.0, 30.0, 1.0],
                [-99.0, -1.0, 37.0, 1.3],
                [-69.0, -68.0, 34.0, 0.9],
                [4.0, -94.0, 30.0, 1.1],
                [70.0, -62.0, 37.0, 1.4],
                [99.0, 3.0, 38.0, 0.9],
                [67.0, 72.0, 38.0, 1.4],
                [-3.0, 95.0, 37.0, 0.8],
                [-67.0, 71.0, 29.0, 0.9],
                [-100.0, -3.0, 34.0, 0.6],
                [-69.0, -72.0, 34.0, 0.7],
                [-4.0, -97.0, 31.0, 1.2],
                [73.0, -75.0, 36.0, 1.3],
                [53.0, 2.0, 38.0, 1.3],
                [34.0, 35.0, 41.0, 0.9],
                [-5.0, 54.0, 38.0, 1.1],
                [-39.0, 36.0, 38.0, 0.6],
                [-46.0, 0.0, 44.0, 1.1],
                [-36.0, -35.0, 39.0, 0.6],
                [4.0, -46.0, 39.0, 1.1],
                [35.0, -34.0, 44.0, 0.5],
                [57.0, -5.0, 40.0, 1.2],
                [43.0, 43.0, 44.0, 0.6],
                [3.0, 58.0, 39.0, 0.5],
                [-43.0, 37.0, 39.0, 1.1],
                [-59.0, 1.0, 41.0, 1.3],
                [-38.0, -36.0, 40.0, 1.4],
                [0.0, -57.0, 35.0, 1.0],
                [41.0, -44.0, 39.0, 1.4],
                [61.0, 0.0, 40.0, 0.7],
                [45.0, 46.0, 41.0, 1.2],
                [4.0, 64.0, 39.0, 0.7],
                [-45.0, 44.0, 44.0, 1.1],
                [-58.0, 4.0, 41.0, 1.3],
                [-42.0, -42.0, 36.0, 0.5],
                [-3.0, -64.0, 38.0, 0.8],
                [43.0, -42.0, 35.0, 0.9],
                [68.0, 2.0, 40.0, 0.9],
                [49.0, 48.0, 41.0, 0.5],
                [1.0, 66.0, 40.0, 0.8],
                [-47.0, 46.0, 39.0, 0.9],
                [-71.0, 3.0, 44.0, 0.8],
                [-43.0, -52.0, 40.0, 0.5],
                [-4.0, -65.0, 37.0, 1.1],
                [47.0, -47.0, 38.0, 1.5],
                [75.0, 0.0, 36.0, 1.5],
                [53.0, 55.0, 37.0, 1.4],
                [2.0, 72.0, 43.0, 0.6],
                [-54.0, 46.0, 42.0, 1.2],
                [-72.0, -5.0, 38.0, 1.3],
                [-51.0, -54.0, 36.0, 0.9],
                [-5.0, -70.0, 42.0, 0.8],
                [53.0, -54.0, 38.0, 1.2],
                [77.0, -5.0, 44.0, 1.2],
                [56.0, 54.0, 43.0, 0.7],
                [1.0, 74.0, 37.0, 1.0],
                [-55.0, 50.0, 39.0, 0.7],
                [-81.0, 0.0, 43.0, 0.9],
                [-52.0, -57.0, 43.0, 1.0],
                [4.0, -78.0, 44.0, 0.8],
                [53.0, -52.0, 44.0, 1.3],
                [80.0, 4.0, 37.0, 1.0],
                [56.0, 62.0, 43.0, 1.3],
                [-3.0, 83.0, 35.0, 0.9],
                [-57.0, 63.0, 38.0, 1.1],
                [-87.0, 1.0, 39.0, 1.5],
                [-57.0, -57.0, 35.0, 0.6],
                [-3.0, -84.0, 40.0, 0.6],
                [63.0, -63.0, 42.0, 1.4],
                [91.0, -2.0, 40.0, 0.5],
                [59.0, 58.0, 37.0, 1.4],
                [-4.0, 84.0, 40.0, 0.5],
                [-61.0, 67.0, 43.0, 0.8],
                [-92.0, 2.0, 41.0, 1.1],
                [-62.0, -66.0, 44.0, 1.2],
                [-2.0, -89.0, 43.0, 1.3],
                [59.0, -65.0, 41.0, 0.5],
                [91.0, 1.0, 38.0, 0.8],
                [62.0, 65.0, 37.0, 1.1],
                [0.0, 96.0, 37.0, 0.8],
                [-65.0, 69.0, 39.0, 0.5],
                [-98.0, 0.0, 37.0, 1.0],
                [-63.0, -70.0, 41.0, 1.0],
                [4.0, -95.0, 44.0, 1.5],
                [70.0, -62.0, 35.0, 1.2],
                [101.0, -4.0, 35.0, 0.6],
                [68.0, 65.0, 35.0, 0.6],
                [0.0, 101.0, 40.0, 1.2],
                [-68.0, 68.0, 41.0, 1.2],
                [-102.0, -2.0, 39.0, 0.6],
                [-66.0, -66.0, 40.0, 0.9],
                [3.0, -98.0, 42.0, 1.2],
                [68.0, -75.0, 42.0, 1.3],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([-1.4, 0.0, 0.0, 0.0, 0.0, 1.0, 1.7, 2.7, 3.6, 5.0, 5.0, 5.0, 5.0, 6.0]), 0
        )
        basis1 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.2, 1.8, 2.8, 3.6, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0])
        )
        basis2 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.1, 3.4, 4.0, 4.0, 4.0, 4.0, 4.0]))
        vol = Volume(basis0, basis1, basis2, controlpoints, True)
        vol2 = vol.clone()
        vol2 *= np.array([6.0, 8.5, 6.7])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] /= 6.000000
        pt2[..., 1] /= 8.500000
        pt2[..., 2] /= 6.700000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_volume_3D_p657_rational_C0_periodic(self):
        controlpoints = np.array(
            [
                [46.0, 1.0, 4.0, 0.7],
                [36.0, 31.0, 2.0, 1.4],
                [5.0, 48.0, -2.0, 1.4],
                [-24.0, 47.0, -2.0, 1.1],
                [-48.0, 14.0, 2.0, 0.7],
                [-50.0, -21.0, 4.0, 1.1],
                [-24.0, -44.0, 1.0, 1.1],
                [8.0, -47.0, 3.0, 0.8],
                [34.0, -35.0, 3.0, 1.0],
                [60.0, -3.0, 4.0, 1.5],
                [47.0, 40.0, 1.0, 0.6],
                [8.0, 59.0, 2.0, 1.4],
                [-27.0, 46.0, -5.0, 0.9],
                [-50.0, 17.0, -4.0, 0.9],
                [-58.0, -19.0, -2.0, 1.1],
                [-27.0, -52.0, 1.0, 0.7],
                [8.0, -59.0, 3.0, 1.4],
                [47.0, -33.0, 2.0, 1.4],
                [59.0, 1.0, -5.0, 1.3],
                [44.0, 39.0, 1.0, 0.7],
                [14.0, 65.0, 2.0, 0.8],
                [-28.0, 55.0, -2.0, 0.9],
                [-60.0, 20.0, -5.0, 1.1],
                [-66.0, -23.0, 4.0, 1.1],
                [-34.0, -59.0, 4.0, 1.4],
                [13.0, -67.0, 4.0, 0.7],
                [48.0, -43.0, -2.0, 0.7],
                [75.0, 4.0, -1.0, 1.3],
                [55.0, 45.0, -4.0, 1.4],
                [13.0, 68.0, 0.0, 1.1],
                [-36.0, 57.0, -4.0, 0.6],
                [-70.0, 24.0, -1.0, 1.3],
                [-69.0, -23.0, -1.0, 0.8],
                [-32.0, -59.0, 2.0, 0.6],
                [11.0, -70.0, 0.0, 0.6],
                [55.0, -47.0, -5.0, 0.6],
                [78.0, -1.0, -1.0, 1.2],
                [58.0, 48.0, -3.0, 0.7],
                [14.0, 77.0, -2.0, 1.4],
                [-40.0, 69.0, 4.0, 1.4],
                [-75.0, 31.0, 4.0, 0.9],
                [-76.0, -31.0, -3.0, 1.3],
                [-36.0, -68.0, -4.0, 1.2],
                [15.0, -76.0, -4.0, 0.5],
                [63.0, -54.0, 0.0, 1.3],
                [88.0, -4.0, 3.0, 0.6],
                [68.0, 54.0, 0.0, 1.0],
                [10.0, 87.0, -4.0, 0.7],
                [-40.0, 73.0, 1.0, 1.3],
                [-84.0, 24.0, -4.0, 0.6],
                [-77.0, -26.0, 4.0, 1.0],
                [-45.0, -72.0, 1.0, 1.4],
                [11.0, -87.0, -2.0, 1.2],
                [63.0, -55.0, -3.0, 1.1],
                [92.0, 0.0, 1.0, 0.6],
                [68.0, 58.0, 1.0, 1.1],
                [17.0, 92.0, 3.0, 1.2],
                [-44.0, 78.0, 4.0, 1.4],
                [-83.0, 32.0, -2.0, 1.5],
                [-86.0, -28.0, -5.0, 1.5],
                [-49.0, -82.0, 1.0, 0.8],
                [19.0, -88.0, 1.0, 1.0],
                [68.0, -56.0, -1.0, 0.6],
                [96.0, -2.0, 2.0, 1.2],
                [72.0, 68.0, 2.0, 0.6],
                [15.0, 97.0, 3.0, 1.1],
                [-49.0, 89.0, -1.0, 0.9],
                [-90.0, 35.0, -4.0, 1.3],
                [-98.0, -30.0, -3.0, 0.8],
                [-52.0, -88.0, -3.0, 1.4],
                [20.0, -98.0, -4.0, 1.0],
                [77.0, -68.0, -4.0, 1.3],
                [52.0, 0.0, 6.0, 1.0],
                [34.0, 33.0, 2.0, 1.4],
                [12.0, 52.0, 1.0, 1.1],
                [-24.0, 46.0, 1.0, 1.0],
                [-50.0, 14.0, 4.0, 1.1],
                [-44.0, -16.0, 5.0, 1.2],
                [-22.0, -41.0, 4.0, 0.7],
                [13.0, -46.0, 4.0, 1.2],
                [41.0, -33.0, 2.0, 0.5],
                [52.0, -2.0, 4.0, 1.4],
                [41.0, 33.0, -1.0, 1.5],
                [7.0, 51.0, 0.0, 0.5],
                [-26.0, 48.0, 1.0, 1.0],
                [-50.0, 16.0, 2.0, 0.5],
                [-55.0, -21.0, 2.0, 1.1],
                [-29.0, -50.0, 8.0, 1.0],
                [11.0, -54.0, 3.0, 0.8],
                [42.0, -34.0, 2.0, 0.6],
                [66.0, -2.0, 3.0, 1.0],
                [52.0, 45.0, 1.0, 0.8],
                [14.0, 60.0, 0.0, 0.5],
                [-34.0, 51.0, 9.0, 0.8],
                [-64.0, 26.0, 8.0, 0.6],
                [-60.0, -26.0, 4.0, 0.5],
                [-33.0, -54.0, 0.0, 1.2],
                [15.0, -66.0, 8.0, 0.8],
                [49.0, -38.0, 4.0, 1.0],
                [68.0, -5.0, 3.0, 1.1],
                [57.0, 43.0, 6.0, 1.3],
                [15.0, 73.0, 6.0, 0.6],
                [-39.0, 61.0, 3.0, 1.0],
                [-66.0, 25.0, 3.0, 1.2],
                [-68.0, -28.0, 2.0, 0.8],
                [-41.0, -64.0, -1.0, 0.7],
                [14.0, -67.0, 2.0, 1.1],
                [50.0, -49.0, 0.0, 1.4],
                [82.0, -2.0, 2.0, 0.7],
                [63.0, 54.0, 0.0, 1.1],
                [14.0, 73.0, 5.0, 0.7],
                [-42.0, 64.0, 0.0, 0.9],
                [-72.0, 22.0, 7.0, 0.6],
                [-74.0, -23.0, -1.0, 1.2],
                [-44.0, -72.0, 6.0, 1.0],
                [12.0, -80.0, 4.0, 1.0],
                [59.0, -48.0, 5.0, 1.2],
                [86.0, 1.0, 5.0, 0.7],
                [67.0, 58.0, 0.0, 0.6],
                [11.0, 88.0, 4.0, 0.8],
                [-40.0, 75.0, 9.0, 1.4],
                [-81.0, 25.0, 5.0, 0.5],
                [-80.0, -31.0, 8.0, 1.4],
                [-41.0, -72.0, 0.0, 0.9],
                [16.0, -82.0, 2.0, 1.3],
                [61.0, -54.0, 3.0, 0.8],
                [92.0, 1.0, 6.0, 0.9],
                [67.0, 56.0, 3.0, 1.5],
                [12.0, 88.0, 2.0, 1.2],
                [-50.0, 85.0, 5.0, 1.1],
                [-92.0, 35.0, 6.0, 1.4],
                [-89.0, -36.0, 3.0, 1.1],
                [-45.0, -86.0, 8.0, 1.1],
                [21.0, -91.0, 1.0, 1.4],
                [74.0, -61.0, 1.0, 0.7],
                [99.0, -2.0, 1.0, 0.5],
                [77.0, 62.0, 4.0, 0.8],
                [18.0, 93.0, 1.0, 1.5],
                [-52.0, 85.0, 7.0, 0.6],
                [-91.0, 29.0, 4.0, 1.3],
                [-93.0, -32.0, 1.0, 0.9],
                [-49.0, -90.0, 1.0, 0.6],
                [16.0, -95.0, 7.0, 1.2],
                [74.0, -62.0, 1.0, 0.7],
                [46.0, -4.0, 4.0, 0.5],
                [34.0, 31.0, 8.0, 1.3],
                [9.0, 52.0, 6.0, 0.5],
                [-25.0, 42.0, 8.0, 0.5],
                [-52.0, 16.0, 13.0, 1.1],
                [-47.0, -20.0, 7.0, 1.4],
                [-30.0, -46.0, 8.0, 1.4],
                [3.0, -48.0, 12.0, 1.2],
                [41.0, -34.0, 13.0, 0.8],
                [54.0, -1.0, 6.0, 1.2],
                [48.0, 33.0, 11.0, 1.1],
                [5.0, 51.0, 4.0, 1.4],
                [-30.0, 54.0, 7.0, 1.2],
                [-56.0, 21.0, 13.0, 0.5],
                [-52.0, -19.0, 12.0, 1.1],
                [-31.0, -51.0, 10.0, 0.7],
                [4.0, -60.0, 3.0, 0.9],
                [42.0, -42.0, 8.0, 1.4],
                [60.0, -4.0, 13.0, 1.0],
                [48.0, 44.0, 12.0, 0.8],
                [11.0, 64.0, 4.0, 1.5],
                [-32.0, 59.0, 9.0, 1.0],
                [-60.0, 22.0, 10.0, 1.0],
                [-59.0, -24.0, 13.0, 0.9],
                [-36.0, -53.0, 7.0, 1.2],
                [12.0, -65.0, 12.0, 1.2],
                [53.0, -40.0, 5.0, 1.1],
                [71.0, -3.0, 5.0, 1.0],
                [58.0, 50.0, 11.0, 0.8],
                [17.0, 74.0, 10.0, 1.2],
                [-34.0, 56.0, 9.0, 1.2],
                [-71.0, 27.0, 12.0, 0.5],
                [-70.0, -25.0, 9.0, 0.8],
                [-32.0, -59.0, 9.0, 1.3],
                [7.0, -69.0, 12.0, 1.0],
                [51.0, -46.0, 5.0, 1.0],
                [78.0, 0.0, 13.0, 1.1],
                [64.0, 46.0, 6.0, 1.4],
                [9.0, 77.0, 8.0, 1.4],
                [-43.0, 63.0, 12.0, 1.2],
                [-70.0, 26.0, 5.0, 1.5],
                [-69.0, -26.0, 6.0, 0.7],
                [-35.0, -72.0, 4.0, 0.5],
                [15.0, -73.0, 7.0, 1.2],
                [64.0, -47.0, 8.0, 1.2],
                [87.0, 4.0, 4.0, 0.7],
                [61.0, 52.0, 10.0, 1.2],
                [10.0, 87.0, 9.0, 1.0],
                [-43.0, 70.0, 9.0, 1.2],
                [-85.0, 32.0, 10.0, 0.5],
                [-85.0, -34.0, 11.0, 1.4],
                [-45.0, -73.0, 12.0, 0.8],
                [19.0, -86.0, 5.0, 0.8],
                [66.0, -59.0, 10.0, 1.3],
                [91.0, -4.0, 9.0, 0.7],
                [66.0, 63.0, 9.0, 0.8],
                [11.0, 88.0, 11.0, 1.3],
                [-43.0, 84.0, 5.0, 0.8],
                [-91.0, 27.0, 4.0, 1.3],
                [-88.0, -37.0, 13.0, 1.1],
                [-48.0, -86.0, 7.0, 0.8],
                [18.0, -94.0, 13.0, 1.1],
                [72.0, -57.0, 8.0, 1.3],
                [100.0, 2.0, 11.0, 0.6],
                [77.0, 61.0, 12.0, 0.5],
                [15.0, 96.0, 13.0, 1.4],
                [-50.0, 85.0, 4.0, 1.1],
                [-96.0, 37.0, 6.0, 0.6],
                [-97.0, -36.0, 9.0, 1.1],
                [-46.0, -85.0, 10.0, 1.3],
                [21.0, -94.0, 4.0, 1.3],
                [76.0, -68.0, 10.0, 1.3],
                [52.0, -5.0, 10.0, 0.7],
                [40.0, 32.0, 13.0, 1.1],
                [6.0, 53.0, 8.0, 1.1],
                [-27.0, 47.0, 8.0, 1.4],
                [-50.0, 21.0, 18.0, 1.3],
                [-47.0, -19.0, 17.0, 0.6],
                [-24.0, -43.0, 16.0, 0.5],
                [8.0, -54.0, 10.0, 1.1],
                [39.0, -30.0, 8.0, 1.3],
                [56.0, 2.0, 14.0, 1.1],
                [44.0, 37.0, 10.0, 0.7],
                [11.0, 59.0, 9.0, 1.1],
                [-29.0, 49.0, 11.0, 0.8],
                [-51.0, 16.0, 13.0, 1.0],
                [-58.0, -23.0, 12.0, 0.7],
                [-31.0, -51.0, 17.0, 1.4],
                [8.0, -56.0, 8.0, 1.2],
                [40.0, -37.0, 17.0, 1.0],
                [59.0, 0.0, 9.0, 0.6],
                [47.0, 36.0, 13.0, 1.5],
                [15.0, 59.0, 14.0, 1.4],
                [-29.0, 52.0, 11.0, 0.6],
                [-58.0, 24.0, 15.0, 0.8],
                [-65.0, -24.0, 14.0, 0.6],
                [-32.0, -57.0, 15.0, 1.0],
                [9.0, -61.0, 15.0, 1.2],
                [49.0, -45.0, 13.0, 1.4],
                [68.0, 0.0, 17.0, 1.3],
                [53.0, 41.0, 11.0, 0.9],
                [10.0, 73.0, 8.0, 1.3],
                [-36.0, 64.0, 12.0, 0.7],
                [-67.0, 26.0, 14.0, 0.5],
                [-64.0, -26.0, 16.0, 1.1],
                [-40.0, -58.0, 8.0, 1.1],
                [9.0, -75.0, 16.0, 1.0],
                [53.0, -42.0, 17.0, 1.3],
                [81.0, 1.0, 17.0, 0.9],
                [64.0, 51.0, 9.0, 1.4],
                [15.0, 73.0, 15.0, 1.2],
                [-44.0, 68.0, 10.0, 1.3],
                [-73.0, 31.0, 10.0, 1.4],
                [-73.0, -30.0, 11.0, 1.2],
                [-35.0, -67.0, 9.0, 1.4],
                [13.0, -74.0, 15.0, 0.7],
                [63.0, -49.0, 11.0, 1.4],
                [88.0, -5.0, 13.0, 0.8],
                [69.0, 50.0, 17.0, 1.5],
                [15.0, 83.0, 9.0, 1.0],
                [-42.0, 74.0, 18.0, 1.0],
                [-80.0, 29.0, 9.0, 1.0],
                [-79.0, -29.0, 10.0, 1.3],
                [-45.0, -78.0, 13.0, 0.8],
                [11.0, -81.0, 16.0, 1.2],
                [66.0, -57.0, 18.0, 0.9],
                [88.0, 1.0, 13.0, 1.3],
                [72.0, 63.0, 16.0, 1.1],
                [13.0, 93.0, 13.0, 0.9],
                [-50.0, 77.0, 11.0, 0.6],
                [-89.0, 31.0, 11.0, 1.0],
                [-83.0, -31.0, 14.0, 1.4],
                [-45.0, -77.0, 13.0, 1.4],
                [11.0, -94.0, 15.0, 0.9],
                [69.0, -61.0, 15.0, 0.7],
                [103.0, 3.0, 15.0, 0.8],
                [73.0, 60.0, 16.0, 1.2],
                [18.0, 96.0, 17.0, 1.4],
                [-51.0, 89.0, 10.0, 0.6],
                [-99.0, 35.0, 18.0, 0.9],
                [-91.0, -31.0, 14.0, 1.0],
                [-52.0, -88.0, 15.0, 1.1],
                [20.0, -97.0, 8.0, 0.6],
                [72.0, -62.0, 12.0, 0.6],
                [48.0, -2.0, 18.0, 0.8],
                [37.0, 37.0, 18.0, 0.6],
                [3.0, 47.0, 13.0, 0.5],
                [-27.0, 46.0, 15.0, 1.4],
                [-52.0, 14.0, 21.0, 0.7],
                [-45.0, -17.0, 17.0, 1.1],
                [-24.0, -41.0, 20.0, 0.8],
                [12.0, -51.0, 17.0, 1.0],
                [42.0, -33.0, 17.0, 1.2],
                [58.0, 1.0, 16.0, 1.1],
                [45.0, 35.0, 17.0, 0.7],
                [8.0, 59.0, 13.0, 0.8],
                [-30.0, 52.0, 19.0, 0.6],
                [-58.0, 15.0, 19.0, 1.0],
                [-53.0, -21.0, 15.0, 1.4],
                [-32.0, -54.0, 16.0, 1.3],
                [13.0, -61.0, 22.0, 0.9],
                [44.0, -35.0, 21.0, 1.0],
                [62.0, 4.0, 13.0, 1.1],
                [53.0, 45.0, 17.0, 0.7],
                [10.0, 63.0, 14.0, 0.7],
                [-37.0, 59.0, 22.0, 0.6],
                [-62.0, 26.0, 20.0, 0.7],
                [-57.0, -25.0, 17.0, 0.9],
                [-32.0, -55.0, 17.0, 0.8],
                [13.0, -64.0, 15.0, 1.1],
                [49.0, -43.0, 15.0, 1.1],
                [70.0, 1.0, 17.0, 1.2],
                [55.0, 49.0, 16.0, 0.5],
                [13.0, 66.0, 15.0, 1.0],
                [-41.0, 59.0, 14.0, 1.3],
                [-71.0, 29.0, 18.0, 0.9],
                [-70.0, -21.0, 19.0, 0.6],
                [-37.0, -65.0, 20.0, 1.0],
                [12.0, -72.0, 22.0, 0.9],
                [53.0, -46.0, 22.0, 1.4],
                [78.0, -5.0, 14.0, 0.7],
                [55.0, 45.0, 21.0, 0.6],
                [13.0, 75.0, 20.0, 1.0],
                [-35.0, 63.0, 21.0, 0.5],
                [-71.0, 22.0, 15.0, 1.0],
                [-75.0, -26.0, 18.0, 0.5],
                [-43.0, -72.0, 18.0, 1.4],
                [18.0, -80.0, 21.0, 1.3],
                [61.0, -52.0, 17.0, 1.0],
                [81.0, 0.0, 17.0, 1.2],
                [61.0, 50.0, 20.0, 1.3],
                [15.0, 82.0, 18.0, 1.2],
                [-41.0, 77.0, 17.0, 0.8],
                [-84.0, 26.0, 21.0, 0.7],
                [-83.0, -27.0, 16.0, 0.6],
                [-42.0, -72.0, 15.0, 0.9],
                [10.0, -90.0, 21.0, 1.1],
                [61.0, -55.0, 16.0, 1.1],
                [96.0, -3.0, 21.0, 0.8],
                [75.0, 60.0, 18.0, 0.7],
                [15.0, 95.0, 20.0, 0.5],
                [-52.0, 79.0, 16.0, 0.9],
                [-83.0, 35.0, 20.0, 0.7],
                [-89.0, -31.0, 17.0, 0.8],
                [-47.0, -78.0, 14.0, 1.2],
                [16.0, -88.0, 13.0, 1.3],
                [75.0, -64.0, 14.0, 1.4],
                [101.0, -2.0, 21.0, 1.4],
                [72.0, 63.0, 15.0, 1.0],
                [17.0, 95.0, 17.0, 1.1],
                [-52.0, 86.0, 16.0, 1.5],
                [-98.0, 30.0, 18.0, 0.8],
                [-96.0, -38.0, 16.0, 0.6],
                [-51.0, -83.0, 12.0, 0.7],
                [13.0, -99.0, 18.0, 0.9],
                [79.0, -63.0, 15.0, 0.6],
                [53.0, 4.0, 23.0, 1.2],
                [39.0, 36.0, 20.0, 1.5],
                [6.0, 49.0, 22.0, 1.0],
                [-29.0, 45.0, 17.0, 1.2],
                [-44.0, 15.0, 26.0, 0.6],
                [-48.0, -19.0, 18.0, 0.7],
                [-25.0, -45.0, 18.0, 0.8],
                [12.0, -51.0, 18.0, 1.2],
                [36.0, -33.0, 22.0, 0.9],
                [53.0, 0.0, 24.0, 1.3],
                [43.0, 39.0, 26.0, 0.9],
                [7.0, 60.0, 24.0, 0.6],
                [-32.0, 45.0, 19.0, 0.5],
                [-56.0, 23.0, 20.0, 1.2],
                [-55.0, -20.0, 21.0, 0.8],
                [-32.0, -49.0, 22.0, 0.6],
                [6.0, -52.0, 24.0, 1.2],
                [39.0, -39.0, 26.0, 1.5],
                [67.0, 3.0, 27.0, 1.1],
                [51.0, 37.0, 17.0, 1.3],
                [15.0, 61.0, 24.0, 1.2],
                [-32.0, 59.0, 22.0, 1.4],
                [-60.0, 19.0, 26.0, 0.8],
                [-64.0, -26.0, 19.0, 1.0],
                [-30.0, -54.0, 19.0, 1.4],
                [7.0, -63.0, 25.0, 1.5],
                [53.0, -45.0, 25.0, 1.3],
                [71.0, -4.0, 26.0, 1.3],
                [55.0, 42.0, 18.0, 1.3],
                [17.0, 65.0, 20.0, 0.9],
                [-32.0, 58.0, 19.0, 1.2],
                [-66.0, 23.0, 25.0, 0.9],
                [-69.0, -24.0, 22.0, 0.7],
                [-39.0, -64.0, 25.0, 1.4],
                [16.0, -68.0, 24.0, 0.7],
                [54.0, -43.0, 21.0, 1.5],
                [77.0, -3.0, 17.0, 1.3],
                [57.0, 54.0, 20.0, 0.7],
                [14.0, 80.0, 25.0, 0.6],
                [-40.0, 67.0, 25.0, 1.1],
                [-72.0, 26.0, 24.0, 1.0],
                [-72.0, -26.0, 23.0, 0.7],
                [-41.0, -71.0, 21.0, 0.6],
                [12.0, -78.0, 18.0, 1.4],
                [60.0, -54.0, 19.0, 0.6],
                [80.0, 1.0, 20.0, 0.5],
                [66.0, 52.0, 26.0, 1.0],
                [12.0, 83.0, 18.0, 1.0],
                [-40.0, 72.0, 19.0, 0.8],
                [-86.0, 33.0, 22.0, 0.5],
                [-82.0, -26.0, 18.0, 0.8],
                [-43.0, -72.0, 23.0, 0.8],
                [15.0, -81.0, 19.0, 1.2],
                [61.0, -57.0, 25.0, 0.7],
                [88.0, 4.0, 22.0, 1.1],
                [66.0, 58.0, 22.0, 0.7],
                [17.0, 89.0, 26.0, 0.6],
                [-49.0, 77.0, 18.0, 1.4],
                [-89.0, 27.0, 24.0, 1.3],
                [-91.0, -34.0, 19.0, 0.5],
                [-46.0, -82.0, 17.0, 0.7],
                [15.0, -90.0, 26.0, 0.7],
                [67.0, -57.0, 25.0, 1.3],
                [103.0, -5.0, 23.0, 1.1],
                [81.0, 64.0, 19.0, 0.6],
                [13.0, 97.0, 20.0, 1.3],
                [-46.0, 91.0, 26.0, 1.4],
                [-95.0, 29.0, 18.0, 1.3],
                [-94.0, -34.0, 23.0, 1.4],
                [-46.0, -83.0, 18.0, 1.2],
                [18.0, -103.0, 21.0, 0.6],
                [74.0, -65.0, 22.0, 0.8],
                [52.0, -4.0, 22.0, 0.7],
                [38.0, 33.0, 23.0, 0.6],
                [10.0, 50.0, 25.0, 0.6],
                [-25.0, 43.0, 25.0, 0.6],
                [-49.0, 17.0, 22.0, 1.3],
                [-43.0, -15.0, 30.0, 0.6],
                [-21.0, -46.0, 29.0, 0.8],
                [11.0, -49.0, 24.0, 1.4],
                [36.0, -34.0, 24.0, 0.6],
                [55.0, -4.0, 22.0, 0.7],
                [43.0, 35.0, 27.0, 0.7],
                [10.0, 52.0, 22.0, 1.4],
                [-32.0, 51.0, 29.0, 0.9],
                [-59.0, 22.0, 26.0, 1.1],
                [-55.0, -17.0, 25.0, 1.1],
                [-26.0, -48.0, 26.0, 1.2],
                [13.0, -58.0, 27.0, 0.7],
                [46.0, -39.0, 31.0, 0.6],
                [64.0, -1.0, 21.0, 0.8],
                [49.0, 43.0, 23.0, 1.0],
                [15.0, 65.0, 25.0, 0.6],
                [-37.0, 53.0, 26.0, 1.1],
                [-59.0, 17.0, 26.0, 1.5],
                [-58.0, -19.0, 23.0, 0.8],
                [-30.0, -59.0, 25.0, 0.7],
                [11.0, -64.0, 29.0, 0.6],
                [48.0, -38.0, 25.0, 0.8],
                [73.0, -2.0, 31.0, 1.4],
                [57.0, 48.0, 29.0, 1.0],
                [8.0, 70.0, 23.0, 0.9],
                [-40.0, 65.0, 26.0, 1.2],
                [-64.0, 22.0, 24.0, 0.9],
                [-67.0, -24.0, 29.0, 1.1],
                [-40.0, -64.0, 29.0, 0.6],
                [11.0, -67.0, 26.0, 0.5],
                [53.0, -44.0, 25.0, 0.9],
                [81.0, -1.0, 26.0, 0.8],
                [56.0, 50.0, 27.0, 1.2],
                [17.0, 74.0, 23.0, 1.3],
                [-44.0, 63.0, 31.0, 1.2],
                [-72.0, 25.0, 23.0, 1.3],
                [-76.0, -31.0, 31.0, 0.7],
                [-35.0, -70.0, 24.0, 0.9],
                [14.0, -73.0, 29.0, 1.2],
                [55.0, -50.0, 30.0, 0.8],
                [81.0, -3.0, 27.0, 1.2],
                [66.0, 59.0, 23.0, 1.5],
                [17.0, 88.0, 27.0, 0.7],
                [-42.0, 70.0, 21.0, 1.5],
                [-79.0, 25.0, 22.0, 0.8],
                [-77.0, -30.0, 30.0, 1.0],
                [-42.0, -73.0, 28.0, 1.3],
                [17.0, -81.0, 22.0, 0.5],
                [64.0, -58.0, 27.0, 0.8],
                [88.0, 1.0, 30.0, 0.6],
                [68.0, 57.0, 26.0, 1.3],
                [18.0, 87.0, 24.0, 0.8],
                [-49.0, 82.0, 22.0, 0.6],
                [-88.0, 33.0, 30.0, 0.6],
                [-87.0, -30.0, 25.0, 0.5],
                [-47.0, -82.0, 25.0, 0.7],
                [16.0, -97.0, 26.0, 0.9],
                [72.0, -64.0, 28.0, 0.9],
                [100.0, 3.0, 22.0, 1.3],
                [80.0, 62.0, 29.0, 0.8],
                [17.0, 101.0, 21.0, 0.6],
                [-47.0, 89.0, 24.0, 1.3],
                [-92.0, 31.0, 30.0, 1.5],
                [-95.0, -35.0, 28.0, 1.2],
                [-47.0, -88.0, 30.0, 0.7],
                [19.0, -100.0, 22.0, 0.9],
                [76.0, -68.0, 23.0, 1.5],
                [46.0, -1.0, 27.0, 0.6],
                [42.0, 32.0, 31.0, 1.1],
                [5.0, 53.0, 28.0, 0.8],
                [-25.0, 44.0, 28.0, 1.5],
                [-51.0, 20.0, 33.0, 1.4],
                [-45.0, -17.0, 28.0, 0.9],
                [-29.0, -41.0, 34.0, 1.1],
                [10.0, -49.0, 32.0, 1.2],
                [38.0, -32.0, 34.0, 0.6],
                [61.0, -2.0, 34.0, 1.4],
                [42.0, 38.0, 31.0, 0.9],
                [13.0, 58.0, 35.0, 0.8],
                [-28.0, 53.0, 31.0, 1.1],
                [-57.0, 17.0, 35.0, 1.0],
                [-58.0, -24.0, 31.0, 1.1],
                [-28.0, -54.0, 29.0, 1.2],
                [13.0, -56.0, 29.0, 0.5],
                [41.0, -38.0, 30.0, 1.0],
                [67.0, 1.0, 31.0, 0.9],
                [47.0, 37.0, 30.0, 1.0],
                [6.0, 68.0, 34.0, 1.4],
                [-37.0, 50.0, 33.0, 0.6],
                [-58.0, 20.0, 31.0, 1.5],
                [-65.0, -25.0, 34.0, 0.7],
                [-32.0, -57.0, 29.0, 1.1],
                [8.0, -62.0, 27.0, 1.1],
                [48.0, -39.0, 31.0, 1.2],
                [70.0, 0.0, 36.0, 0.9],
                [56.0, 45.0, 31.0, 1.4],
                [9.0, 71.0, 32.0, 1.4],
                [-41.0, 62.0, 30.0, 1.2],
                [-71.0, 23.0, 30.0, 0.6],
                [-67.0, -22.0, 31.0, 1.0],
                [-34.0, -58.0, 28.0, 0.8],
                [17.0, -67.0, 35.0, 0.7],
                [55.0, -42.0, 30.0, 0.9],
                [82.0, 1.0, 27.0, 1.2],
                [55.0, 48.0, 29.0, 0.7],
                [12.0, 77.0, 27.0, 1.4],
                [-43.0, 63.0, 33.0, 0.6],
                [-77.0, 27.0, 28.0, 1.5],
                [-73.0, -30.0, 30.0, 1.1],
                [-43.0, -73.0, 28.0, 1.4],
                [15.0, -76.0, 34.0, 0.8],
                [64.0, -46.0, 32.0, 0.9],
                [88.0, -2.0, 31.0, 0.8],
                [69.0, 50.0, 32.0, 0.7],
                [14.0, 89.0, 30.0, 0.8],
                [-40.0, 70.0, 30.0, 0.8],
                [-79.0, 32.0, 26.0, 1.4],
                [-83.0, -28.0, 31.0, 1.2],
                [-45.0, -73.0, 30.0, 0.9],
                [13.0, -86.0, 27.0, 1.5],
                [61.0, -60.0, 36.0, 0.7],
                [89.0, 3.0, 29.0, 1.5],
                [75.0, 56.0, 34.0, 0.6],
                [13.0, 95.0, 34.0, 1.0],
                [-47.0, 77.0, 31.0, 1.5],
                [-88.0, 36.0, 31.0, 0.9],
                [-85.0, -36.0, 29.0, 1.0],
                [-48.0, -84.0, 26.0, 1.1],
                [18.0, -92.0, 31.0, 0.7],
                [75.0, -56.0, 28.0, 1.3],
                [99.0, -3.0, 32.0, 1.0],
                [81.0, 62.0, 28.0, 0.6],
                [18.0, 94.0, 27.0, 0.6],
                [-49.0, 82.0, 26.0, 1.1],
                [-99.0, 34.0, 35.0, 1.5],
                [-93.0, -37.0, 27.0, 1.3],
                [-53.0, -89.0, 35.0, 1.2],
                [15.0, -97.0, 26.0, 0.7],
                [80.0, -61.0, 32.0, 0.5],
                [53.0, 3.0, 34.0, 1.4],
                [39.0, 31.0, 33.0, 1.2],
                [10.0, 52.0, 33.0, 0.5],
                [-26.0, 40.0, 35.0, 0.8],
                [-47.0, 18.0, 39.0, 1.4],
                [-48.0, -16.0, 37.0, 0.7],
                [-30.0, -46.0, 32.0, 1.5],
                [6.0, -50.0, 39.0, 1.4],
                [39.0, -28.0, 32.0, 1.5],
                [53.0, 0.0, 35.0, 0.8],
                [41.0, 37.0, 38.0, 0.9],
                [12.0, 53.0, 39.0, 0.5],
                [-27.0, 44.0, 31.0, 0.9],
                [-50.0, 20.0, 37.0, 1.1],
                [-55.0, -24.0, 36.0, 1.1],
                [-25.0, -52.0, 36.0, 1.2],
                [9.0, -61.0, 38.0, 0.7],
                [47.0, -38.0, 31.0, 1.1],
                [62.0, 0.0, 40.0, 1.5],
                [49.0, 45.0, 39.0, 1.4],
                [10.0, 60.0, 37.0, 1.2],
                [-34.0, 57.0, 35.0, 0.8],
                [-62.0, 24.0, 36.0, 1.4],
                [-59.0, -27.0, 30.0, 0.6],
                [-36.0, -57.0, 38.0, 1.0],
                [13.0, -61.0, 31.0, 1.5],
                [47.0, -43.0, 35.0, 0.6],
                [73.0, 2.0, 32.0, 0.7],
                [58.0, 44.0, 39.0, 1.1],
                [13.0, 67.0, 33.0, 0.7],
                [-37.0, 64.0, 34.0, 1.2],
                [-67.0, 20.0, 33.0, 1.1],
                [-73.0, -28.0, 37.0, 1.3],
                [-33.0, -64.0, 38.0, 1.3],
                [14.0, -73.0, 40.0, 0.7],
                [56.0, -45.0, 37.0, 1.2],
                [77.0, -1.0, 34.0, 1.4],
                [64.0, 54.0, 34.0, 0.5],
                [14.0, 79.0, 33.0, 0.8],
                [-38.0, 65.0, 34.0, 0.9],
                [-72.0, 26.0, 40.0, 1.2],
                [-71.0, -25.0, 31.0, 0.5],
                [-38.0, -70.0, 37.0, 1.3],
                [14.0, -78.0, 40.0, 1.5],
                [62.0, -50.0, 38.0, 0.6],
                [84.0, 4.0, 36.0, 0.6],
                [67.0, 53.0, 36.0, 1.4],
                [12.0, 81.0, 33.0, 1.1],
                [-45.0, 76.0, 34.0, 1.3],
                [-83.0, 24.0, 38.0, 0.6],
                [-79.0, -33.0, 32.0, 0.6],
                [-46.0, -78.0, 38.0, 1.1],
                [16.0, -81.0, 36.0, 1.0],
                [68.0, -59.0, 35.0, 1.0],
                [95.0, -4.0, 34.0, 0.6],
                [69.0, 60.0, 31.0, 0.6],
                [19.0, 93.0, 31.0, 0.8],
                [-48.0, 78.0, 38.0, 0.7],
                [-92.0, 34.0, 34.0, 1.1],
                [-92.0, -33.0, 39.0, 0.6],
                [-51.0, -84.0, 33.0, 0.6],
                [13.0, -97.0, 39.0, 1.2],
                [69.0, -63.0, 36.0, 1.4],
                [99.0, 3.0, 37.0, 1.2],
                [71.0, 66.0, 35.0, 1.3],
                [19.0, 100.0, 35.0, 1.3],
                [-47.0, 84.0, 36.0, 1.1],
                [-98.0, 35.0, 33.0, 1.4],
                [-93.0, -30.0, 36.0, 0.6],
                [-47.0, -89.0, 34.0, 0.8],
                [22.0, -98.0, 35.0, 1.2],
                [79.0, -67.0, 40.0, 0.5],
                [51.0, -3.0, 41.0, 0.6],
                [34.0, 28.0, 36.0, 0.8],
                [11.0, 44.0, 38.0, 1.2],
                [-23.0, 42.0, 37.0, 1.0],
                [-48.0, 16.0, 36.0, 1.2],
                [-46.0, -19.0, 40.0, 1.0],
                [-24.0, -40.0, 35.0, 1.3],
                [11.0, -45.0, 38.0, 1.0],
                [36.0, -33.0, 38.0, 0.6],
                [55.0, -2.0, 35.0, 1.3],
                [43.0, 37.0, 43.0, 1.0],
                [8.0, 59.0, 44.0, 1.1],
                [-34.0, 52.0, 41.0, 0.9],
                [-51.0, 16.0, 40.0, 1.5],
                [-53.0, -20.0, 40.0, 0.6],
                [-28.0, -46.0, 37.0, 1.3],
                [5.0, -52.0, 42.0, 1.3],
                [38.0, -40.0, 43.0, 1.1],
                [62.0, 3.0, 41.0, 0.5],
                [50.0, 43.0, 44.0, 0.8],
                [7.0, 63.0, 38.0, 1.4],
                [-33.0, 57.0, 37.0, 1.4],
                [-63.0, 18.0, 37.0, 0.8],
                [-61.0, -25.0, 44.0, 1.3],
                [-28.0, -55.0, 42.0, 1.4],
                [7.0, -66.0, 38.0, 0.6],
                [50.0, -38.0, 41.0, 1.0],
                [72.0, -2.0, 43.0, 1.5],
                [58.0, 44.0, 35.0, 0.7],
                [13.0, 67.0, 35.0, 1.5],
                [-41.0, 59.0, 35.0, 0.7],
                [-65.0, 23.0, 35.0, 1.4],
                [-69.0, -25.0, 37.0, 0.8],
                [-39.0, -60.0, 37.0, 1.1],
                [16.0, -75.0, 37.0, 0.6],
                [58.0, -51.0, 42.0, 0.9],
                [77.0, -3.0, 42.0, 1.2],
                [57.0, 52.0, 43.0, 1.0],
                [8.0, 78.0, 42.0, 1.1],
                [-40.0, 69.0, 43.0, 0.8],
                [-70.0, 27.0, 38.0, 0.5],
                [-72.0, -27.0, 35.0, 1.3],
                [-39.0, -69.0, 39.0, 1.5],
                [11.0, -82.0, 42.0, 1.0],
                [62.0, -54.0, 38.0, 1.4],
                [83.0, 4.0, 38.0, 0.5],
                [67.0, 57.0, 35.0, 0.6],
                [9.0, 82.0, 44.0, 0.5],
                [-46.0, 78.0, 40.0, 0.7],
                [-78.0, 24.0, 35.0, 0.5],
                [-77.0, -34.0, 36.0, 1.1],
                [-47.0, -79.0, 39.0, 0.8],
                [14.0, -85.0, 37.0, 0.6],
                [66.0, -54.0, 41.0, 1.3],
                [95.0, -2.0, 35.0, 1.4],
                [73.0, 56.0, 35.0, 1.2],
                [17.0, 94.0, 36.0, 1.4],
                [-47.0, 79.0, 36.0, 1.4],
                [-85.0, 31.0, 39.0, 1.4],
                [-84.0, -37.0, 41.0, 1.4],
                [-45.0, -84.0, 38.0, 0.9],
                [15.0, -94.0, 36.0, 1.0],
                [67.0, -63.0, 36.0, 1.3],
                [98.0, -2.0, 35.0, 0.6],
                [75.0, 63.0, 35.0, 1.4],
                [18.0, 94.0, 38.0, 1.2],
                [-55.0, 91.0, 44.0, 1.2],
                [-92.0, 35.0, 38.0, 1.0],
                [-97.0, -40.0, 40.0, 1.1],
                [-54.0, -91.0, 36.0, 1.1],
                [17.0, -102.0, 44.0, 0.8],
                [79.0, -68.0, 44.0, 0.7],
            ]
        )
        basis0 = BSplineBasis(
            6, np.array([-1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.2, 1.8, 3.3, 4.0, 5.0, 5.0, 5.0, 5.0, 5.0, 6.2]), 0
        )
        basis1 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.7, 3.2, 4.0, 4.0, 4.0, 4.0, 4.0]))
        basis2 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.2, 2.1, 2.7, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        vol = Volume(basis0, basis1, basis2, controlpoints, True)
        vol2 = vol.clone()
        vol2.mirror([3, 0, 0])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] = -pt2[..., 0]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_3D_p5_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [102.0, -5.0, 0.0, 1.2],
                [81.0, 65.0, -2.0, 0.7],
                [13.0, 100.0, -3.0, 1.2],
                [-55.0, 89.0, -1.0, 1.0],
                [-99.0, 32.0, -3.0, 1.0],
                [-91.0, -38.0, -3.0, 1.5],
                [-48.0, -90.0, 3.0, 1.4],
                [21.0, -102.0, 2.0, 1.0],
                [79.0, -67.0, -1.0, 0.6],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([-1.6, -1.1, 0.0, 0.0, 0.0, 1.1, 2.3, 2.7, 3.7, 5.4, 5.9, 7.0, 7.0, 7.0, 8.1, 9.3]), 1
        )
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 += np.array([4.8, 3.5, 9.2])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 4.800000
        pt2[..., 1] -= 3.500000
        pt2[..., 2] -= 9.200000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_3D_p7_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [96.0, 2.0, 1.0, 0.9],
                [80.0, 63.0, -1.0, 0.8],
                [34.0, 91.0, 4.0, 0.9],
                [-34.0, 98.0, -5.0, 0.8],
                [-79.0, 54.0, 4.0, 0.5],
                [-98.0, -2.0, -2.0, 0.7],
                [-86.0, -64.0, -1.0, 1.1],
                [-31.0, -92.0, -3.0, 1.1],
                [32.0, -100.0, -1.0, 0.7],
                [81.0, -55.0, 4.0, 0.9],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    -1.7,
                    -0.6,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.6,
                    2.3,
                    3.3,
                    4.3,
                    5.4,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.6,
                    8.3,
                ]
            ),
            1,
        )
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2 *= np.array([6.3, 11.6, 7.6])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 6.300000
        pt2[..., 1] /= 11.600000
        pt2[..., 2] /= 7.600000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_curve_3D_p5_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [98.0, -3.0, 4.0, 0.7],
                [46.0, 86.0, 0.0, 0.6],
                [-53.0, 89.0, 4.0, 0.7],
                [-97.0, 0.0, 3.0, 1.2],
                [-53.0, -84.0, -2.0, 0.8],
                [52.0, -87.0, -5.0, 0.7],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([-2.3, -1.2, 0.0, 0.0, 0.0, 1.1, 1.7, 2.8, 4.0, 4.0, 4.0, 5.1, 5.7]), 1
        )
        crv = Curve(basis0, controlpoints, True)
        crv2 = crv.clone()
        crv2.mirror([0, 0, 3])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 2] = -pt2[..., 2]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_3D_p56_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [55.0, -4.0, 0.0, 0.8],
                [32.0, 56.0, -5.0, 1.4],
                [-30.0, 52.0, -1.0, 0.8],
                [-64.0, -5.0, -5.0, 1.5],
                [-27.0, -55.0, 2.0, 1.1],
                [28.0, -49.0, 3.0, 0.5],
                [61.0, -3.0, 2.0, 0.8],
                [27.0, 59.0, -3.0, 0.8],
                [-34.0, 55.0, -3.0, 1.3],
                [-67.0, -2.0, -4.0, 1.2],
                [-34.0, -59.0, -5.0, 1.1],
                [35.0, -52.0, -5.0, 1.2],
                [64.0, 1.0, 3.0, 0.9],
                [30.0, 57.0, -2.0, 1.5],
                [-37.0, 62.0, 1.0, 1.4],
                [-66.0, -4.0, -2.0, 1.5],
                [-39.0, -60.0, -2.0, 1.1],
                [33.0, -61.0, -1.0, 1.2],
                [75.0, 2.0, -1.0, 0.5],
                [40.0, 60.0, 1.0, 1.2],
                [-32.0, 66.0, 0.0, 1.3],
                [-75.0, 2.0, -5.0, 1.3],
                [-32.0, -63.0, 0.0, 1.4],
                [40.0, -65.0, 3.0, 1.3],
                [78.0, 0.0, 4.0, 1.3],
                [34.0, 66.0, 4.0, 1.1],
                [-37.0, 62.0, -4.0, 1.0],
                [-80.0, -3.0, -2.0, 0.7],
                [-39.0, -65.0, 2.0, 1.1],
                [39.0, -70.0, 4.0, 1.4],
                [84.0, 0.0, -1.0, 0.6],
                [38.0, 71.0, 0.0, 1.3],
                [-38.0, 64.0, -5.0, 0.6],
                [-85.0, -2.0, -3.0, 0.9],
                [-38.0, -65.0, -4.0, 1.2],
                [39.0, -71.0, 1.0, 0.9],
                [82.0, -2.0, 4.0, 1.1],
                [42.0, 72.0, 4.0, 0.9],
                [-46.0, 76.0, -5.0, 1.3],
                [-83.0, -4.0, -1.0, 0.9],
                [-39.0, -69.0, -1.0, 1.0],
                [40.0, -75.0, -1.0, 0.8],
                [84.0, 2.0, -4.0, 1.3],
                [45.0, 76.0, 4.0, 0.8],
                [-47.0, 75.0, -4.0, 0.7],
                [-85.0, 0.0, 1.0, 0.7],
                [-41.0, -76.0, 0.0, 0.8],
                [42.0, -76.0, 3.0, 1.3],
                [95.0, -2.0, 1.0, 0.9],
                [46.0, 83.0, 1.0, 0.9],
                [-45.0, 76.0, 0.0, 1.0],
                [-97.0, -5.0, -1.0, 0.7],
                [-51.0, -84.0, 0.0, 0.6],
                [49.0, -80.0, 4.0, 0.6],
                [91.0, 0.0, -1.0, 0.9],
                [48.0, 79.0, 4.0, 1.2],
                [-46.0, 84.0, -5.0, 0.7],
                [-92.0, -1.0, -4.0, 1.5],
                [-53.0, -82.0, -3.0, 0.8],
                [51.0, -85.0, 0.0, 0.7],
                [95.0, -4.0, 0.0, 1.4],
                [50.0, 84.0, 3.0, 0.9],
                [-54.0, 82.0, 1.0, 1.1],
                [-104.0, -2.0, 2.0, 1.1],
                [-46.0, -85.0, 2.0, 0.6],
                [53.0, -87.0, -3.0, 0.9],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([-2.4, -0.6, 0.0, 0.0, 0.0, 0.8, 1.6, 3.4, 4.0, 4.0, 4.0, 4.8, 5.6]), 1
        )
        basis1 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1, 1.9, 3.0, 4.0, 4.9, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0])
        )
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 += np.array([7.4, 3.9, 2.9])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 7.400000
        pt2[..., 1] -= 3.900000
        pt2[..., 2] -= 2.900000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_surface_3D_p75_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [59.0, -3.0, 1.0, 1.5],
                [52.0, 32.0, -5.0, 0.7],
                [30.0, 56.0, -2.0, 1.3],
                [2.0, 55.0, -3.0, 0.7],
                [-33.0, 54.0, 2.0, 1.5],
                [-53.0, 34.0, 1.0, 1.5],
                [-64.0, 1.0, 4.0, 1.4],
                [-48.0, -35.0, 4.0, 1.0],
                [-27.0, -55.0, 2.0, 0.6],
                [3.0, -60.0, -5.0, 0.6],
                [33.0, -48.0, 4.0, 0.9],
                [49.0, -33.0, 0.0, 1.1],
                [65.0, -4.0, 3.0, 1.2],
                [60.0, 28.0, -3.0, 1.2],
                [35.0, 53.0, 1.0, 1.1],
                [2.0, 65.0, -3.0, 0.9],
                [-37.0, 59.0, 2.0, 0.7],
                [-62.0, 35.0, 1.0, 0.8],
                [-66.0, -3.0, -4.0, 0.9],
                [-63.0, -29.0, -4.0, 0.8],
                [-37.0, -61.0, 2.0, 1.4],
                [2.0, -70.0, 3.0, 1.1],
                [37.0, -58.0, 2.0, 0.7],
                [57.0, -31.0, 1.0, 0.7],
                [70.0, -1.0, 4.0, 0.9],
                [59.0, 39.0, -1.0, 1.2],
                [35.0, 64.0, -1.0, 0.6],
                [-2.0, 76.0, 0.0, 0.7],
                [-37.0, 67.0, -4.0, 1.0],
                [-63.0, 38.0, -4.0, 1.4],
                [-76.0, 1.0, -3.0, 1.3],
                [-65.0, -33.0, -4.0, 0.9],
                [-37.0, -68.0, -3.0, 0.8],
                [3.0, -74.0, 4.0, 1.3],
                [32.0, -62.0, 2.0, 1.5],
                [62.0, -39.0, 4.0, 0.5],
                [84.0, 4.0, 3.0, 0.6],
                [70.0, 44.0, -1.0, 1.2],
                [38.0, 72.0, -3.0, 0.7],
                [4.0, 84.0, 0.0, 1.1],
                [-39.0, 65.0, 3.0, 0.8],
                [-72.0, 36.0, 0.0, 1.5],
                [-85.0, -4.0, 0.0, 0.9],
                [-70.0, -40.0, -5.0, 1.2],
                [-43.0, -67.0, -1.0, 1.2],
                [-3.0, -85.0, -5.0, 1.4],
                [39.0, -74.0, -4.0, 1.1],
                [71.0, -39.0, 1.0, 0.7],
                [91.0, -5.0, -4.0, 0.9],
                [71.0, 42.0, 2.0, 1.4],
                [46.0, 75.0, 2.0, 0.6],
                [4.0, 89.0, 3.0, 1.1],
                [-47.0, 79.0, -5.0, 1.0],
                [-71.0, 43.0, -5.0, 0.9],
                [-85.0, 1.0, 3.0, 0.7],
                [-71.0, -42.0, 0.0, 1.4],
                [-48.0, -74.0, 0.0, 1.0],
                [0.0, -92.0, -4.0, 0.7],
                [39.0, -71.0, 1.0, 0.5],
                [71.0, -41.0, 4.0, 1.1],
                [93.0, -2.0, 4.0, 1.4],
                [77.0, 42.0, -5.0, 0.9],
                [46.0, 78.0, 2.0, 1.3],
                [-3.0, 92.0, 4.0, 0.7],
                [-43.0, 85.0, -3.0, 1.0],
                [-84.0, 50.0, 0.0, 1.0],
                [-95.0, 0.0, -4.0, 1.2],
                [-85.0, -52.0, -5.0, 1.4],
                [-51.0, -83.0, -5.0, 1.3],
                [2.0, -98.0, -2.0, 1.5],
                [50.0, -83.0, 1.0, 1.1],
                [76.0, -51.0, -3.0, 0.7],
                [102.0, -4.0, -4.0, 0.9],
                [86.0, 51.0, 1.0, 0.7],
                [50.0, 86.0, 3.0, 0.6],
                [2.0, 102.0, 4.0, 1.0],
                [-51.0, 91.0, 1.0, 0.8],
                [-87.0, 45.0, 2.0, 0.8],
                [-100.0, 3.0, -3.0, 1.1],
                [-83.0, -52.0, -1.0, 0.5],
                [-50.0, -83.0, -3.0, 1.1],
                [0.0, -99.0, -4.0, 1.4],
                [46.0, -83.0, 0.0, 0.9],
                [88.0, -46.0, -2.0, 0.6],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    -1.7,
                    -0.9,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.9,
                    1.9,
                    3.4,
                    4.1,
                    4.8,
                    6.3,
                    7.1,
                    8.0,
                    8.0,
                    8.0,
                    8.0,
                    8.0,
                    8.9,
                    9.9,
                ]
            ),
            1,
        )
        basis1 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 1.3, 2.2, 3.0, 3.0, 3.0, 3.0, 3.0]))
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2 *= np.array([6.6, 9.9, 8.5])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 6.600000
        pt2[..., 1] /= 9.900000
        pt2[..., 2] /= 8.500000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_surface_3D_p76_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [63.0, 1.0, -2.0, 1.1],
                [43.0, 35.0, -2.0, 0.9],
                [14.0, 61.0, 0.0, 1.5],
                [-28.0, 55.0, 3.0, 1.5],
                [-52.0, 24.0, 2.0, 0.8],
                [-54.0, -23.0, -5.0, 1.2],
                [-26.0, -50.0, -1.0, 1.1],
                [10.0, -61.0, -2.0, 0.6],
                [48.0, -37.0, -2.0, 0.7],
                [61.0, 3.0, -1.0, 0.9],
                [45.0, 42.0, 2.0, 0.7],
                [11.0, 66.0, 2.0, 0.7],
                [-31.0, 53.0, -2.0, 1.5],
                [-65.0, 20.0, -3.0, 1.0],
                [-62.0, -27.0, 2.0, 0.6],
                [-37.0, -55.0, -5.0, 1.1],
                [13.0, -63.0, -2.0, 0.5],
                [47.0, -41.0, 3.0, 1.3],
                [64.0, -5.0, -3.0, 1.1],
                [54.0, 40.0, -4.0, 1.2],
                [12.0, 69.0, -1.0, 1.0],
                [-39.0, 63.0, 1.0, 0.9],
                [-62.0, 18.0, -4.0, 0.9],
                [-68.0, -19.0, -1.0, 0.6],
                [-31.0, -63.0, -2.0, 0.7],
                [15.0, -70.0, -2.0, 1.4],
                [49.0, -49.0, -2.0, 0.6],
                [69.0, -5.0, 0.0, 1.0],
                [57.0, 41.0, -4.0, 0.8],
                [12.0, 66.0, -4.0, 1.2],
                [-35.0, 63.0, -1.0, 0.7],
                [-70.0, 25.0, 2.0, 1.3],
                [-72.0, -21.0, -3.0, 0.8],
                [-41.0, -61.0, -4.0, 1.0],
                [11.0, -71.0, -1.0, 0.7],
                [57.0, -45.0, 0.0, 1.1],
                [71.0, -3.0, 3.0, 1.2],
                [58.0, 46.0, 1.0, 0.8],
                [9.0, 75.0, 2.0, 1.1],
                [-38.0, 62.0, -3.0, 0.8],
                [-76.0, 28.0, 1.0, 0.5],
                [-76.0, -27.0, -2.0, 1.3],
                [-35.0, -66.0, 1.0, 0.9],
                [10.0, -79.0, -5.0, 0.8],
                [61.0, -45.0, 4.0, 1.1],
                [83.0, 1.0, 3.0, 1.2],
                [61.0, 53.0, -1.0, 0.7],
                [11.0, 78.0, -3.0, 1.1],
                [-39.0, 66.0, -2.0, 0.9],
                [-74.0, 22.0, 0.0, 0.9],
                [-77.0, -28.0, 0.0, 0.8],
                [-43.0, -69.0, 3.0, 0.7],
                [14.0, -77.0, 1.0, 1.3],
                [60.0, -53.0, 1.0, 0.8],
                [80.0, -1.0, 0.0, 0.7],
                [67.0, 51.0, 4.0, 1.1],
                [16.0, 84.0, -2.0, 1.4],
                [-40.0, 70.0, -4.0, 0.7],
                [-75.0, 33.0, -4.0, 0.7],
                [-79.0, -30.0, 3.0, 1.1],
                [-45.0, -77.0, 4.0, 0.8],
                [10.0, -84.0, -3.0, 1.4],
                [65.0, -54.0, 0.0, 0.5],
                [91.0, 3.0, 3.0, 1.2],
                [66.0, 60.0, -3.0, 0.7],
                [17.0, 90.0, 4.0, 1.1],
                [-40.0, 79.0, -3.0, 1.3],
                [-82.0, 33.0, -3.0, 1.5],
                [-80.0, -26.0, 3.0, 0.9],
                [-45.0, -77.0, 3.0, 1.4],
                [19.0, -88.0, 3.0, 1.5],
                [64.0, -61.0, 3.0, 1.1],
                [95.0, -3.0, 4.0, 1.1],
                [75.0, 56.0, 1.0, 0.6],
                [15.0, 85.0, 4.0, 0.6],
                [-45.0, 79.0, 4.0, 1.3],
                [-83.0, 31.0, 3.0, 0.8],
                [-83.0, -37.0, -3.0, 0.5],
                [-44.0, -85.0, -2.0, 1.5],
                [11.0, -91.0, -3.0, 0.8],
                [73.0, -55.0, -1.0, 1.2],
                [91.0, 0.0, 2.0, 0.6],
                [75.0, 61.0, 0.0, 1.4],
                [12.0, 90.0, 3.0, 1.4],
                [-44.0, 79.0, 3.0, 0.6],
                [-86.0, 30.0, 2.0, 0.8],
                [-95.0, -38.0, 4.0, 0.9],
                [-45.0, -85.0, 3.0, 1.3],
                [17.0, -93.0, -3.0, 1.3],
                [70.0, -64.0, -4.0, 0.9],
                [103.0, -3.0, -5.0, 0.8],
                [72.0, 64.0, 2.0, 1.2],
                [13.0, 99.0, 2.0, 0.7],
                [-53.0, 83.0, -5.0, 1.2],
                [-97.0, 31.0, -1.0, 1.2],
                [-90.0, -33.0, 2.0, 1.4],
                [-54.0, -84.0, -4.0, 1.2],
                [13.0, -97.0, -4.0, 0.6],
                [73.0, -61.0, -2.0, 1.4],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [-2.2, -0.7, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.1, 2.8, 4.3, 5.0, 5.0, 5.0, 5.0, 5.0, 6.0, 7.1]
            ),
            1,
        )
        basis1 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 1.8, 3.4, 3.7, 5.2, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0])
        )
        surf = Surface(basis0, basis1, controlpoints, True)
        surf2 = surf.clone()
        surf2.mirror([0, 1, 0])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 1] = -pt2[..., 1]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_volume_3D_p757_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [52.0, -5.0, -1.0, 0.6],
                [38.0, 23.0, 3.0, 0.8],
                [20.0, 48.0, 3.0, 1.0],
                [-4.0, 51.0, 3.0, 0.7],
                [-34.0, 38.0, 0.0, 0.8],
                [-48.0, 17.0, 1.0, 0.8],
                [-51.0, -19.0, 3.0, 1.5],
                [-34.0, -40.0, -1.0, 0.6],
                [-5.0, -50.0, -4.0, 1.3],
                [20.0, -45.0, 4.0, 0.7],
                [38.0, -27.0, -4.0, 0.8],
                [60.0, 1.0, -5.0, 1.4],
                [46.0, 35.0, 2.0, 0.5],
                [24.0, 51.0, 4.0, 1.3],
                [-5.0, 52.0, 0.0, 0.6],
                [-34.0, 43.0, -4.0, 1.2],
                [-59.0, 17.0, 3.0, 0.8],
                [-56.0, -16.0, -2.0, 0.9],
                [-33.0, -45.0, -3.0, 1.3],
                [-4.0, -56.0, 4.0, 1.0],
                [21.0, -52.0, -3.0, 1.0],
                [50.0, -36.0, 1.0, 0.5],
                [67.0, 4.0, 0.0, 1.4],
                [54.0, 38.0, -5.0, 1.2],
                [25.0, 57.0, 1.0, 1.1],
                [-8.0, 58.0, -3.0, 1.1],
                [-39.0, 44.0, 3.0, 0.7],
                [-60.0, 18.0, 4.0, 0.6],
                [-64.0, -22.0, 0.0, 1.1],
                [-43.0, -48.0, -1.0, 0.6],
                [-10.0, -64.0, 4.0, 0.8],
                [23.0, -59.0, -3.0, 1.2],
                [57.0, -37.0, -5.0, 0.7],
                [72.0, -3.0, -5.0, 0.7],
                [61.0, 39.0, -4.0, 1.0],
                [32.0, 65.0, 2.0, 0.9],
                [-9.0, 66.0, 2.0, 1.4],
                [-49.0, 49.0, 3.0, 1.2],
                [-73.0, 19.0, 0.0, 1.4],
                [-69.0, -22.0, 0.0, 1.1],
                [-45.0, -50.0, 2.0, 0.9],
                [-8.0, -67.0, 1.0, 1.5],
                [25.0, -66.0, -4.0, 1.4],
                [60.0, -41.0, -2.0, 0.9],
                [81.0, -5.0, -2.0, 1.4],
                [70.0, 38.0, 0.0, 1.1],
                [37.0, 76.0, 3.0, 1.5],
                [-10.0, 76.0, 4.0, 1.1],
                [-50.0, 62.0, 0.0, 0.6],
                [-77.0, 23.0, -2.0, 0.6],
                [-78.0, -18.0, 4.0, 0.5],
                [-52.0, -62.0, -3.0, 0.7],
                [-10.0, -74.0, -2.0, 1.1],
                [33.0, -72.0, -4.0, 1.0],
                [69.0, -38.0, 1.0, 0.9],
                [83.0, 3.0, -2.0, 0.8],
                [72.0, 46.0, -3.0, 1.4],
                [38.0, 79.0, -4.0, 1.1],
                [-11.0, 89.0, -5.0, 0.9],
                [-59.0, 64.0, -5.0, 0.6],
                [-82.0, 26.0, -5.0, 1.5],
                [-85.0, -25.0, -4.0, 1.2],
                [-55.0, -63.0, -1.0, 0.5],
                [-15.0, -90.0, 2.0, 0.8],
                [35.0, -78.0, -3.0, 1.0],
                [67.0, -51.0, -5.0, 0.9],
                [91.0, 2.0, -4.0, 1.1],
                [82.0, 49.0, 2.0, 1.1],
                [36.0, 86.0, -1.0, 0.8],
                [-19.0, 95.0, -3.0, 0.6],
                [-63.0, 73.0, -1.0, 0.6],
                [-88.0, 25.0, -1.0, 1.4],
                [-90.0, -27.0, 2.0, 1.4],
                [-65.0, -70.0, 1.0, 1.2],
                [-15.0, -93.0, 4.0, 1.0],
                [36.0, -89.0, 4.0, 0.8],
                [82.0, -49.0, -2.0, 0.8],
                [98.0, -2.0, 1.0, 0.9],
                [83.0, 50.0, 4.0, 1.3],
                [37.0, 95.0, 1.0, 1.2],
                [-11.0, 94.0, -5.0, 1.1],
                [-68.0, 77.0, 0.0, 1.1],
                [-93.0, 32.0, -4.0, 1.3],
                [-94.0, -30.0, 0.0, 0.6],
                [-61.0, -79.0, 0.0, 0.7],
                [-17.0, -100.0, -4.0, 1.1],
                [40.0, -92.0, 4.0, 1.4],
                [81.0, -55.0, -2.0, 1.2],
                [53.0, -3.0, 5.0, 1.1],
                [43.0, 29.0, 2.0, 0.6],
                [17.0, 42.0, 3.0, 1.1],
                [-7.0, 46.0, 0.0, 1.2],
                [-34.0, 41.0, 3.0, 0.8],
                [-47.0, 17.0, 5.0, 0.9],
                [-46.0, -19.0, -1.0, 1.1],
                [-35.0, -43.0, 8.0, 1.0],
                [-8.0, -55.0, 5.0, 1.2],
                [22.0, -49.0, 2.0, 0.5],
                [39.0, -25.0, 5.0, 0.7],
                [61.0, 1.0, 0.0, 1.2],
                [50.0, 35.0, 4.0, 0.5],
                [26.0, 49.0, 1.0, 1.4],
                [-9.0, 59.0, 5.0, 1.2],
                [-36.0, 41.0, 4.0, 0.6],
                [-52.0, 13.0, 0.0, 0.9],
                [-50.0, -18.0, 8.0, 1.1],
                [-35.0, -43.0, 2.0, 0.7],
                [-9.0, -55.0, 1.0, 1.2],
                [19.0, -51.0, 8.0, 0.6],
                [47.0, -35.0, 2.0, 1.1],
                [65.0, -5.0, 6.0, 0.8],
                [55.0, 38.0, 1.0, 1.2],
                [31.0, 53.0, 6.0, 1.3],
                [-13.0, 61.0, 3.0, 1.2],
                [-42.0, 46.0, 0.0, 1.2],
                [-63.0, 19.0, -1.0, 0.9],
                [-60.0, -21.0, 4.0, 1.5],
                [-43.0, -45.0, 8.0, 0.9],
                [-13.0, -67.0, 6.0, 1.1],
                [22.0, -57.0, 5.0, 0.8],
                [49.0, -36.0, -1.0, 1.0],
                [69.0, -1.0, 5.0, 0.9],
                [64.0, 42.0, 5.0, 1.4],
                [28.0, 66.0, -1.0, 0.7],
                [-8.0, 70.0, 8.0, 1.4],
                [-44.0, 55.0, 3.0, 0.9],
                [-70.0, 16.0, 5.0, 0.9],
                [-68.0, -19.0, 1.0, 0.5],
                [-44.0, -59.0, 2.0, 1.3],
                [-15.0, -69.0, 2.0, 1.4],
                [25.0, -68.0, 7.0, 1.1],
                [60.0, -39.0, 1.0, 1.1],
                [77.0, -3.0, 0.0, 0.8],
                [69.0, 41.0, -1.0, 1.3],
                [35.0, 67.0, 2.0, 1.4],
                [-12.0, 73.0, 1.0, 1.2],
                [-52.0, 63.0, 5.0, 0.8],
                [-74.0, 21.0, 6.0, 0.7],
                [-80.0, -25.0, 2.0, 1.2],
                [-48.0, -55.0, 3.0, 1.1],
                [-10.0, -76.0, 5.0, 0.9],
                [31.0, -74.0, 6.0, 0.6],
                [69.0, -40.0, -1.0, 1.0],
                [89.0, -2.0, 5.0, 0.6],
                [67.0, 48.0, 6.0, 1.1],
                [33.0, 80.0, 2.0, 1.0],
                [-11.0, 86.0, -1.0, 1.0],
                [-55.0, 69.0, 0.0, 1.4],
                [-87.0, 25.0, 6.0, 1.0],
                [-79.0, -27.0, 3.0, 0.6],
                [-60.0, -68.0, -1.0, 1.5],
                [-10.0, -86.0, 5.0, 1.2],
                [37.0, -78.0, 1.0, 0.7],
                [76.0, -48.0, 5.0, 1.4],
                [93.0, -5.0, 6.0, 1.4],
                [75.0, 45.0, 8.0, 1.4],
                [38.0, 86.0, 3.0, 1.5],
                [-13.0, 90.0, 4.0, 1.3],
                [-65.0, 74.0, 3.0, 1.2],
                [-85.0, 23.0, 0.0, 0.5],
                [-85.0, -23.0, 1.0, 0.9],
                [-59.0, -74.0, 1.0, 0.7],
                [-11.0, -95.0, 0.0, 0.7],
                [37.0, -86.0, 3.0, 1.0],
                [76.0, -53.0, 3.0, 1.2],
                [104.0, 3.0, 6.0, 0.8],
                [88.0, 54.0, 0.0, 0.5],
                [41.0, 93.0, 7.0, 1.1],
                [-16.0, 99.0, 7.0, 1.2],
                [-63.0, 71.0, 3.0, 1.2],
                [-101.0, 32.0, 0.0, 1.2],
                [-96.0, -25.0, 2.0, 1.4],
                [-70.0, -78.0, 6.0, 1.3],
                [-18.0, -104.0, 7.0, 0.7],
                [40.0, -87.0, 3.0, 1.3],
                [83.0, -51.0, 7.0, 1.0],
                [47.0, -1.0, 6.0, 1.4],
                [45.0, 23.0, 7.0, 0.5],
                [23.0, 41.0, 9.0, 0.9],
                [-8.0, 51.0, 12.0, 1.2],
                [-37.0, 33.0, 5.0, 0.8],
                [-48.0, 13.0, 3.0, 0.6],
                [-52.0, -19.0, 7.0, 1.4],
                [-37.0, -37.0, 7.0, 0.7],
                [-10.0, -49.0, 7.0, 1.2],
                [18.0, -48.0, 5.0, 1.0],
                [41.0, -27.0, 9.0, 1.2],
                [60.0, -2.0, 10.0, 0.6],
                [51.0, 31.0, 7.0, 1.0],
                [22.0, 53.0, 3.0, 0.8],
                [-12.0, 56.0, 9.0, 0.6],
                [-40.0, 40.0, 11.0, 0.6],
                [-51.0, 15.0, 10.0, 0.6],
                [-59.0, -18.0, 7.0, 0.7],
                [-39.0, -43.0, 6.0, 1.4],
                [-9.0, -57.0, 7.0, 0.8],
                [22.0, -50.0, 3.0, 1.4],
                [47.0, -27.0, 4.0, 1.3],
                [59.0, 3.0, 8.0, 0.8],
                [56.0, 38.0, 3.0, 1.2],
                [25.0, 61.0, 4.0, 1.1],
                [-11.0, 65.0, 11.0, 1.0],
                [-40.0, 51.0, 10.0, 1.3],
                [-59.0, 14.0, 12.0, 1.0],
                [-64.0, -16.0, 5.0, 1.1],
                [-46.0, -52.0, 5.0, 1.0],
                [-5.0, -63.0, 7.0, 1.4],
                [23.0, -58.0, 4.0, 0.8],
                [52.0, -33.0, 9.0, 1.2],
                [75.0, 0.0, 9.0, 0.5],
                [58.0, 36.0, 11.0, 1.2],
                [30.0, 63.0, 5.0, 0.6],
                [-15.0, 74.0, 11.0, 0.6],
                [-48.0, 57.0, 11.0, 1.0],
                [-73.0, 22.0, 3.0, 0.8],
                [-69.0, -23.0, 4.0, 1.2],
                [-44.0, -57.0, 7.0, 1.5],
                [-14.0, -71.0, 9.0, 1.2],
                [25.0, -63.0, 5.0, 1.3],
                [55.0, -34.0, 9.0, 0.6],
                [79.0, 1.0, 12.0, 1.2],
                [62.0, 41.0, 3.0, 1.3],
                [30.0, 74.0, 3.0, 1.5],
                [-9.0, 80.0, 12.0, 0.8],
                [-55.0, 58.0, 11.0, 0.5],
                [-79.0, 18.0, 10.0, 0.6],
                [-73.0, -19.0, 9.0, 1.3],
                [-50.0, -58.0, 5.0, 0.8],
                [-13.0, -78.0, 11.0, 0.8],
                [36.0, -68.0, 12.0, 0.7],
                [64.0, -43.0, 10.0, 0.8],
                [84.0, -3.0, 11.0, 1.5],
                [69.0, 47.0, 12.0, 0.9],
                [32.0, 75.0, 6.0, 1.2],
                [-10.0, 89.0, 4.0, 1.1],
                [-53.0, 64.0, 5.0, 0.6],
                [-83.0, 26.0, 10.0, 0.6],
                [-83.0, -21.0, 11.0, 1.3],
                [-52.0, -70.0, 3.0, 1.2],
                [-8.0, -83.0, 5.0, 1.1],
                [39.0, -78.0, 12.0, 1.1],
                [68.0, -49.0, 5.0, 1.2],
                [93.0, 4.0, 8.0, 0.8],
                [76.0, 51.0, 4.0, 1.2],
                [35.0, 85.0, 4.0, 1.4],
                [-11.0, 92.0, 8.0, 1.1],
                [-60.0, 69.0, 10.0, 1.0],
                [-86.0, 22.0, 4.0, 1.0],
                [-86.0, -24.0, 11.0, 0.7],
                [-58.0, -73.0, 6.0, 0.5],
                [-10.0, -90.0, 5.0, 1.1],
                [37.0, -82.0, 7.0, 0.9],
                [81.0, -55.0, 9.0, 1.5],
                [95.0, 3.0, 4.0, 1.1],
                [86.0, 51.0, 11.0, 0.5],
                [37.0, 90.0, 9.0, 0.9],
                [-10.0, 99.0, 11.0, 0.6],
                [-66.0, 73.0, 11.0, 1.1],
                [-95.0, 30.0, 10.0, 0.7],
                [-97.0, -26.0, 4.0, 0.5],
                [-68.0, -71.0, 10.0, 0.5],
                [-12.0, -95.0, 5.0, 0.6],
                [41.0, -92.0, 5.0, 1.0],
                [82.0, -60.0, 5.0, 1.4],
                [54.0, 1.0, 11.0, 0.6],
                [42.0, 31.0, 13.0, 1.3],
                [18.0, 44.0, 12.0, 1.0],
                [-8.0, 45.0, 16.0, 0.6],
                [-30.0, 39.0, 8.0, 1.0],
                [-50.0, 12.0, 14.0, 1.2],
                [-45.0, -18.0, 15.0, 0.8],
                [-29.0, -40.0, 11.0, 0.6],
                [-6.0, -53.0, 11.0, 0.9],
                [19.0, -45.0, 16.0, 1.4],
                [42.0, -27.0, 11.0, 0.9],
                [58.0, 4.0, 7.0, 1.1],
                [47.0, 30.0, 11.0, 1.0],
                [26.0, 47.0, 14.0, 1.0],
                [-9.0, 51.0, 14.0, 1.1],
                [-40.0, 44.0, 12.0, 1.0],
                [-56.0, 20.0, 16.0, 0.6],
                [-60.0, -16.0, 9.0, 1.3],
                [-36.0, -44.0, 14.0, 1.1],
                [-4.0, -54.0, 11.0, 0.7],
                [20.0, -50.0, 9.0, 0.6],
                [47.0, -28.0, 7.0, 1.3],
                [60.0, 2.0, 12.0, 1.5],
                [56.0, 37.0, 14.0, 0.7],
                [27.0, 54.0, 16.0, 0.7],
                [-8.0, 67.0, 8.0, 0.9],
                [-38.0, 52.0, 16.0, 1.0],
                [-66.0, 21.0, 12.0, 1.1],
                [-66.0, -18.0, 14.0, 0.7],
                [-39.0, -48.0, 16.0, 1.2],
                [-13.0, -63.0, 14.0, 1.3],
                [22.0, -55.0, 8.0, 0.6],
                [53.0, -32.0, 16.0, 0.7],
                [74.0, 2.0, 16.0, 0.5],
                [61.0, 42.0, 8.0, 0.5],
                [29.0, 68.0, 12.0, 0.6],
                [-13.0, 68.0, 16.0, 1.1],
                [-45.0, 55.0, 16.0, 1.1],
                [-67.0, 19.0, 16.0, 1.2],
                [-73.0, -20.0, 11.0, 1.5],
                [-49.0, -55.0, 14.0, 0.7],
                [-9.0, -70.0, 7.0, 0.9],
                [25.0, -69.0, 16.0, 1.3],
                [61.0, -35.0, 15.0, 0.7],
                [79.0, -1.0, 14.0, 1.1],
                [63.0, 43.0, 16.0, 0.5],
                [31.0, 75.0, 14.0, 1.2],
                [-16.0, 77.0, 16.0, 0.9],
                [-51.0, 56.0, 14.0, 0.6],
                [-71.0, 24.0, 8.0, 0.6],
                [-73.0, -24.0, 9.0, 1.0],
                [-53.0, -61.0, 14.0, 1.0],
                [-15.0, -78.0, 9.0, 1.1],
                [32.0, -75.0, 8.0, 1.2],
                [69.0, -44.0, 9.0, 1.0],
                [85.0, -1.0, 10.0, 0.5],
                [76.0, 45.0, 15.0, 1.1],
                [39.0, 74.0, 8.0, 1.2],
                [-8.0, 84.0, 16.0, 1.5],
                [-56.0, 61.0, 10.0, 1.5],
                [-85.0, 28.0, 12.0, 0.9],
                [-81.0, -20.0, 10.0, 1.2],
                [-59.0, -68.0, 14.0, 1.3],
                [-17.0, -85.0, 16.0, 1.0],
                [31.0, -81.0, 12.0, 1.2],
                [70.0, -42.0, 7.0, 1.2],
                [87.0, 4.0, 10.0, 1.1],
                [79.0, 49.0, 7.0, 0.9],
                [41.0, 80.0, 10.0, 1.1],
                [-16.0, 87.0, 11.0, 1.1],
                [-62.0, 67.0, 14.0, 0.8],
                [-94.0, 25.0, 15.0, 1.2],
                [-93.0, -28.0, 7.0, 0.6],
                [-64.0, -70.0, 11.0, 0.9],
                [-17.0, -92.0, 12.0, 1.3],
                [36.0, -80.0, 11.0, 1.0],
                [74.0, -49.0, 8.0, 0.9],
                [102.0, -4.0, 10.0, 1.2],
                [87.0, 57.0, 8.0, 1.0],
                [42.0, 89.0, 16.0, 1.5],
                [-18.0, 96.0, 14.0, 1.1],
                [-67.0, 71.0, 16.0, 1.5],
                [-91.0, 26.0, 16.0, 0.6],
                [-92.0, -32.0, 13.0, 1.1],
                [-69.0, -76.0, 14.0, 1.2],
                [-15.0, -98.0, 7.0, 1.3],
                [38.0, -96.0, 11.0, 0.7],
                [85.0, -52.0, 15.0, 1.1],
                [48.0, -5.0, 13.0, 1.0],
                [42.0, 26.0, 11.0, 1.3],
                [21.0, 45.0, 15.0, 1.2],
                [-11.0, 53.0, 15.0, 1.0],
                [-34.0, 40.0, 12.0, 1.2],
                [-44.0, 12.0, 16.0, 1.0],
                [-46.0, -11.0, 14.0, 0.5],
                [-35.0, -33.0, 18.0, 0.7],
                [-3.0, -49.0, 12.0, 0.6],
                [18.0, -48.0, 14.0, 1.3],
                [46.0, -29.0, 20.0, 0.9],
                [60.0, 0.0, 12.0, 0.9],
                [43.0, 29.0, 16.0, 0.7],
                [26.0, 50.0, 11.0, 0.5],
                [-8.0, 57.0, 14.0, 1.2],
                [-42.0, 38.0, 19.0, 0.6],
                [-56.0, 11.0, 16.0, 1.4],
                [-56.0, -13.0, 16.0, 0.9],
                [-42.0, -45.0, 11.0, 1.0],
                [-8.0, -53.0, 15.0, 0.5],
                [27.0, -52.0, 11.0, 1.2],
                [46.0, -36.0, 14.0, 0.7],
                [64.0, -1.0, 19.0, 0.7],
                [54.0, 34.0, 11.0, 1.1],
                [22.0, 63.0, 20.0, 1.0],
                [-12.0, 67.0, 16.0, 1.1],
                [-44.0, 48.0, 17.0, 1.5],
                [-60.0, 14.0, 14.0, 0.5],
                [-65.0, -22.0, 12.0, 1.1],
                [-47.0, -46.0, 13.0, 0.6],
                [-10.0, -61.0, 13.0, 0.7],
                [24.0, -60.0, 14.0, 1.2],
                [58.0, -33.0, 19.0, 0.7],
                [72.0, 4.0, 20.0, 0.5],
                [59.0, 34.0, 15.0, 1.5],
                [29.0, 61.0, 14.0, 0.5],
                [-13.0, 72.0, 17.0, 1.0],
                [-51.0, 53.0, 19.0, 1.4],
                [-72.0, 19.0, 18.0, 0.7],
                [-69.0, -24.0, 12.0, 1.1],
                [-46.0, -51.0, 12.0, 0.9],
                [-12.0, -73.0, 13.0, 1.0],
                [33.0, -65.0, 19.0, 0.7],
                [57.0, -38.0, 18.0, 0.9],
                [80.0, -4.0, 18.0, 1.3],
                [65.0, 37.0, 16.0, 0.6],
                [32.0, 68.0, 17.0, 0.9],
                [-16.0, 73.0, 11.0, 1.3],
                [-53.0, 57.0, 17.0, 0.9],
                [-75.0, 17.0, 19.0, 1.5],
                [-79.0, -24.0, 16.0, 0.8],
                [-53.0, -58.0, 17.0, 1.2],
                [-16.0, -77.0, 17.0, 0.6],
                [28.0, -67.0, 16.0, 1.0],
                [67.0, -41.0, 13.0, 0.6],
                [84.0, -2.0, 19.0, 1.0],
                [68.0, 49.0, 11.0, 1.2],
                [36.0, 81.0, 18.0, 0.5],
                [-9.0, 88.0, 19.0, 0.7],
                [-52.0, 68.0, 15.0, 1.0],
                [-85.0, 26.0, 13.0, 0.8],
                [-87.0, -23.0, 16.0, 0.8],
                [-58.0, -68.0, 13.0, 1.2],
                [-13.0, -89.0, 13.0, 0.5],
                [32.0, -83.0, 19.0, 1.0],
                [73.0, -45.0, 13.0, 0.9],
                [91.0, -4.0, 13.0, 0.8],
                [75.0, 53.0, 19.0, 0.6],
                [36.0, 82.0, 16.0, 1.2],
                [-17.0, 88.0, 14.0, 1.1],
                [-57.0, 69.0, 13.0, 0.7],
                [-85.0, 22.0, 13.0, 1.1],
                [-85.0, -26.0, 13.0, 1.3],
                [-56.0, -74.0, 12.0, 0.6],
                [-16.0, -97.0, 15.0, 0.6],
                [33.0, -80.0, 13.0, 0.8],
                [78.0, -47.0, 15.0, 1.0],
                [99.0, 0.0, 16.0, 0.8],
                [86.0, 49.0, 19.0, 1.5],
                [42.0, 92.0, 14.0, 0.6],
                [-18.0, 95.0, 19.0, 1.3],
                [-63.0, 79.0, 13.0, 0.9],
                [-101.0, 29.0, 19.0, 0.8],
                [-93.0, -31.0, 11.0, 0.6],
                [-66.0, -73.0, 12.0, 0.7],
                [-18.0, -98.0, 12.0, 0.6],
                [44.0, -88.0, 13.0, 0.5],
                [84.0, -53.0, 12.0, 1.3],
                [46.0, 1.0, 15.0, 1.3],
                [42.0, 29.0, 22.0, 0.6],
                [18.0, 44.0, 19.0, 1.0],
                [-7.0, 54.0, 24.0, 0.9],
                [-37.0, 37.0, 16.0, 0.6],
                [-48.0, 15.0, 15.0, 0.7],
                [-44.0, -18.0, 20.0, 1.1],
                [-34.0, -39.0, 20.0, 1.4],
                [-8.0, -45.0, 17.0, 0.9],
                [17.0, -45.0, 24.0, 1.4],
                [38.0, -32.0, 19.0, 0.7],
                [55.0, 0.0, 21.0, 1.3],
                [51.0, 33.0, 18.0, 0.5],
                [18.0, 52.0, 17.0, 0.7],
                [-8.0, 59.0, 16.0, 0.6],
                [-40.0, 46.0, 24.0, 1.2],
                [-51.0, 14.0, 23.0, 0.5],
                [-59.0, -13.0, 21.0, 0.5],
                [-38.0, -40.0, 21.0, 0.9],
                [-8.0, -58.0, 16.0, 1.4],
                [21.0, -52.0, 22.0, 0.6],
                [47.0, -36.0, 24.0, 1.4],
                [63.0, -3.0, 17.0, 0.5],
                [55.0, 32.0, 18.0, 1.0],
                [25.0, 57.0, 18.0, 1.2],
                [-6.0, 63.0, 19.0, 1.4],
                [-41.0, 44.0, 15.0, 0.6],
                [-58.0, 20.0, 17.0, 0.9],
                [-66.0, -15.0, 17.0, 1.2],
                [-45.0, -51.0, 24.0, 1.3],
                [-10.0, -61.0, 15.0, 1.3],
                [30.0, -57.0, 20.0, 0.8],
                [55.0, -32.0, 23.0, 1.3],
                [71.0, -2.0, 21.0, 1.3],
                [62.0, 43.0, 20.0, 0.6],
                [28.0, 62.0, 24.0, 1.2],
                [-15.0, 71.0, 24.0, 1.3],
                [-51.0, 55.0, 21.0, 0.6],
                [-64.0, 22.0, 22.0, 0.7],
                [-69.0, -22.0, 20.0, 0.9],
                [-48.0, -56.0, 17.0, 1.1],
                [-6.0, -67.0, 19.0, 1.4],
                [30.0, -70.0, 21.0, 0.9],
                [55.0, -42.0, 16.0, 0.7],
                [83.0, -4.0, 15.0, 1.0],
                [61.0, 43.0, 18.0, 0.7],
                [29.0, 68.0, 16.0, 0.8],
                [-8.0, 80.0, 22.0, 0.6],
                [-48.0, 61.0, 24.0, 0.6],
                [-73.0, 26.0, 17.0, 1.4],
                [-78.0, -26.0, 20.0, 1.5],
                [-55.0, -58.0, 19.0, 0.9],
                [-11.0, -78.0, 19.0, 0.7],
                [31.0, -67.0, 18.0, 1.4],
                [63.0, -47.0, 18.0, 1.3],
                [84.0, -2.0, 16.0, 1.0],
                [72.0, 42.0, 21.0, 0.7],
                [38.0, 81.0, 24.0, 0.9],
                [-9.0, 87.0, 22.0, 0.6],
                [-53.0, 68.0, 15.0, 0.6],
                [-85.0, 21.0, 21.0, 1.2],
                [-86.0, -23.0, 17.0, 0.8],
                [-56.0, -61.0, 17.0, 1.0],
                [-13.0, -87.0, 16.0, 0.7],
                [30.0, -78.0, 20.0, 1.2],
                [72.0, -51.0, 23.0, 1.0],
                [89.0, -5.0, 24.0, 1.0],
                [76.0, 45.0, 18.0, 0.8],
                [33.0, 83.0, 23.0, 1.1],
                [-16.0, 93.0, 20.0, 1.4],
                [-59.0, 69.0, 15.0, 0.7],
                [-89.0, 25.0, 16.0, 0.6],
                [-86.0, -29.0, 20.0, 1.4],
                [-61.0, -68.0, 16.0, 1.0],
                [-19.0, -92.0, 16.0, 0.9],
                [34.0, -88.0, 19.0, 0.8],
                [79.0, -52.0, 17.0, 1.4],
                [99.0, 1.0, 18.0, 0.7],
                [80.0, 53.0, 20.0, 1.4],
                [40.0, 86.0, 16.0, 1.3],
                [-19.0, 96.0, 15.0, 1.1],
                [-65.0, 72.0, 22.0, 1.1],
                [-97.0, 23.0, 23.0, 1.3],
                [-92.0, -29.0, 22.0, 1.5],
                [-69.0, -71.0, 22.0, 1.0],
                [-19.0, -97.0, 24.0, 0.8],
                [39.0, -92.0, 17.0, 1.2],
                [84.0, -56.0, 24.0, 1.5],
                [53.0, -1.0, 19.0, 0.7],
                [39.0, 30.0, 28.0, 0.9],
                [17.0, 41.0, 19.0, 1.1],
                [-10.0, 45.0, 20.0, 1.2],
                [-33.0, 38.0, 20.0, 1.4],
                [-47.0, 9.0, 23.0, 1.1],
                [-52.0, -12.0, 20.0, 1.4],
                [-34.0, -34.0, 23.0, 0.5],
                [-5.0, -50.0, 19.0, 1.4],
                [17.0, -51.0, 27.0, 0.5],
                [43.0, -30.0, 19.0, 1.1],
                [61.0, -5.0, 28.0, 0.6],
                [47.0, 26.0, 21.0, 1.2],
                [28.0, 49.0, 26.0, 0.7],
                [-12.0, 55.0, 24.0, 0.6],
                [-34.0, 43.0, 28.0, 1.4],
                [-52.0, 16.0, 28.0, 1.1],
                [-58.0, -14.0, 28.0, 0.7],
                [-36.0, -48.0, 19.0, 0.5],
                [-9.0, -62.0, 27.0, 1.4],
                [25.0, -54.0, 19.0, 0.9],
                [49.0, -31.0, 28.0, 1.5],
                [64.0, 0.0, 20.0, 1.4],
                [50.0, 30.0, 22.0, 0.5],
                [26.0, 60.0, 23.0, 1.2],
                [-10.0, 61.0, 27.0, 0.6],
                [-39.0, 48.0, 22.0, 1.4],
                [-60.0, 18.0, 24.0, 1.1],
                [-59.0, -22.0, 28.0, 1.5],
                [-43.0, -53.0, 27.0, 1.4],
                [-8.0, -59.0, 20.0, 1.0],
                [28.0, -57.0, 23.0, 0.6],
                [58.0, -31.0, 19.0, 1.3],
                [68.0, 4.0, 21.0, 0.8],
                [58.0, 37.0, 20.0, 1.2],
                [28.0, 62.0, 25.0, 1.0],
                [-8.0, 68.0, 25.0, 1.3],
                [-50.0, 50.0, 24.0, 0.7],
                [-73.0, 17.0, 25.0, 1.1],
                [-69.0, -22.0, 25.0, 1.1],
                [-44.0, -58.0, 19.0, 1.1],
                [-8.0, -74.0, 27.0, 0.6],
                [25.0, -63.0, 22.0, 1.4],
                [64.0, -34.0, 27.0, 1.4],
                [77.0, 2.0, 28.0, 0.7],
                [66.0, 45.0, 21.0, 0.6],
                [30.0, 68.0, 26.0, 1.1],
                [-7.0, 76.0, 27.0, 1.1],
                [-54.0, 59.0, 20.0, 0.7],
                [-73.0, 22.0, 20.0, 0.6],
                [-74.0, -20.0, 24.0, 1.0],
                [-48.0, -55.0, 21.0, 0.8],
                [-7.0, -77.0, 27.0, 1.1],
                [37.0, -73.0, 28.0, 0.8],
                [66.0, -39.0, 20.0, 0.6],
                [80.0, 1.0, 19.0, 0.8],
                [75.0, 43.0, 26.0, 0.5],
                [31.0, 73.0, 20.0, 0.8],
                [-9.0, 85.0, 27.0, 0.6],
                [-57.0, 66.0, 23.0, 1.3],
                [-81.0, 23.0, 26.0, 0.5],
                [-85.0, -26.0, 27.0, 1.0],
                [-53.0, -62.0, 28.0, 1.4],
                [-15.0, -83.0, 28.0, 1.3],
                [34.0, -81.0, 27.0, 0.7],
                [72.0, -49.0, 26.0, 1.4],
                [90.0, 4.0, 19.0, 0.6],
                [79.0, 54.0, 19.0, 0.8],
                [35.0, 82.0, 20.0, 1.1],
                [-16.0, 90.0, 27.0, 1.1],
                [-61.0, 69.0, 24.0, 1.1],
                [-87.0, 21.0, 20.0, 1.0],
                [-89.0, -30.0, 22.0, 0.6],
                [-65.0, -67.0, 27.0, 0.9],
                [-17.0, -96.0, 23.0, 0.6],
                [34.0, -83.0, 19.0, 0.9],
                [76.0, -53.0, 21.0, 0.7],
                [99.0, -4.0, 19.0, 1.5],
                [85.0, 56.0, 28.0, 1.2],
                [40.0, 94.0, 27.0, 1.0],
                [-15.0, 100.0, 19.0, 1.0],
                [-66.0, 78.0, 25.0, 1.2],
                [-94.0, 32.0, 26.0, 0.6],
                [-98.0, -26.0, 23.0, 1.1],
                [-64.0, -79.0, 19.0, 1.0],
                [-14.0, -102.0, 22.0, 0.6],
                [36.0, -96.0, 27.0, 0.8],
                [83.0, -54.0, 27.0, 1.1],
                [49.0, 0.0, 29.0, 1.5],
                [42.0, 27.0, 32.0, 1.2],
                [21.0, 47.0, 30.0, 1.2],
                [-8.0, 44.0, 29.0, 1.2],
                [-29.0, 34.0, 30.0, 0.6],
                [-46.0, 10.0, 25.0, 1.0],
                [-45.0, -14.0, 28.0, 1.2],
                [-37.0, -37.0, 24.0, 1.5],
                [-10.0, -51.0, 28.0, 1.4],
                [25.0, -46.0, 27.0, 1.3],
                [45.0, -23.0, 27.0, 1.1],
                [58.0, -3.0, 28.0, 0.9],
                [49.0, 34.0, 27.0, 0.7],
                [22.0, 48.0, 29.0, 0.9],
                [-11.0, 60.0, 24.0, 1.0],
                [-36.0, 43.0, 27.0, 0.8],
                [-51.0, 13.0, 30.0, 1.4],
                [-60.0, -18.0, 26.0, 1.2],
                [-43.0, -41.0, 27.0, 0.7],
                [-13.0, -56.0, 23.0, 1.3],
                [18.0, -48.0, 24.0, 1.5],
                [43.0, -28.0, 24.0, 1.4],
                [65.0, -3.0, 24.0, 0.6],
                [57.0, 39.0, 25.0, 0.6],
                [22.0, 53.0, 27.0, 0.5],
                [-5.0, 63.0, 30.0, 1.0],
                [-41.0, 49.0, 24.0, 0.6],
                [-67.0, 20.0, 24.0, 0.6],
                [-64.0, -21.0, 26.0, 0.9],
                [-44.0, -45.0, 23.0, 1.5],
                [-13.0, -68.0, 30.0, 0.9],
                [24.0, -62.0, 27.0, 0.8],
                [50.0, -30.0, 30.0, 1.2],
                [70.0, 2.0, 26.0, 1.3],
                [57.0, 39.0, 27.0, 1.3],
                [28.0, 65.0, 28.0, 1.4],
                [-13.0, 72.0, 29.0, 0.7],
                [-50.0, 56.0, 25.0, 0.5],
                [-65.0, 23.0, 29.0, 1.0],
                [-70.0, -24.0, 30.0, 0.7],
                [-45.0, -56.0, 29.0, 1.0],
                [-7.0, -68.0, 29.0, 1.4],
                [33.0, -66.0, 28.0, 1.1],
                [56.0, -41.0, 27.0, 1.2],
                [78.0, -4.0, 30.0, 0.8],
                [64.0, 42.0, 25.0, 0.9],
                [33.0, 69.0, 31.0, 1.1],
                [-10.0, 81.0, 23.0, 1.2],
                [-53.0, 58.0, 24.0, 1.4],
                [-80.0, 18.0, 26.0, 0.8],
                [-72.0, -26.0, 27.0, 0.8],
                [-56.0, -64.0, 30.0, 1.4],
                [-10.0, -77.0, 31.0, 0.5],
                [32.0, -67.0, 28.0, 1.0],
                [64.0, -46.0, 29.0, 0.8],
                [83.0, 2.0, 31.0, 1.1],
                [70.0, 42.0, 29.0, 0.8],
                [38.0, 79.0, 26.0, 1.0],
                [-17.0, 82.0, 30.0, 1.2],
                [-57.0, 65.0, 23.0, 1.3],
                [-81.0, 27.0, 30.0, 1.4],
                [-86.0, -27.0, 26.0, 0.8],
                [-61.0, -65.0, 31.0, 0.7],
                [-16.0, -85.0, 28.0, 1.4],
                [32.0, -75.0, 31.0, 0.5],
                [75.0, -47.0, 30.0, 0.8],
                [96.0, 2.0, 29.0, 1.1],
                [75.0, 53.0, 26.0, 1.3],
                [34.0, 81.0, 31.0, 1.1],
                [-15.0, 94.0, 23.0, 1.3],
                [-58.0, 71.0, 26.0, 0.9],
                [-93.0, 23.0, 28.0, 0.7],
                [-85.0, -31.0, 25.0, 1.4],
                [-63.0, -72.0, 28.0, 1.1],
                [-14.0, -94.0, 32.0, 1.2],
                [38.0, -88.0, 30.0, 1.3],
                [74.0, -55.0, 30.0, 0.8],
                [99.0, 0.0, 30.0, 1.5],
                [83.0, 59.0, 28.0, 1.1],
                [43.0, 89.0, 26.0, 1.4],
                [-13.0, 101.0, 27.0, 1.1],
                [-64.0, 79.0, 27.0, 0.9],
                [-98.0, 29.0, 32.0, 0.6],
                [-100.0, -33.0, 27.0, 1.2],
                [-66.0, -76.0, 29.0, 0.9],
                [-10.0, -96.0, 29.0, 0.6],
                [43.0, -92.0, 29.0, 0.8],
                [83.0, -56.0, 32.0, 1.0],
                [52.0, 0.0, 30.0, 0.7],
                [41.0, 22.0, 32.0, 1.2],
                [24.0, 48.0, 36.0, 0.9],
                [-7.0, 49.0, 33.0, 0.7],
                [-31.0, 41.0, 28.0, 0.5],
                [-50.0, 15.0, 27.0, 0.9],
                [-45.0, -17.0, 28.0, 1.1],
                [-30.0, -42.0, 30.0, 1.3],
                [-9.0, -50.0, 31.0, 0.5],
                [24.0, -48.0, 33.0, 0.7],
                [42.0, -31.0, 27.0, 0.7],
                [60.0, -5.0, 32.0, 0.5],
                [49.0, 32.0, 36.0, 0.8],
                [26.0, 56.0, 31.0, 1.4],
                [-5.0, 59.0, 34.0, 0.9],
                [-37.0, 43.0, 33.0, 1.3],
                [-58.0, 14.0, 34.0, 0.7],
                [-58.0, -14.0, 30.0, 1.0],
                [-34.0, -40.0, 27.0, 1.3],
                [-11.0, -55.0, 34.0, 1.3],
                [22.0, -54.0, 35.0, 1.5],
                [51.0, -35.0, 31.0, 1.4],
                [60.0, 4.0, 28.0, 0.7],
                [53.0, 38.0, 34.0, 1.4],
                [25.0, 62.0, 28.0, 0.8],
                [-10.0, 62.0, 35.0, 1.5],
                [-46.0, 50.0, 34.0, 1.0],
                [-60.0, 23.0, 32.0, 1.2],
                [-67.0, -19.0, 33.0, 1.4],
                [-46.0, -52.0, 31.0, 1.2],
                [-13.0, -59.0, 29.0, 1.4],
                [26.0, -59.0, 35.0, 1.1],
                [51.0, -39.0, 32.0, 1.3],
                [74.0, -5.0, 30.0, 1.4],
                [56.0, 35.0, 31.0, 0.5],
                [25.0, 64.0, 33.0, 1.3],
                [-13.0, 74.0, 32.0, 1.3],
                [-43.0, 52.0, 33.0, 0.9],
                [-69.0, 18.0, 30.0, 1.4],
                [-65.0, -18.0, 28.0, 1.3],
                [-43.0, -51.0, 33.0, 0.8],
                [-11.0, -74.0, 34.0, 1.2],
                [25.0, -65.0, 36.0, 0.6],
                [58.0, -37.0, 32.0, 0.6],
                [79.0, -4.0, 29.0, 0.8],
                [70.0, 46.0, 30.0, 1.4],
                [33.0, 73.0, 36.0, 1.1],
                [-7.0, 75.0, 36.0, 1.1],
                [-50.0, 54.0, 28.0, 0.9],
                [-75.0, 23.0, 35.0, 0.9],
                [-78.0, -23.0, 27.0, 1.3],
                [-47.0, -64.0, 34.0, 0.8],
                [-7.0, -76.0, 28.0, 1.1],
                [36.0, -68.0, 27.0, 0.8],
                [61.0, -39.0, 29.0, 1.4],
                [86.0, -5.0, 35.0, 1.4],
                [76.0, 42.0, 32.0, 1.4],
                [33.0, 79.0, 28.0, 1.1],
                [-18.0, 81.0, 29.0, 1.3],
                [-58.0, 59.0, 30.0, 0.7],
                [-83.0, 23.0, 34.0, 0.8],
                [-84.0, -22.0, 29.0, 1.2],
                [-61.0, -70.0, 35.0, 1.0],
                [-14.0, -89.0, 33.0, 1.3],
                [40.0, -77.0, 36.0, 0.8],
                [71.0, -44.0, 28.0, 1.0],
                [90.0, -3.0, 32.0, 0.7],
                [74.0, 50.0, 36.0, 0.6],
                [36.0, 89.0, 30.0, 1.3],
                [-17.0, 89.0, 31.0, 0.8],
                [-63.0, 74.0, 27.0, 1.0],
                [-94.0, 26.0, 32.0, 0.8],
                [-91.0, -27.0, 29.0, 0.9],
                [-57.0, -75.0, 32.0, 1.2],
                [-16.0, -97.0, 28.0, 1.0],
                [37.0, -86.0, 33.0, 1.0],
                [81.0, -53.0, 30.0, 1.2],
                [104.0, 1.0, 34.0, 1.3],
                [85.0, 54.0, 33.0, 0.6],
                [43.0, 89.0, 27.0, 1.5],
                [-19.0, 101.0, 32.0, 1.0],
                [-66.0, 75.0, 29.0, 1.1],
                [-97.0, 29.0, 28.0, 1.5],
                [-94.0, -32.0, 27.0, 1.5],
                [-65.0, -80.0, 30.0, 1.0],
                [-13.0, -103.0, 36.0, 0.5],
                [41.0, -95.0, 30.0, 1.5],
                [79.0, -59.0, 31.0, 0.8],
                [52.0, 3.0, 37.0, 0.6],
                [37.0, 25.0, 39.0, 0.5],
                [19.0, 43.0, 39.0, 1.1],
                [-12.0, 47.0, 35.0, 1.2],
                [-29.0, 36.0, 37.0, 0.9],
                [-51.0, 10.0, 34.0, 1.5],
                [-45.0, -19.0, 33.0, 0.9],
                [-36.0, -38.0, 35.0, 1.2],
                [-9.0, -54.0, 35.0, 1.0],
                [17.0, -48.0, 39.0, 0.6],
                [37.0, -25.0, 33.0, 1.2],
                [57.0, 2.0, 32.0, 0.7],
                [51.0, 31.0, 36.0, 0.9],
                [21.0, 49.0, 36.0, 1.1],
                [-4.0, 57.0, 38.0, 0.7],
                [-34.0, 43.0, 32.0, 1.1],
                [-59.0, 15.0, 33.0, 1.0],
                [-60.0, -18.0, 38.0, 0.9],
                [-42.0, -42.0, 31.0, 1.2],
                [-13.0, -52.0, 38.0, 1.3],
                [23.0, -52.0, 31.0, 0.8],
                [48.0, -36.0, 40.0, 0.9],
                [64.0, -4.0, 32.0, 1.1],
                [57.0, 39.0, 36.0, 1.4],
                [28.0, 55.0, 32.0, 0.9],
                [-7.0, 61.0, 40.0, 1.0],
                [-41.0, 45.0, 33.0, 0.5],
                [-66.0, 19.0, 31.0, 0.7],
                [-64.0, -14.0, 39.0, 1.3],
                [-44.0, -52.0, 39.0, 0.7],
                [-6.0, -69.0, 32.0, 0.8],
                [27.0, -60.0, 35.0, 0.6],
                [53.0, -36.0, 39.0, 1.5],
                [75.0, 3.0, 39.0, 1.2],
                [63.0, 40.0, 40.0, 1.2],
                [28.0, 64.0, 34.0, 1.1],
                [-6.0, 67.0, 37.0, 1.4],
                [-46.0, 49.0, 33.0, 0.9],
                [-67.0, 15.0, 37.0, 1.0],
                [-71.0, -18.0, 37.0, 0.6],
                [-49.0, -58.0, 40.0, 0.9],
                [-6.0, -75.0, 33.0, 0.5],
                [29.0, -64.0, 37.0, 1.0],
                [64.0, -44.0, 39.0, 0.9],
                [82.0, 0.0, 34.0, 1.2],
                [69.0, 38.0, 37.0, 1.2],
                [35.0, 70.0, 36.0, 1.0],
                [-12.0, 73.0, 33.0, 1.4],
                [-51.0, 62.0, 37.0, 1.4],
                [-80.0, 25.0, 34.0, 0.6],
                [-72.0, -25.0, 33.0, 0.5],
                [-54.0, -63.0, 34.0, 1.2],
                [-15.0, -80.0, 32.0, 1.1],
                [31.0, -75.0, 32.0, 0.8],
                [68.0, -43.0, 40.0, 1.3],
                [83.0, 3.0, 40.0, 0.7],
                [68.0, 45.0, 33.0, 0.6],
                [30.0, 76.0, 37.0, 1.5],
                [-14.0, 81.0, 40.0, 0.5],
                [-57.0, 63.0, 33.0, 0.6],
                [-87.0, 22.0, 34.0, 1.1],
                [-86.0, -24.0, 38.0, 1.0],
                [-57.0, -68.0, 33.0, 0.8],
                [-14.0, -90.0, 31.0, 0.8],
                [33.0, -80.0, 38.0, 1.3],
                [69.0, -49.0, 33.0, 0.7],
                [90.0, -2.0, 36.0, 0.5],
                [79.0, 46.0, 36.0, 0.8],
                [33.0, 84.0, 34.0, 1.5],
                [-12.0, 90.0, 37.0, 1.4],
                [-64.0, 67.0, 36.0, 0.9],
                [-90.0, 25.0, 33.0, 0.7],
                [-85.0, -22.0, 34.0, 0.6],
                [-59.0, -72.0, 38.0, 1.0],
                [-11.0, -96.0, 33.0, 1.4],
                [34.0, -84.0, 38.0, 1.3],
                [80.0, -52.0, 37.0, 0.6],
                [95.0, 0.0, 38.0, 0.6],
                [82.0, 57.0, 33.0, 1.2],
                [40.0, 90.0, 38.0, 1.0],
                [-19.0, 101.0, 35.0, 0.7],
                [-68.0, 75.0, 36.0, 1.0],
                [-101.0, 30.0, 37.0, 0.7],
                [-93.0, -25.0, 36.0, 1.0],
                [-64.0, -72.0, 31.0, 1.0],
                [-17.0, -99.0, 32.0, 0.8],
                [41.0, -94.0, 36.0, 1.4],
                [87.0, -59.0, 39.0, 1.2],
                [45.0, -3.0, 44.0, 0.9],
                [40.0, 31.0, 41.0, 0.7],
                [18.0, 47.0, 44.0, 0.7],
                [-12.0, 48.0, 38.0, 0.6],
                [-38.0, 34.0, 37.0, 1.0],
                [-50.0, 16.0, 37.0, 1.3],
                [-48.0, -15.0, 41.0, 0.7],
                [-38.0, -39.0, 40.0, 1.1],
                [-9.0, -47.0, 38.0, 1.3],
                [19.0, -49.0, 41.0, 1.3],
                [45.0, -24.0, 37.0, 1.2],
                [59.0, -4.0, 36.0, 0.5],
                [47.0, 32.0, 40.0, 1.1],
                [27.0, 51.0, 41.0, 0.8],
                [-7.0, 58.0, 39.0, 0.6],
                [-40.0, 46.0, 36.0, 1.4],
                [-53.0, 18.0, 40.0, 1.0],
                [-55.0, -20.0, 39.0, 1.0],
                [-38.0, -46.0, 42.0, 1.2],
                [-10.0, -60.0, 37.0, 1.4],
                [19.0, -54.0, 43.0, 1.3],
                [47.0, -32.0, 41.0, 1.4],
                [65.0, -5.0, 44.0, 0.7],
                [57.0, 29.0, 40.0, 1.1],
                [29.0, 56.0, 42.0, 1.4],
                [-10.0, 65.0, 38.0, 1.3],
                [-46.0, 52.0, 36.0, 1.2],
                [-64.0, 15.0, 35.0, 0.9],
                [-63.0, -17.0, 44.0, 0.9],
                [-44.0, -52.0, 37.0, 1.3],
                [-11.0, -64.0, 39.0, 1.2],
                [26.0, -60.0, 38.0, 0.8],
                [49.0, -30.0, 39.0, 1.0],
                [75.0, -2.0, 42.0, 1.0],
                [60.0, 36.0, 41.0, 1.3],
                [31.0, 64.0, 43.0, 0.6],
                [-11.0, 71.0, 36.0, 0.8],
                [-51.0, 52.0, 40.0, 1.3],
                [-71.0, 21.0, 36.0, 0.8],
                [-70.0, -19.0, 36.0, 0.8],
                [-50.0, -55.0, 43.0, 0.9],
                [-8.0, -67.0, 43.0, 0.6],
                [26.0, -70.0, 41.0, 0.6],
                [61.0, -35.0, 42.0, 0.5],
                [77.0, -3.0, 42.0, 1.3],
                [63.0, 39.0, 44.0, 1.4],
                [36.0, 74.0, 41.0, 0.7],
                [-9.0, 81.0, 39.0, 0.7],
                [-51.0, 58.0, 36.0, 1.2],
                [-77.0, 24.0, 44.0, 0.9],
                [-75.0, -21.0, 42.0, 1.4],
                [-52.0, -58.0, 41.0, 1.1],
                [-14.0, -79.0, 42.0, 0.8],
                [35.0, -70.0, 43.0, 1.3],
                [63.0, -43.0, 43.0, 1.0],
                [89.0, -2.0, 42.0, 0.7],
                [76.0, 45.0, 39.0, 0.6],
                [39.0, 73.0, 44.0, 1.3],
                [-14.0, 88.0, 36.0, 1.1],
                [-59.0, 60.0, 40.0, 1.1],
                [-80.0, 22.0, 38.0, 1.3],
                [-87.0, -22.0, 44.0, 0.6],
                [-52.0, -63.0, 43.0, 1.0],
                [-11.0, -81.0, 38.0, 1.0],
                [37.0, -75.0, 38.0, 1.0],
                [73.0, -44.0, 36.0, 1.1],
                [92.0, -3.0, 41.0, 1.1],
                [80.0, 49.0, 42.0, 1.1],
                [36.0, 84.0, 38.0, 0.9],
                [-11.0, 90.0, 43.0, 1.2],
                [-61.0, 74.0, 43.0, 1.2],
                [-86.0, 27.0, 35.0, 1.4],
                [-86.0, -31.0, 44.0, 1.3],
                [-58.0, -71.0, 35.0, 1.4],
                [-14.0, -96.0, 40.0, 0.9],
                [36.0, -81.0, 44.0, 0.7],
                [73.0, -55.0, 43.0, 1.3],
                [104.0, 1.0, 40.0, 1.3],
                [85.0, 50.0, 35.0, 1.1],
                [38.0, 92.0, 37.0, 1.3],
                [-13.0, 96.0, 44.0, 1.3],
                [-66.0, 70.0, 43.0, 0.8],
                [-101.0, 24.0, 37.0, 0.8],
                [-99.0, -25.0, 41.0, 0.8],
                [-70.0, -76.0, 35.0, 1.5],
                [-17.0, -100.0, 37.0, 0.6],
                [45.0, -91.0, 42.0, 0.7],
                [79.0, -54.0, 40.0, 0.8],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    -1.6,
                    -1.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.9,
                    2.3,
                    2.8,
                    4.4,
                    5.4,
                    6.0,
                    7.0,
                    7.0,
                    7.0,
                    7.0,
                    7.0,
                    7.9,
                    9.3,
                ]
            ),
            1,
        )
        basis1 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 1.7, 3.0, 4.0, 4.0, 4.0, 4.0, 4.0]))
        basis2 = BSplineBasis(
            7,
            np.array(
                [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9, 2.3, 2.9, 3.7, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0]
            ),
        )
        vol = Volume(basis0, basis1, basis2, controlpoints, True)
        vol2 = vol.clone()
        vol2 += np.array([8.4, 4.7, 6.6])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] -= 8.400000
        pt2[..., 1] -= 4.700000
        pt2[..., 2] -= 6.600000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_volume_3D_p565_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [49.0, -2.0, -5.0, 0.6],
                [43.0, 24.0, 4.0, 1.0],
                [12.0, 42.0, -3.0, 1.1],
                [-18.0, 47.0, 4.0, 0.9],
                [-40.0, 29.0, 4.0, 0.9],
                [-51.0, 3.0, -4.0, 0.9],
                [-38.0, -32.0, 4.0, 1.4],
                [-19.0, -48.0, -2.0, 1.3],
                [19.0, -44.0, 3.0, 0.6],
                [39.0, -31.0, 3.0, 0.5],
                [60.0, -4.0, -4.0, 1.2],
                [49.0, 29.0, 0.0, 1.1],
                [16.0, 51.0, 2.0, 1.1],
                [-18.0, 56.0, 4.0, 1.5],
                [-43.0, 38.0, 0.0, 1.3],
                [-58.0, -2.0, 4.0, 0.7],
                [-48.0, -37.0, -3.0, 1.2],
                [-20.0, -53.0, 1.0, 0.6],
                [15.0, -49.0, -5.0, 0.7],
                [47.0, -34.0, -4.0, 1.3],
                [66.0, -3.0, -3.0, 0.7],
                [50.0, 32.0, -4.0, 0.9],
                [21.0, 55.0, 4.0, 0.9],
                [-23.0, 54.0, -2.0, 0.7],
                [-48.0, 39.0, 1.0, 0.7],
                [-59.0, -4.0, 0.0, 0.6],
                [-47.0, -34.0, 0.0, 1.2],
                [-17.0, -57.0, -5.0, 0.7],
                [14.0, -59.0, 0.0, 1.1],
                [48.0, -32.0, -2.0, 1.1],
                [73.0, 4.0, -2.0, 0.6],
                [51.0, 44.0, -3.0, 0.6],
                [22.0, 62.0, 2.0, 0.8],
                [-19.0, 66.0, 3.0, 1.2],
                [-56.0, 36.0, -1.0, 1.3],
                [-67.0, 2.0, -4.0, 0.9],
                [-52.0, -37.0, -5.0, 1.3],
                [-21.0, -63.0, -4.0, 1.2],
                [22.0, -62.0, 3.0, 0.6],
                [52.0, -40.0, -1.0, 1.4],
                [77.0, -1.0, 4.0, 1.3],
                [56.0, 48.0, 4.0, 0.6],
                [18.0, 70.0, 3.0, 1.0],
                [-28.0, 76.0, -4.0, 0.8],
                [-59.0, 48.0, -2.0, 0.7],
                [-72.0, -2.0, 1.0, 0.5],
                [-62.0, -48.0, 2.0, 0.7],
                [-20.0, -72.0, -5.0, 1.1],
                [19.0, -72.0, -2.0, 1.3],
                [58.0, -45.0, -3.0, 0.8],
                [79.0, -4.0, -4.0, 0.6],
                [63.0, 51.0, 2.0, 1.0],
                [27.0, 75.0, 0.0, 0.8],
                [-26.0, 78.0, -5.0, 1.2],
                [-67.0, 51.0, 3.0, 0.8],
                [-77.0, 1.0, 3.0, 1.3],
                [-68.0, -44.0, -5.0, 1.5],
                [-27.0, -78.0, 1.0, 0.6],
                [26.0, -79.0, 1.0, 1.3],
                [64.0, -48.0, -5.0, 0.7],
                [87.0, 4.0, -4.0, 0.7],
                [70.0, 47.0, -4.0, 1.1],
                [28.0, 85.0, -1.0, 0.9],
                [-30.0, 83.0, -2.0, 1.0],
                [-68.0, 48.0, 2.0, 0.9],
                [-84.0, 0.0, 3.0, 0.7],
                [-74.0, -50.0, 1.0, 1.3],
                [-29.0, -87.0, 0.0, 0.7],
                [31.0, -86.0, 4.0, 0.6],
                [71.0, -55.0, 1.0, 1.1],
                [97.0, -3.0, -3.0, 0.7],
                [77.0, 57.0, 1.0, 1.5],
                [25.0, 91.0, -4.0, 0.7],
                [-32.0, 87.0, 0.0, 1.0],
                [-73.0, 52.0, -5.0, 0.8],
                [-95.0, 0.0, -5.0, 0.5],
                [-81.0, -55.0, 0.0, 0.8],
                [-32.0, -85.0, 3.0, 0.6],
                [28.0, -88.0, 0.0, 0.7],
                [75.0, -58.0, -2.0, 0.7],
                [103.0, -5.0, -4.0, 1.4],
                [80.0, 53.0, -4.0, 1.0],
                [34.0, 91.0, 4.0, 0.8],
                [-31.0, 99.0, 4.0, 0.7],
                [-81.0, 60.0, 1.0, 1.4],
                [-99.0, 4.0, -5.0, 1.4],
                [-85.0, -63.0, -1.0, 1.2],
                [-28.0, -95.0, 0.0, 0.9],
                [33.0, -94.0, 0.0, 1.4],
                [83.0, -61.0, 1.0, 0.6],
                [45.0, -5.0, 0.0, 1.4],
                [36.0, 24.0, 9.0, 0.8],
                [12.0, 44.0, 7.0, 1.0],
                [-16.0, 50.0, 1.0, 1.3],
                [-43.0, 29.0, 0.0, 1.1],
                [-52.0, -2.0, 5.0, 0.6],
                [-42.0, -26.0, 7.0, 1.3],
                [-18.0, -51.0, 2.0, 0.8],
                [18.0, -52.0, 5.0, 1.2],
                [45.0, -34.0, 2.0, 1.0],
                [51.0, -4.0, 0.0, 1.0],
                [45.0, 36.0, 9.0, 0.9],
                [18.0, 56.0, 2.0, 0.7],
                [-13.0, 54.0, 2.0, 0.8],
                [-50.0, 33.0, 4.0, 0.9],
                [-59.0, 3.0, 9.0, 0.8],
                [-46.0, -32.0, 6.0, 1.0],
                [-19.0, -54.0, 0.0, 1.2],
                [20.0, -58.0, 1.0, 1.4],
                [41.0, -39.0, 5.0, 0.8],
                [61.0, -1.0, 3.0, 0.9],
                [51.0, 37.0, 1.0, 1.2],
                [18.0, 60.0, 0.0, 1.1],
                [-17.0, 58.0, 4.0, 0.6],
                [-48.0, 39.0, 0.0, 1.2],
                [-61.0, 0.0, 5.0, 1.0],
                [-56.0, -32.0, 2.0, 0.6],
                [-19.0, -56.0, 4.0, 0.7],
                [20.0, -60.0, 7.0, 1.0],
                [55.0, -41.0, 4.0, 1.2],
                [64.0, -2.0, 4.0, 0.9],
                [58.0, 40.0, 1.0, 1.2],
                [16.0, 61.0, 3.0, 0.7],
                [-25.0, 61.0, 2.0, 0.6],
                [-60.0, 42.0, 5.0, 0.7],
                [-66.0, -3.0, 2.0, 1.2],
                [-59.0, -42.0, 5.0, 0.6],
                [-20.0, -68.0, 5.0, 1.4],
                [25.0, -67.0, 0.0, 1.4],
                [57.0, -36.0, 8.0, 0.7],
                [78.0, -3.0, 7.0, 1.5],
                [59.0, 41.0, 0.0, 1.2],
                [18.0, 69.0, 8.0, 1.5],
                [-23.0, 73.0, 5.0, 0.9],
                [-58.0, 45.0, 5.0, 1.2],
                [-74.0, -1.0, 6.0, 1.3],
                [-63.0, -47.0, 0.0, 0.7],
                [-21.0, -70.0, 3.0, 1.0],
                [22.0, -71.0, 5.0, 1.3],
                [63.0, -50.0, 7.0, 0.7],
                [82.0, 0.0, 3.0, 1.5],
                [65.0, 43.0, 4.0, 0.7],
                [28.0, 76.0, 9.0, 1.3],
                [-23.0, 78.0, 7.0, 1.2],
                [-62.0, 45.0, 9.0, 0.9],
                [-81.0, -2.0, 0.0, 0.6],
                [-68.0, -48.0, 9.0, 1.3],
                [-23.0, -81.0, 7.0, 0.9],
                [22.0, -77.0, 3.0, 1.2],
                [67.0, -45.0, 6.0, 1.1],
                [87.0, 4.0, 7.0, 1.0],
                [68.0, 47.0, 1.0, 1.0],
                [25.0, 81.0, 7.0, 1.2],
                [-28.0, 84.0, 8.0, 1.5],
                [-76.0, 51.0, 0.0, 1.0],
                [-89.0, 2.0, 7.0, 1.2],
                [-74.0, -50.0, 3.0, 1.1],
                [-32.0, -87.0, 4.0, 0.8],
                [23.0, -86.0, 3.0, 1.0],
                [65.0, -49.0, 7.0, 0.9],
                [97.0, 3.0, 7.0, 0.8],
                [71.0, 50.0, 1.0, 1.0],
                [26.0, 88.0, 5.0, 1.1],
                [-34.0, 93.0, 0.0, 1.1],
                [-77.0, 57.0, 7.0, 1.0],
                [-95.0, 3.0, 0.0, 1.2],
                [-75.0, -55.0, 4.0, 0.5],
                [-32.0, -94.0, 2.0, 1.1],
                [33.0, -88.0, 7.0, 1.2],
                [75.0, -54.0, 6.0, 0.6],
                [103.0, 3.0, 4.0, 0.8],
                [77.0, 58.0, 0.0, 0.6],
                [28.0, 93.0, 7.0, 1.4],
                [-34.0, 96.0, 9.0, 1.1],
                [-79.0, 56.0, 2.0, 0.6],
                [-98.0, 2.0, 3.0, 0.6],
                [-86.0, -58.0, 5.0, 0.7],
                [-36.0, -97.0, 0.0, 1.1],
                [29.0, -92.0, 7.0, 0.9],
                [85.0, -61.0, 6.0, 1.3],
                [49.0, 3.0, 11.0, 1.4],
                [45.0, 27.0, 14.0, 0.5],
                [19.0, 52.0, 14.0, 0.8],
                [-15.0, 45.0, 5.0, 1.2],
                [-46.0, 26.0, 11.0, 1.1],
                [-47.0, -1.0, 7.0, 0.8],
                [-39.0, -25.0, 14.0, 0.9],
                [-17.0, -46.0, 10.0, 0.8],
                [18.0, -46.0, 5.0, 1.2],
                [41.0, -34.0, 8.0, 0.7],
                [58.0, -1.0, 10.0, 1.3],
                [46.0, 30.0, 6.0, 0.9],
                [20.0, 52.0, 5.0, 0.7],
                [-22.0, 48.0, 8.0, 1.1],
                [-48.0, 29.0, 12.0, 1.2],
                [-56.0, -4.0, 13.0, 1.2],
                [-42.0, -31.0, 9.0, 1.1],
                [-13.0, -53.0, 8.0, 1.0],
                [12.0, -51.0, 9.0, 0.8],
                [46.0, -32.0, 6.0, 1.3],
                [66.0, 0.0, 7.0, 1.4],
                [52.0, 38.0, 11.0, 0.9],
                [16.0, 60.0, 7.0, 0.6],
                [-23.0, 58.0, 12.0, 0.9],
                [-52.0, 33.0, 7.0, 1.1],
                [-62.0, 0.0, 12.0, 0.5],
                [-51.0, -42.0, 5.0, 1.0],
                [-22.0, -65.0, 14.0, 0.6],
                [14.0, -56.0, 13.0, 1.0],
                [45.0, -37.0, 8.0, 1.4],
                [66.0, 0.0, 11.0, 1.1],
                [53.0, 45.0, 11.0, 0.8],
                [21.0, 65.0, 11.0, 1.0],
                [-26.0, 65.0, 8.0, 0.5],
                [-60.0, 38.0, 11.0, 1.5],
                [-73.0, -1.0, 12.0, 0.7],
                [-53.0, -37.0, 11.0, 0.6],
                [-21.0, -67.0, 9.0, 0.9],
                [25.0, -64.0, 5.0, 0.8],
                [53.0, -39.0, 13.0, 1.2],
                [78.0, 3.0, 12.0, 1.3],
                [62.0, 40.0, 11.0, 0.6],
                [25.0, 67.0, 10.0, 0.9],
                [-21.0, 66.0, 8.0, 1.2],
                [-60.0, 47.0, 6.0, 0.6],
                [-73.0, 2.0, 13.0, 0.6],
                [-65.0, -43.0, 8.0, 0.7],
                [-19.0, -72.0, 13.0, 0.9],
                [25.0, -76.0, 7.0, 0.7],
                [65.0, -41.0, 5.0, 0.9],
                [79.0, -5.0, 7.0, 0.9],
                [69.0, 47.0, 13.0, 1.2],
                [25.0, 73.0, 12.0, 0.6],
                [-28.0, 75.0, 8.0, 1.3],
                [-66.0, 46.0, 12.0, 1.0],
                [-79.0, -1.0, 8.0, 0.8],
                [-70.0, -52.0, 6.0, 1.3],
                [-26.0, -77.0, 7.0, 0.8],
                [25.0, -83.0, 6.0, 0.6],
                [64.0, -47.0, 7.0, 1.3],
                [86.0, -5.0, 10.0, 1.5],
                [74.0, 47.0, 12.0, 0.8],
                [28.0, 80.0, 8.0, 1.1],
                [-25.0, 84.0, 6.0, 1.2],
                [-69.0, 49.0, 11.0, 0.5],
                [-90.0, -2.0, 6.0, 0.7],
                [-68.0, -53.0, 5.0, 0.8],
                [-23.0, -80.0, 14.0, 0.8],
                [25.0, -84.0, 14.0, 1.2],
                [73.0, -57.0, 14.0, 1.4],
                [97.0, 4.0, 12.0, 1.0],
                [80.0, 54.0, 10.0, 1.0],
                [29.0, 84.0, 10.0, 1.4],
                [-28.0, 89.0, 13.0, 1.0],
                [-78.0, 58.0, 14.0, 0.6],
                [-93.0, -4.0, 12.0, 1.1],
                [-77.0, -54.0, 12.0, 1.1],
                [-28.0, -88.0, 10.0, 0.7],
                [24.0, -93.0, 11.0, 0.9],
                [77.0, -58.0, 10.0, 1.4],
                [96.0, -5.0, 8.0, 0.8],
                [81.0, 58.0, 7.0, 0.8],
                [35.0, 97.0, 7.0, 1.1],
                [-36.0, 99.0, 5.0, 0.6],
                [-82.0, 54.0, 5.0, 0.7],
                [-102.0, 1.0, 13.0, 1.2],
                [-81.0, -63.0, 11.0, 1.1],
                [-29.0, -95.0, 7.0, 1.1],
                [30.0, -95.0, 9.0, 1.0],
                [77.0, -60.0, 10.0, 1.2],
                [54.0, 4.0, 13.0, 0.8],
                [44.0, 31.0, 15.0, 0.5],
                [20.0, 45.0, 19.0, 1.4],
                [-18.0, 43.0, 12.0, 0.8],
                [-38.0, 33.0, 11.0, 1.4],
                [-50.0, -2.0, 17.0, 0.7],
                [-44.0, -32.0, 16.0, 0.5],
                [-15.0, -52.0, 15.0, 1.0],
                [11.0, -49.0, 14.0, 0.8],
                [38.0, -29.0, 11.0, 1.0],
                [56.0, 3.0, 19.0, 1.0],
                [40.0, 29.0, 14.0, 0.7],
                [15.0, 51.0, 17.0, 1.3],
                [-23.0, 57.0, 14.0, 1.4],
                [-44.0, 30.0, 10.0, 0.7],
                [-55.0, -1.0, 11.0, 1.1],
                [-43.0, -29.0, 13.0, 1.1],
                [-13.0, -49.0, 16.0, 1.1],
                [18.0, -55.0, 17.0, 1.1],
                [49.0, -34.0, 13.0, 1.3],
                [61.0, 0.0, 17.0, 1.1],
                [46.0, 38.0, 19.0, 1.0],
                [16.0, 54.0, 18.0, 0.8],
                [-22.0, 62.0, 10.0, 0.6],
                [-47.0, 32.0, 15.0, 0.5],
                [-67.0, 3.0, 16.0, 1.0],
                [-55.0, -33.0, 16.0, 1.3],
                [-24.0, -62.0, 18.0, 1.4],
                [22.0, -61.0, 12.0, 0.8],
                [46.0, -33.0, 10.0, 1.4],
                [66.0, 0.0, 12.0, 1.4],
                [58.0, 37.0, 14.0, 1.2],
                [19.0, 69.0, 19.0, 0.9],
                [-27.0, 69.0, 10.0, 1.4],
                [-55.0, 35.0, 19.0, 1.2],
                [-74.0, 2.0, 13.0, 1.4],
                [-60.0, -43.0, 13.0, 1.3],
                [-25.0, -69.0, 13.0, 1.0],
                [25.0, -62.0, 12.0, 1.5],
                [51.0, -44.0, 16.0, 1.2],
                [70.0, 0.0, 14.0, 0.7],
                [58.0, 41.0, 11.0, 0.9],
                [26.0, 72.0, 16.0, 1.4],
                [-26.0, 69.0, 13.0, 1.0],
                [-65.0, 41.0, 12.0, 1.1],
                [-78.0, -5.0, 19.0, 1.4],
                [-59.0, -45.0, 18.0, 0.9],
                [-22.0, -74.0, 19.0, 0.8],
                [23.0, -70.0, 14.0, 1.2],
                [58.0, -49.0, 13.0, 1.0],
                [81.0, 3.0, 18.0, 1.3],
                [65.0, 45.0, 10.0, 0.8],
                [26.0, 76.0, 10.0, 1.4],
                [-26.0, 80.0, 16.0, 0.9],
                [-71.0, 50.0, 19.0, 0.5],
                [-83.0, 1.0, 18.0, 0.9],
                [-70.0, -45.0, 15.0, 1.1],
                [-30.0, -78.0, 13.0, 0.6],
                [20.0, -79.0, 19.0, 1.0],
                [68.0, -45.0, 14.0, 1.1],
                [90.0, -4.0, 13.0, 0.9],
                [75.0, 49.0, 12.0, 1.0],
                [25.0, 87.0, 11.0, 0.7],
                [-24.0, 80.0, 14.0, 1.0],
                [-75.0, 48.0, 12.0, 1.2],
                [-87.0, 0.0, 17.0, 1.4],
                [-67.0, -48.0, 12.0, 1.4],
                [-24.0, -84.0, 12.0, 1.2],
                [29.0, -80.0, 18.0, 1.3],
                [72.0, -55.0, 10.0, 1.2],
                [92.0, -1.0, 19.0, 1.1],
                [72.0, 55.0, 16.0, 1.3],
                [29.0, 90.0, 15.0, 1.3],
                [-33.0, 86.0, 13.0, 1.3],
                [-77.0, 55.0, 17.0, 1.3],
                [-97.0, 2.0, 12.0, 1.5],
                [-76.0, -60.0, 12.0, 0.7],
                [-33.0, -85.0, 11.0, 1.1],
                [33.0, -89.0, 18.0, 0.6],
                [73.0, -60.0, 18.0, 0.5],
                [104.0, -5.0, 10.0, 0.5],
                [76.0, 57.0, 17.0, 1.3],
                [28.0, 99.0, 10.0, 0.6],
                [-30.0, 90.0, 19.0, 0.7],
                [-84.0, 54.0, 16.0, 0.8],
                [-104.0, 4.0, 19.0, 1.4],
                [-84.0, -64.0, 13.0, 1.4],
                [-31.0, -93.0, 11.0, 1.1],
                [35.0, -93.0, 10.0, 0.9],
                [77.0, -56.0, 15.0, 0.9],
                [48.0, -3.0, 21.0, 1.4],
                [36.0, 29.0, 18.0, 0.6],
                [14.0, 48.0, 24.0, 0.8],
                [-16.0, 50.0, 19.0, 0.8],
                [-46.0, 26.0, 21.0, 0.7],
                [-52.0, -5.0, 23.0, 1.3],
                [-39.0, -34.0, 23.0, 1.1],
                [-20.0, -52.0, 15.0, 1.3],
                [15.0, -49.0, 23.0, 1.5],
                [43.0, -33.0, 17.0, 0.6],
                [59.0, -2.0, 22.0, 1.1],
                [41.0, 34.0, 22.0, 1.4],
                [20.0, 57.0, 18.0, 1.4],
                [-13.0, 56.0, 18.0, 0.6],
                [-51.0, 30.0, 17.0, 1.4],
                [-59.0, 4.0, 19.0, 1.3],
                [-43.0, -35.0, 18.0, 0.6],
                [-21.0, -49.0, 15.0, 0.8],
                [18.0, -58.0, 17.0, 1.3],
                [48.0, -38.0, 24.0, 0.7],
                [62.0, -4.0, 20.0, 1.1],
                [51.0, 33.0, 21.0, 1.4],
                [21.0, 57.0, 24.0, 0.7],
                [-17.0, 54.0, 18.0, 1.5],
                [-50.0, 37.0, 21.0, 1.1],
                [-63.0, -3.0, 22.0, 1.1],
                [-55.0, -41.0, 19.0, 0.5],
                [-19.0, -56.0, 19.0, 1.1],
                [21.0, -56.0, 18.0, 0.5],
                [46.0, -36.0, 16.0, 1.2],
                [65.0, 1.0, 24.0, 0.7],
                [57.0, 36.0, 15.0, 1.3],
                [16.0, 65.0, 24.0, 1.4],
                [-21.0, 61.0, 21.0, 0.6],
                [-54.0, 40.0, 17.0, 1.2],
                [-72.0, 4.0, 20.0, 0.9],
                [-57.0, -36.0, 19.0, 1.4],
                [-23.0, -69.0, 23.0, 1.2],
                [22.0, -62.0, 22.0, 1.0],
                [55.0, -45.0, 18.0, 0.9],
                [74.0, -4.0, 21.0, 1.0],
                [61.0, 48.0, 18.0, 1.1],
                [26.0, 72.0, 22.0, 0.5],
                [-24.0, 66.0, 23.0, 1.2],
                [-60.0, 42.0, 16.0, 1.5],
                [-72.0, -5.0, 16.0, 1.1],
                [-66.0, -45.0, 17.0, 0.8],
                [-23.0, -75.0, 24.0, 0.6],
                [18.0, -67.0, 19.0, 1.5],
                [62.0, -45.0, 23.0, 1.4],
                [83.0, -3.0, 17.0, 0.6],
                [69.0, 51.0, 20.0, 1.4],
                [22.0, 81.0, 15.0, 1.5],
                [-23.0, 75.0, 19.0, 1.4],
                [-70.0, 45.0, 22.0, 0.8],
                [-79.0, -5.0, 23.0, 1.0],
                [-68.0, -45.0, 17.0, 0.7],
                [-21.0, -81.0, 21.0, 1.1],
                [24.0, -80.0, 24.0, 1.4],
                [63.0, -47.0, 16.0, 0.9],
                [91.0, -3.0, 18.0, 1.0],
                [67.0, 49.0, 15.0, 1.4],
                [26.0, 87.0, 17.0, 1.1],
                [-27.0, 79.0, 17.0, 1.5],
                [-71.0, 54.0, 16.0, 1.1],
                [-91.0, 1.0, 17.0, 1.3],
                [-66.0, -55.0, 24.0, 1.2],
                [-29.0, -80.0, 19.0, 0.6],
                [23.0, -81.0, 18.0, 0.9],
                [73.0, -48.0, 15.0, 1.3],
                [93.0, -4.0, 19.0, 0.9],
                [79.0, 52.0, 17.0, 1.0],
                [29.0, 92.0, 24.0, 0.6],
                [-26.0, 87.0, 21.0, 0.6],
                [-75.0, 54.0, 20.0, 1.3],
                [-93.0, 1.0, 15.0, 0.7],
                [-79.0, -51.0, 21.0, 0.8],
                [-29.0, -94.0, 20.0, 0.7],
                [30.0, -92.0, 16.0, 0.6],
                [74.0, -58.0, 15.0, 0.8],
                [103.0, 4.0, 15.0, 0.6],
                [77.0, 56.0, 22.0, 1.3],
                [30.0, 90.0, 20.0, 1.2],
                [-30.0, 97.0, 20.0, 0.9],
                [-85.0, 59.0, 20.0, 1.0],
                [-102.0, -3.0, 18.0, 0.9],
                [-81.0, -64.0, 23.0, 1.1],
                [-27.0, -92.0, 20.0, 1.3],
                [34.0, -94.0, 23.0, 0.6],
                [76.0, -58.0, 18.0, 0.9],
                [48.0, -3.0, 27.0, 1.5],
                [45.0, 33.0, 25.0, 0.6],
                [11.0, 50.0, 28.0, 1.2],
                [-13.0, 52.0, 22.0, 0.9],
                [-45.0, 27.0, 22.0, 1.2],
                [-52.0, -4.0, 24.0, 0.8],
                [-43.0, -28.0, 23.0, 1.5],
                [-20.0, -46.0, 25.0, 1.0],
                [10.0, -51.0, 23.0, 1.3],
                [43.0, -32.0, 29.0, 0.5],
                [60.0, 0.0, 23.0, 1.0],
                [44.0, 36.0, 21.0, 1.5],
                [14.0, 58.0, 21.0, 1.4],
                [-13.0, 53.0, 21.0, 1.0],
                [-43.0, 32.0, 29.0, 1.1],
                [-53.0, 3.0, 20.0, 0.6],
                [-42.0, -34.0, 24.0, 0.9],
                [-22.0, -56.0, 23.0, 0.7],
                [22.0, -54.0, 21.0, 1.2],
                [49.0, -36.0, 23.0, 0.6],
                [62.0, 2.0, 21.0, 0.7],
                [47.0, 40.0, 23.0, 1.1],
                [20.0, 59.0, 27.0, 0.5],
                [-16.0, 61.0, 26.0, 0.5],
                [-54.0, 36.0, 24.0, 1.4],
                [-65.0, -5.0, 24.0, 1.4],
                [-54.0, -40.0, 20.0, 0.9],
                [-24.0, -58.0, 29.0, 0.5],
                [23.0, -58.0, 27.0, 1.2],
                [49.0, -34.0, 21.0, 1.1],
                [63.0, 1.0, 25.0, 1.3],
                [53.0, 38.0, 22.0, 0.9],
                [17.0, 66.0, 23.0, 0.9],
                [-24.0, 65.0, 28.0, 1.3],
                [-56.0, 38.0, 27.0, 0.9],
                [-69.0, -5.0, 23.0, 0.8],
                [-55.0, -38.0, 29.0, 0.6],
                [-25.0, -66.0, 26.0, 1.2],
                [17.0, -62.0, 28.0, 1.0],
                [59.0, -43.0, 20.0, 1.2],
                [78.0, 0.0, 27.0, 1.0],
                [56.0, 44.0, 20.0, 0.6],
                [20.0, 75.0, 26.0, 0.8],
                [-25.0, 67.0, 25.0, 1.3],
                [-63.0, 42.0, 22.0, 1.5],
                [-78.0, -2.0, 29.0, 0.6],
                [-59.0, -48.0, 26.0, 0.6],
                [-19.0, -70.0, 28.0, 0.9],
                [25.0, -76.0, 25.0, 1.4],
                [59.0, -40.0, 26.0, 1.1],
                [84.0, -5.0, 28.0, 1.3],
                [63.0, 45.0, 27.0, 1.4],
                [28.0, 80.0, 22.0, 1.5],
                [-27.0, 72.0, 26.0, 0.9],
                [-62.0, 50.0, 27.0, 1.1],
                [-81.0, -3.0, 26.0, 1.3],
                [-67.0, -49.0, 22.0, 1.1],
                [-25.0, -73.0, 22.0, 0.9],
                [29.0, -76.0, 28.0, 1.4],
                [61.0, -47.0, 23.0, 0.6],
                [91.0, -1.0, 27.0, 1.4],
                [73.0, 51.0, 25.0, 0.7],
                [25.0, 86.0, 23.0, 0.8],
                [-33.0, 82.0, 26.0, 1.0],
                [-69.0, 56.0, 25.0, 1.3],
                [-90.0, 0.0, 20.0, 1.0],
                [-75.0, -49.0, 28.0, 1.3],
                [-30.0, -84.0, 21.0, 1.1],
                [28.0, -81.0, 24.0, 1.2],
                [71.0, -55.0, 28.0, 1.4],
                [91.0, -2.0, 25.0, 0.9],
                [79.0, 53.0, 26.0, 0.8],
                [32.0, 86.0, 25.0, 1.2],
                [-32.0, 91.0, 21.0, 1.0],
                [-72.0, 54.0, 27.0, 0.9],
                [-94.0, 2.0, 26.0, 0.9],
                [-72.0, -53.0, 23.0, 1.3],
                [-27.0, -91.0, 21.0, 1.4],
                [31.0, -93.0, 21.0, 1.3],
                [71.0, -56.0, 22.0, 0.9],
                [101.0, 4.0, 28.0, 1.1],
                [84.0, 54.0, 28.0, 0.7],
                [29.0, 98.0, 24.0, 1.5],
                [-26.0, 90.0, 27.0, 0.7],
                [-80.0, 61.0, 22.0, 1.3],
                [-103.0, 2.0, 27.0, 1.4],
                [-85.0, -64.0, 20.0, 0.7],
                [-34.0, -91.0, 26.0, 0.6],
                [29.0, -92.0, 23.0, 1.4],
                [85.0, -57.0, 20.0, 0.8],
                [52.0, -3.0, 32.0, 1.4],
                [36.0, 27.0, 33.0, 0.8],
                [14.0, 43.0, 29.0, 0.9],
                [-20.0, 51.0, 32.0, 0.8],
                [-46.0, 24.0, 25.0, 0.8],
                [-55.0, -3.0, 31.0, 0.7],
                [-38.0, -33.0, 34.0, 1.3],
                [-15.0, -47.0, 33.0, 1.0],
                [15.0, -49.0, 33.0, 1.1],
                [36.0, -25.0, 27.0, 0.5],
                [52.0, -3.0, 29.0, 1.5],
                [46.0, 36.0, 29.0, 0.9],
                [14.0, 54.0, 33.0, 1.0],
                [-15.0, 55.0, 30.0, 1.3],
                [-50.0, 32.0, 27.0, 1.1],
                [-58.0, 4.0, 26.0, 1.1],
                [-45.0, -34.0, 28.0, 1.3],
                [-15.0, -57.0, 30.0, 0.7],
                [19.0, -53.0, 29.0, 1.0],
                [41.0, -31.0, 28.0, 0.6],
                [67.0, -5.0, 32.0, 0.9],
                [51.0, 35.0, 27.0, 1.1],
                [17.0, 58.0, 32.0, 0.8],
                [-23.0, 63.0, 26.0, 1.1],
                [-48.0, 36.0, 26.0, 0.6],
                [-59.0, 2.0, 32.0, 0.7],
                [-47.0, -41.0, 25.0, 1.1],
                [-24.0, -64.0, 29.0, 0.8],
                [22.0, -64.0, 31.0, 1.5],
                [47.0, -38.0, 30.0, 1.4],
                [64.0, 0.0, 32.0, 1.4],
                [51.0, 35.0, 29.0, 1.3],
                [19.0, 69.0, 31.0, 1.0],
                [-22.0, 65.0, 29.0, 1.0],
                [-56.0, 39.0, 27.0, 0.8],
                [-74.0, 3.0, 30.0, 0.5],
                [-55.0, -45.0, 28.0, 1.2],
                [-23.0, -69.0, 31.0, 0.8],
                [17.0, -71.0, 27.0, 1.3],
                [52.0, -45.0, 27.0, 0.6],
                [71.0, -3.0, 27.0, 0.7],
                [61.0, 45.0, 30.0, 0.6],
                [19.0, 68.0, 31.0, 1.0],
                [-21.0, 67.0, 27.0, 0.6],
                [-66.0, 47.0, 32.0, 1.3],
                [-72.0, 0.0, 27.0, 1.2],
                [-57.0, -41.0, 32.0, 0.9],
                [-23.0, -69.0, 29.0, 0.5],
                [21.0, -71.0, 34.0, 1.3],
                [59.0, -44.0, 25.0, 0.9],
                [80.0, -2.0, 34.0, 0.6],
                [61.0, 48.0, 28.0, 1.2],
                [22.0, 80.0, 26.0, 1.3],
                [-23.0, 80.0, 25.0, 1.3],
                [-66.0, 43.0, 28.0, 1.1],
                [-87.0, 0.0, 30.0, 1.0],
                [-68.0, -47.0, 27.0, 1.2],
                [-29.0, -79.0, 25.0, 1.0],
                [25.0, -82.0, 33.0, 0.6],
                [61.0, -52.0, 25.0, 0.6],
                [84.0, -5.0, 32.0, 1.0],
                [70.0, 54.0, 31.0, 1.3],
                [22.0, 81.0, 27.0, 1.1],
                [-30.0, 84.0, 30.0, 0.9],
                [-74.0, 54.0, 32.0, 0.6],
                [-88.0, -1.0, 26.0, 1.3],
                [-75.0, -49.0, 28.0, 1.1],
                [-24.0, -89.0, 26.0, 0.8],
                [24.0, -83.0, 33.0, 0.7],
                [74.0, -48.0, 31.0, 1.2],
                [97.0, -3.0, 34.0, 1.0],
                [72.0, 53.0, 28.0, 1.5],
                [31.0, 88.0, 32.0, 1.4],
                [-31.0, 85.0, 29.0, 0.8],
                [-76.0, 52.0, 31.0, 1.1],
                [-92.0, -3.0, 29.0, 0.8],
                [-80.0, -58.0, 32.0, 1.5],
                [-30.0, -90.0, 27.0, 0.7],
                [25.0, -88.0, 29.0, 1.3],
                [74.0, -59.0, 26.0, 0.9],
                [100.0, 0.0, 25.0, 0.8],
                [82.0, 60.0, 25.0, 0.6],
                [35.0, 92.0, 30.0, 0.9],
                [-36.0, 98.0, 28.0, 0.6],
                [-85.0, 54.0, 33.0, 1.3],
                [-99.0, 2.0, 32.0, 0.6],
                [-81.0, -64.0, 26.0, 1.1],
                [-36.0, -97.0, 28.0, 1.0],
                [31.0, -96.0, 26.0, 1.5],
                [80.0, -63.0, 31.0, 0.9],
                [49.0, -5.0, 35.0, 0.7],
                [43.0, 29.0, 33.0, 0.5],
                [19.0, 47.0, 32.0, 1.1],
                [-14.0, 42.0, 36.0, 1.1],
                [-41.0, 31.0, 35.0, 1.3],
                [-54.0, -5.0, 39.0, 1.2],
                [-39.0, -31.0, 35.0, 1.1],
                [-20.0, -47.0, 31.0, 1.2],
                [18.0, -44.0, 32.0, 0.6],
                [38.0, -29.0, 30.0, 1.4],
                [54.0, -3.0, 31.0, 0.9],
                [41.0, 28.0, 36.0, 1.2],
                [12.0, 54.0, 37.0, 0.8],
                [-23.0, 56.0, 30.0, 1.1],
                [-51.0, 37.0, 38.0, 1.2],
                [-57.0, -1.0, 33.0, 1.4],
                [-47.0, -31.0, 30.0, 1.4],
                [-20.0, -52.0, 30.0, 1.4],
                [13.0, -49.0, 36.0, 1.1],
                [45.0, -29.0, 37.0, 0.7],
                [62.0, -4.0, 35.0, 0.9],
                [49.0, 36.0, 33.0, 1.5],
                [20.0, 56.0, 30.0, 0.6],
                [-16.0, 61.0, 31.0, 1.3],
                [-50.0, 37.0, 32.0, 1.1],
                [-67.0, 1.0, 32.0, 0.5],
                [-50.0, -38.0, 36.0, 1.2],
                [-19.0, -63.0, 37.0, 0.5],
                [16.0, -56.0, 39.0, 1.1],
                [49.0, -33.0, 34.0, 1.1],
                [65.0, -2.0, 36.0, 1.0],
                [60.0, 38.0, 32.0, 1.0],
                [17.0, 60.0, 39.0, 1.3],
                [-20.0, 69.0, 31.0, 1.4],
                [-55.0, 39.0, 39.0, 0.7],
                [-72.0, 1.0, 32.0, 1.4],
                [-56.0, -39.0, 38.0, 0.7],
                [-22.0, -67.0, 30.0, 1.4],
                [26.0, -68.0, 38.0, 1.4],
                [50.0, -38.0, 35.0, 0.7],
                [74.0, -1.0, 35.0, 0.7],
                [65.0, 44.0, 33.0, 1.0],
                [22.0, 75.0, 30.0, 1.1],
                [-23.0, 74.0, 31.0, 0.6],
                [-58.0, 41.0, 31.0, 0.9],
                [-76.0, 4.0, 38.0, 1.4],
                [-56.0, -44.0, 39.0, 0.6],
                [-27.0, -77.0, 34.0, 0.9],
                [27.0, -76.0, 37.0, 0.6],
                [56.0, -41.0, 35.0, 0.9],
                [76.0, -1.0, 31.0, 0.8],
                [61.0, 49.0, 31.0, 1.1],
                [29.0, 75.0, 37.0, 1.0],
                [-29.0, 76.0, 37.0, 1.3],
                [-68.0, 44.0, 35.0, 0.8],
                [-85.0, 0.0, 32.0, 1.0],
                [-70.0, -51.0, 39.0, 1.0],
                [-24.0, -82.0, 34.0, 0.9],
                [25.0, -78.0, 36.0, 1.5],
                [61.0, -51.0, 32.0, 1.0],
                [86.0, -3.0, 36.0, 1.1],
                [66.0, 49.0, 33.0, 0.7],
                [22.0, 84.0, 32.0, 0.7],
                [-23.0, 83.0, 34.0, 0.7],
                [-69.0, 56.0, 32.0, 1.5],
                [-87.0, -2.0, 37.0, 0.5],
                [-73.0, -54.0, 34.0, 1.4],
                [-25.0, -89.0, 39.0, 0.6],
                [24.0, -81.0, 30.0, 0.9],
                [67.0, -47.0, 39.0, 1.1],
                [96.0, 3.0, 38.0, 0.7],
                [72.0, 52.0, 36.0, 0.9],
                [25.0, 90.0, 32.0, 1.5],
                [-26.0, 85.0, 32.0, 1.1],
                [-80.0, 55.0, 32.0, 1.2],
                [-96.0, 2.0, 30.0, 1.0],
                [-72.0, -55.0, 32.0, 1.2],
                [-29.0, -89.0, 31.0, 1.3],
                [31.0, -92.0, 37.0, 1.4],
                [71.0, -51.0, 35.0, 0.6],
                [101.0, -4.0, 31.0, 1.1],
                [84.0, 58.0, 35.0, 0.7],
                [34.0, 93.0, 35.0, 1.4],
                [-36.0, 93.0, 35.0, 1.1],
                [-77.0, 54.0, 39.0, 1.3],
                [-96.0, -3.0, 38.0, 0.5],
                [-85.0, -60.0, 32.0, 0.9],
                [-36.0, -96.0, 34.0, 0.9],
                [30.0, -99.0, 38.0, 1.0],
                [84.0, -64.0, 35.0, 0.9],
                [46.0, -1.0, 35.0, 0.7],
                [39.0, 31.0, 43.0, 0.8],
                [14.0, 42.0, 37.0, 0.6],
                [-13.0, 49.0, 40.0, 0.5],
                [-37.0, 33.0, 42.0, 0.6],
                [-53.0, -2.0, 35.0, 0.8],
                [-37.0, -28.0, 39.0, 1.2],
                [-21.0, -51.0, 35.0, 0.6],
                [13.0, -48.0, 42.0, 1.0],
                [41.0, -31.0, 35.0, 0.9],
                [51.0, -4.0, 38.0, 0.8],
                [48.0, 32.0, 37.0, 1.3],
                [22.0, 50.0, 41.0, 0.5],
                [-17.0, 57.0, 39.0, 1.3],
                [-41.0, 31.0, 40.0, 0.5],
                [-57.0, -1.0, 43.0, 1.5],
                [-42.0, -33.0, 44.0, 0.8],
                [-16.0, -52.0, 35.0, 1.3],
                [19.0, -51.0, 39.0, 1.5],
                [40.0, -31.0, 36.0, 1.5],
                [62.0, 2.0, 35.0, 0.6],
                [51.0, 37.0, 36.0, 1.4],
                [20.0, 60.0, 42.0, 0.5],
                [-15.0, 61.0, 35.0, 1.1],
                [-53.0, 35.0, 42.0, 1.4],
                [-64.0, -1.0, 39.0, 1.1],
                [-56.0, -35.0, 40.0, 1.1],
                [-21.0, -61.0, 36.0, 1.2],
                [20.0, -64.0, 35.0, 0.9],
                [50.0, -40.0, 41.0, 1.5],
                [73.0, -1.0, 38.0, 0.7],
                [51.0, 35.0, 43.0, 0.7],
                [24.0, 66.0, 44.0, 1.2],
                [-22.0, 63.0, 43.0, 0.8],
                [-61.0, 42.0, 43.0, 0.5],
                [-65.0, 4.0, 39.0, 0.6],
                [-59.0, -39.0, 36.0, 1.0],
                [-19.0, -66.0, 36.0, 1.3],
                [24.0, -62.0, 43.0, 1.5],
                [53.0, -38.0, 43.0, 0.8],
                [72.0, -5.0, 37.0, 1.5],
                [57.0, 44.0, 36.0, 0.8],
                [22.0, 75.0, 44.0, 1.4],
                [-26.0, 69.0, 37.0, 0.7],
                [-65.0, 48.0, 42.0, 1.4],
                [-74.0, -3.0, 35.0, 0.7],
                [-61.0, -42.0, 38.0, 0.6],
                [-28.0, -70.0, 42.0, 1.3],
                [24.0, -68.0, 35.0, 0.6],
                [55.0, -46.0, 41.0, 0.7],
                [79.0, -1.0, 40.0, 1.0],
                [69.0, 44.0, 43.0, 1.3],
                [21.0, 72.0, 35.0, 1.0],
                [-21.0, 80.0, 42.0, 1.1],
                [-68.0, 47.0, 39.0, 1.0],
                [-80.0, 0.0, 44.0, 1.4],
                [-62.0, -52.0, 38.0, 0.6],
                [-27.0, -79.0, 37.0, 0.8],
                [24.0, -77.0, 44.0, 0.7],
                [65.0, -46.0, 43.0, 0.5],
                [85.0, -2.0, 43.0, 1.4],
                [67.0, 47.0, 35.0, 0.7],
                [22.0, 78.0, 42.0, 1.2],
                [-27.0, 84.0, 39.0, 1.3],
                [-76.0, 56.0, 35.0, 1.0],
                [-93.0, -1.0, 38.0, 0.7],
                [-75.0, -52.0, 42.0, 0.7],
                [-31.0, -87.0, 41.0, 1.2],
                [27.0, -80.0, 39.0, 0.7],
                [71.0, -56.0, 36.0, 1.2],
                [95.0, 3.0, 44.0, 1.2],
                [80.0, 51.0, 43.0, 1.5],
                [27.0, 89.0, 35.0, 1.0],
                [-32.0, 86.0, 40.0, 1.5],
                [-81.0, 53.0, 41.0, 1.1],
                [-96.0, -1.0, 36.0, 0.9],
                [-80.0, -51.0, 40.0, 0.5],
                [-28.0, -87.0, 44.0, 0.7],
                [27.0, -90.0, 44.0, 0.9],
                [74.0, -52.0, 39.0, 0.9],
                [103.0, 4.0, 39.0, 1.3],
                [80.0, 58.0, 43.0, 1.1],
                [33.0, 95.0, 35.0, 0.7],
                [-34.0, 91.0, 40.0, 0.6],
                [-82.0, 60.0, 40.0, 0.6],
                [-97.0, -4.0, 41.0, 1.1],
                [-82.0, -59.0, 38.0, 1.0],
                [-32.0, -97.0, 40.0, 1.5],
                [29.0, -94.0, 37.0, 1.1],
                [79.0, -58.0, 38.0, 1.0],
            ]
        )
        basis0 = BSplineBasis(
            5,
            np.array([-2.1, -1.3, 0.0, 0.0, 0.0, 0.9, 1.8, 2.8, 4.3, 4.9, 5.9, 6.7, 8.0, 8.0, 8.0, 8.9, 9.8]),
            1,
        )
        basis1 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 1.7, 3.2, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        basis2 = BSplineBasis(
            5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 2.1, 2.7, 3.8, 5.0, 5.0, 5.0, 5.0, 5.0])
        )
        vol = Volume(basis0, basis1, basis2, controlpoints, True)
        vol2 = vol.clone()
        vol2 *= np.array([7.6, 9.1, 10.3])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] /= 7.600000
        pt2[..., 1] /= 9.100000
        pt2[..., 2] /= 10.300000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_volume_3D_p757_rational_C1_periodic(self):
        controlpoints = np.array(
            [
                [54.0, -3.0, -4.0, 1.1],
                [36.0, 24.0, 2.0, 0.7],
                [13.0, 45.0, 4.0, 1.2],
                [-17.0, 48.0, 2.0, 1.3],
                [-40.0, 31.0, 4.0, 0.8],
                [-48.0, -4.0, -5.0, 1.2],
                [-39.0, -35.0, -1.0, 1.0],
                [-20.0, -45.0, -2.0, 1.3],
                [13.0, -47.0, 4.0, 0.8],
                [40.0, -34.0, -4.0, 1.4],
                [60.0, -4.0, 1.0, 1.5],
                [49.0, 33.0, -5.0, 1.1],
                [19.0, 54.0, -1.0, 1.0],
                [-22.0, 49.0, 3.0, 0.5],
                [-41.0, 34.0, 3.0, 0.8],
                [-55.0, -3.0, 3.0, 0.5],
                [-50.0, -34.0, 4.0, 1.3],
                [-20.0, -50.0, 2.0, 0.5],
                [21.0, -53.0, 1.0, 1.0],
                [43.0, -36.0, -2.0, 1.5],
                [62.0, 2.0, 2.0, 1.2],
                [45.0, 32.0, 2.0, 1.3],
                [23.0, 56.0, -4.0, 1.0],
                [-16.0, 58.0, 0.0, 1.0],
                [-52.0, 41.0, 2.0, 1.3],
                [-65.0, -4.0, -1.0, 0.8],
                [-53.0, -38.0, -4.0, 0.6],
                [-21.0, -60.0, 2.0, 1.1],
                [21.0, -60.0, 1.0, 0.9],
                [55.0, -37.0, -2.0, 1.4],
                [70.0, -4.0, 0.0, 0.9],
                [56.0, 36.0, -2.0, 1.0],
                [26.0, 62.0, 1.0, 1.2],
                [-21.0, 69.0, 3.0, 0.7],
                [-56.0, 45.0, -2.0, 1.0],
                [-71.0, 2.0, 3.0, 0.8],
                [-55.0, -38.0, -4.0, 1.0],
                [-17.0, -62.0, 3.0, 1.1],
                [23.0, -62.0, 0.0, 1.0],
                [58.0, -44.0, -5.0, 1.4],
                [79.0, 1.0, 4.0, 1.5],
                [61.0, 47.0, 3.0, 1.3],
                [24.0, 69.0, -5.0, 0.7],
                [-28.0, 67.0, -1.0, 1.3],
                [-57.0, 44.0, 2.0, 0.8],
                [-74.0, -5.0, 0.0, 1.0],
                [-61.0, -42.0, 3.0, 1.3],
                [-25.0, -71.0, -3.0, 0.6],
                [18.0, -76.0, -1.0, 0.8],
                [62.0, -40.0, 0.0, 1.0],
                [79.0, -2.0, -1.0, 1.1],
                [63.0, 45.0, 4.0, 1.4],
                [29.0, 79.0, 1.0, 0.7],
                [-27.0, 82.0, 1.0, 1.2],
                [-68.0, 47.0, 2.0, 0.6],
                [-77.0, 1.0, -2.0, 1.1],
                [-62.0, -52.0, 2.0, 1.1],
                [-26.0, -73.0, 0.0, 1.0],
                [27.0, -73.0, 3.0, 1.1],
                [63.0, -47.0, 3.0, 1.1],
                [85.0, -1.0, 3.0, 1.4],
                [66.0, 54.0, -3.0, 1.4],
                [31.0, 80.0, 0.0, 1.2],
                [-24.0, 81.0, -2.0, 0.8],
                [-72.0, 47.0, 1.0, 0.8],
                [-85.0, 1.0, 4.0, 1.5],
                [-67.0, -49.0, -2.0, 0.8],
                [-23.0, -80.0, -5.0, 0.8],
                [29.0, -83.0, -2.0, 0.9],
                [69.0, -56.0, 0.0, 1.0],
                [90.0, 2.0, -5.0, 1.3],
                [76.0, 51.0, 0.0, 0.8],
                [31.0, 89.0, 4.0, 0.7],
                [-32.0, 91.0, 0.0, 1.1],
                [-75.0, 56.0, -1.0, 1.5],
                [-94.0, 1.0, 2.0, 0.9],
                [-80.0, -52.0, -2.0, 1.0],
                [-33.0, -87.0, 0.0, 0.7],
                [28.0, -91.0, -1.0, 1.3],
                [79.0, -55.0, 2.0, 0.6],
                [95.0, -1.0, 3.0, 0.6],
                [81.0, 60.0, -4.0, 1.1],
                [28.0, 90.0, -1.0, 0.9],
                [-32.0, 94.0, 2.0, 1.0],
                [-82.0, 58.0, 1.0, 1.2],
                [-103.0, -4.0, -1.0, 1.1],
                [-76.0, -57.0, -1.0, 1.1],
                [-30.0, -97.0, -1.0, 0.9],
                [32.0, -94.0, 2.0, 1.3],
                [76.0, -60.0, 3.0, 0.9],
                [48.0, 4.0, -1.0, 1.0],
                [36.0, 32.0, -1.0, 0.6],
                [17.0, 43.0, -1.0, 0.5],
                [-14.0, 48.0, -1.0, 0.7],
                [-37.0, 28.0, 3.0, 1.4],
                [-53.0, 1.0, 2.0, 0.9],
                [-43.0, -29.0, 4.0, 1.0],
                [-13.0, -50.0, 7.0, 0.8],
                [17.0, -50.0, 5.0, 0.8],
                [39.0, -34.0, 4.0, 1.3],
                [56.0, 4.0, 3.0, 0.9],
                [48.0, 30.0, 3.0, 0.8],
                [19.0, 52.0, 4.0, 1.4],
                [-20.0, 50.0, 8.0, 1.2],
                [-44.0, 36.0, 6.0, 1.0],
                [-53.0, -5.0, 4.0, 1.2],
                [-43.0, -33.0, -1.0, 1.1],
                [-13.0, -51.0, 0.0, 1.0],
                [21.0, -52.0, 2.0, 0.8],
                [45.0, -34.0, -1.0, 1.3],
                [57.0, 2.0, -1.0, 1.4],
                [49.0, 33.0, 2.0, 1.3],
                [19.0, 61.0, 4.0, 0.9],
                [-19.0, 61.0, 8.0, 1.4],
                [-46.0, 39.0, 6.0, 1.3],
                [-68.0, 3.0, 2.0, 0.8],
                [-51.0, -40.0, 5.0, 1.4],
                [-23.0, -55.0, 0.0, 1.3],
                [19.0, -62.0, -1.0, 1.5],
                [45.0, -35.0, 1.0, 0.9],
                [66.0, -1.0, 3.0, 1.0],
                [56.0, 38.0, 7.0, 0.6],
                [16.0, 63.0, 5.0, 1.3],
                [-19.0, 61.0, 1.0, 0.9],
                [-54.0, 42.0, 6.0, 1.5],
                [-69.0, 2.0, 6.0, 1.4],
                [-56.0, -37.0, 5.0, 0.7],
                [-20.0, -65.0, 1.0, 1.3],
                [22.0, -66.0, 3.0, 0.8],
                [53.0, -37.0, 4.0, 1.1],
                [74.0, -5.0, 6.0, 0.6],
                [62.0, 47.0, 1.0, 1.5],
                [21.0, 67.0, 1.0, 1.2],
                [-22.0, 74.0, 3.0, 0.8],
                [-64.0, 42.0, 8.0, 1.3],
                [-78.0, 3.0, 8.0, 0.5],
                [-65.0, -46.0, 6.0, 1.1],
                [-21.0, -71.0, 1.0, 1.5],
                [23.0, -70.0, 2.0, 0.8],
                [64.0, -40.0, 5.0, 0.6],
                [83.0, -5.0, 3.0, 0.9],
                [62.0, 45.0, -2.0, 0.6],
                [26.0, 80.0, 2.0, 1.1],
                [-28.0, 80.0, 3.0, 1.1],
                [-70.0, 49.0, 0.0, 1.4],
                [-77.0, -2.0, 0.0, 1.3],
                [-65.0, -50.0, 5.0, 1.0],
                [-30.0, -83.0, 1.0, 0.6],
                [20.0, -81.0, 1.0, 1.2],
                [68.0, -46.0, 6.0, 1.3],
                [87.0, 3.0, 1.0, 1.1],
                [67.0, 49.0, 7.0, 1.2],
                [25.0, 82.0, 8.0, 0.7],
                [-28.0, 84.0, -1.0, 0.9],
                [-69.0, 51.0, 1.0, 1.3],
                [-90.0, 3.0, 0.0, 0.7],
                [-71.0, -52.0, 4.0, 0.6],
                [-26.0, -85.0, -1.0, 1.4],
                [28.0, -80.0, 2.0, 0.9],
                [67.0, -48.0, 0.0, 1.3],
                [92.0, 0.0, 3.0, 1.1],
                [78.0, 52.0, 7.0, 1.4],
                [32.0, 92.0, -1.0, 0.7],
                [-25.0, 85.0, 2.0, 0.6],
                [-77.0, 59.0, 6.0, 0.5],
                [-94.0, 4.0, 7.0, 1.0],
                [-76.0, -59.0, 2.0, 0.6],
                [-25.0, -85.0, 1.0, 1.3],
                [33.0, -87.0, 0.0, 1.2],
                [73.0, -52.0, 6.0, 0.6],
                [101.0, 1.0, 1.0, 1.1],
                [79.0, 60.0, -2.0, 0.7],
                [33.0, 93.0, 5.0, 1.0],
                [-33.0, 99.0, 0.0, 0.5],
                [-84.0, 55.0, 6.0, 1.4],
                [-103.0, 0.0, 5.0, 1.1],
                [-83.0, -57.0, 3.0, 0.9],
                [-33.0, -96.0, -1.0, 0.6],
                [28.0, -100.0, 4.0, 1.3],
                [85.0, -60.0, 4.0, 1.3],
                [46.0, -1.0, 3.0, 0.7],
                [37.0, 32.0, 6.0, 1.1],
                [12.0, 52.0, 10.0, 0.8],
                [-16.0, 45.0, 11.0, 1.1],
                [-36.0, 30.0, 7.0, 0.5],
                [-48.0, 2.0, 2.0, 1.3],
                [-37.0, -27.0, 5.0, 0.9],
                [-17.0, -43.0, 11.0, 0.9],
                [11.0, -52.0, 4.0, 1.4],
                [36.0, -33.0, 7.0, 0.9],
                [60.0, 1.0, 8.0, 0.9],
                [49.0, 36.0, 6.0, 0.6],
                [17.0, 55.0, 3.0, 1.1],
                [-22.0, 50.0, 3.0, 0.9],
                [-48.0, 36.0, 6.0, 1.5],
                [-56.0, -3.0, 7.0, 1.2],
                [-51.0, -29.0, 2.0, 0.6],
                [-14.0, -52.0, 11.0, 1.2],
                [17.0, -49.0, 11.0, 0.8],
                [45.0, -38.0, 6.0, 1.0],
                [67.0, -3.0, 2.0, 1.0],
                [48.0, 35.0, 3.0, 1.0],
                [19.0, 59.0, 8.0, 1.5],
                [-15.0, 56.0, 5.0, 0.9],
                [-52.0, 32.0, 6.0, 0.8],
                [-65.0, 2.0, 4.0, 1.5],
                [-52.0, -33.0, 8.0, 0.8],
                [-20.0, -65.0, 4.0, 0.9],
                [20.0, -65.0, 10.0, 1.0],
                [46.0, -38.0, 4.0, 1.2],
                [68.0, 4.0, 9.0, 1.4],
                [53.0, 37.0, 5.0, 0.7],
                [23.0, 68.0, 3.0, 1.3],
                [-21.0, 69.0, 6.0, 0.8],
                [-53.0, 42.0, 6.0, 0.8],
                [-72.0, -3.0, 2.0, 1.0],
                [-61.0, -44.0, 3.0, 1.2],
                [-25.0, -66.0, 3.0, 1.2],
                [24.0, -69.0, 3.0, 0.9],
                [59.0, -37.0, 11.0, 1.0],
                [72.0, 1.0, 6.0, 0.8],
                [61.0, 42.0, 2.0, 1.0],
                [20.0, 72.0, 11.0, 0.7],
                [-20.0, 73.0, 10.0, 0.6],
                [-64.0, 43.0, 10.0, 0.6],
                [-79.0, -3.0, 7.0, 1.4],
                [-58.0, -46.0, 9.0, 1.1],
                [-22.0, -68.0, 3.0, 0.6],
                [24.0, -70.0, 11.0, 1.4],
                [61.0, -49.0, 8.0, 0.7],
                [82.0, 4.0, 3.0, 1.3],
                [68.0, 47.0, 2.0, 0.8],
                [28.0, 79.0, 9.0, 0.5],
                [-24.0, 73.0, 12.0, 1.5],
                [-67.0, 44.0, 2.0, 0.6],
                [-81.0, 3.0, 8.0, 1.3],
                [-62.0, -46.0, 3.0, 0.6],
                [-30.0, -74.0, 11.0, 0.7],
                [28.0, -77.0, 7.0, 1.5],
                [69.0, -44.0, 8.0, 1.4],
                [91.0, 2.0, 6.0, 0.9],
                [70.0, 52.0, 8.0, 1.2],
                [28.0, 82.0, 2.0, 0.9],
                [-30.0, 81.0, 9.0, 0.9],
                [-75.0, 55.0, 3.0, 0.5],
                [-85.0, 3.0, 11.0, 0.6],
                [-69.0, -55.0, 3.0, 1.4],
                [-29.0, -79.0, 3.0, 1.5],
                [26.0, -79.0, 2.0, 1.0],
                [68.0, -55.0, 9.0, 0.8],
                [91.0, -5.0, 3.0, 0.6],
                [80.0, 50.0, 2.0, 0.8],
                [30.0, 88.0, 5.0, 0.7],
                [-25.0, 93.0, 2.0, 1.4],
                [-77.0, 60.0, 2.0, 0.7],
                [-97.0, -1.0, 9.0, 0.7],
                [-77.0, -54.0, 9.0, 1.2],
                [-33.0, -91.0, 5.0, 1.0],
                [32.0, -91.0, 3.0, 1.5],
                [80.0, -59.0, 8.0, 1.0],
                [104.0, 3.0, 7.0, 0.6],
                [84.0, 61.0, 12.0, 1.3],
                [28.0, 93.0, 10.0, 0.6],
                [-33.0, 99.0, 9.0, 0.6],
                [-81.0, 54.0, 4.0, 1.1],
                [-100.0, 1.0, 4.0, 1.5],
                [-78.0, -64.0, 3.0, 1.1],
                [-35.0, -94.0, 4.0, 1.1],
                [28.0, -92.0, 11.0, 1.1],
                [82.0, -61.0, 2.0, 1.1],
                [45.0, -2.0, 10.0, 1.0],
                [43.0, 28.0, 11.0, 1.2],
                [13.0, 46.0, 11.0, 0.9],
                [-14.0, 46.0, 9.0, 1.2],
                [-37.0, 25.0, 11.0, 1.0],
                [-52.0, -4.0, 6.0, 1.0],
                [-42.0, -35.0, 15.0, 1.1],
                [-14.0, -49.0, 5.0, 0.7],
                [14.0, -47.0, 9.0, 0.7],
                [41.0, -27.0, 11.0, 1.0],
                [51.0, -5.0, 14.0, 0.7],
                [46.0, 28.0, 11.0, 0.7],
                [16.0, 58.0, 10.0, 0.9],
                [-17.0, 55.0, 12.0, 0.8],
                [-49.0, 32.0, 10.0, 0.5],
                [-54.0, 0.0, 7.0, 1.3],
                [-50.0, -35.0, 13.0, 1.1],
                [-16.0, -53.0, 12.0, 1.3],
                [15.0, -57.0, 13.0, 0.8],
                [48.0, -34.0, 10.0, 1.1],
                [65.0, 4.0, 12.0, 0.9],
                [55.0, 39.0, 6.0, 0.5],
                [17.0, 59.0, 6.0, 1.4],
                [-18.0, 63.0, 12.0, 1.3],
                [-46.0, 37.0, 8.0, 1.3],
                [-62.0, 0.0, 6.0, 0.6],
                [-55.0, -34.0, 8.0, 1.5],
                [-19.0, -63.0, 9.0, 0.9],
                [16.0, -55.0, 12.0, 0.8],
                [51.0, -39.0, 6.0, 0.7],
                [72.0, -3.0, 15.0, 1.3],
                [53.0, 39.0, 10.0, 0.7],
                [24.0, 61.0, 14.0, 1.2],
                [-23.0, 69.0, 6.0, 1.3],
                [-53.0, 42.0, 11.0, 1.2],
                [-64.0, -4.0, 14.0, 0.7],
                [-54.0, -45.0, 14.0, 1.5],
                [-26.0, -67.0, 12.0, 1.3],
                [22.0, -65.0, 15.0, 0.6],
                [51.0, -36.0, 10.0, 1.2],
                [74.0, -1.0, 13.0, 1.3],
                [64.0, 45.0, 15.0, 1.0],
                [20.0, 73.0, 12.0, 0.6],
                [-23.0, 69.0, 12.0, 0.9],
                [-57.0, 46.0, 15.0, 0.6],
                [-72.0, 1.0, 11.0, 1.5],
                [-65.0, -40.0, 10.0, 1.3],
                [-24.0, -70.0, 13.0, 1.0],
                [24.0, -69.0, 11.0, 1.0],
                [63.0, -45.0, 15.0, 0.6],
                [83.0, -4.0, 12.0, 1.2],
                [63.0, 48.0, 15.0, 1.0],
                [21.0, 80.0, 6.0, 1.3],
                [-25.0, 80.0, 5.0, 0.7],
                [-65.0, 49.0, 10.0, 1.2],
                [-82.0, 3.0, 9.0, 0.6],
                [-63.0, -51.0, 12.0, 0.7],
                [-24.0, -75.0, 6.0, 1.0],
                [24.0, -77.0, 7.0, 1.0],
                [69.0, -47.0, 11.0, 1.3],
                [83.0, 1.0, 15.0, 0.7],
                [67.0, 49.0, 11.0, 1.5],
                [22.0, 83.0, 11.0, 1.3],
                [-29.0, 81.0, 9.0, 1.0],
                [-68.0, 50.0, 12.0, 1.5],
                [-86.0, 2.0, 13.0, 0.6],
                [-75.0, -51.0, 7.0, 1.0],
                [-32.0, -82.0, 12.0, 0.6],
                [24.0, -79.0, 14.0, 0.7],
                [74.0, -52.0, 9.0, 0.8],
                [93.0, -3.0, 9.0, 0.6],
                [71.0, 55.0, 14.0, 0.7],
                [32.0, 88.0, 12.0, 0.8],
                [-34.0, 90.0, 13.0, 0.8],
                [-75.0, 55.0, 14.0, 1.1],
                [-99.0, -2.0, 10.0, 1.1],
                [-78.0, -52.0, 10.0, 1.4],
                [-32.0, -93.0, 7.0, 1.3],
                [28.0, -88.0, 8.0, 0.7],
                [74.0, -54.0, 6.0, 1.4],
                [100.0, 3.0, 11.0, 0.8],
                [80.0, 61.0, 13.0, 1.1],
                [28.0, 92.0, 8.0, 0.8],
                [-35.0, 92.0, 6.0, 1.2],
                [-80.0, 62.0, 11.0, 0.5],
                [-98.0, 2.0, 7.0, 0.5],
                [-81.0, -60.0, 14.0, 0.5],
                [-32.0, -92.0, 7.0, 1.3],
                [27.0, -94.0, 12.0, 1.1],
                [82.0, -61.0, 7.0, 0.7],
                [53.0, 0.0, 18.0, 1.0],
                [38.0, 27.0, 10.0, 1.2],
                [15.0, 43.0, 14.0, 1.4],
                [-20.0, 51.0, 14.0, 0.7],
                [-38.0, 32.0, 15.0, 0.8],
                [-54.0, 3.0, 12.0, 0.5],
                [-42.0, -28.0, 15.0, 1.3],
                [-12.0, -43.0, 12.0, 0.8],
                [14.0, -50.0, 10.0, 0.8],
                [39.0, -33.0, 16.0, 0.8],
                [57.0, 3.0, 16.0, 1.5],
                [45.0, 36.0, 17.0, 0.9],
                [16.0, 55.0, 19.0, 1.2],
                [-20.0, 54.0, 16.0, 0.7],
                [-48.0, 28.0, 10.0, 0.7],
                [-60.0, 1.0, 15.0, 0.7],
                [-48.0, -38.0, 13.0, 0.6],
                [-18.0, -53.0, 12.0, 1.4],
                [20.0, -52.0, 11.0, 1.4],
                [48.0, -34.0, 11.0, 1.3],
                [66.0, 4.0, 10.0, 0.6],
                [53.0, 37.0, 11.0, 1.3],
                [15.0, 62.0, 18.0, 1.3],
                [-18.0, 60.0, 12.0, 0.7],
                [-51.0, 32.0, 19.0, 0.6],
                [-58.0, -5.0, 12.0, 0.6],
                [-55.0, -38.0, 13.0, 1.0],
                [-19.0, -60.0, 18.0, 0.6],
                [20.0, -57.0, 15.0, 0.6],
                [46.0, -37.0, 13.0, 1.2],
                [64.0, -2.0, 16.0, 0.7],
                [50.0, 39.0, 12.0, 1.0],
                [25.0, 65.0, 10.0, 0.6],
                [-19.0, 68.0, 17.0, 1.2],
                [-60.0, 36.0, 13.0, 1.0],
                [-65.0, -5.0, 18.0, 1.4],
                [-58.0, -44.0, 13.0, 0.9],
                [-23.0, -62.0, 19.0, 1.5],
                [22.0, -65.0, 14.0, 0.8],
                [56.0, -38.0, 16.0, 1.0],
                [70.0, -5.0, 17.0, 0.6],
                [57.0, 43.0, 17.0, 0.9],
                [22.0, 73.0, 12.0, 0.8],
                [-24.0, 73.0, 12.0, 1.4],
                [-59.0, 41.0, 15.0, 1.4],
                [-72.0, 4.0, 11.0, 0.9],
                [-59.0, -44.0, 19.0, 0.7],
                [-26.0, -67.0, 10.0, 0.8],
                [27.0, -70.0, 14.0, 1.2],
                [58.0, -46.0, 18.0, 0.7],
                [77.0, -3.0, 18.0, 0.9],
                [66.0, 47.0, 13.0, 1.1],
                [24.0, 76.0, 13.0, 1.0],
                [-27.0, 79.0, 11.0, 1.4],
                [-70.0, 46.0, 11.0, 1.1],
                [-86.0, 0.0, 14.0, 1.3],
                [-70.0, -47.0, 16.0, 1.0],
                [-26.0, -76.0, 14.0, 0.6],
                [25.0, -74.0, 16.0, 1.2],
                [68.0, -46.0, 12.0, 0.7],
                [92.0, -2.0, 13.0, 1.1],
                [68.0, 53.0, 18.0, 1.0],
                [24.0, 82.0, 13.0, 1.0],
                [-32.0, 81.0, 15.0, 0.7],
                [-71.0, 50.0, 11.0, 1.2],
                [-92.0, -3.0, 13.0, 0.7],
                [-75.0, -49.0, 13.0, 0.6],
                [-31.0, -83.0, 10.0, 1.2],
                [22.0, -85.0, 18.0, 1.0],
                [67.0, -49.0, 11.0, 0.5],
                [89.0, -4.0, 10.0, 1.3],
                [79.0, 56.0, 13.0, 0.6],
                [27.0, 90.0, 9.0, 1.3],
                [-28.0, 85.0, 18.0, 1.2],
                [-76.0, 53.0, 16.0, 1.4],
                [-90.0, 3.0, 15.0, 1.0],
                [-79.0, -54.0, 13.0, 1.5],
                [-33.0, -89.0, 11.0, 1.4],
                [33.0, -88.0, 10.0, 1.3],
                [71.0, -57.0, 11.0, 1.2],
                [102.0, -3.0, 16.0, 0.7],
                [76.0, 59.0, 17.0, 1.1],
                [34.0, 97.0, 17.0, 0.7],
                [-27.0, 93.0, 17.0, 0.7],
                [-77.0, 55.0, 10.0, 0.6],
                [-98.0, -1.0, 11.0, 0.8],
                [-83.0, -60.0, 12.0, 1.1],
                [-33.0, -96.0, 18.0, 0.6],
                [33.0, -98.0, 15.0, 1.2],
                [81.0, -64.0, 18.0, 0.9],
                [53.0, -1.0, 16.0, 1.0],
                [41.0, 28.0, 18.0, 0.6],
                [13.0, 51.0, 18.0, 0.8],
                [-17.0, 47.0, 18.0, 0.8],
                [-39.0, 32.0, 18.0, 1.2],
                [-47.0, 1.0, 20.0, 0.6],
                [-45.0, -34.0, 19.0, 1.2],
                [-14.0, -52.0, 21.0, 1.2],
                [16.0, -49.0, 20.0, 1.4],
                [38.0, -25.0, 16.0, 0.8],
                [57.0, 1.0, 22.0, 1.4],
                [47.0, 30.0, 17.0, 1.3],
                [15.0, 57.0, 15.0, 0.9],
                [-21.0, 48.0, 19.0, 0.8],
                [-44.0, 30.0, 16.0, 1.1],
                [-61.0, 1.0, 20.0, 0.9],
                [-49.0, -31.0, 22.0, 1.3],
                [-18.0, -50.0, 18.0, 1.0],
                [15.0, -52.0, 19.0, 0.7],
                [44.0, -29.0, 13.0, 1.3],
                [60.0, -4.0, 18.0, 1.0],
                [48.0, 38.0, 18.0, 1.2],
                [17.0, 60.0, 20.0, 1.4],
                [-19.0, 62.0, 18.0, 1.3],
                [-53.0, 35.0, 14.0, 0.6],
                [-59.0, 1.0, 20.0, 0.9],
                [-54.0, -33.0, 18.0, 0.8],
                [-18.0, -63.0, 19.0, 1.5],
                [22.0, -62.0, 19.0, 0.8],
                [53.0, -38.0, 14.0, 1.0],
                [66.0, 3.0, 21.0, 1.1],
                [59.0, 42.0, 22.0, 1.2],
                [20.0, 66.0, 19.0, 0.5],
                [-27.0, 63.0, 15.0, 0.6],
                [-52.0, 43.0, 20.0, 0.7],
                [-65.0, -2.0, 18.0, 1.5],
                [-55.0, -37.0, 20.0, 0.7],
                [-20.0, -65.0, 14.0, 0.6],
                [17.0, -67.0, 23.0, 1.1],
                [56.0, -45.0, 13.0, 0.5],
                [79.0, -5.0, 22.0, 0.8],
                [64.0, 42.0, 14.0, 1.1],
                [18.0, 75.0, 21.0, 0.7],
                [-28.0, 74.0, 20.0, 1.0],
                [-65.0, 47.0, 20.0, 0.6],
                [-72.0, -1.0, 21.0, 1.3],
                [-66.0, -42.0, 18.0, 0.9],
                [-26.0, -69.0, 18.0, 0.8],
                [22.0, -75.0, 20.0, 0.8],
                [56.0, -48.0, 14.0, 1.2],
                [85.0, -5.0, 20.0, 1.1],
                [64.0, 47.0, 17.0, 1.1],
                [23.0, 72.0, 17.0, 1.4],
                [-26.0, 75.0, 22.0, 1.5],
                [-62.0, 46.0, 21.0, 1.5],
                [-80.0, -4.0, 17.0, 1.2],
                [-64.0, -45.0, 17.0, 0.8],
                [-25.0, -78.0, 22.0, 1.1],
                [23.0, -73.0, 15.0, 0.5],
                [68.0, -51.0, 14.0, 1.2],
                [90.0, 0.0, 13.0, 1.1],
                [71.0, 50.0, 20.0, 0.7],
                [23.0, 79.0, 17.0, 0.7],
                [-32.0, 84.0, 16.0, 0.6],
                [-73.0, 53.0, 20.0, 0.6],
                [-90.0, -2.0, 15.0, 1.1],
                [-69.0, -48.0, 19.0, 0.9],
                [-31.0, -83.0, 20.0, 1.2],
                [25.0, -80.0, 20.0, 0.9],
                [72.0, -54.0, 21.0, 1.3],
                [93.0, -1.0, 19.0, 0.6],
                [77.0, 59.0, 20.0, 1.2],
                [32.0, 91.0, 14.0, 0.9],
                [-32.0, 93.0, 19.0, 0.9],
                [-80.0, 58.0, 14.0, 1.4],
                [-94.0, -3.0, 14.0, 1.4],
                [-72.0, -57.0, 21.0, 1.2],
                [-26.0, -88.0, 15.0, 0.7],
                [31.0, -94.0, 13.0, 0.6],
                [78.0, -55.0, 22.0, 1.1],
                [97.0, -3.0, 19.0, 0.9],
                [78.0, 55.0, 14.0, 1.1],
                [28.0, 94.0, 18.0, 1.2],
                [-32.0, 99.0, 17.0, 0.7],
                [-77.0, 63.0, 18.0, 0.9],
                [-100.0, -5.0, 17.0, 1.1],
                [-83.0, -59.0, 22.0, 0.5],
                [-29.0, -96.0, 20.0, 0.6],
                [34.0, -95.0, 22.0, 0.5],
                [76.0, -56.0, 13.0, 0.7],
                [54.0, -4.0, 18.0, 0.8],
                [39.0, 24.0, 19.0, 1.1],
                [15.0, 48.0, 22.0, 0.6],
                [-20.0, 44.0, 23.0, 1.5],
                [-46.0, 32.0, 19.0, 1.0],
                [-47.0, 4.0, 25.0, 0.6],
                [-39.0, -35.0, 18.0, 1.0],
                [-13.0, -50.0, 26.0, 0.7],
                [18.0, -46.0, 25.0, 1.2],
                [37.0, -28.0, 24.0, 1.0],
                [59.0, 3.0, 21.0, 0.6],
                [44.0, 37.0, 17.0, 1.2],
                [13.0, 55.0, 17.0, 0.9],
                [-20.0, 57.0, 25.0, 1.2],
                [-46.0, 35.0, 21.0, 1.1],
                [-57.0, -4.0, 18.0, 1.1],
                [-49.0, -37.0, 22.0, 0.7],
                [-23.0, -58.0, 25.0, 1.2],
                [14.0, -59.0, 19.0, 1.3],
                [41.0, -32.0, 17.0, 1.1],
                [62.0, -4.0, 21.0, 0.6],
                [54.0, 31.0, 24.0, 1.2],
                [23.0, 55.0, 22.0, 1.5],
                [-18.0, 61.0, 20.0, 1.5],
                [-52.0, 33.0, 23.0, 0.9],
                [-65.0, -4.0, 25.0, 0.6],
                [-53.0, -40.0, 18.0, 0.9],
                [-18.0, -60.0, 25.0, 0.5],
                [22.0, -55.0, 22.0, 1.1],
                [54.0, -36.0, 25.0, 0.7],
                [65.0, 3.0, 24.0, 0.6],
                [59.0, 42.0, 19.0, 1.0],
                [24.0, 64.0, 23.0, 0.6],
                [-18.0, 61.0, 23.0, 0.5],
                [-59.0, 44.0, 17.0, 1.1],
                [-74.0, 2.0, 19.0, 1.1],
                [-54.0, -46.0, 18.0, 1.3],
                [-21.0, -64.0, 18.0, 0.8],
                [26.0, -62.0, 25.0, 1.4],
                [52.0, -39.0, 23.0, 1.2],
                [70.0, -2.0, 20.0, 0.6],
                [62.0, 45.0, 23.0, 0.7],
                [19.0, 73.0, 24.0, 1.2],
                [-22.0, 66.0, 25.0, 0.6],
                [-61.0, 47.0, 22.0, 1.3],
                [-80.0, 4.0, 23.0, 0.7],
                [-60.0, -42.0, 20.0, 1.3],
                [-25.0, -70.0, 18.0, 1.4],
                [18.0, -74.0, 25.0, 1.2],
                [62.0, -45.0, 17.0, 0.5],
                [76.0, 3.0, 18.0, 0.9],
                [62.0, 51.0, 23.0, 1.4],
                [21.0, 75.0, 20.0, 0.8],
                [-26.0, 75.0, 23.0, 1.3],
                [-65.0, 52.0, 26.0, 0.8],
                [-84.0, -1.0, 19.0, 1.1],
                [-69.0, -50.0, 24.0, 1.1],
                [-28.0, -78.0, 22.0, 0.6],
                [29.0, -82.0, 17.0, 0.7],
                [62.0, -52.0, 24.0, 0.9],
                [92.0, 3.0, 24.0, 1.1],
                [67.0, 50.0, 25.0, 1.1],
                [26.0, 87.0, 23.0, 0.8],
                [-30.0, 82.0, 21.0, 1.1],
                [-67.0, 51.0, 19.0, 0.6],
                [-84.0, -2.0, 19.0, 1.3],
                [-74.0, -55.0, 26.0, 1.4],
                [-26.0, -85.0, 20.0, 0.7],
                [27.0, -86.0, 19.0, 1.0],
                [72.0, -51.0, 25.0, 1.2],
                [95.0, -1.0, 24.0, 1.5],
                [77.0, 51.0, 26.0, 1.2],
                [33.0, 88.0, 20.0, 1.2],
                [-30.0, 91.0, 18.0, 1.3],
                [-75.0, 50.0, 16.0, 0.5],
                [-93.0, 4.0, 17.0, 0.8],
                [-75.0, -54.0, 17.0, 0.5],
                [-33.0, -94.0, 17.0, 1.1],
                [25.0, -87.0, 23.0, 0.8],
                [76.0, -55.0, 21.0, 1.2],
                [100.0, -4.0, 24.0, 0.6],
                [79.0, 59.0, 22.0, 0.8],
                [33.0, 91.0, 21.0, 1.4],
                [-31.0, 97.0, 25.0, 0.7],
                [-82.0, 57.0, 22.0, 1.2],
                [-99.0, 1.0, 21.0, 1.3],
                [-78.0, -64.0, 25.0, 1.1],
                [-32.0, -99.0, 25.0, 0.9],
                [30.0, -99.0, 26.0, 0.7],
                [79.0, -64.0, 23.0, 0.9],
                [50.0, 2.0, 20.0, 1.2],
                [43.0, 32.0, 21.0, 0.7],
                [18.0, 43.0, 27.0, 1.0],
                [-18.0, 48.0, 20.0, 1.1],
                [-38.0, 29.0, 23.0, 1.5],
                [-52.0, -2.0, 25.0, 0.9],
                [-38.0, -26.0, 21.0, 0.7],
                [-16.0, -50.0, 22.0, 1.2],
                [16.0, -53.0, 22.0, 0.8],
                [43.0, -25.0, 29.0, 0.6],
                [55.0, -2.0, 20.0, 0.8],
                [45.0, 32.0, 25.0, 1.1],
                [20.0, 53.0, 24.0, 1.4],
                [-23.0, 52.0, 21.0, 0.6],
                [-49.0, 32.0, 28.0, 0.7],
                [-58.0, 3.0, 27.0, 0.7],
                [-48.0, -37.0, 27.0, 0.6],
                [-14.0, -55.0, 25.0, 1.5],
                [15.0, -51.0, 24.0, 1.0],
                [45.0, -33.0, 21.0, 0.9],
                [63.0, -4.0, 27.0, 1.0],
                [49.0, 37.0, 21.0, 1.0],
                [19.0, 57.0, 27.0, 1.3],
                [-16.0, 59.0, 26.0, 0.9],
                [-48.0, 31.0, 21.0, 0.7],
                [-65.0, 2.0, 29.0, 1.0],
                [-49.0, -35.0, 28.0, 0.5],
                [-18.0, -64.0, 29.0, 0.8],
                [19.0, -63.0, 29.0, 1.4],
                [49.0, -33.0, 28.0, 0.6],
                [71.0, -2.0, 28.0, 1.2],
                [55.0, 37.0, 21.0, 1.1],
                [17.0, 61.0, 23.0, 1.2],
                [-18.0, 65.0, 28.0, 1.4],
                [-58.0, 38.0, 25.0, 1.1],
                [-71.0, 1.0, 25.0, 1.1],
                [-57.0, -40.0, 25.0, 1.1],
                [-24.0, -67.0, 23.0, 0.8],
                [18.0, -65.0, 22.0, 1.3],
                [50.0, -44.0, 23.0, 0.9],
                [75.0, 1.0, 28.0, 0.9],
                [57.0, 49.0, 21.0, 0.8],
                [24.0, 70.0, 29.0, 0.7],
                [-27.0, 71.0, 22.0, 0.8],
                [-64.0, 45.0, 27.0, 1.4],
                [-80.0, -5.0, 28.0, 1.2],
                [-65.0, -47.0, 21.0, 0.6],
                [-26.0, -72.0, 23.0, 1.4],
                [19.0, -68.0, 28.0, 0.9],
                [59.0, -46.0, 25.0, 1.1],
                [82.0, -5.0, 24.0, 0.6],
                [61.0, 45.0, 29.0, 0.8],
                [28.0, 78.0, 27.0, 1.0],
                [-21.0, 77.0, 26.0, 1.3],
                [-71.0, 51.0, 28.0, 0.9],
                [-80.0, -5.0, 26.0, 0.5],
                [-66.0, -48.0, 23.0, 1.1],
                [-28.0, -79.0, 26.0, 1.5],
                [26.0, -81.0, 25.0, 1.1],
                [63.0, -44.0, 27.0, 1.1],
                [88.0, -5.0, 30.0, 0.5],
                [74.0, 56.0, 20.0, 0.9],
                [27.0, 80.0, 23.0, 1.1],
                [-27.0, 81.0, 21.0, 0.8],
                [-68.0, 52.0, 28.0, 1.2],
                [-87.0, -1.0, 23.0, 0.5],
                [-71.0, -54.0, 26.0, 0.7],
                [-28.0, -88.0, 23.0, 1.2],
                [28.0, -87.0, 29.0, 0.8],
                [69.0, -52.0, 25.0, 1.0],
                [93.0, -5.0, 24.0, 0.6],
                [75.0, 51.0, 21.0, 1.0],
                [25.0, 91.0, 25.0, 1.4],
                [-34.0, 84.0, 27.0, 1.4],
                [-78.0, 59.0, 28.0, 1.0],
                [-93.0, -5.0, 23.0, 1.0],
                [-76.0, -51.0, 30.0, 1.2],
                [-25.0, -87.0, 26.0, 0.8],
                [32.0, -85.0, 22.0, 1.3],
                [71.0, -56.0, 27.0, 1.3],
                [97.0, -5.0, 30.0, 1.1],
                [78.0, 55.0, 24.0, 1.3],
                [35.0, 92.0, 20.0, 1.3],
                [-34.0, 97.0, 25.0, 1.4],
                [-82.0, 60.0, 21.0, 1.2],
                [-99.0, -3.0, 29.0, 1.2],
                [-84.0, -64.0, 25.0, 0.6],
                [-34.0, -93.0, 25.0, 1.4],
                [31.0, -93.0, 24.0, 1.5],
                [85.0, -56.0, 26.0, 1.4],
                [52.0, 4.0, 29.0, 1.4],
                [41.0, 27.0, 27.0, 1.4],
                [16.0, 50.0, 32.0, 1.5],
                [-14.0, 45.0, 25.0, 1.2],
                [-45.0, 34.0, 28.0, 1.4],
                [-54.0, -4.0, 30.0, 1.3],
                [-37.0, -27.0, 29.0, 0.8],
                [-12.0, -44.0, 25.0, 1.4],
                [19.0, -52.0, 24.0, 0.6],
                [36.0, -30.0, 28.0, 1.1],
                [54.0, -2.0, 26.0, 1.2],
                [41.0, 31.0, 24.0, 0.8],
                [17.0, 50.0, 30.0, 0.5],
                [-18.0, 56.0, 33.0, 0.6],
                [-50.0, 29.0, 28.0, 1.5],
                [-59.0, 2.0, 27.0, 0.7],
                [-45.0, -33.0, 24.0, 0.9],
                [-15.0, -54.0, 32.0, 1.1],
                [18.0, -57.0, 24.0, 1.4],
                [45.0, -34.0, 32.0, 0.8],
                [65.0, 1.0, 30.0, 1.1],
                [45.0, 39.0, 32.0, 0.8],
                [15.0, 58.0, 31.0, 0.9],
                [-20.0, 62.0, 31.0, 1.0],
                [-49.0, 39.0, 26.0, 1.2],
                [-67.0, -4.0, 33.0, 1.2],
                [-48.0, -40.0, 25.0, 1.1],
                [-25.0, -60.0, 24.0, 1.4],
                [22.0, -60.0, 27.0, 0.8],
                [53.0, -42.0, 32.0, 1.2],
                [73.0, 2.0, 30.0, 1.5],
                [51.0, 36.0, 32.0, 0.7],
                [24.0, 62.0, 33.0, 0.8],
                [-21.0, 66.0, 29.0, 0.9],
                [-55.0, 43.0, 25.0, 1.1],
                [-72.0, 3.0, 26.0, 0.9],
                [-60.0, -42.0, 34.0, 0.9],
                [-22.0, -62.0, 29.0, 0.8],
                [19.0, -70.0, 32.0, 1.3],
                [58.0, -44.0, 24.0, 0.8],
                [77.0, -3.0, 27.0, 1.4],
                [60.0, 41.0, 27.0, 1.0],
                [19.0, 75.0, 24.0, 0.6],
                [-25.0, 70.0, 28.0, 1.1],
                [-65.0, 49.0, 30.0, 0.6],
                [-72.0, -4.0, 28.0, 1.3],
                [-63.0, -42.0, 30.0, 1.2],
                [-19.0, -75.0, 24.0, 1.5],
                [26.0, -71.0, 31.0, 0.9],
                [57.0, -48.0, 26.0, 1.4],
                [77.0, 3.0, 26.0, 0.6],
                [60.0, 48.0, 30.0, 0.9],
                [29.0, 74.0, 25.0, 0.6],
                [-26.0, 78.0, 30.0, 1.2],
                [-69.0, 52.0, 32.0, 0.5],
                [-81.0, 2.0, 24.0, 0.8],
                [-65.0, -51.0, 28.0, 0.8],
                [-29.0, -76.0, 28.0, 1.0],
                [23.0, -82.0, 24.0, 1.4],
                [66.0, -52.0, 33.0, 1.2],
                [87.0, 2.0, 33.0, 1.1],
                [67.0, 53.0, 30.0, 1.4],
                [27.0, 83.0, 30.0, 0.6],
                [-23.0, 86.0, 28.0, 1.2],
                [-72.0, 52.0, 33.0, 1.2],
                [-91.0, -4.0, 31.0, 0.8],
                [-73.0, -47.0, 27.0, 0.9],
                [-26.0, -85.0, 24.0, 0.8],
                [28.0, -84.0, 26.0, 1.0],
                [72.0, -53.0, 25.0, 0.9],
                [93.0, 2.0, 26.0, 0.7],
                [79.0, 59.0, 25.0, 0.8],
                [33.0, 93.0, 25.0, 0.8],
                [-28.0, 85.0, 31.0, 0.8],
                [-73.0, 54.0, 29.0, 0.9],
                [-94.0, -5.0, 28.0, 0.9],
                [-77.0, -59.0, 27.0, 1.2],
                [-28.0, -86.0, 25.0, 1.0],
                [29.0, -87.0, 27.0, 1.1],
                [73.0, -54.0, 29.0, 0.9],
                [96.0, 0.0, 32.0, 1.2],
                [80.0, 63.0, 26.0, 0.7],
                [28.0, 93.0, 32.0, 1.2],
                [-29.0, 92.0, 25.0, 1.5],
                [-83.0, 54.0, 26.0, 1.2],
                [-105.0, -5.0, 33.0, 1.4],
                [-83.0, -60.0, 28.0, 0.9],
                [-28.0, -94.0, 34.0, 1.2],
                [33.0, -100.0, 33.0, 1.3],
                [85.0, -57.0, 25.0, 1.5],
                [53.0, 4.0, 34.0, 1.3],
                [38.0, 26.0, 34.0, 0.9],
                [11.0, 44.0, 28.0, 1.5],
                [-12.0, 47.0, 30.0, 0.5],
                [-40.0, 28.0, 34.0, 1.3],
                [-55.0, -1.0, 36.0, 1.5],
                [-43.0, -31.0, 35.0, 1.2],
                [-19.0, -44.0, 30.0, 1.2],
                [15.0, -48.0, 36.0, 1.1],
                [44.0, -31.0, 28.0, 0.6],
                [56.0, 4.0, 37.0, 1.5],
                [45.0, 34.0, 31.0, 0.6],
                [22.0, 58.0, 29.0, 0.8],
                [-20.0, 52.0, 28.0, 0.8],
                [-50.0, 33.0, 31.0, 1.2],
                [-60.0, 0.0, 31.0, 0.8],
                [-47.0, -30.0, 30.0, 0.8],
                [-19.0, -56.0, 36.0, 1.0],
                [15.0, -52.0, 37.0, 1.4],
                [49.0, -34.0, 33.0, 0.6],
                [60.0, -5.0, 30.0, 1.4],
                [54.0, 39.0, 31.0, 1.2],
                [21.0, 57.0, 34.0, 0.7],
                [-16.0, 63.0, 33.0, 0.9],
                [-54.0, 31.0, 28.0, 1.2],
                [-66.0, -3.0, 33.0, 0.9],
                [-50.0, -39.0, 36.0, 1.0],
                [-18.0, -58.0, 31.0, 0.6],
                [15.0, -59.0, 30.0, 1.4],
                [49.0, -38.0, 36.0, 1.0],
                [65.0, -3.0, 34.0, 0.6],
                [51.0, 35.0, 35.0, 1.2],
                [20.0, 65.0, 37.0, 0.9],
                [-22.0, 66.0, 35.0, 0.8],
                [-52.0, 41.0, 30.0, 0.8],
                [-72.0, 3.0, 34.0, 1.4],
                [-60.0, -46.0, 31.0, 1.5],
                [-24.0, -68.0, 27.0, 1.5],
                [20.0, -62.0, 35.0, 0.6],
                [51.0, -37.0, 30.0, 0.8],
                [75.0, 3.0, 35.0, 0.5],
                [62.0, 45.0, 33.0, 1.1],
                [26.0, 67.0, 32.0, 0.6],
                [-23.0, 73.0, 34.0, 0.6],
                [-63.0, 42.0, 36.0, 1.0],
                [-74.0, -4.0, 31.0, 1.4],
                [-58.0, -42.0, 34.0, 1.4],
                [-22.0, -70.0, 32.0, 1.3],
                [19.0, -74.0, 32.0, 0.9],
                [65.0, -46.0, 30.0, 0.8],
                [79.0, -2.0, 30.0, 0.7],
                [61.0, 43.0, 28.0, 1.2],
                [25.0, 74.0, 34.0, 0.8],
                [-21.0, 73.0, 29.0, 0.6],
                [-71.0, 51.0, 28.0, 0.8],
                [-78.0, 1.0, 33.0, 0.8],
                [-71.0, -44.0, 36.0, 0.6],
                [-29.0, -75.0, 35.0, 0.7],
                [24.0, -77.0, 34.0, 1.2],
                [64.0, -47.0, 28.0, 1.4],
                [89.0, 4.0, 35.0, 1.5],
                [69.0, 47.0, 34.0, 0.6],
                [23.0, 85.0, 30.0, 0.9],
                [-27.0, 85.0, 28.0, 1.2],
                [-70.0, 50.0, 28.0, 0.7],
                [-88.0, -1.0, 33.0, 0.9],
                [-67.0, -47.0, 30.0, 0.6],
                [-24.0, -88.0, 33.0, 1.1],
                [30.0, -82.0, 30.0, 1.3],
                [65.0, -48.0, 32.0, 0.8],
                [92.0, -3.0, 37.0, 0.8],
                [73.0, 53.0, 36.0, 0.8],
                [27.0, 90.0, 28.0, 1.1],
                [-27.0, 87.0, 35.0, 1.2],
                [-72.0, 52.0, 31.0, 1.1],
                [-97.0, -5.0, 29.0, 0.8],
                [-77.0, -57.0, 33.0, 0.5],
                [-34.0, -87.0, 29.0, 0.6],
                [24.0, -87.0, 28.0, 1.4],
                [76.0, -52.0, 30.0, 0.7],
                [98.0, 2.0, 30.0, 1.3],
                [84.0, 59.0, 36.0, 0.9],
                [33.0, 98.0, 36.0, 1.2],
                [-27.0, 94.0, 30.0, 1.0],
                [-85.0, 55.0, 32.0, 0.7],
                [-100.0, 2.0, 34.0, 0.7],
                [-82.0, -61.0, 28.0, 1.0],
                [-28.0, -93.0, 31.0, 1.4],
                [35.0, -94.0, 30.0, 1.0],
                [80.0, -55.0, 37.0, 0.8],
                [45.0, 4.0, 38.0, 0.8],
                [45.0, 30.0, 37.0, 0.8],
                [12.0, 48.0, 32.0, 0.9],
                [-18.0, 47.0, 41.0, 1.0],
                [-38.0, 33.0, 35.0, 1.2],
                [-51.0, -4.0, 34.0, 0.8],
                [-43.0, -31.0, 38.0, 1.5],
                [-12.0, -44.0, 41.0, 1.3],
                [18.0, -51.0, 33.0, 0.9],
                [39.0, -27.0, 40.0, 1.0],
                [58.0, -2.0, 39.0, 0.8],
                [40.0, 29.0, 41.0, 1.1],
                [14.0, 51.0, 39.0, 0.7],
                [-15.0, 52.0, 31.0, 0.8],
                [-46.0, 32.0, 33.0, 1.2],
                [-60.0, 1.0, 34.0, 0.6],
                [-44.0, -30.0, 33.0, 0.9],
                [-16.0, -54.0, 31.0, 0.5],
                [13.0, -57.0, 40.0, 1.3],
                [40.0, -35.0, 36.0, 1.0],
                [60.0, 2.0, 34.0, 0.7],
                [55.0, 39.0, 33.0, 0.6],
                [17.0, 63.0, 31.0, 1.2],
                [-23.0, 62.0, 33.0, 1.1],
                [-53.0, 36.0, 37.0, 0.9],
                [-59.0, -2.0, 32.0, 1.3],
                [-52.0, -33.0, 38.0, 0.9],
                [-19.0, -60.0, 37.0, 1.4],
                [15.0, -59.0, 35.0, 0.9],
                [51.0, -35.0, 40.0, 1.0],
                [67.0, -5.0, 37.0, 1.3],
                [53.0, 38.0, 40.0, 0.7],
                [16.0, 68.0, 38.0, 1.5],
                [-22.0, 69.0, 37.0, 1.3],
                [-53.0, 41.0, 37.0, 1.2],
                [-67.0, 3.0, 39.0, 0.7],
                [-59.0, -44.0, 31.0, 0.7],
                [-17.0, -69.0, 35.0, 0.6],
                [18.0, -68.0, 40.0, 1.1],
                [56.0, -38.0, 31.0, 0.7],
                [76.0, -5.0, 39.0, 0.5],
                [56.0, 41.0, 40.0, 1.4],
                [27.0, 66.0, 34.0, 0.6],
                [-19.0, 76.0, 39.0, 1.0],
                [-62.0, 48.0, 32.0, 1.3],
                [-74.0, -5.0, 34.0, 1.5],
                [-56.0, -48.0, 33.0, 0.8],
                [-25.0, -68.0, 38.0, 1.3],
                [21.0, -73.0, 40.0, 0.6],
                [59.0, -47.0, 34.0, 0.7],
                [79.0, -1.0, 37.0, 1.1],
                [66.0, 50.0, 40.0, 0.8],
                [23.0, 78.0, 36.0, 1.0],
                [-24.0, 77.0, 40.0, 0.9],
                [-66.0, 45.0, 40.0, 1.4],
                [-82.0, -1.0, 39.0, 1.5],
                [-67.0, -45.0, 33.0, 1.4],
                [-28.0, -76.0, 39.0, 0.6],
                [27.0, -76.0, 38.0, 0.6],
                [70.0, -51.0, 39.0, 1.3],
                [89.0, 1.0, 33.0, 0.7],
                [73.0, 52.0, 37.0, 0.5],
                [22.0, 84.0, 38.0, 1.2],
                [-30.0, 80.0, 34.0, 0.6],
                [-73.0, 55.0, 38.0, 1.5],
                [-92.0, -1.0, 40.0, 1.4],
                [-73.0, -50.0, 41.0, 1.2],
                [-24.0, -83.0, 40.0, 0.9],
                [28.0, -88.0, 35.0, 0.7],
                [66.0, -53.0, 41.0, 1.0],
                [98.0, 2.0, 37.0, 1.0],
                [73.0, 52.0, 39.0, 1.3],
                [30.0, 90.0, 33.0, 1.2],
                [-25.0, 92.0, 37.0, 1.4],
                [-81.0, 57.0, 31.0, 1.3],
                [-99.0, 4.0, 31.0, 0.8],
                [-74.0, -54.0, 32.0, 1.4],
                [-30.0, -91.0, 35.0, 0.6],
                [25.0, -87.0, 37.0, 1.5],
                [72.0, -57.0, 32.0, 1.2],
                [95.0, -5.0, 32.0, 1.1],
                [79.0, 54.0, 32.0, 1.4],
                [33.0, 90.0, 35.0, 1.3],
                [-33.0, 93.0, 34.0, 0.5],
                [-82.0, 58.0, 38.0, 1.0],
                [-104.0, 2.0, 34.0, 1.4],
                [-81.0, -55.0, 40.0, 0.8],
                [-34.0, -97.0, 35.0, 0.9],
                [30.0, -92.0, 33.0, 0.8],
                [76.0, -59.0, 33.0, 0.5],
                [51.0, -3.0, 42.0, 0.9],
                [39.0, 25.0, 44.0, 0.9],
                [19.0, 50.0, 36.0, 0.8],
                [-18.0, 51.0, 38.0, 1.1],
                [-38.0, 29.0, 40.0, 1.3],
                [-54.0, -5.0, 38.0, 0.9],
                [-42.0, -35.0, 43.0, 1.1],
                [-11.0, -44.0, 35.0, 0.9],
                [18.0, -43.0, 37.0, 0.6],
                [43.0, -28.0, 39.0, 1.1],
                [52.0, -3.0, 38.0, 0.8],
                [47.0, 36.0, 37.0, 0.7],
                [14.0, 57.0, 41.0, 1.1],
                [-22.0, 56.0, 39.0, 1.5],
                [-46.0, 37.0, 39.0, 1.3],
                [-57.0, -4.0, 40.0, 1.3],
                [-41.0, -34.0, 40.0, 1.2],
                [-14.0, -58.0, 44.0, 0.6],
                [19.0, -55.0, 39.0, 1.4],
                [47.0, -31.0, 36.0, 1.1],
                [61.0, -1.0, 38.0, 0.6],
                [53.0, 38.0, 40.0, 0.6],
                [15.0, 62.0, 39.0, 1.0],
                [-21.0, 63.0, 36.0, 0.6],
                [-47.0, 33.0, 43.0, 0.8],
                [-64.0, 0.0, 35.0, 0.5],
                [-46.0, -36.0, 39.0, 1.3],
                [-20.0, -55.0, 44.0, 0.9],
                [17.0, -59.0, 35.0, 0.7],
                [49.0, -40.0, 42.0, 0.7],
                [72.0, 1.0, 37.0, 1.2],
                [51.0, 43.0, 37.0, 1.4],
                [25.0, 70.0, 43.0, 1.3],
                [-20.0, 60.0, 37.0, 0.8],
                [-54.0, 37.0, 36.0, 1.3],
                [-70.0, -2.0, 35.0, 0.8],
                [-53.0, -44.0, 35.0, 1.0],
                [-22.0, -65.0, 36.0, 0.5],
                [17.0, -61.0, 36.0, 1.0],
                [59.0, -44.0, 43.0, 1.5],
                [78.0, -5.0, 41.0, 1.2],
                [56.0, 46.0, 36.0, 0.5],
                [25.0, 75.0, 44.0, 0.6],
                [-25.0, 67.0, 41.0, 1.1],
                [-58.0, 48.0, 38.0, 0.9],
                [-77.0, 0.0, 44.0, 1.2],
                [-65.0, -40.0, 42.0, 0.8],
                [-27.0, -71.0, 36.0, 0.5],
                [20.0, -75.0, 36.0, 1.5],
                [60.0, -47.0, 36.0, 1.2],
                [77.0, 2.0, 35.0, 0.9],
                [69.0, 45.0, 35.0, 1.3],
                [20.0, 78.0, 41.0, 1.2],
                [-28.0, 80.0, 41.0, 1.2],
                [-65.0, 50.0, 38.0, 0.9],
                [-85.0, -2.0, 37.0, 1.5],
                [-65.0, -44.0, 35.0, 1.5],
                [-28.0, -77.0, 40.0, 1.2],
                [22.0, -76.0, 36.0, 0.9],
                [65.0, -53.0, 36.0, 0.6],
                [90.0, -1.0, 36.0, 1.1],
                [66.0, 50.0, 35.0, 0.5],
                [26.0, 83.0, 44.0, 1.3],
                [-23.0, 82.0, 40.0, 1.0],
                [-67.0, 53.0, 36.0, 0.9],
                [-92.0, -1.0, 39.0, 1.4],
                [-76.0, -48.0, 43.0, 0.8],
                [-26.0, -83.0, 37.0, 0.6],
                [27.0, -84.0, 39.0, 1.4],
                [74.0, -51.0, 40.0, 1.3],
                [93.0, -5.0, 42.0, 0.8],
                [80.0, 51.0, 36.0, 1.4],
                [32.0, 85.0, 36.0, 0.7],
                [-27.0, 88.0, 42.0, 1.2],
                [-79.0, 57.0, 35.0, 1.5],
                [-94.0, -5.0, 41.0, 1.0],
                [-77.0, -53.0, 39.0, 0.7],
                [-26.0, -93.0, 35.0, 1.4],
                [26.0, -88.0, 35.0, 0.8],
                [74.0, -53.0, 40.0, 1.5],
                [101.0, 4.0, 43.0, 1.0],
                [84.0, 57.0, 39.0, 1.4],
                [34.0, 91.0, 35.0, 0.9],
                [-34.0, 93.0, 41.0, 1.4],
                [-79.0, 61.0, 43.0, 0.5],
                [-100.0, 0.0, 36.0, 0.8],
                [-85.0, -58.0, 40.0, 0.5],
                [-34.0, -98.0, 35.0, 0.8],
                [30.0, -101.0, 44.0, 0.6],
                [85.0, -59.0, 38.0, 0.7],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    -1.8,
                    -1.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.4,
                    1.7,
                    3.1,
                    4.2,
                    5.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    7.4,
                    7.7,
                ]
            ),
            1,
        )
        basis1 = BSplineBasis(
            5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 1.1, 1.9, 3.3, 4.1, 5.0, 5.0, 5.0, 5.0, 5.0])
        )
        basis2 = BSplineBasis(
            7,
            np.array(
                [
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.9,
                    2.2,
                    3.3,
                    4.3,
                    5.3,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                ]
            ),
        )
        vol = Volume(basis0, basis1, basis2, controlpoints, True)
        vol2 = vol.clone()
        vol2.mirror([2, 0, 0])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] = -pt2[..., 0]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_3D_p7(self):
        controlpoints = np.array(
            [
                [3.0, -4.0, -5.0],
                [9.0, 2.0, -1.0],
                [23.0, -2.0, 2.0],
                [37.0, 2.0, 1.0],
                [46.0, 4.0, -5.0],
                [56.0, -3.0, -2.0],
                [70.0, -5.0, 3.0],
                [78.0, 1.0, 2.0],
                [91.0, -5.0, 3.0],
                [97.0, 3.0, -2.0],
            ]
        )
        basis0 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6, 1.8, 2.8, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 += np.array([4.3, 5.5, 7.4])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 4.300000
        pt2[..., 1] -= 5.500000
        pt2[..., 2] -= 7.400000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_3D_p7(self):
        controlpoints = np.array(
            [
                [0.0, 1.0, 3.0],
                [11.0, 2.0, -5.0],
                [20.0, 4.0, -2.0],
                [27.0, 3.0, -4.0],
                [32.0, -5.0, -3.0],
                [49.0, -5.0, 3.0],
                [55.0, -3.0, -5.0],
                [60.0, -5.0, -5.0],
                [75.0, -5.0, -1.0],
                [82.0, 1.0, 2.0],
                [91.0, 2.0, 0.0],
                [97.0, 3.0, 0.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.3,
                    1.7,
                    2.9,
                    4.3,
                    5.2,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                ]
            ),
        )
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 *= np.array([7.3, 7.2, 11.2])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 7.300000
        pt2[..., 1] /= 7.200000
        pt2[..., 2] /= 11.200000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_curve_3D_p7(self):
        controlpoints = np.array(
            [
                [0.0, 4.0, -5.0],
                [12.0, 3.0, -2.0],
                [26.0, 1.0, 4.0],
                [47.0, 4.0, 3.0],
                [61.0, 3.0, 3.0],
                [68.0, -1.0, 0.0],
                [88.0, -5.0, -4.0],
                [100.0, 3.0, 2.0],
            ]
        )
        basis0 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0])
        )
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2.mirror([1, 0, 0])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] = -pt2[..., 0]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_3D_p77(self):
        controlpoints = np.array(
            [
                [3.0, -1.0, -2.0],
                [8.0, -1.0, -4.0],
                [22.0, 3.0, -1.0],
                [35.0, 1.0, 0.0],
                [44.0, 4.0, -1.0],
                [58.0, 0.0, -5.0],
                [65.0, 0.0, -5.0],
                [81.0, -5.0, -5.0],
                [85.0, 0.0, -4.0],
                [95.0, -2.0, -3.0],
                [4.0, 9.0, 2.0],
                [11.0, 11.0, -2.0],
                [24.0, 8.0, 3.0],
                [34.0, 13.0, 4.0],
                [41.0, 15.0, 4.0],
                [59.0, 9.0, 4.0],
                [70.0, 15.0, 3.0],
                [77.0, 13.0, 4.0],
                [87.0, 16.0, -4.0],
                [97.0, 14.0, 0.0],
                [-3.0, 25.0, 3.0],
                [10.0, 29.0, 1.0],
                [27.0, 28.0, -4.0],
                [28.0, 27.0, -4.0],
                [42.0, 27.0, 4.0],
                [52.0, 24.0, -5.0],
                [64.0, 26.0, -2.0],
                [81.0, 26.0, -2.0],
                [84.0, 22.0, -3.0],
                [99.0, 21.0, 0.0],
                [0.0, 33.0, -5.0],
                [13.0, 39.0, -5.0],
                [18.0, 41.0, -4.0],
                [29.0, 42.0, 4.0],
                [39.0, 33.0, -4.0],
                [53.0, 35.0, 0.0],
                [65.0, 35.0, 0.0],
                [75.0, 39.0, -4.0],
                [85.0, 36.0, -5.0],
                [99.0, 34.0, -2.0],
                [1.0, 53.0, 3.0],
                [12.0, 48.0, 3.0],
                [18.0, 45.0, -1.0],
                [36.0, 46.0, 4.0],
                [48.0, 52.0, -3.0],
                [54.0, 50.0, -4.0],
                [64.0, 53.0, -1.0],
                [79.0, 53.0, -4.0],
                [88.0, 53.0, -4.0],
                [104.0, 48.0, -3.0],
                [1.0, 64.0, -3.0],
                [6.0, 57.0, -5.0],
                [19.0, 65.0, 2.0],
                [35.0, 63.0, -3.0],
                [46.0, 65.0, 3.0],
                [50.0, 66.0, 1.0],
                [71.0, 60.0, -1.0],
                [75.0, 61.0, -3.0],
                [85.0, 62.0, 1.0],
                [99.0, 67.0, -2.0],
                [3.0, 75.0, 3.0],
                [7.0, 72.0, -3.0],
                [18.0, 78.0, 2.0],
                [30.0, 79.0, -5.0],
                [48.0, 76.0, -2.0],
                [55.0, 79.0, -1.0],
                [68.0, 77.0, 4.0],
                [75.0, 70.0, -1.0],
                [92.0, 78.0, -2.0],
                [103.0, 74.0, 1.0],
                [-2.0, 89.0, -3.0],
                [11.0, 85.0, 3.0],
                [19.0, 88.0, 3.0],
                [29.0, 91.0, 1.0],
                [46.0, 89.0, 4.0],
                [59.0, 82.0, 1.0],
                [63.0, 92.0, -2.0],
                [75.0, 89.0, 2.0],
                [92.0, 89.0, 0.0],
                [98.0, 90.0, 0.0],
                [4.0, 99.0, 2.0],
                [8.0, 95.0, -2.0],
                [26.0, 101.0, 0.0],
                [37.0, 104.0, -4.0],
                [41.0, 101.0, -4.0],
                [53.0, 100.0, 4.0],
                [63.0, 104.0, -1.0],
                [73.0, 96.0, 2.0],
                [84.0, 99.0, -2.0],
                [99.0, 98.0, -2.0],
            ]
        )
        basis0 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 1.6, 2.7, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        basis1 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.4, 2.3, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0])
        )
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 += np.array([7.2, 2.7, 5.6])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 7.200000
        pt2[..., 1] -= 2.700000
        pt2[..., 2] -= 5.600000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_surface_3D_p77(self):
        controlpoints = np.array(
            [
                [-1.0, -4.0, -4.0],
                [5.0, -3.0, -3.0],
                [18.0, 4.0, -1.0],
                [24.0, -4.0, 1.0],
                [33.0, -3.0, 1.0],
                [49.0, 0.0, 1.0],
                [59.0, 0.0, -4.0],
                [67.0, -3.0, -4.0],
                [71.0, 3.0, 1.0],
                [86.0, 4.0, 1.0],
                [93.0, -5.0, -5.0],
                [98.0, 1.0, -5.0],
                [3.0, 11.0, 0.0],
                [8.0, 8.0, 0.0],
                [22.0, 14.0, 4.0],
                [31.0, 15.0, -3.0],
                [38.0, 15.0, -4.0],
                [43.0, 13.0, 0.0],
                [53.0, 14.0, 4.0],
                [59.0, 13.0, -1.0],
                [76.0, 10.0, -2.0],
                [79.0, 9.0, -2.0],
                [94.0, 7.0, 2.0],
                [101.0, 15.0, -1.0],
                [4.0, 25.0, 1.0],
                [11.0, 22.0, 1.0],
                [21.0, 23.0, -5.0],
                [25.0, 23.0, 4.0],
                [31.0, 25.0, 1.0],
                [45.0, 26.0, -2.0],
                [50.0, 22.0, 2.0],
                [61.0, 24.0, -2.0],
                [76.0, 20.0, -2.0],
                [76.0, 26.0, -4.0],
                [89.0, 22.0, -5.0],
                [96.0, 22.0, 1.0],
                [1.0, 41.0, -4.0],
                [12.0, 35.0, 0.0],
                [14.0, 35.0, 2.0],
                [30.0, 34.0, -5.0],
                [35.0, 34.0, -2.0],
                [47.0, 36.0, -2.0],
                [54.0, 37.0, -4.0],
                [61.0, 36.0, 1.0],
                [71.0, 37.0, 1.0],
                [85.0, 32.0, 3.0],
                [92.0, 41.0, 4.0],
                [104.0, 41.0, 1.0],
                [2.0, 48.0, 1.0],
                [9.0, 51.0, -4.0],
                [22.0, 45.0, -1.0],
                [31.0, 51.0, -4.0],
                [32.0, 46.0, 1.0],
                [46.0, 51.0, 4.0],
                [55.0, 53.0, -3.0],
                [64.0, 47.0, 0.0],
                [69.0, 47.0, -4.0],
                [80.0, 47.0, 2.0],
                [93.0, 54.0, -5.0],
                [101.0, 51.0, 4.0],
                [-4.0, 60.0, -3.0],
                [7.0, 58.0, -1.0],
                [21.0, 59.0, 2.0],
                [28.0, 66.0, 1.0],
                [41.0, 61.0, 3.0],
                [47.0, 58.0, 0.0],
                [55.0, 58.0, -3.0],
                [68.0, 63.0, -2.0],
                [68.0, 61.0, -5.0],
                [83.0, 64.0, 0.0],
                [94.0, 63.0, -1.0],
                [101.0, 60.0, 0.0],
                [0.0, 70.0, 1.0],
                [5.0, 77.0, -1.0],
                [21.0, 74.0, -1.0],
                [28.0, 79.0, -2.0],
                [36.0, 70.0, -1.0],
                [42.0, 78.0, -1.0],
                [55.0, 79.0, -1.0],
                [60.0, 72.0, 4.0],
                [69.0, 75.0, -5.0],
                [76.0, 71.0, 0.0],
                [94.0, 78.0, 2.0],
                [98.0, 79.0, -1.0],
                [-1.0, 85.0, -5.0],
                [4.0, 85.0, -3.0],
                [18.0, 88.0, 0.0],
                [24.0, 86.0, 2.0],
                [34.0, 91.0, 2.0],
                [45.0, 90.0, -3.0],
                [57.0, 88.0, -5.0],
                [65.0, 85.0, -4.0],
                [74.0, 88.0, 3.0],
                [78.0, 89.0, 1.0],
                [89.0, 92.0, -2.0],
                [101.0, 82.0, -1.0],
                [-4.0, 103.0, -5.0],
                [6.0, 96.0, -1.0],
                [21.0, 99.0, -3.0],
                [30.0, 102.0, 4.0],
                [31.0, 104.0, 4.0],
                [44.0, 104.0, -2.0],
                [51.0, 97.0, -3.0],
                [66.0, 98.0, 1.0],
                [68.0, 98.0, -2.0],
                [84.0, 97.0, -1.0],
                [95.0, 99.0, 0.0],
                [99.0, 99.0, -4.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.7,
                    1.8,
                    3.2,
                    4.2,
                    5.1,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                ]
            ),
        )
        basis1 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9, 1.6, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0])
        )
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 *= np.array([6.6, 7.7, 2.4])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 6.600000
        pt2[..., 1] /= 7.700000
        pt2[..., 2] /= 2.400000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_surface_3D_p77(self):
        controlpoints = np.array(
            [
                [-2.0, -3.0, 4.0],
                [8.0, 2.0, 3.0],
                [19.0, 1.0, -4.0],
                [27.0, -3.0, 4.0],
                [39.0, -2.0, 4.0],
                [54.0, -1.0, -4.0],
                [55.0, -5.0, 4.0],
                [73.0, 2.0, 1.0],
                [79.0, 1.0, -3.0],
                [86.0, 1.0, 1.0],
                [96.0, 1.0, -5.0],
                [4.0, 14.0, 0.0],
                [13.0, 6.0, 1.0],
                [20.0, 15.0, 3.0],
                [34.0, 13.0, -3.0],
                [40.0, 15.0, 4.0],
                [48.0, 9.0, -4.0],
                [59.0, 15.0, 2.0],
                [67.0, 15.0, 4.0],
                [79.0, 14.0, 0.0],
                [94.0, 15.0, -2.0],
                [97.0, 10.0, 2.0],
                [-2.0, 24.0, -1.0],
                [7.0, 22.0, -5.0],
                [15.0, 22.0, -1.0],
                [29.0, 19.0, 1.0],
                [36.0, 26.0, -1.0],
                [46.0, 17.0, -4.0],
                [59.0, 19.0, -1.0],
                [70.0, 27.0, -4.0],
                [81.0, 18.0, -5.0],
                [87.0, 22.0, -2.0],
                [104.0, 23.0, 2.0],
                [0.0, 34.0, -2.0],
                [6.0, 38.0, 4.0],
                [20.0, 33.0, 2.0],
                [32.0, 34.0, -1.0],
                [38.0, 28.0, -4.0],
                [52.0, 38.0, -1.0],
                [64.0, 31.0, -1.0],
                [72.0, 35.0, 1.0],
                [82.0, 32.0, 0.0],
                [86.0, 29.0, -1.0],
                [101.0, 35.0, 0.0],
                [4.0, 40.0, -3.0],
                [7.0, 46.0, 2.0],
                [19.0, 47.0, 0.0],
                [25.0, 44.0, -3.0],
                [36.0, 48.0, 1.0],
                [49.0, 39.0, -3.0],
                [63.0, 49.0, -3.0],
                [67.0, 39.0, -4.0],
                [80.0, 40.0, 0.0],
                [90.0, 44.0, -5.0],
                [99.0, 39.0, 4.0],
                [-3.0, 54.0, -4.0],
                [13.0, 58.0, 1.0],
                [18.0, 54.0, -5.0],
                [30.0, 57.0, -4.0],
                [38.0, 55.0, -1.0],
                [47.0, 58.0, 1.0],
                [55.0, 52.0, 0.0],
                [70.0, 58.0, 0.0],
                [81.0, 58.0, 2.0],
                [90.0, 55.0, -4.0],
                [95.0, 57.0, -1.0],
                [3.0, 63.0, -1.0],
                [14.0, 62.0, 2.0],
                [21.0, 69.0, -2.0],
                [26.0, 67.0, 3.0],
                [41.0, 64.0, -2.0],
                [45.0, 65.0, -5.0],
                [59.0, 68.0, -1.0],
                [69.0, 68.0, -3.0],
                [76.0, 69.0, 2.0],
                [91.0, 69.0, 4.0],
                [101.0, 62.0, -3.0],
                [2.0, 79.0, 2.0],
                [12.0, 77.0, -1.0],
                [17.0, 81.0, -2.0],
                [26.0, 76.0, 3.0],
                [43.0, 82.0, 1.0],
                [46.0, 77.0, 0.0],
                [64.0, 73.0, 4.0],
                [72.0, 80.0, 0.0],
                [78.0, 82.0, 1.0],
                [94.0, 77.0, 4.0],
                [100.0, 78.0, -4.0],
                [-3.0, 89.0, -3.0],
                [13.0, 89.0, 4.0],
                [15.0, 87.0, 2.0],
                [32.0, 93.0, 2.0],
                [38.0, 90.0, 0.0],
                [48.0, 90.0, -5.0],
                [64.0, 87.0, 4.0],
                [71.0, 89.0, 1.0],
                [78.0, 93.0, -2.0],
                [86.0, 93.0, 3.0],
                [104.0, 86.0, -2.0],
                [4.0, 95.0, -4.0],
                [8.0, 98.0, -3.0],
                [16.0, 98.0, 1.0],
                [32.0, 104.0, -5.0],
                [40.0, 100.0, 0.0],
                [49.0, 104.0, 2.0],
                [57.0, 95.0, -3.0],
                [67.0, 100.0, 1.0],
                [82.0, 95.0, -5.0],
                [93.0, 99.0, 2.0],
                [100.0, 95.0, 3.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 2.3, 3.3, 4.1, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0]
            ),
        )
        basis1 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.3, 1.9, 2.6, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2.mirror([0, 0, 3])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 2] = -pt2[..., 2]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_volume_3D_p656(self):
        controlpoints = np.array(
            [
                [1.0, 1.0, 2.0],
                [16.0, -2.0, 3.0],
                [32.0, -4.0, -1.0],
                [40.0, 3.0, 0.0],
                [54.0, 2.0, 2.0],
                [71.0, 1.0, -5.0],
                [86.0, 2.0, -5.0],
                [97.0, 2.0, -2.0],
                [-2.0, 23.0, -2.0],
                [9.0, 23.0, 3.0],
                [25.0, 24.0, -5.0],
                [41.0, 18.0, -1.0],
                [62.0, 22.0, 3.0],
                [71.0, 16.0, 0.0],
                [86.0, 23.0, 1.0],
                [96.0, 24.0, 3.0],
                [-3.0, 37.0, -3.0],
                [10.0, 42.0, 1.0],
                [28.0, 43.0, 0.0],
                [40.0, 44.0, 1.0],
                [52.0, 43.0, -5.0],
                [72.0, 37.0, -1.0],
                [86.0, 42.0, 3.0],
                [96.0, 35.0, -3.0],
                [0.0, 55.0, 3.0],
                [9.0, 63.0, -1.0],
                [30.0, 62.0, -4.0],
                [46.0, 60.0, -2.0],
                [53.0, 57.0, 3.0],
                [74.0, 59.0, -4.0],
                [85.0, 64.0, -1.0],
                [95.0, 58.0, -1.0],
                [-2.0, 82.0, -1.0],
                [18.0, 75.0, -3.0],
                [28.0, 75.0, 1.0],
                [45.0, 80.0, -4.0],
                [56.0, 79.0, -3.0],
                [72.0, 79.0, 3.0],
                [82.0, 84.0, 4.0],
                [103.0, 75.0, -1.0],
                [4.0, 95.0, -4.0],
                [13.0, 103.0, 3.0],
                [26.0, 102.0, -2.0],
                [41.0, 100.0, 0.0],
                [54.0, 104.0, -5.0],
                [76.0, 100.0, -5.0],
                [82.0, 96.0, 4.0],
                [102.0, 95.0, 2.0],
                [3.0, -3.0, 10.0],
                [13.0, -4.0, 17.0],
                [30.0, 3.0, 11.0],
                [37.0, -3.0, 16.0],
                [55.0, 0.0, 14.0],
                [70.0, -1.0, 13.0],
                [81.0, -3.0, 10.0],
                [102.0, 2.0, 14.0],
                [-4.0, 20.0, 13.0],
                [9.0, 15.0, 12.0],
                [28.0, 22.0, 15.0],
                [44.0, 22.0, 7.0],
                [55.0, 24.0, 8.0],
                [71.0, 19.0, 8.0],
                [87.0, 22.0, 16.0],
                [95.0, 24.0, 12.0],
                [-2.0, 36.0, 8.0],
                [18.0, 36.0, 14.0],
                [24.0, 37.0, 9.0],
                [40.0, 37.0, 17.0],
                [55.0, 36.0, 10.0],
                [74.0, 44.0, 9.0],
                [90.0, 42.0, 15.0],
                [100.0, 41.0, 17.0],
                [-4.0, 61.0, 17.0],
                [9.0, 55.0, 9.0],
                [31.0, 61.0, 9.0],
                [37.0, 59.0, 9.0],
                [54.0, 60.0, 9.0],
                [68.0, 60.0, 8.0],
                [90.0, 59.0, 11.0],
                [100.0, 64.0, 11.0],
                [-4.0, 79.0, 9.0],
                [10.0, 81.0, 15.0],
                [23.0, 79.0, 8.0],
                [40.0, 84.0, 9.0],
                [59.0, 83.0, 14.0],
                [66.0, 83.0, 16.0],
                [89.0, 76.0, 9.0],
                [100.0, 84.0, 14.0],
                [-1.0, 100.0, 8.0],
                [19.0, 96.0, 7.0],
                [28.0, 96.0, 13.0],
                [42.0, 102.0, 11.0],
                [53.0, 97.0, 10.0],
                [67.0, 101.0, 14.0],
                [80.0, 104.0, 8.0],
                [98.0, 103.0, 7.0],
                [3.0, 3.0, 20.0],
                [10.0, 4.0, 23.0],
                [23.0, 4.0, 25.0],
                [42.0, 3.0, 22.0],
                [57.0, 1.0, 23.0],
                [69.0, -2.0, 28.0],
                [84.0, -4.0, 26.0],
                [104.0, 3.0, 24.0],
                [-4.0, 16.0, 24.0],
                [17.0, 19.0, 21.0],
                [32.0, 22.0, 21.0],
                [44.0, 19.0, 28.0],
                [60.0, 15.0, 24.0],
                [75.0, 23.0, 24.0],
                [90.0, 24.0, 29.0],
                [100.0, 24.0, 23.0],
                [-3.0, 43.0, 25.0],
                [10.0, 38.0, 29.0],
                [33.0, 40.0, 24.0],
                [45.0, 42.0, 23.0],
                [59.0, 35.0, 29.0],
                [73.0, 42.0, 23.0],
                [88.0, 39.0, 20.0],
                [98.0, 41.0, 24.0],
                [4.0, 62.0, 27.0],
                [14.0, 59.0, 23.0],
                [32.0, 61.0, 24.0],
                [38.0, 58.0, 29.0],
                [59.0, 61.0, 21.0],
                [69.0, 55.0, 23.0],
                [82.0, 60.0, 29.0],
                [95.0, 55.0, 21.0],
                [-1.0, 81.0, 29.0],
                [19.0, 84.0, 20.0],
                [29.0, 80.0, 29.0],
                [45.0, 79.0, 20.0],
                [60.0, 79.0, 24.0],
                [74.0, 78.0, 29.0],
                [90.0, 84.0, 29.0],
                [102.0, 80.0, 29.0],
                [4.0, 97.0, 24.0],
                [11.0, 98.0, 28.0],
                [33.0, 96.0, 24.0],
                [40.0, 97.0, 27.0],
                [58.0, 103.0, 28.0],
                [73.0, 95.0, 23.0],
                [86.0, 97.0, 22.0],
                [95.0, 103.0, 23.0],
                [4.0, -4.0, 37.0],
                [18.0, -2.0, 34.0],
                [23.0, 2.0, 35.0],
                [38.0, 3.0, 35.0],
                [52.0, -5.0, 35.0],
                [69.0, -2.0, 36.0],
                [84.0, -1.0, 35.0],
                [101.0, -4.0, 37.0],
                [-4.0, 23.0, 34.0],
                [17.0, 20.0, 34.0],
                [23.0, 24.0, 32.0],
                [37.0, 22.0, 33.0],
                [60.0, 17.0, 40.0],
                [71.0, 19.0, 40.0],
                [88.0, 20.0, 36.0],
                [102.0, 20.0, 33.0],
                [-2.0, 37.0, 33.0],
                [16.0, 42.0, 40.0],
                [33.0, 44.0, 41.0],
                [38.0, 39.0, 35.0],
                [55.0, 37.0, 32.0],
                [71.0, 38.0, 41.0],
                [82.0, 36.0, 35.0],
                [98.0, 35.0, 37.0],
                [-5.0, 55.0, 38.0],
                [13.0, 55.0, 32.0],
                [27.0, 56.0, 34.0],
                [43.0, 63.0, 37.0],
                [55.0, 64.0, 41.0],
                [72.0, 55.0, 33.0],
                [84.0, 57.0, 35.0],
                [98.0, 55.0, 39.0],
                [3.0, 75.0, 42.0],
                [12.0, 80.0, 40.0],
                [26.0, 79.0, 39.0],
                [42.0, 78.0, 32.0],
                [59.0, 79.0, 37.0],
                [70.0, 82.0, 38.0],
                [81.0, 77.0, 37.0],
                [95.0, 84.0, 35.0],
                [-2.0, 101.0, 33.0],
                [13.0, 95.0, 33.0],
                [25.0, 102.0, 38.0],
                [45.0, 102.0, 37.0],
                [53.0, 95.0, 34.0],
                [66.0, 103.0, 33.0],
                [88.0, 104.0, 36.0],
                [99.0, 96.0, 32.0],
                [-4.0, 4.0, 45.0],
                [11.0, 0.0, 52.0],
                [30.0, -1.0, 49.0],
                [47.0, 0.0, 53.0],
                [54.0, 3.0, 53.0],
                [66.0, 4.0, 48.0],
                [89.0, 0.0, 53.0],
                [95.0, 3.0, 48.0],
                [-5.0, 22.0, 52.0],
                [10.0, 17.0, 47.0],
                [26.0, 17.0, 52.0],
                [42.0, 16.0, 48.0],
                [60.0, 24.0, 48.0],
                [71.0, 18.0, 48.0],
                [82.0, 18.0, 51.0],
                [100.0, 22.0, 50.0],
                [-5.0, 43.0, 46.0],
                [12.0, 41.0, 48.0],
                [31.0, 40.0, 48.0],
                [42.0, 39.0, 47.0],
                [62.0, 43.0, 51.0],
                [74.0, 40.0, 52.0],
                [89.0, 36.0, 50.0],
                [99.0, 43.0, 52.0],
                [3.0, 64.0, 47.0],
                [10.0, 57.0, 47.0],
                [26.0, 64.0, 48.0],
                [43.0, 58.0, 52.0],
                [55.0, 60.0, 48.0],
                [69.0, 62.0, 49.0],
                [84.0, 62.0, 53.0],
                [98.0, 58.0, 52.0],
                [-4.0, 82.0, 49.0],
                [15.0, 76.0, 46.0],
                [27.0, 76.0, 54.0],
                [47.0, 79.0, 51.0],
                [52.0, 78.0, 51.0],
                [70.0, 81.0, 45.0],
                [87.0, 82.0, 53.0],
                [100.0, 76.0, 47.0],
                [3.0, 104.0, 47.0],
                [19.0, 103.0, 51.0],
                [30.0, 96.0, 52.0],
                [40.0, 102.0, 45.0],
                [61.0, 98.0, 53.0],
                [69.0, 97.0, 47.0],
                [81.0, 103.0, 51.0],
                [104.0, 97.0, 52.0],
                [-3.0, 0.0, 60.0],
                [15.0, -2.0, 61.0],
                [25.0, 0.0, 61.0],
                [46.0, 1.0, 65.0],
                [54.0, 3.0, 66.0],
                [67.0, -2.0, 58.0],
                [87.0, 3.0, 58.0],
                [103.0, -4.0, 59.0],
                [-1.0, 23.0, 64.0],
                [16.0, 21.0, 63.0],
                [28.0, 18.0, 57.0],
                [41.0, 21.0, 62.0],
                [57.0, 15.0, 60.0],
                [69.0, 19.0, 64.0],
                [83.0, 16.0, 61.0],
                [104.0, 19.0, 63.0],
                [-3.0, 41.0, 58.0],
                [15.0, 42.0, 58.0],
                [23.0, 42.0, 59.0],
                [39.0, 37.0, 66.0],
                [62.0, 44.0, 62.0],
                [66.0, 39.0, 58.0],
                [82.0, 42.0, 63.0],
                [103.0, 40.0, 63.0],
                [-4.0, 61.0, 66.0],
                [15.0, 58.0, 66.0],
                [27.0, 55.0, 61.0],
                [39.0, 56.0, 63.0],
                [52.0, 61.0, 65.0],
                [69.0, 55.0, 62.0],
                [85.0, 56.0, 57.0],
                [104.0, 55.0, 57.0],
                [1.0, 80.0, 65.0],
                [12.0, 80.0, 62.0],
                [25.0, 75.0, 67.0],
                [42.0, 76.0, 66.0],
                [60.0, 77.0, 66.0],
                [73.0, 80.0, 62.0],
                [88.0, 84.0, 61.0],
                [103.0, 80.0, 65.0],
                [-2.0, 99.0, 60.0],
                [10.0, 101.0, 65.0],
                [27.0, 100.0, 57.0],
                [40.0, 98.0, 60.0],
                [58.0, 97.0, 61.0],
                [68.0, 97.0, 64.0],
                [82.0, 98.0, 59.0],
                [96.0, 99.0, 64.0],
                [-2.0, 3.0, 75.0],
                [18.0, 2.0, 76.0],
                [31.0, -5.0, 72.0],
                [47.0, 2.0, 71.0],
                [62.0, 2.0, 70.0],
                [67.0, -4.0, 75.0],
                [86.0, -1.0, 73.0],
                [103.0, -4.0, 71.0],
                [-3.0, 16.0, 76.0],
                [15.0, 20.0, 75.0],
                [26.0, 18.0, 78.0],
                [43.0, 24.0, 78.0],
                [59.0, 22.0, 75.0],
                [72.0, 19.0, 70.0],
                [88.0, 22.0, 79.0],
                [98.0, 19.0, 79.0],
                [-1.0, 41.0, 76.0],
                [13.0, 39.0, 78.0],
                [25.0, 40.0, 79.0],
                [42.0, 37.0, 72.0],
                [60.0, 43.0, 79.0],
                [67.0, 36.0, 73.0],
                [83.0, 44.0, 75.0],
                [100.0, 37.0, 78.0],
                [-1.0, 59.0, 74.0],
                [11.0, 55.0, 71.0],
                [31.0, 63.0, 71.0],
                [47.0, 62.0, 75.0],
                [59.0, 57.0, 75.0],
                [76.0, 63.0, 73.0],
                [84.0, 58.0, 79.0],
                [104.0, 57.0, 74.0],
                [-1.0, 84.0, 71.0],
                [10.0, 79.0, 75.0],
                [24.0, 78.0, 78.0],
                [44.0, 79.0, 72.0],
                [57.0, 75.0, 72.0],
                [73.0, 79.0, 75.0],
                [87.0, 75.0, 73.0],
                [104.0, 77.0, 79.0],
                [-4.0, 98.0, 77.0],
                [13.0, 100.0, 77.0],
                [25.0, 96.0, 74.0],
                [39.0, 102.0, 79.0],
                [62.0, 96.0, 73.0],
                [75.0, 95.0, 70.0],
                [88.0, 97.0, 74.0],
                [99.0, 95.0, 74.0],
                [-1.0, -4.0, 83.0],
                [9.0, -1.0, 91.0],
                [23.0, 4.0, 89.0],
                [38.0, -5.0, 91.0],
                [55.0, 0.0, 82.0],
                [75.0, -3.0, 90.0],
                [86.0, -3.0, 82.0],
                [96.0, -4.0, 88.0],
                [-3.0, 17.0, 83.0],
                [10.0, 24.0, 82.0],
                [28.0, 20.0, 90.0],
                [42.0, 15.0, 88.0],
                [55.0, 20.0, 85.0],
                [75.0, 23.0, 87.0],
                [83.0, 16.0, 90.0],
                [104.0, 20.0, 85.0],
                [-5.0, 44.0, 84.0],
                [10.0, 42.0, 84.0],
                [24.0, 39.0, 83.0],
                [39.0, 44.0, 87.0],
                [60.0, 42.0, 88.0],
                [66.0, 39.0, 90.0],
                [81.0, 38.0, 86.0],
                [98.0, 44.0, 86.0],
                [-5.0, 63.0, 88.0],
                [9.0, 64.0, 85.0],
                [25.0, 60.0, 89.0],
                [43.0, 64.0, 88.0],
                [59.0, 55.0, 90.0],
                [74.0, 64.0, 85.0],
                [90.0, 61.0, 85.0],
                [103.0, 64.0, 92.0],
                [-4.0, 83.0, 92.0],
                [14.0, 75.0, 84.0],
                [26.0, 78.0, 88.0],
                [46.0, 79.0, 91.0],
                [58.0, 82.0, 83.0],
                [73.0, 79.0, 90.0],
                [82.0, 81.0, 83.0],
                [95.0, 84.0, 90.0],
                [1.0, 96.0, 83.0],
                [11.0, 101.0, 88.0],
                [27.0, 102.0, 88.0],
                [47.0, 97.0, 88.0],
                [54.0, 104.0, 87.0],
                [70.0, 101.0, 82.0],
                [87.0, 102.0, 92.0],
                [100.0, 97.0, 83.0],
                [-3.0, -4.0, 95.0],
                [18.0, -5.0, 98.0],
                [28.0, -5.0, 98.0],
                [45.0, -4.0, 101.0],
                [53.0, -3.0, 101.0],
                [75.0, -2.0, 97.0],
                [86.0, 2.0, 101.0],
                [101.0, 1.0, 103.0],
                [3.0, 24.0, 101.0],
                [17.0, 21.0, 98.0],
                [31.0, 17.0, 104.0],
                [45.0, 16.0, 99.0],
                [56.0, 17.0, 98.0],
                [70.0, 19.0, 98.0],
                [83.0, 18.0, 101.0],
                [96.0, 20.0, 99.0],
                [-2.0, 42.0, 104.0],
                [14.0, 39.0, 102.0],
                [27.0, 40.0, 102.0],
                [44.0, 41.0, 104.0],
                [57.0, 40.0, 100.0],
                [75.0, 36.0, 103.0],
                [83.0, 42.0, 101.0],
                [104.0, 44.0, 101.0],
                [3.0, 56.0, 96.0],
                [10.0, 62.0, 100.0],
                [29.0, 56.0, 104.0],
                [46.0, 58.0, 103.0],
                [55.0, 58.0, 97.0],
                [69.0, 61.0, 100.0],
                [89.0, 57.0, 101.0],
                [101.0, 57.0, 103.0],
                [-1.0, 83.0, 97.0],
                [18.0, 82.0, 98.0],
                [33.0, 78.0, 101.0],
                [46.0, 75.0, 100.0],
                [54.0, 81.0, 101.0],
                [73.0, 77.0, 104.0],
                [86.0, 79.0, 95.0],
                [98.0, 83.0, 98.0],
                [2.0, 100.0, 100.0],
                [12.0, 104.0, 104.0],
                [26.0, 103.0, 103.0],
                [44.0, 100.0, 100.0],
                [62.0, 103.0, 97.0],
                [66.0, 99.0, 100.0],
                [81.0, 101.0, 99.0],
                [95.0, 101.0, 96.0],
            ]
        )
        basis0 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.2, 2.3, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0])
        )
        basis1 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 1.3, 2.0, 2.0, 2.0, 2.0, 2.0]))
        basis2 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.2, 2.3, 3.1, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        vol = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2 += np.array([5.7, 7.2, 6.9])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] -= 5.700000
        pt2[..., 1] -= 7.200000
        pt2[..., 2] -= 6.900000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_volume_3D_p557(self):
        controlpoints = np.array(
            [
                [-1.0, -4.0, -1.0],
                [12.0, -2.0, -3.0],
                [25.0, 1.0, -2.0],
                [41.0, 3.0, -4.0],
                [53.0, -3.0, 1.0],
                [59.0, 0.0, -2.0],
                [70.0, -5.0, 1.0],
                [88.0, -2.0, -2.0],
                [102.0, 4.0, -2.0],
                [-1.0, 13.0, -1.0],
                [15.0, 10.0, -2.0],
                [23.0, 16.0, 3.0],
                [41.0, 17.0, 4.0],
                [52.0, 18.0, 1.0],
                [60.0, 9.0, 4.0],
                [72.0, 11.0, -4.0],
                [90.0, 18.0, -3.0],
                [101.0, 16.0, 4.0],
                [-3.0, 30.0, 3.0],
                [16.0, 25.0, 0.0],
                [28.0, 28.0, 0.0],
                [39.0, 33.0, 4.0],
                [53.0, 29.0, 0.0],
                [67.0, 33.0, -3.0],
                [74.0, 25.0, -3.0],
                [88.0, 33.0, 0.0],
                [100.0, 25.0, -3.0],
                [0.0, 46.0, 1.0],
                [7.0, 38.0, -3.0],
                [26.0, 38.0, -3.0],
                [37.0, 39.0, -2.0],
                [52.0, 43.0, 3.0],
                [60.0, 43.0, 2.0],
                [75.0, 40.0, 1.0],
                [88.0, 47.0, 4.0],
                [96.0, 43.0, 0.0],
                [0.0, 57.0, -3.0],
                [14.0, 59.0, -5.0],
                [22.0, 54.0, 2.0],
                [42.0, 53.0, 4.0],
                [48.0, 57.0, 4.0],
                [62.0, 59.0, 3.0],
                [71.0, 59.0, 3.0],
                [89.0, 54.0, 2.0],
                [98.0, 52.0, -1.0],
                [3.0, 71.0, 3.0],
                [17.0, 76.0, -5.0],
                [29.0, 70.0, 0.0],
                [37.0, 73.0, -2.0],
                [54.0, 73.0, 4.0],
                [66.0, 76.0, 2.0],
                [73.0, 75.0, 3.0],
                [83.0, 68.0, 1.0],
                [104.0, 72.0, -1.0],
                [-1.0, 88.0, 1.0],
                [8.0, 85.0, -1.0],
                [29.0, 82.0, -5.0],
                [37.0, 85.0, 2.0],
                [51.0, 83.0, -2.0],
                [62.0, 87.0, 0.0],
                [75.0, 85.0, 2.0],
                [92.0, 82.0, -5.0],
                [102.0, 87.0, -2.0],
                [-5.0, 98.0, -3.0],
                [13.0, 100.0, 1.0],
                [20.0, 98.0, 3.0],
                [39.0, 95.0, 3.0],
                [48.0, 97.0, 2.0],
                [63.0, 103.0, -2.0],
                [73.0, 95.0, 1.0],
                [89.0, 99.0, 0.0],
                [97.0, 95.0, -1.0],
                [-2.0, -5.0, 12.0],
                [10.0, -3.0, 11.0],
                [27.0, 4.0, 10.0],
                [35.0, 0.0, 14.0],
                [45.0, -1.0, 11.0],
                [65.0, 4.0, 13.0],
                [76.0, -1.0, 9.0],
                [87.0, 0.0, 15.0],
                [97.0, 2.0, 14.0],
                [0.0, 12.0, 12.0],
                [16.0, 15.0, 17.0],
                [23.0, 11.0, 10.0],
                [34.0, 12.0, 13.0],
                [45.0, 11.0, 12.0],
                [65.0, 9.0, 12.0],
                [78.0, 10.0, 12.0],
                [92.0, 11.0, 12.0],
                [101.0, 17.0, 16.0],
                [-1.0, 32.0, 13.0],
                [15.0, 27.0, 19.0],
                [28.0, 24.0, 18.0],
                [36.0, 29.0, 17.0],
                [46.0, 30.0, 14.0],
                [64.0, 25.0, 12.0],
                [71.0, 27.0, 9.0],
                [88.0, 32.0, 9.0],
                [99.0, 32.0, 18.0],
                [-2.0, 41.0, 11.0],
                [13.0, 47.0, 18.0],
                [24.0, 41.0, 18.0],
                [37.0, 43.0, 17.0],
                [47.0, 39.0, 12.0],
                [66.0, 44.0, 14.0],
                [79.0, 42.0, 15.0],
                [92.0, 42.0, 16.0],
                [95.0, 42.0, 16.0],
                [4.0, 59.0, 16.0],
                [8.0, 53.0, 10.0],
                [20.0, 60.0, 18.0],
                [34.0, 59.0, 14.0],
                [49.0, 57.0, 16.0],
                [67.0, 52.0, 13.0],
                [72.0, 57.0, 15.0],
                [89.0, 52.0, 16.0],
                [101.0, 60.0, 11.0],
                [1.0, 73.0, 11.0],
                [8.0, 69.0, 18.0],
                [21.0, 70.0, 10.0],
                [37.0, 72.0, 16.0],
                [51.0, 68.0, 14.0],
                [59.0, 69.0, 12.0],
                [77.0, 74.0, 10.0],
                [89.0, 73.0, 18.0],
                [100.0, 74.0, 19.0],
                [-4.0, 88.0, 10.0],
                [14.0, 90.0, 14.0],
                [22.0, 84.0, 16.0],
                [32.0, 90.0, 16.0],
                [53.0, 80.0, 11.0],
                [60.0, 84.0, 17.0],
                [77.0, 85.0, 14.0],
                [91.0, 83.0, 16.0],
                [99.0, 81.0, 15.0],
                [1.0, 97.0, 17.0],
                [12.0, 97.0, 10.0],
                [23.0, 97.0, 18.0],
                [42.0, 97.0, 16.0],
                [54.0, 97.0, 14.0],
                [63.0, 100.0, 9.0],
                [79.0, 101.0, 9.0],
                [88.0, 96.0, 11.0],
                [99.0, 102.0, 17.0],
                [2.0, -1.0, 31.0],
                [7.0, 4.0, 26.0],
                [22.0, -1.0, 32.0],
                [40.0, -2.0, 31.0],
                [45.0, -3.0, 25.0],
                [67.0, -1.0, 25.0],
                [78.0, 3.0, 30.0],
                [91.0, -4.0, 33.0],
                [96.0, 3.0, 27.0],
                [-2.0, 18.0, 29.0],
                [11.0, 14.0, 24.0],
                [28.0, 18.0, 28.0],
                [33.0, 14.0, 27.0],
                [46.0, 13.0, 31.0],
                [60.0, 11.0, 30.0],
                [73.0, 16.0, 31.0],
                [85.0, 13.0, 32.0],
                [102.0, 10.0, 33.0],
                [1.0, 28.0, 32.0],
                [10.0, 33.0, 23.0],
                [22.0, 24.0, 26.0],
                [41.0, 31.0, 26.0],
                [51.0, 24.0, 29.0],
                [59.0, 30.0, 26.0],
                [71.0, 30.0, 25.0],
                [85.0, 28.0, 23.0],
                [104.0, 30.0, 25.0],
                [-4.0, 45.0, 24.0],
                [9.0, 44.0, 23.0],
                [24.0, 43.0, 31.0],
                [35.0, 42.0, 31.0],
                [46.0, 38.0, 25.0],
                [67.0, 39.0, 30.0],
                [70.0, 47.0, 31.0],
                [82.0, 47.0, 26.0],
                [99.0, 38.0, 32.0],
                [-3.0, 57.0, 25.0],
                [15.0, 55.0, 25.0],
                [28.0, 62.0, 25.0],
                [42.0, 55.0, 28.0],
                [47.0, 56.0, 33.0],
                [63.0, 61.0, 31.0],
                [77.0, 57.0, 30.0],
                [89.0, 60.0, 27.0],
                [97.0, 55.0, 32.0],
                [3.0, 67.0, 29.0],
                [7.0, 75.0, 24.0],
                [24.0, 74.0, 32.0],
                [33.0, 67.0, 31.0],
                [51.0, 69.0, 32.0],
                [62.0, 68.0, 29.0],
                [76.0, 72.0, 28.0],
                [83.0, 74.0, 32.0],
                [97.0, 68.0, 26.0],
                [3.0, 89.0, 25.0],
                [13.0, 86.0, 26.0],
                [25.0, 85.0, 25.0],
                [36.0, 84.0, 25.0],
                [51.0, 88.0, 30.0],
                [57.0, 84.0, 26.0],
                [71.0, 89.0, 32.0],
                [87.0, 86.0, 26.0],
                [98.0, 83.0, 26.0],
                [2.0, 95.0, 31.0],
                [17.0, 99.0, 28.0],
                [27.0, 100.0, 23.0],
                [35.0, 96.0, 23.0],
                [50.0, 103.0, 31.0],
                [62.0, 96.0, 28.0],
                [73.0, 100.0, 30.0],
                [90.0, 103.0, 26.0],
                [103.0, 96.0, 33.0],
                [-4.0, 3.0, 42.0],
                [14.0, -4.0, 44.0],
                [28.0, -4.0, 42.0],
                [38.0, -3.0, 46.0],
                [53.0, 1.0, 44.0],
                [67.0, -3.0, 45.0],
                [75.0, 1.0, 41.0],
                [90.0, 2.0, 42.0],
                [101.0, 0.0, 44.0],
                [-4.0, 11.0, 43.0],
                [9.0, 19.0, 38.0],
                [21.0, 15.0, 41.0],
                [33.0, 11.0, 42.0],
                [46.0, 12.0, 41.0],
                [61.0, 11.0, 38.0],
                [73.0, 18.0, 40.0],
                [89.0, 18.0, 39.0],
                [102.0, 11.0, 45.0],
                [-2.0, 25.0, 41.0],
                [13.0, 23.0, 44.0],
                [28.0, 32.0, 39.0],
                [33.0, 27.0, 42.0],
                [46.0, 31.0, 45.0],
                [67.0, 30.0, 37.0],
                [70.0, 30.0, 42.0],
                [89.0, 33.0, 42.0],
                [99.0, 31.0, 40.0],
                [3.0, 46.0, 39.0],
                [9.0, 47.0, 41.0],
                [21.0, 38.0, 43.0],
                [40.0, 39.0, 40.0],
                [46.0, 39.0, 39.0],
                [59.0, 46.0, 47.0],
                [74.0, 43.0, 39.0],
                [84.0, 47.0, 40.0],
                [102.0, 38.0, 43.0],
                [-5.0, 52.0, 47.0],
                [10.0, 53.0, 41.0],
                [21.0, 53.0, 39.0],
                [38.0, 56.0, 39.0],
                [45.0, 53.0, 39.0],
                [59.0, 56.0, 41.0],
                [75.0, 54.0, 39.0],
                [89.0, 61.0, 47.0],
                [101.0, 62.0, 47.0],
                [4.0, 67.0, 45.0],
                [13.0, 66.0, 47.0],
                [29.0, 67.0, 40.0],
                [39.0, 71.0, 39.0],
                [52.0, 67.0, 40.0],
                [66.0, 68.0, 46.0],
                [72.0, 71.0, 39.0],
                [91.0, 70.0, 47.0],
                [96.0, 67.0, 40.0],
                [2.0, 84.0, 44.0],
                [14.0, 85.0, 40.0],
                [28.0, 81.0, 42.0],
                [40.0, 84.0, 41.0],
                [46.0, 86.0, 38.0],
                [66.0, 85.0, 47.0],
                [77.0, 87.0, 47.0],
                [87.0, 83.0, 41.0],
                [104.0, 85.0, 40.0],
                [-4.0, 104.0, 44.0],
                [8.0, 101.0, 40.0],
                [21.0, 95.0, 43.0],
                [35.0, 103.0, 41.0],
                [50.0, 99.0, 47.0],
                [57.0, 96.0, 46.0],
                [72.0, 95.0, 38.0],
                [88.0, 99.0, 46.0],
                [104.0, 97.0, 39.0],
                [0.0, 1.0, 57.0],
                [7.0, -4.0, 61.0],
                [24.0, -2.0, 52.0],
                [37.0, 4.0, 57.0],
                [49.0, 0.0, 56.0],
                [59.0, -1.0, 56.0],
                [71.0, 2.0, 60.0],
                [87.0, 4.0, 52.0],
                [96.0, -1.0, 57.0],
                [-2.0, 11.0, 61.0],
                [15.0, 13.0, 52.0],
                [27.0, 17.0, 53.0],
                [35.0, 16.0, 57.0],
                [51.0, 12.0, 59.0],
                [66.0, 13.0, 61.0],
                [79.0, 15.0, 53.0],
                [83.0, 16.0, 61.0],
                [101.0, 17.0, 53.0],
                [4.0, 27.0, 60.0],
                [10.0, 33.0, 55.0],
                [28.0, 25.0, 57.0],
                [32.0, 33.0, 57.0],
                [53.0, 29.0, 54.0],
                [64.0, 27.0, 61.0],
                [78.0, 29.0, 57.0],
                [88.0, 32.0, 55.0],
                [100.0, 29.0, 52.0],
                [0.0, 46.0, 54.0],
                [15.0, 41.0, 52.0],
                [25.0, 40.0, 52.0],
                [42.0, 42.0, 59.0],
                [54.0, 41.0, 55.0],
                [60.0, 40.0, 52.0],
                [79.0, 42.0, 53.0],
                [83.0, 39.0, 55.0],
                [99.0, 39.0, 60.0],
                [-3.0, 61.0, 58.0],
                [15.0, 54.0, 55.0],
                [28.0, 56.0, 53.0],
                [35.0, 55.0, 54.0],
                [50.0, 60.0, 52.0],
                [65.0, 55.0, 58.0],
                [70.0, 61.0, 57.0],
                [91.0, 55.0, 60.0],
                [102.0, 60.0, 52.0],
                [4.0, 73.0, 52.0],
                [10.0, 71.0, 55.0],
                [25.0, 72.0, 55.0],
                [35.0, 75.0, 53.0],
                [46.0, 67.0, 53.0],
                [61.0, 73.0, 60.0],
                [72.0, 74.0, 59.0],
                [82.0, 71.0, 55.0],
                [100.0, 74.0, 59.0],
                [-3.0, 86.0, 55.0],
                [15.0, 88.0, 54.0],
                [22.0, 89.0, 54.0],
                [40.0, 84.0, 59.0],
                [53.0, 84.0, 52.0],
                [65.0, 85.0, 56.0],
                [79.0, 81.0, 53.0],
                [90.0, 84.0, 57.0],
                [103.0, 90.0, 55.0],
                [-5.0, 98.0, 57.0],
                [9.0, 100.0, 53.0],
                [20.0, 95.0, 60.0],
                [40.0, 100.0, 60.0],
                [51.0, 101.0, 56.0],
                [60.0, 95.0, 55.0],
                [78.0, 104.0, 56.0],
                [85.0, 104.0, 60.0],
                [103.0, 95.0, 58.0],
                [2.0, 2.0, 75.0],
                [9.0, 1.0, 67.0],
                [23.0, 1.0, 75.0],
                [41.0, 0.0, 69.0],
                [52.0, 1.0, 71.0],
                [59.0, -1.0, 72.0],
                [75.0, 2.0, 74.0],
                [84.0, 1.0, 71.0],
                [100.0, 2.0, 70.0],
                [-5.0, 12.0, 76.0],
                [17.0, 17.0, 67.0],
                [29.0, 12.0, 72.0],
                [35.0, 13.0, 71.0],
                [45.0, 11.0, 74.0],
                [58.0, 9.0, 75.0],
                [70.0, 15.0, 68.0],
                [88.0, 10.0, 74.0],
                [101.0, 15.0, 69.0],
                [3.0, 28.0, 70.0],
                [15.0, 31.0, 76.0],
                [21.0, 29.0, 71.0],
                [37.0, 25.0, 67.0],
                [51.0, 23.0, 75.0],
                [64.0, 30.0, 73.0],
                [78.0, 29.0, 69.0],
                [86.0, 31.0, 71.0],
                [103.0, 26.0, 73.0],
                [4.0, 40.0, 72.0],
                [9.0, 42.0, 67.0],
                [23.0, 39.0, 69.0],
                [40.0, 46.0, 74.0],
                [48.0, 42.0, 67.0],
                [60.0, 39.0, 73.0],
                [71.0, 46.0, 74.0],
                [88.0, 47.0, 76.0],
                [98.0, 47.0, 68.0],
                [-4.0, 55.0, 73.0],
                [8.0, 52.0, 70.0],
                [22.0, 61.0, 68.0],
                [37.0, 56.0, 76.0],
                [54.0, 61.0, 71.0],
                [62.0, 57.0, 70.0],
                [79.0, 60.0, 66.0],
                [87.0, 61.0, 74.0],
                [95.0, 60.0, 66.0],
                [3.0, 69.0, 70.0],
                [10.0, 66.0, 71.0],
                [20.0, 72.0, 69.0],
                [40.0, 74.0, 75.0],
                [48.0, 68.0, 69.0],
                [67.0, 67.0, 73.0],
                [70.0, 73.0, 73.0],
                [85.0, 69.0, 71.0],
                [103.0, 76.0, 70.0],
                [0.0, 89.0, 73.0],
                [8.0, 88.0, 74.0],
                [25.0, 83.0, 67.0],
                [35.0, 88.0, 67.0],
                [51.0, 89.0, 66.0],
                [58.0, 89.0, 68.0],
                [72.0, 87.0, 69.0],
                [89.0, 85.0, 68.0],
                [97.0, 87.0, 69.0],
                [-4.0, 102.0, 74.0],
                [9.0, 103.0, 75.0],
                [27.0, 102.0, 67.0],
                [40.0, 100.0, 66.0],
                [51.0, 102.0, 69.0],
                [61.0, 95.0, 67.0],
                [79.0, 99.0, 73.0],
                [85.0, 103.0, 66.0],
                [97.0, 99.0, 70.0],
                [4.0, -1.0, 89.0],
                [15.0, -3.0, 82.0],
                [21.0, -3.0, 84.0],
                [39.0, 4.0, 80.0],
                [48.0, 0.0, 87.0],
                [64.0, -4.0, 82.0],
                [71.0, -2.0, 87.0],
                [84.0, -2.0, 84.0],
                [102.0, -2.0, 87.0],
                [-1.0, 13.0, 84.0],
                [11.0, 13.0, 90.0],
                [20.0, 12.0, 89.0],
                [41.0, 18.0, 82.0],
                [54.0, 14.0, 89.0],
                [63.0, 17.0, 81.0],
                [78.0, 11.0, 86.0],
                [92.0, 11.0, 80.0],
                [98.0, 10.0, 89.0],
                [1.0, 26.0, 90.0],
                [13.0, 32.0, 90.0],
                [22.0, 25.0, 82.0],
                [41.0, 30.0, 83.0],
                [46.0, 23.0, 81.0],
                [63.0, 25.0, 83.0],
                [72.0, 24.0, 85.0],
                [89.0, 29.0, 90.0],
                [102.0, 30.0, 89.0],
                [-1.0, 42.0, 85.0],
                [15.0, 41.0, 82.0],
                [28.0, 39.0, 87.0],
                [41.0, 39.0, 84.0],
                [50.0, 40.0, 81.0],
                [60.0, 40.0, 83.0],
                [71.0, 46.0, 88.0],
                [88.0, 39.0, 81.0],
                [95.0, 43.0, 86.0],
                [4.0, 55.0, 85.0],
                [12.0, 54.0, 87.0],
                [27.0, 54.0, 87.0],
                [41.0, 60.0, 90.0],
                [53.0, 52.0, 83.0],
                [60.0, 57.0, 89.0],
                [78.0, 53.0, 82.0],
                [88.0, 52.0, 82.0],
                [103.0, 53.0, 84.0],
                [4.0, 76.0, 83.0],
                [15.0, 69.0, 81.0],
                [20.0, 67.0, 84.0],
                [34.0, 71.0, 88.0],
                [50.0, 69.0, 85.0],
                [65.0, 74.0, 87.0],
                [72.0, 69.0, 83.0],
                [87.0, 72.0, 89.0],
                [104.0, 74.0, 88.0],
                [-1.0, 86.0, 87.0],
                [14.0, 83.0, 88.0],
                [24.0, 83.0, 82.0],
                [42.0, 82.0, 90.0],
                [50.0, 88.0, 84.0],
                [62.0, 87.0, 88.0],
                [78.0, 88.0, 86.0],
                [90.0, 83.0, 85.0],
                [95.0, 85.0, 90.0],
                [2.0, 97.0, 84.0],
                [11.0, 102.0, 88.0],
                [25.0, 97.0, 83.0],
                [37.0, 102.0, 86.0],
                [48.0, 102.0, 90.0],
                [61.0, 97.0, 88.0],
                [73.0, 104.0, 87.0],
                [84.0, 96.0, 81.0],
                [103.0, 98.0, 84.0],
                [4.0, -4.0, 99.0],
                [8.0, -4.0, 98.0],
                [29.0, -3.0, 97.0],
                [33.0, 2.0, 104.0],
                [52.0, -2.0, 96.0],
                [64.0, -5.0, 104.0],
                [74.0, -1.0, 100.0],
                [87.0, -3.0, 95.0],
                [95.0, -3.0, 95.0],
                [0.0, 11.0, 100.0],
                [16.0, 10.0, 99.0],
                [23.0, 13.0, 102.0],
                [36.0, 15.0, 104.0],
                [45.0, 18.0, 95.0],
                [58.0, 16.0, 103.0],
                [79.0, 15.0, 103.0],
                [83.0, 12.0, 96.0],
                [103.0, 12.0, 97.0],
                [2.0, 32.0, 100.0],
                [10.0, 24.0, 103.0],
                [21.0, 32.0, 95.0],
                [33.0, 28.0, 99.0],
                [47.0, 24.0, 102.0],
                [64.0, 33.0, 100.0],
                [72.0, 27.0, 100.0],
                [83.0, 33.0, 99.0],
                [103.0, 24.0, 103.0],
                [-4.0, 44.0, 104.0],
                [11.0, 41.0, 102.0],
                [21.0, 41.0, 99.0],
                [34.0, 45.0, 101.0],
                [52.0, 46.0, 104.0],
                [57.0, 42.0, 103.0],
                [70.0, 41.0, 101.0],
                [92.0, 47.0, 104.0],
                [95.0, 44.0, 96.0],
                [4.0, 61.0, 102.0],
                [14.0, 60.0, 104.0],
                [22.0, 57.0, 104.0],
                [39.0, 55.0, 101.0],
                [52.0, 59.0, 96.0],
                [61.0, 52.0, 101.0],
                [71.0, 55.0, 97.0],
                [91.0, 58.0, 100.0],
                [104.0, 59.0, 101.0],
                [-2.0, 71.0, 98.0],
                [14.0, 71.0, 99.0],
                [25.0, 74.0, 99.0],
                [38.0, 73.0, 99.0],
                [48.0, 73.0, 102.0],
                [60.0, 69.0, 98.0],
                [74.0, 74.0, 96.0],
                [86.0, 71.0, 103.0],
                [98.0, 72.0, 98.0],
                [1.0, 87.0, 104.0],
                [11.0, 82.0, 101.0],
                [20.0, 88.0, 98.0],
                [37.0, 90.0, 99.0],
                [49.0, 85.0, 95.0],
                [64.0, 84.0, 104.0],
                [75.0, 89.0, 104.0],
                [86.0, 84.0, 103.0],
                [98.0, 86.0, 95.0],
                [-3.0, 104.0, 99.0],
                [15.0, 103.0, 101.0],
                [20.0, 98.0, 96.0],
                [40.0, 95.0, 102.0],
                [52.0, 100.0, 102.0],
                [62.0, 97.0, 100.0],
                [73.0, 103.0, 99.0],
                [89.0, 97.0, 104.0],
                [101.0, 103.0, 104.0],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.9, 3.1, 4.4, 5.0, 5.0, 5.0, 5.0, 5.0])
        )
        basis1 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 1.1, 2.4, 2.9, 4.0, 4.0, 4.0, 4.0, 4.0]))
        basis2 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0])
        )
        vol = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2 *= np.array([4.4, 7.3, 6.2])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] /= 4.400000
        pt2[..., 1] /= 7.300000
        pt2[..., 2] /= 6.200000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_volume_3D_p777(self):
        controlpoints = np.array(
            [
                [-5.0, 1.0, 2.0],
                [8.0, -2.0, 4.0],
                [26.0, 4.0, -2.0],
                [29.0, 1.0, 2.0],
                [48.0, -2.0, -5.0],
                [55.0, 3.0, 4.0],
                [69.0, -4.0, 1.0],
                [73.0, -5.0, 0.0],
                [91.0, 4.0, -1.0],
                [99.0, 1.0, -1.0],
                [4.0, 15.0, 1.0],
                [12.0, 6.0, -5.0],
                [20.0, 8.0, 3.0],
                [36.0, 12.0, 1.0],
                [46.0, 7.0, 0.0],
                [53.0, 11.0, -1.0],
                [70.0, 8.0, 4.0],
                [75.0, 6.0, 1.0],
                [83.0, 12.0, -1.0],
                [98.0, 10.0, -2.0],
                [-3.0, 20.0, -2.0],
                [14.0, 19.0, 3.0],
                [17.0, 23.0, 3.0],
                [32.0, 25.0, 1.0],
                [39.0, 20.0, -3.0],
                [53.0, 21.0, 0.0],
                [69.0, 24.0, 2.0],
                [78.0, 17.0, 4.0],
                [90.0, 25.0, 3.0],
                [101.0, 23.0, 4.0],
                [2.0, 33.0, 4.0],
                [9.0, 32.0, 0.0],
                [23.0, 34.0, -3.0],
                [28.0, 31.0, 1.0],
                [46.0, 28.0, -2.0],
                [54.0, 33.0, 0.0],
                [62.0, 31.0, 4.0],
                [80.0, 32.0, 3.0],
                [92.0, 38.0, 4.0],
                [103.0, 32.0, 4.0],
                [0.0, 40.0, 4.0],
                [8.0, 47.0, -3.0],
                [22.0, 46.0, -5.0],
                [29.0, 46.0, 0.0],
                [41.0, 47.0, -2.0],
                [59.0, 45.0, 2.0],
                [66.0, 44.0, -5.0],
                [77.0, 44.0, -4.0],
                [87.0, 45.0, -3.0],
                [98.0, 47.0, -2.0],
                [0.0, 54.0, -2.0],
                [9.0, 55.0, -4.0],
                [25.0, 56.0, -2.0],
                [30.0, 57.0, 1.0],
                [39.0, 59.0, 0.0],
                [57.0, 60.0, 3.0],
                [70.0, 54.0, -5.0],
                [82.0, 54.0, 2.0],
                [89.0, 52.0, -1.0],
                [95.0, 52.0, 3.0],
                [0.0, 66.0, 3.0],
                [12.0, 65.0, 0.0],
                [17.0, 69.0, -5.0],
                [33.0, 66.0, 2.0],
                [41.0, 70.0, 4.0],
                [59.0, 70.0, -3.0],
                [62.0, 67.0, -2.0],
                [73.0, 62.0, -3.0],
                [90.0, 70.0, -4.0],
                [96.0, 63.0, 4.0],
                [1.0, 76.0, -2.0],
                [15.0, 74.0, -2.0],
                [20.0, 81.0, 0.0],
                [29.0, 74.0, 0.0],
                [43.0, 73.0, 2.0],
                [55.0, 82.0, -5.0],
                [66.0, 80.0, 0.0],
                [82.0, 73.0, -3.0],
                [85.0, 79.0, 1.0],
                [97.0, 73.0, 3.0],
                [-2.0, 88.0, -3.0],
                [13.0, 86.0, 3.0],
                [19.0, 84.0, -5.0],
                [32.0, 85.0, 3.0],
                [46.0, 84.0, 3.0],
                [59.0, 89.0, -3.0],
                [64.0, 92.0, -4.0],
                [80.0, 90.0, -5.0],
                [93.0, 88.0, 3.0],
                [100.0, 89.0, 4.0],
                [2.0, 96.0, -3.0],
                [8.0, 102.0, -4.0],
                [17.0, 99.0, -4.0],
                [34.0, 99.0, -2.0],
                [46.0, 98.0, 3.0],
                [54.0, 102.0, 4.0],
                [69.0, 100.0, -1.0],
                [77.0, 96.0, 0.0],
                [87.0, 104.0, -1.0],
                [97.0, 96.0, -2.0],
                [4.0, 0.0, 11.0],
                [10.0, -3.0, 17.0],
                [18.0, -2.0, 16.0],
                [28.0, 0.0, 17.0],
                [41.0, -2.0, 13.0],
                [54.0, -5.0, 18.0],
                [65.0, -3.0, 18.0],
                [78.0, -5.0, 17.0],
                [84.0, -5.0, 19.0],
                [100.0, 2.0, 15.0],
                [-4.0, 14.0, 18.0],
                [14.0, 14.0, 15.0],
                [22.0, 13.0, 19.0],
                [31.0, 13.0, 18.0],
                [43.0, 14.0, 17.0],
                [54.0, 6.0, 9.0],
                [69.0, 13.0, 10.0],
                [73.0, 13.0, 18.0],
                [87.0, 10.0, 18.0],
                [99.0, 6.0, 14.0],
                [-3.0, 23.0, 14.0],
                [12.0, 17.0, 15.0],
                [22.0, 23.0, 15.0],
                [31.0, 23.0, 13.0],
                [43.0, 23.0, 17.0],
                [53.0, 21.0, 14.0],
                [69.0, 24.0, 18.0],
                [78.0, 22.0, 15.0],
                [87.0, 26.0, 13.0],
                [100.0, 18.0, 14.0],
                [3.0, 32.0, 12.0],
                [8.0, 37.0, 13.0],
                [19.0, 32.0, 13.0],
                [30.0, 33.0, 10.0],
                [45.0, 36.0, 12.0],
                [51.0, 30.0, 17.0],
                [65.0, 28.0, 16.0],
                [82.0, 31.0, 19.0],
                [93.0, 30.0, 10.0],
                [101.0, 34.0, 15.0],
                [0.0, 47.0, 9.0],
                [13.0, 46.0, 12.0],
                [22.0, 44.0, 11.0],
                [31.0, 44.0, 12.0],
                [46.0, 42.0, 17.0],
                [60.0, 43.0, 16.0],
                [62.0, 46.0, 14.0],
                [74.0, 48.0, 10.0],
                [87.0, 40.0, 16.0],
                [97.0, 41.0, 13.0],
                [1.0, 55.0, 11.0],
                [6.0, 54.0, 19.0],
                [22.0, 54.0, 14.0],
                [38.0, 59.0, 15.0],
                [47.0, 54.0, 10.0],
                [60.0, 54.0, 13.0],
                [63.0, 58.0, 19.0],
                [79.0, 59.0, 17.0],
                [84.0, 54.0, 18.0],
                [100.0, 59.0, 16.0],
                [3.0, 67.0, 16.0],
                [11.0, 66.0, 18.0],
                [19.0, 69.0, 19.0],
                [31.0, 65.0, 15.0],
                [44.0, 62.0, 15.0],
                [51.0, 62.0, 9.0],
                [64.0, 65.0, 17.0],
                [75.0, 63.0, 18.0],
                [87.0, 68.0, 11.0],
                [95.0, 70.0, 11.0],
                [4.0, 74.0, 12.0],
                [13.0, 76.0, 10.0],
                [21.0, 77.0, 13.0],
                [30.0, 82.0, 15.0],
                [48.0, 77.0, 12.0],
                [58.0, 80.0, 14.0],
                [69.0, 73.0, 12.0],
                [81.0, 76.0, 13.0],
                [89.0, 77.0, 17.0],
                [96.0, 78.0, 18.0],
                [1.0, 89.0, 14.0],
                [12.0, 88.0, 10.0],
                [25.0, 84.0, 12.0],
                [35.0, 84.0, 14.0],
                [43.0, 88.0, 14.0],
                [58.0, 84.0, 10.0],
                [68.0, 87.0, 10.0],
                [79.0, 85.0, 10.0],
                [92.0, 85.0, 16.0],
                [100.0, 91.0, 15.0],
                [-2.0, 100.0, 11.0],
                [10.0, 98.0, 15.0],
                [21.0, 102.0, 16.0],
                [36.0, 96.0, 14.0],
                [39.0, 102.0, 13.0],
                [59.0, 102.0, 10.0],
                [68.0, 96.0, 17.0],
                [81.0, 97.0, 16.0],
                [92.0, 96.0, 18.0],
                [96.0, 101.0, 15.0],
                [-4.0, -3.0, 29.0],
                [14.0, -4.0, 24.0],
                [22.0, -5.0, 26.0],
                [34.0, -2.0, 24.0],
                [43.0, 4.0, 25.0],
                [54.0, 2.0, 30.0],
                [66.0, -3.0, 24.0],
                [74.0, 2.0, 27.0],
                [87.0, -4.0, 28.0],
                [97.0, -4.0, 31.0],
                [-2.0, 11.0, 29.0],
                [6.0, 9.0, 24.0],
                [21.0, 7.0, 26.0],
                [28.0, 10.0, 29.0],
                [47.0, 8.0, 28.0],
                [60.0, 10.0, 29.0],
                [65.0, 9.0, 30.0],
                [78.0, 15.0, 31.0],
                [85.0, 12.0, 28.0],
                [104.0, 10.0, 30.0],
                [2.0, 23.0, 24.0],
                [10.0, 22.0, 30.0],
                [26.0, 21.0, 32.0],
                [34.0, 22.0, 30.0],
                [45.0, 22.0, 27.0],
                [55.0, 22.0, 28.0],
                [68.0, 22.0, 26.0],
                [77.0, 25.0, 29.0],
                [90.0, 25.0, 31.0],
                [99.0, 24.0, 27.0],
                [1.0, 29.0, 26.0],
                [12.0, 31.0, 30.0],
                [20.0, 36.0, 32.0],
                [36.0, 34.0, 23.0],
                [43.0, 30.0, 23.0],
                [55.0, 36.0, 26.0],
                [65.0, 33.0, 31.0],
                [79.0, 36.0, 29.0],
                [84.0, 31.0, 31.0],
                [97.0, 35.0, 33.0],
                [0.0, 44.0, 24.0],
                [15.0, 41.0, 26.0],
                [20.0, 45.0, 25.0],
                [32.0, 41.0, 26.0],
                [43.0, 44.0, 26.0],
                [56.0, 41.0, 28.0],
                [67.0, 46.0, 28.0],
                [73.0, 40.0, 30.0],
                [89.0, 43.0, 27.0],
                [95.0, 42.0, 29.0],
                [-2.0, 51.0, 33.0],
                [15.0, 59.0, 25.0],
                [22.0, 52.0, 33.0],
                [33.0, 58.0, 28.0],
                [43.0, 60.0, 31.0],
                [54.0, 54.0, 24.0],
                [65.0, 52.0, 31.0],
                [78.0, 58.0, 26.0],
                [87.0, 55.0, 24.0],
                [104.0, 55.0, 29.0],
                [-5.0, 64.0, 33.0],
                [6.0, 68.0, 27.0],
                [22.0, 68.0, 24.0],
                [29.0, 71.0, 27.0],
                [45.0, 67.0, 31.0],
                [60.0, 61.0, 31.0],
                [62.0, 65.0, 29.0],
                [77.0, 71.0, 25.0],
                [88.0, 68.0, 32.0],
                [101.0, 65.0, 29.0],
                [3.0, 77.0, 24.0],
                [13.0, 80.0, 30.0],
                [17.0, 74.0, 26.0],
                [28.0, 73.0, 30.0],
                [47.0, 75.0, 31.0],
                [57.0, 77.0, 33.0],
                [65.0, 76.0, 25.0],
                [75.0, 80.0, 32.0],
                [86.0, 81.0, 29.0],
                [97.0, 76.0, 24.0],
                [-2.0, 84.0, 32.0],
                [11.0, 85.0, 27.0],
                [20.0, 87.0, 33.0],
                [29.0, 88.0, 29.0],
                [39.0, 85.0, 32.0],
                [59.0, 84.0, 28.0],
                [61.0, 85.0, 33.0],
                [80.0, 91.0, 27.0],
                [88.0, 93.0, 32.0],
                [95.0, 91.0, 30.0],
                [-4.0, 102.0, 27.0],
                [6.0, 102.0, 31.0],
                [25.0, 95.0, 28.0],
                [31.0, 103.0, 27.0],
                [39.0, 104.0, 33.0],
                [52.0, 99.0, 28.0],
                [63.0, 104.0, 25.0],
                [81.0, 103.0, 27.0],
                [84.0, 104.0, 28.0],
                [96.0, 102.0, 30.0],
                [-2.0, -4.0, 39.0],
                [6.0, -1.0, 40.0],
                [17.0, 4.0, 47.0],
                [35.0, -4.0, 43.0],
                [49.0, 4.0, 47.0],
                [55.0, 1.0, 44.0],
                [66.0, -2.0, 44.0],
                [79.0, 1.0, 40.0],
                [92.0, -4.0, 43.0],
                [99.0, -3.0, 42.0],
                [2.0, 15.0, 46.0],
                [15.0, 12.0, 39.0],
                [24.0, 15.0, 39.0],
                [38.0, 16.0, 41.0],
                [47.0, 12.0, 46.0],
                [58.0, 11.0, 41.0],
                [62.0, 15.0, 46.0],
                [75.0, 12.0, 38.0],
                [92.0, 11.0, 46.0],
                [101.0, 14.0, 41.0],
                [-5.0, 21.0, 47.0],
                [9.0, 23.0, 42.0],
                [21.0, 19.0, 40.0],
                [34.0, 24.0, 46.0],
                [43.0, 20.0, 46.0],
                [52.0, 24.0, 46.0],
                [67.0, 25.0, 44.0],
                [81.0, 22.0, 38.0],
                [84.0, 23.0, 44.0],
                [96.0, 27.0, 44.0],
                [2.0, 32.0, 39.0],
                [7.0, 36.0, 39.0],
                [21.0, 32.0, 43.0],
                [31.0, 31.0, 43.0],
                [40.0, 29.0, 41.0],
                [56.0, 36.0, 45.0],
                [66.0, 35.0, 39.0],
                [77.0, 30.0, 37.0],
                [91.0, 35.0, 42.0],
                [98.0, 37.0, 42.0],
                [2.0, 45.0, 41.0],
                [11.0, 43.0, 46.0],
                [25.0, 40.0, 38.0],
                [33.0, 41.0, 39.0],
                [41.0, 42.0, 45.0],
                [58.0, 41.0, 39.0],
                [69.0, 45.0, 40.0],
                [75.0, 40.0, 45.0],
                [88.0, 46.0, 38.0],
                [101.0, 43.0, 40.0],
                [0.0, 52.0, 44.0],
                [14.0, 53.0, 44.0],
                [18.0, 57.0, 42.0],
                [28.0, 56.0, 44.0],
                [43.0, 51.0, 40.0],
                [54.0, 55.0, 42.0],
                [62.0, 55.0, 43.0],
                [75.0, 52.0, 40.0],
                [88.0, 58.0, 44.0],
                [99.0, 59.0, 41.0],
                [3.0, 62.0, 37.0],
                [9.0, 66.0, 38.0],
                [25.0, 62.0, 46.0],
                [36.0, 68.0, 42.0],
                [40.0, 65.0, 39.0],
                [58.0, 65.0, 46.0],
                [70.0, 67.0, 42.0],
                [77.0, 61.0, 41.0],
                [84.0, 64.0, 42.0],
                [96.0, 65.0, 46.0],
                [-2.0, 81.0, 44.0],
                [6.0, 74.0, 38.0],
                [24.0, 80.0, 38.0],
                [36.0, 74.0, 42.0],
                [42.0, 77.0, 39.0],
                [51.0, 76.0, 38.0],
                [63.0, 77.0, 42.0],
                [77.0, 82.0, 40.0],
                [91.0, 75.0, 38.0],
                [95.0, 77.0, 47.0],
                [-5.0, 85.0, 44.0],
                [8.0, 89.0, 45.0],
                [24.0, 86.0, 46.0],
                [36.0, 89.0, 39.0],
                [40.0, 91.0, 45.0],
                [50.0, 85.0, 40.0],
                [67.0, 85.0, 38.0],
                [81.0, 90.0, 47.0],
                [84.0, 93.0, 39.0],
                [96.0, 88.0, 43.0],
                [3.0, 102.0, 43.0],
                [9.0, 102.0, 39.0],
                [23.0, 95.0, 43.0],
                [29.0, 100.0, 45.0],
                [41.0, 98.0, 45.0],
                [53.0, 99.0, 42.0],
                [62.0, 104.0, 39.0],
                [79.0, 95.0, 41.0],
                [93.0, 101.0, 40.0],
                [103.0, 98.0, 46.0],
                [-3.0, 4.0, 52.0],
                [8.0, 2.0, 57.0],
                [22.0, -5.0, 56.0],
                [29.0, -1.0, 59.0],
                [43.0, -4.0, 52.0],
                [55.0, -1.0, 53.0],
                [63.0, -5.0, 57.0],
                [78.0, -2.0, 57.0],
                [93.0, 4.0, 54.0],
                [95.0, 0.0, 52.0],
                [3.0, 7.0, 61.0],
                [9.0, 10.0, 58.0],
                [22.0, 7.0, 60.0],
                [32.0, 10.0, 60.0],
                [39.0, 11.0, 61.0],
                [54.0, 15.0, 61.0],
                [65.0, 15.0, 53.0],
                [73.0, 12.0, 59.0],
                [90.0, 6.0, 61.0],
                [101.0, 11.0, 52.0],
                [0.0, 26.0, 62.0],
                [11.0, 27.0, 59.0],
                [20.0, 25.0, 61.0],
                [35.0, 23.0, 56.0],
                [48.0, 26.0, 53.0],
                [50.0, 24.0, 54.0],
                [69.0, 26.0, 54.0],
                [79.0, 24.0, 56.0],
                [92.0, 25.0, 55.0],
                [103.0, 23.0, 57.0],
                [-1.0, 31.0, 55.0],
                [6.0, 28.0, 58.0],
                [20.0, 33.0, 59.0],
                [36.0, 36.0, 52.0],
                [43.0, 32.0, 55.0],
                [52.0, 33.0, 56.0],
                [61.0, 34.0, 57.0],
                [75.0, 29.0, 53.0],
                [92.0, 32.0, 56.0],
                [99.0, 35.0, 55.0],
                [1.0, 42.0, 53.0],
                [16.0, 45.0, 54.0],
                [25.0, 40.0, 52.0],
                [29.0, 44.0, 60.0],
                [44.0, 41.0, 52.0],
                [52.0, 40.0, 58.0],
                [66.0, 44.0, 57.0],
                [80.0, 47.0, 59.0],
                [87.0, 44.0, 59.0],
                [104.0, 45.0, 55.0],
                [2.0, 59.0, 54.0],
                [10.0, 54.0, 56.0],
                [18.0, 60.0, 54.0],
                [37.0, 51.0, 55.0],
                [45.0, 57.0, 55.0],
                [58.0, 57.0, 62.0],
                [68.0, 53.0, 57.0],
                [76.0, 52.0, 54.0],
                [88.0, 51.0, 59.0],
                [100.0, 52.0, 57.0],
                [-1.0, 66.0, 58.0],
                [11.0, 63.0, 57.0],
                [24.0, 65.0, 54.0],
                [30.0, 68.0, 53.0],
                [47.0, 71.0, 54.0],
                [55.0, 69.0, 53.0],
                [68.0, 66.0, 57.0],
                [77.0, 62.0, 53.0],
                [84.0, 68.0, 53.0],
                [104.0, 66.0, 57.0],
                [2.0, 78.0, 55.0],
                [15.0, 81.0, 55.0],
                [18.0, 82.0, 57.0],
                [31.0, 80.0, 54.0],
                [44.0, 74.0, 61.0],
                [55.0, 73.0, 61.0],
                [62.0, 81.0, 54.0],
                [77.0, 80.0, 57.0],
                [92.0, 74.0, 52.0],
                [99.0, 74.0, 62.0],
                [-4.0, 87.0, 59.0],
                [10.0, 90.0, 59.0],
                [23.0, 86.0, 56.0],
                [35.0, 93.0, 56.0],
                [41.0, 83.0, 56.0],
                [52.0, 85.0, 53.0],
                [64.0, 93.0, 60.0],
                [74.0, 90.0, 61.0],
                [88.0, 90.0, 56.0],
                [100.0, 87.0, 57.0],
                [0.0, 95.0, 55.0],
                [15.0, 99.0, 56.0],
                [21.0, 96.0, 55.0],
                [31.0, 104.0, 57.0],
                [47.0, 96.0, 61.0],
                [60.0, 96.0, 61.0],
                [69.0, 99.0, 57.0],
                [79.0, 97.0, 53.0],
                [89.0, 97.0, 58.0],
                [100.0, 99.0, 59.0],
                [-3.0, -3.0, 69.0],
                [11.0, -2.0, 73.0],
                [17.0, -5.0, 69.0],
                [34.0, -3.0, 70.0],
                [41.0, -3.0, 70.0],
                [57.0, -5.0, 71.0],
                [70.0, 3.0, 72.0],
                [80.0, 4.0, 75.0],
                [90.0, -4.0, 70.0],
                [101.0, -4.0, 74.0],
                [1.0, 10.0, 71.0],
                [15.0, 15.0, 68.0],
                [17.0, 6.0, 66.0],
                [32.0, 6.0, 69.0],
                [45.0, 8.0, 69.0],
                [54.0, 14.0, 71.0],
                [69.0, 8.0, 68.0],
                [82.0, 10.0, 70.0],
                [84.0, 13.0, 75.0],
                [104.0, 15.0, 74.0],
                [4.0, 26.0, 70.0],
                [14.0, 20.0, 72.0],
                [18.0, 26.0, 71.0],
                [30.0, 23.0, 75.0],
                [48.0, 20.0, 72.0],
                [53.0, 20.0, 70.0],
                [68.0, 23.0, 69.0],
                [82.0, 18.0, 76.0],
                [84.0, 27.0, 70.0],
                [97.0, 26.0, 70.0],
                [-5.0, 31.0, 72.0],
                [10.0, 28.0, 72.0],
                [18.0, 32.0, 71.0],
                [35.0, 30.0, 73.0],
                [46.0, 32.0, 74.0],
                [52.0, 30.0, 68.0],
                [66.0, 36.0, 70.0],
                [78.0, 37.0, 72.0],
                [85.0, 33.0, 71.0],
                [99.0, 29.0, 68.0],
                [-4.0, 40.0, 74.0],
                [7.0, 47.0, 75.0],
                [19.0, 45.0, 74.0],
                [34.0, 39.0, 69.0],
                [44.0, 44.0, 75.0],
                [51.0, 42.0, 69.0],
                [62.0, 42.0, 67.0],
                [79.0, 41.0, 72.0],
                [85.0, 45.0, 72.0],
                [97.0, 39.0, 72.0],
                [-1.0, 56.0, 74.0],
                [12.0, 60.0, 76.0],
                [26.0, 54.0, 74.0],
                [35.0, 53.0, 71.0],
                [42.0, 57.0, 73.0],
                [56.0, 51.0, 69.0],
                [66.0, 56.0, 75.0],
                [76.0, 57.0, 72.0],
                [87.0, 59.0, 67.0],
                [100.0, 55.0, 72.0],
                [-3.0, 64.0, 68.0],
                [8.0, 71.0, 73.0],
                [24.0, 64.0, 72.0],
                [38.0, 64.0, 68.0],
                [42.0, 61.0, 72.0],
                [57.0, 70.0, 74.0],
                [66.0, 67.0, 68.0],
                [82.0, 70.0, 68.0],
                [92.0, 63.0, 73.0],
                [100.0, 67.0, 71.0],
                [3.0, 78.0, 76.0],
                [7.0, 77.0, 74.0],
                [24.0, 80.0, 75.0],
                [37.0, 75.0, 70.0],
                [45.0, 78.0, 66.0],
                [59.0, 80.0, 73.0],
                [70.0, 77.0, 70.0],
                [79.0, 80.0, 74.0],
                [91.0, 81.0, 73.0],
                [98.0, 81.0, 76.0],
                [2.0, 85.0, 66.0],
                [8.0, 91.0, 72.0],
                [20.0, 86.0, 69.0],
                [31.0, 93.0, 67.0],
                [48.0, 86.0, 71.0],
                [51.0, 86.0, 68.0],
                [65.0, 85.0, 75.0],
                [75.0, 83.0, 72.0],
                [90.0, 90.0, 74.0],
                [96.0, 93.0, 71.0],
                [2.0, 96.0, 66.0],
                [9.0, 102.0, 70.0],
                [25.0, 100.0, 68.0],
                [31.0, 102.0, 67.0],
                [43.0, 104.0, 68.0],
                [59.0, 99.0, 66.0],
                [70.0, 100.0, 73.0],
                [80.0, 96.0, 74.0],
                [85.0, 99.0, 74.0],
                [103.0, 99.0, 70.0],
                [2.0, 3.0, 87.0],
                [9.0, 1.0, 84.0],
                [25.0, -2.0, 84.0],
                [35.0, -2.0, 90.0],
                [45.0, 2.0, 90.0],
                [56.0, 1.0, 80.0],
                [61.0, -2.0, 84.0],
                [82.0, 0.0, 90.0],
                [92.0, -5.0, 85.0],
                [103.0, 2.0, 83.0],
                [-3.0, 14.0, 83.0],
                [11.0, 8.0, 84.0],
                [23.0, 11.0, 90.0],
                [28.0, 9.0, 82.0],
                [46.0, 11.0, 90.0],
                [55.0, 10.0, 84.0],
                [62.0, 13.0, 82.0],
                [74.0, 8.0, 88.0],
                [93.0, 12.0, 82.0],
                [101.0, 16.0, 89.0],
                [2.0, 18.0, 86.0],
                [14.0, 18.0, 86.0],
                [26.0, 20.0, 90.0],
                [29.0, 26.0, 81.0],
                [45.0, 21.0, 81.0],
                [58.0, 22.0, 84.0],
                [65.0, 26.0, 85.0],
                [75.0, 26.0, 87.0],
                [89.0, 22.0, 81.0],
                [100.0, 24.0, 88.0],
                [-1.0, 35.0, 81.0],
                [7.0, 37.0, 82.0],
                [22.0, 37.0, 88.0],
                [35.0, 29.0, 89.0],
                [44.0, 32.0, 84.0],
                [51.0, 32.0, 87.0],
                [70.0, 35.0, 84.0],
                [75.0, 38.0, 85.0],
                [88.0, 31.0, 82.0],
                [96.0, 37.0, 81.0],
                [1.0, 45.0, 83.0],
                [15.0, 45.0, 83.0],
                [23.0, 49.0, 85.0],
                [35.0, 40.0, 84.0],
                [44.0, 46.0, 80.0],
                [57.0, 42.0, 83.0],
                [69.0, 46.0, 80.0],
                [74.0, 47.0, 88.0],
                [89.0, 44.0, 90.0],
                [100.0, 49.0, 84.0],
                [1.0, 58.0, 86.0],
                [15.0, 59.0, 80.0],
                [20.0, 54.0, 88.0],
                [29.0, 51.0, 82.0],
                [39.0, 58.0, 89.0],
                [55.0, 51.0, 86.0],
                [64.0, 58.0, 89.0],
                [72.0, 59.0, 87.0],
                [90.0, 57.0, 87.0],
                [97.0, 56.0, 89.0],
                [4.0, 66.0, 83.0],
                [10.0, 71.0, 83.0],
                [22.0, 69.0, 83.0],
                [34.0, 63.0, 87.0],
                [46.0, 68.0, 80.0],
                [56.0, 65.0, 86.0],
                [68.0, 63.0, 81.0],
                [81.0, 66.0, 82.0],
                [85.0, 69.0, 85.0],
                [95.0, 62.0, 87.0],
                [2.0, 73.0, 89.0],
                [14.0, 75.0, 89.0],
                [19.0, 74.0, 88.0],
                [34.0, 80.0, 83.0],
                [48.0, 80.0, 90.0],
                [52.0, 82.0, 85.0],
                [69.0, 79.0, 87.0],
                [81.0, 75.0, 81.0],
                [87.0, 79.0, 84.0],
                [98.0, 78.0, 83.0],
                [-2.0, 92.0, 87.0],
                [10.0, 92.0, 83.0],
                [21.0, 84.0, 81.0],
                [28.0, 86.0, 85.0],
                [47.0, 86.0, 90.0],
                [55.0, 89.0, 89.0],
                [71.0, 85.0, 89.0],
                [80.0, 85.0, 84.0],
                [92.0, 85.0, 84.0],
                [102.0, 83.0, 89.0],
                [4.0, 98.0, 83.0],
                [14.0, 98.0, 89.0],
                [21.0, 98.0, 81.0],
                [36.0, 100.0, 82.0],
                [42.0, 100.0, 88.0],
                [58.0, 99.0, 83.0],
                [62.0, 97.0, 83.0],
                [77.0, 99.0, 87.0],
                [93.0, 103.0, 87.0],
                [95.0, 98.0, 88.0],
                [-4.0, -3.0, 100.0],
                [8.0, -5.0, 102.0],
                [21.0, 3.0, 95.0],
                [31.0, -4.0, 96.0],
                [46.0, 1.0, 101.0],
                [58.0, 4.0, 96.0],
                [65.0, -1.0, 97.0],
                [77.0, -5.0, 104.0],
                [93.0, 3.0, 104.0],
                [96.0, 1.0, 101.0],
                [-2.0, 11.0, 100.0],
                [15.0, 14.0, 104.0],
                [20.0, 11.0, 103.0],
                [37.0, 8.0, 101.0],
                [46.0, 14.0, 99.0],
                [55.0, 9.0, 104.0],
                [70.0, 15.0, 97.0],
                [75.0, 16.0, 100.0],
                [88.0, 7.0, 96.0],
                [95.0, 8.0, 102.0],
                [4.0, 21.0, 99.0],
                [15.0, 24.0, 95.0],
                [20.0, 21.0, 103.0],
                [36.0, 19.0, 103.0],
                [47.0, 27.0, 102.0],
                [58.0, 25.0, 103.0],
                [62.0, 19.0, 100.0],
                [75.0, 26.0, 100.0],
                [92.0, 20.0, 102.0],
                [98.0, 19.0, 102.0],
                [-2.0, 32.0, 95.0],
                [13.0, 34.0, 95.0],
                [20.0, 32.0, 103.0],
                [28.0, 34.0, 100.0],
                [40.0, 38.0, 97.0],
                [53.0, 36.0, 104.0],
                [62.0, 36.0, 104.0],
                [73.0, 34.0, 99.0],
                [86.0, 30.0, 103.0],
                [104.0, 33.0, 100.0],
                [0.0, 47.0, 101.0],
                [10.0, 45.0, 99.0],
                [19.0, 45.0, 103.0],
                [31.0, 45.0, 95.0],
                [42.0, 42.0, 99.0],
                [51.0, 42.0, 99.0],
                [61.0, 40.0, 101.0],
                [72.0, 41.0, 104.0],
                [86.0, 42.0, 102.0],
                [97.0, 47.0, 103.0],
                [4.0, 53.0, 97.0],
                [9.0, 57.0, 97.0],
                [22.0, 50.0, 104.0],
                [33.0, 57.0, 99.0],
                [45.0, 55.0, 102.0],
                [59.0, 52.0, 104.0],
                [71.0, 60.0, 104.0],
                [80.0, 59.0, 101.0],
                [84.0, 53.0, 104.0],
                [97.0, 54.0, 98.0],
                [4.0, 64.0, 104.0],
                [13.0, 63.0, 98.0],
                [25.0, 69.0, 95.0],
                [30.0, 67.0, 100.0],
                [39.0, 69.0, 104.0],
                [56.0, 63.0, 95.0],
                [66.0, 69.0, 101.0],
                [77.0, 62.0, 104.0],
                [92.0, 63.0, 96.0],
                [103.0, 65.0, 97.0],
                [1.0, 80.0, 104.0],
                [10.0, 76.0, 95.0],
                [26.0, 79.0, 99.0],
                [30.0, 82.0, 104.0],
                [42.0, 73.0, 103.0],
                [51.0, 80.0, 100.0],
                [62.0, 75.0, 98.0],
                [80.0, 75.0, 97.0],
                [89.0, 75.0, 100.0],
                [97.0, 75.0, 95.0],
                [2.0, 87.0, 95.0],
                [14.0, 90.0, 97.0],
                [23.0, 85.0, 95.0],
                [36.0, 83.0, 104.0],
                [44.0, 92.0, 103.0],
                [57.0, 91.0, 104.0],
                [65.0, 90.0, 102.0],
                [81.0, 85.0, 104.0],
                [84.0, 90.0, 104.0],
                [104.0, 88.0, 98.0],
                [-2.0, 101.0, 99.0],
                [6.0, 100.0, 101.0],
                [23.0, 98.0, 99.0],
                [30.0, 96.0, 103.0],
                [41.0, 95.0, 96.0],
                [59.0, 103.0, 95.0],
                [63.0, 101.0, 99.0],
                [76.0, 95.0, 96.0],
                [90.0, 96.0, 96.0],
                [95.0, 95.0, 103.0],
            ]
        )
        basis0 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9, 2.3, 3.2, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        basis1 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.2, 2.2, 3.2, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        basis2 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0])
        )
        vol = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2.mirror([0, 1, 0])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 1] = -pt2[..., 1]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_3D_p5_C0_periodic(self):
        controlpoints = np.array(
            [
                [101.0, 3.0, -1.0],
                [64.0, 74.0, 1.0],
                [-24.0, 94.0, -4.0],
                [-95.0, 39.0, 4.0],
                [-88.0, -44.0, 4.0],
                [-23.0, -101.0, -3.0],
                [66.0, -83.0, 2.0],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([-1.0, 0.0, 0.0, 0.0, 0.0, 1.3, 1.7, 3.0, 4.0, 4.0, 4.0, 4.0, 5.3]), 0
        )
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 += np.array([0.9, 4.2, 0.0])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 0.900000
        pt2[..., 1] -= 4.200000
        pt2[..., 2] -= 0.000000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_3D_p7_C0_periodic(self):
        controlpoints = np.array(
            [
                [99.0, -2.0, 1.0],
                [85.0, 49.0, -1.0],
                [46.0, 87.0, -1.0],
                [3.0, 99.0, 0.0],
                [-55.0, 84.0, -2.0],
                [-83.0, 45.0, 4.0],
                [-104.0, 2.0, 2.0],
                [-83.0, -49.0, 0.0],
                [-48.0, -90.0, -3.0],
                [-4.0, -97.0, -1.0],
                [53.0, -87.0, 0.0],
                [83.0, -51.0, -1.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    -1.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.7,
                    2.3,
                    2.7,
                    4.0,
                    5.2,
                    6.0,
                    7.0,
                    7.0,
                    7.0,
                    7.0,
                    7.0,
                    7.0,
                    7.7,
                ]
            ),
            0,
        )
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 *= np.array([4.8, 9.4, 6.9])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 4.800000
        pt2[..., 1] /= 9.400000
        pt2[..., 2] /= 6.900000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_curve_3D_p7_C0_periodic(self):
        controlpoints = np.array(
            [
                [100.0, 2.0, -5.0],
                [73.0, 67.0, -1.0],
                [21.0, 103.0, 2.0],
                [-53.0, 85.0, -2.0],
                [-90.0, 37.0, -1.0],
                [-97.0, -32.0, -2.0],
                [-51.0, -82.0, -5.0],
                [13.0, -97.0, 0.0],
                [81.0, -66.0, 1.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array([-0.9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.3, 2.1, 3.1, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 5.3]),
            0,
        )
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2.mirror([0, 1, 0])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 1] = -pt2[..., 1]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_3D_p75_C0_periodic(self):
        controlpoints = np.array(
            [
                [58.0, 2.0, -1.0],
                [53.0, 31.0, -2.0],
                [23.0, 59.0, -1.0],
                [-8.0, 59.0, 1.0],
                [-39.0, 44.0, 2.0],
                [-63.0, 20.0, -5.0],
                [-61.0, -14.0, -4.0],
                [-41.0, -47.0, -1.0],
                [-13.0, -58.0, -5.0],
                [27.0, -51.0, -2.0],
                [52.0, -31.0, -4.0],
                [61.0, -1.0, 1.0],
                [52.0, 37.0, -3.0],
                [24.0, 56.0, -5.0],
                [-9.0, 64.0, -3.0],
                [-38.0, 50.0, -5.0],
                [-60.0, 18.0, -1.0],
                [-64.0, -22.0, 1.0],
                [-47.0, -48.0, -2.0],
                [-7.0, -63.0, 0.0],
                [21.0, -57.0, 3.0],
                [55.0, -34.0, 2.0],
                [64.0, -3.0, 3.0],
                [61.0, 40.0, -4.0],
                [33.0, 65.0, -5.0],
                [-13.0, 66.0, -4.0],
                [-48.0, 50.0, -5.0],
                [-69.0, 16.0, -4.0],
                [-69.0, -21.0, 2.0],
                [-50.0, -55.0, 3.0],
                [-14.0, -66.0, -3.0],
                [27.0, -64.0, 2.0],
                [57.0, -41.0, 2.0],
                [77.0, -3.0, -1.0],
                [57.0, 40.0, 1.0],
                [27.0, 65.0, 1.0],
                [-6.0, 69.0, -3.0],
                [-46.0, 56.0, 4.0],
                [-75.0, 22.0, -1.0],
                [-70.0, -23.0, -1.0],
                [-52.0, -55.0, -5.0],
                [-10.0, -73.0, 2.0],
                [35.0, -64.0, 0.0],
                [62.0, -36.0, -5.0],
                [81.0, 3.0, -5.0],
                [61.0, 40.0, 2.0],
                [33.0, 72.0, -2.0],
                [-13.0, 80.0, 1.0],
                [-53.0, 57.0, -2.0],
                [-77.0, 18.0, 0.0],
                [-77.0, -24.0, 3.0],
                [-51.0, -55.0, 1.0],
                [-11.0, -78.0, -2.0],
                [33.0, -70.0, -2.0],
                [62.0, -46.0, 4.0],
                [77.0, -1.0, -1.0],
                [65.0, 44.0, -2.0],
                [36.0, 76.0, -2.0],
                [-12.0, 85.0, -4.0],
                [-51.0, 59.0, -5.0],
                [-78.0, 24.0, -2.0],
                [-80.0, -25.0, -3.0],
                [-54.0, -61.0, -5.0],
                [-16.0, -83.0, 4.0],
                [31.0, -74.0, -4.0],
                [68.0, -40.0, -1.0],
                [84.0, -2.0, 0.0],
                [68.0, 49.0, 4.0],
                [33.0, 81.0, -4.0],
                [-10.0, 90.0, -5.0],
                [-62.0, 70.0, 1.0],
                [-86.0, 27.0, 2.0],
                [-88.0, -20.0, -1.0],
                [-53.0, -70.0, -4.0],
                [-14.0, -88.0, -5.0],
                [33.0, -74.0, 3.0],
                [76.0, -48.0, -5.0],
                [90.0, -2.0, 0.0],
                [78.0, 52.0, 3.0],
                [36.0, 83.0, -2.0],
                [-15.0, 89.0, -3.0],
                [-58.0, 70.0, 1.0],
                [-84.0, 20.0, -3.0],
                [-84.0, -25.0, 1.0],
                [-64.0, -74.0, -2.0],
                [-17.0, -95.0, 0.0],
                [40.0, -84.0, -5.0],
                [72.0, -46.0, 4.0],
                [94.0, 2.0, -5.0],
                [80.0, 53.0, -4.0],
                [37.0, 87.0, -1.0],
                [-10.0, 93.0, 2.0],
                [-64.0, 72.0, -2.0],
                [-90.0, 22.0, -1.0],
                [-89.0, -25.0, -4.0],
                [-62.0, -75.0, 3.0],
                [-12.0, -93.0, -4.0],
                [43.0, -92.0, 1.0],
                [80.0, -55.0, 3.0],
                [97.0, 0.0, 3.0],
                [88.0, 54.0, -3.0],
                [41.0, 95.0, -3.0],
                [-11.0, 97.0, -5.0],
                [-66.0, 76.0, 2.0],
                [-101.0, 26.0, 1.0],
                [-93.0, -27.0, 0.0],
                [-67.0, -77.0, 3.0],
                [-16.0, -97.0, 2.0],
                [37.0, -92.0, -4.0],
                [84.0, -55.0, -2.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    -1.1,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.7,
                    1.7,
                    3.3,
                    3.9,
                    4.9,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.7,
                ]
            ),
            0,
        )
        basis1 = BSplineBasis(
            5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 1.3, 2.1, 3.2, 4.0, 5.1, 6.0, 6.0, 6.0, 6.0, 6.0])
        )
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 += np.array([1.4, 7.6, 3.7])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 1.400000
        pt2[..., 1] -= 7.600000
        pt2[..., 2] -= 3.700000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_surface_3D_p67_C0_periodic(self):
        controlpoints = np.array(
            [
                [56.0, 2.0, 4.0],
                [46.0, 33.0, 4.0],
                [14.0, 55.0, -4.0],
                [-22.0, 56.0, -1.0],
                [-48.0, 36.0, 3.0],
                [-64.0, -5.0, 2.0],
                [-45.0, -35.0, 3.0],
                [-19.0, -61.0, -2.0],
                [18.0, -58.0, -1.0],
                [52.0, -35.0, -5.0],
                [59.0, -4.0, -5.0],
                [48.0, 41.0, -4.0],
                [24.0, 63.0, -5.0],
                [-15.0, 59.0, 0.0],
                [-48.0, 41.0, 2.0],
                [-66.0, 2.0, -4.0],
                [-48.0, -38.0, -5.0],
                [-22.0, -61.0, 4.0],
                [21.0, -62.0, 4.0],
                [56.0, -41.0, -3.0],
                [71.0, 1.0, 2.0],
                [55.0, 38.0, -4.0],
                [16.0, 66.0, 0.0],
                [-23.0, 66.0, -4.0],
                [-56.0, 42.0, 3.0],
                [-73.0, -1.0, -5.0],
                [-59.0, -37.0, 2.0],
                [-19.0, -68.0, -5.0],
                [16.0, -67.0, 4.0],
                [56.0, -40.0, -4.0],
                [72.0, 3.0, -1.0],
                [62.0, 44.0, -1.0],
                [26.0, 69.0, 4.0],
                [-21.0, 68.0, -2.0],
                [-57.0, 43.0, 0.0],
                [-72.0, -2.0, 4.0],
                [-62.0, -40.0, 3.0],
                [-26.0, -64.0, -3.0],
                [25.0, -69.0, -2.0],
                [62.0, -48.0, 1.0],
                [76.0, -4.0, 4.0],
                [64.0, 43.0, -5.0],
                [21.0, 70.0, -2.0],
                [-27.0, 72.0, -5.0],
                [-65.0, 40.0, 3.0],
                [-74.0, -5.0, 1.0],
                [-62.0, -44.0, -1.0],
                [-26.0, -68.0, -4.0],
                [26.0, -74.0, -3.0],
                [65.0, -45.0, 1.0],
                [75.0, -2.0, 3.0],
                [66.0, 46.0, -5.0],
                [21.0, 72.0, -5.0],
                [-30.0, 75.0, -4.0],
                [-67.0, 46.0, -5.0],
                [-84.0, 2.0, -2.0],
                [-61.0, -47.0, 2.0],
                [-25.0, -74.0, -3.0],
                [23.0, -73.0, -4.0],
                [65.0, -45.0, -4.0],
                [81.0, -2.0, 0.0],
                [67.0, 44.0, -1.0],
                [28.0, 76.0, 3.0],
                [-26.0, 77.0, -5.0],
                [-64.0, 48.0, -4.0],
                [-84.0, -3.0, 3.0],
                [-70.0, -51.0, -4.0],
                [-24.0, -85.0, 0.0],
                [29.0, -81.0, 2.0],
                [68.0, -47.0, -4.0],
                [90.0, -1.0, 1.0],
                [67.0, 53.0, -1.0],
                [23.0, 79.0, 1.0],
                [-29.0, 86.0, -1.0],
                [-73.0, 49.0, -2.0],
                [-88.0, 2.0, 4.0],
                [-72.0, -50.0, 2.0],
                [-26.0, -84.0, -2.0],
                [23.0, -81.0, 2.0],
                [68.0, -52.0, -1.0],
                [87.0, 4.0, -4.0],
                [70.0, 52.0, 0.0],
                [24.0, 83.0, 0.0],
                [-25.0, 85.0, -3.0],
                [-73.0, 53.0, 2.0],
                [-90.0, -2.0, -5.0],
                [-70.0, -50.0, 0.0],
                [-28.0, -89.0, 2.0],
                [28.0, -86.0, 2.0],
                [77.0, -52.0, -2.0],
                [99.0, 1.0, -4.0],
                [79.0, 53.0, 1.0],
                [32.0, 95.0, 4.0],
                [-28.0, 93.0, -2.0],
                [-78.0, 56.0, 2.0],
                [-95.0, -3.0, 3.0],
                [-78.0, -55.0, -1.0],
                [-32.0, -92.0, 3.0],
                [32.0, -92.0, 1.0],
                [72.0, -53.0, -4.0],
                [101.0, 4.0, -3.0],
                [78.0, 56.0, 3.0],
                [28.0, 97.0, -2.0],
                [-31.0, 99.0, -3.0],
                [-81.0, 61.0, 2.0],
                [-102.0, -1.0, 0.0],
                [-78.0, -63.0, 4.0],
                [-35.0, -95.0, 4.0],
                [28.0, -96.0, -1.0],
                [77.0, -55.0, -2.0],
            ]
        )
        basis0 = BSplineBasis(
            6,
            np.array([-1.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9, 2.0, 3.1, 4.1, 4.8, 6.0, 6.0, 6.0, 6.0, 6.0, 6.9]),
            0,
        )
        basis1 = BSplineBasis(
            7,
            np.array(
                [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1, 1.9, 3.1, 3.9, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0]
            ),
        )
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 *= np.array([3.2, 10.2, 5.6])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 3.200000
        pt2[..., 1] /= 10.200000
        pt2[..., 2] /= 5.600000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_surface_3D_p75_C0_periodic(self):
        controlpoints = np.array(
            [
                [61.0, -3.0, -4.0],
                [52.0, 28.0, 2.0],
                [25.0, 55.0, -2.0],
                [-10.0, 62.0, 4.0],
                [-35.0, 46.0, 3.0],
                [-60.0, 12.0, -4.0],
                [-56.0, -17.0, 1.0],
                [-35.0, -41.0, 0.0],
                [-9.0, -62.0, -4.0],
                [29.0, -51.0, -1.0],
                [50.0, -37.0, -1.0],
                [70.0, -1.0, 2.0],
                [56.0, 31.0, -5.0],
                [29.0, 61.0, -1.0],
                [-9.0, 62.0, 0.0],
                [-48.0, 45.0, 0.0],
                [-67.0, 20.0, -3.0],
                [-62.0, -21.0, 3.0],
                [-42.0, -51.0, 3.0],
                [-10.0, -66.0, 3.0],
                [30.0, -58.0, -5.0],
                [60.0, -35.0, -1.0],
                [69.0, 1.0, 3.0],
                [59.0, 43.0, 1.0],
                [31.0, 68.0, -3.0],
                [-9.0, 68.0, 4.0],
                [-47.0, 50.0, 2.0],
                [-69.0, 21.0, -5.0],
                [-73.0, -26.0, 4.0],
                [-44.0, -58.0, -1.0],
                [-8.0, -71.0, -1.0],
                [33.0, -63.0, 1.0],
                [63.0, -43.0, -3.0],
                [84.0, 2.0, 2.0],
                [63.0, 41.0, -5.0],
                [29.0, 73.0, 4.0],
                [-7.0, 78.0, -3.0],
                [-52.0, 58.0, 3.0],
                [-75.0, 23.0, -4.0],
                [-74.0, -25.0, -1.0],
                [-51.0, -58.0, -1.0],
                [-11.0, -78.0, -5.0],
                [36.0, -75.0, 1.0],
                [63.0, -40.0, -4.0],
                [90.0, 4.0, -3.0],
                [72.0, 43.0, -3.0],
                [34.0, 76.0, 0.0],
                [-10.0, 80.0, -2.0],
                [-54.0, 67.0, 2.0],
                [-82.0, 27.0, 0.0],
                [-87.0, -26.0, 2.0],
                [-60.0, -62.0, -3.0],
                [-13.0, -81.0, -3.0],
                [39.0, -84.0, 2.0],
                [75.0, -51.0, 0.0],
                [95.0, 3.0, 3.0],
                [78.0, 46.0, -2.0],
                [39.0, 80.0, 2.0],
                [-11.0, 92.0, 3.0],
                [-63.0, 66.0, -4.0],
                [-86.0, 30.0, 4.0],
                [-93.0, -31.0, 4.0],
                [-60.0, -70.0, -1.0],
                [-18.0, -89.0, 1.0],
                [38.0, -87.0, -2.0],
                [82.0, -47.0, -1.0],
                [102.0, -4.0, 4.0],
                [88.0, 56.0, 2.0],
                [37.0, 88.0, 1.0],
                [-12.0, 103.0, -3.0],
                [-67.0, 75.0, 0.0],
                [-97.0, 25.0, -1.0],
                [-99.0, -29.0, -4.0],
                [-65.0, -74.0, -3.0],
                [-15.0, -95.0, 1.0],
                [43.0, -93.0, -2.0],
                [89.0, -57.0, 0.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    -0.9,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.3,
                    1.7,
                    3.2,
                    3.7,
                    5.1,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    7.3,
                ]
            ),
            0,
        )
        basis1 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 1.4, 1.7, 3.0, 3.0, 3.0, 3.0, 3.0]))
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2.mirror([1, 0, 0])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] = -pt2[..., 0]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_volume_3D_p756_C0_periodic(self):
        controlpoints = np.array(
            [
                [53.0, -4.0, -1.0],
                [32.0, 38.0, 4.0],
                [2.0, 45.0, -1.0],
                [-32.0, 31.0, -5.0],
                [-49.0, -2.0, -5.0],
                [-36.0, -33.0, -2.0],
                [-4.0, -50.0, -1.0],
                [33.0, -33.0, -1.0],
                [53.0, -1.0, -5.0],
                [36.0, 40.0, -5.0],
                [0.0, 62.0, 2.0],
                [-39.0, 36.0, -3.0],
                [-54.0, 2.0, 1.0],
                [-37.0, -46.0, 0.0],
                [-3.0, -56.0, -1.0],
                [45.0, -44.0, -5.0],
                [60.0, 3.0, 3.0],
                [48.0, 41.0, 3.0],
                [-4.0, 67.0, -4.0],
                [-42.0, 43.0, -5.0],
                [-70.0, -5.0, -5.0],
                [-46.0, -50.0, -5.0],
                [-1.0, -66.0, -3.0],
                [50.0, -49.0, -5.0],
                [72.0, -5.0, 2.0],
                [49.0, 47.0, 3.0],
                [0.0, 74.0, 3.0],
                [-49.0, 50.0, -1.0],
                [-68.0, 3.0, 2.0],
                [-47.0, -54.0, 1.0],
                [3.0, -77.0, -1.0],
                [47.0, -51.0, 3.0],
                [81.0, 1.0, 0.0],
                [59.0, 52.0, 0.0],
                [-2.0, 83.0, -1.0],
                [-61.0, 58.0, -1.0],
                [-75.0, 2.0, -4.0],
                [-55.0, -57.0, 0.0],
                [-2.0, -82.0, 4.0],
                [54.0, -52.0, -3.0],
                [84.0, 0.0, -5.0],
                [60.0, 56.0, 0.0],
                [0.0, 83.0, 2.0],
                [-60.0, 63.0, 3.0],
                [-82.0, 2.0, -4.0],
                [-63.0, -58.0, -5.0],
                [-1.0, -83.0, -3.0],
                [64.0, -57.0, 3.0],
                [97.0, 4.0, -3.0],
                [61.0, 62.0, -2.0],
                [-4.0, 93.0, -5.0],
                [-69.0, 67.0, -5.0],
                [-90.0, -3.0, 3.0],
                [-64.0, -61.0, 1.0],
                [-4.0, -96.0, 1.0],
                [68.0, -61.0, 1.0],
                [103.0, 2.0, 4.0],
                [69.0, 74.0, 0.0],
                [-4.0, 101.0, -3.0],
                [-67.0, 67.0, -4.0],
                [-98.0, 4.0, -4.0],
                [-67.0, -70.0, 2.0],
                [-4.0, -98.0, -4.0],
                [68.0, -74.0, -3.0],
                [54.0, 3.0, 8.0],
                [33.0, 33.0, 7.0],
                [-2.0, 47.0, 5.0],
                [-34.0, 31.0, 5.0],
                [-47.0, -1.0, 1.0],
                [-36.0, -36.0, 6.0],
                [-4.0, -55.0, 7.0],
                [34.0, -35.0, 6.0],
                [60.0, 3.0, 0.0],
                [38.0, 39.0, 0.0],
                [4.0, 55.0, 4.0],
                [-41.0, 43.0, 3.0],
                [-58.0, -3.0, 0.0],
                [-45.0, -46.0, 7.0],
                [-3.0, -59.0, -1.0],
                [35.0, -41.0, 2.0],
                [61.0, 3.0, 1.0],
                [42.0, 49.0, 4.0],
                [0.0, 67.0, 6.0],
                [-47.0, 45.0, 7.0],
                [-69.0, -3.0, 2.0],
                [-45.0, -50.0, 8.0],
                [-2.0, -61.0, 8.0],
                [41.0, -43.0, 1.0],
                [75.0, 1.0, 4.0],
                [45.0, 50.0, 8.0],
                [-2.0, 69.0, 7.0],
                [-51.0, 54.0, 8.0],
                [-74.0, 4.0, 5.0],
                [-47.0, -56.0, 2.0],
                [-5.0, -67.0, 0.0],
                [54.0, -55.0, 4.0],
                [76.0, 3.0, 6.0],
                [56.0, 51.0, 7.0],
                [-3.0, 79.0, 0.0],
                [-58.0, 52.0, 1.0],
                [-83.0, -4.0, 1.0],
                [-53.0, -58.0, -1.0],
                [-4.0, -77.0, -1.0],
                [60.0, -51.0, 0.0],
                [90.0, 3.0, 7.0],
                [59.0, 56.0, 1.0],
                [-5.0, 82.0, 0.0],
                [-62.0, 65.0, 6.0],
                [-83.0, -4.0, 4.0],
                [-66.0, -58.0, 8.0],
                [1.0, -89.0, 7.0],
                [61.0, -56.0, 0.0],
                [89.0, -5.0, 8.0],
                [65.0, 64.0, -1.0],
                [1.0, 96.0, 0.0],
                [-68.0, 65.0, 3.0],
                [-96.0, 3.0, 2.0],
                [-65.0, -63.0, 1.0],
                [-3.0, -94.0, 7.0],
                [68.0, -61.0, 3.0],
                [98.0, -1.0, 2.0],
                [75.0, 70.0, 0.0],
                [-3.0, 96.0, 4.0],
                [-68.0, 69.0, 1.0],
                [-102.0, 2.0, 6.0],
                [-69.0, -67.0, 6.0],
                [-5.0, -103.0, 5.0],
                [70.0, -74.0, 1.0],
                [52.0, -1.0, 8.0],
                [33.0, 30.0, 9.0],
                [0.0, 48.0, 6.0],
                [-35.0, 35.0, 10.0],
                [-52.0, -4.0, 7.0],
                [-32.0, -33.0, 7.0],
                [-2.0, -47.0, 8.0],
                [31.0, -38.0, 7.0],
                [61.0, 0.0, 5.0],
                [35.0, 35.0, 7.0],
                [2.0, 57.0, 5.0],
                [-37.0, 40.0, 10.0],
                [-61.0, -4.0, 4.0],
                [-40.0, -38.0, 7.0],
                [2.0, -59.0, 3.0],
                [42.0, -36.0, 12.0],
                [65.0, -2.0, 4.0],
                [43.0, 40.0, 9.0],
                [0.0, 62.0, 6.0],
                [-41.0, 41.0, 4.0],
                [-60.0, -2.0, 11.0],
                [-47.0, -49.0, 3.0],
                [-2.0, -63.0, 12.0],
                [48.0, -48.0, 10.0],
                [69.0, -4.0, 5.0],
                [53.0, 48.0, 10.0],
                [1.0, 74.0, 12.0],
                [-46.0, 51.0, 7.0],
                [-76.0, 3.0, 4.0],
                [-48.0, -56.0, 5.0],
                [0.0, -77.0, 8.0],
                [49.0, -53.0, 11.0],
                [80.0, 2.0, 5.0],
                [58.0, 58.0, 9.0],
                [1.0, 82.0, 9.0],
                [-59.0, 52.0, 3.0],
                [-78.0, -2.0, 5.0],
                [-58.0, -54.0, 3.0],
                [1.0, -76.0, 3.0],
                [55.0, -56.0, 3.0],
                [89.0, 4.0, 12.0],
                [61.0, 58.0, 8.0],
                [-4.0, 84.0, 3.0],
                [-63.0, 59.0, 5.0],
                [-89.0, -3.0, 6.0],
                [-63.0, -66.0, 10.0],
                [-1.0, -85.0, 4.0],
                [58.0, -61.0, 8.0],
                [94.0, -1.0, 4.0],
                [67.0, 65.0, 10.0],
                [-1.0, 90.0, 6.0],
                [-64.0, 62.0, 5.0],
                [-97.0, -2.0, 10.0],
                [-62.0, -66.0, 7.0],
                [3.0, -91.0, 11.0],
                [66.0, -62.0, 5.0],
                [98.0, 0.0, 3.0],
                [69.0, 68.0, 4.0],
                [-4.0, 96.0, 5.0],
                [-66.0, 73.0, 11.0],
                [-101.0, 4.0, 10.0],
                [-72.0, -75.0, 6.0],
                [1.0, -105.0, 3.0],
                [71.0, -67.0, 12.0],
                [47.0, 0.0, 8.0],
                [36.0, 33.0, 14.0],
                [-1.0, 48.0, 11.0],
                [-31.0, 34.0, 11.0],
                [-52.0, -3.0, 7.0],
                [-34.0, -39.0, 14.0],
                [2.0, -51.0, 10.0],
                [34.0, -41.0, 12.0],
                [55.0, -2.0, 11.0],
                [42.0, 35.0, 11.0],
                [4.0, 62.0, 11.0],
                [-42.0, 36.0, 9.0],
                [-54.0, 4.0, 11.0],
                [-36.0, -44.0, 14.0],
                [4.0, -57.0, 14.0],
                [36.0, -45.0, 13.0],
                [59.0, -1.0, 10.0],
                [48.0, 45.0, 15.0],
                [-5.0, 59.0, 10.0],
                [-46.0, 44.0, 11.0],
                [-67.0, -5.0, 8.0],
                [-47.0, -41.0, 8.0],
                [4.0, -61.0, 16.0],
                [45.0, -50.0, 9.0],
                [74.0, 0.0, 13.0],
                [54.0, 51.0, 14.0],
                [2.0, 70.0, 10.0],
                [-50.0, 49.0, 13.0],
                [-77.0, -4.0, 10.0],
                [-53.0, -54.0, 8.0],
                [3.0, -77.0, 10.0],
                [51.0, -55.0, 12.0],
                [82.0, 0.0, 12.0],
                [59.0, 56.0, 12.0],
                [-4.0, 79.0, 8.0],
                [-57.0, 59.0, 8.0],
                [-83.0, 2.0, 8.0],
                [-61.0, -56.0, 8.0],
                [-4.0, -80.0, 9.0],
                [51.0, -56.0, 9.0],
                [81.0, 1.0, 16.0],
                [63.0, 63.0, 10.0],
                [3.0, 88.0, 14.0],
                [-57.0, 62.0, 7.0],
                [-85.0, -3.0, 12.0],
                [-65.0, -61.0, 14.0],
                [4.0, -87.0, 14.0],
                [57.0, -57.0, 13.0],
                [95.0, 4.0, 10.0],
                [62.0, 67.0, 7.0],
                [3.0, 92.0, 11.0],
                [-68.0, 68.0, 11.0],
                [-91.0, -1.0, 13.0],
                [-64.0, -68.0, 13.0],
                [1.0, -98.0, 14.0],
                [61.0, -71.0, 9.0],
                [95.0, -3.0, 13.0],
                [72.0, 73.0, 14.0],
                [3.0, 98.0, 9.0],
                [-67.0, 69.0, 7.0],
                [-98.0, -3.0, 8.0],
                [-76.0, -72.0, 15.0],
                [1.0, -101.0, 9.0],
                [71.0, -68.0, 9.0],
                [51.0, 1.0, 19.0],
                [34.0, 31.0, 18.0],
                [0.0, 52.0, 19.0],
                [-37.0, 34.0, 18.0],
                [-55.0, -5.0, 20.0],
                [-40.0, -36.0, 13.0],
                [2.0, -51.0, 14.0],
                [38.0, -38.0, 17.0],
                [54.0, 2.0, 19.0],
                [39.0, 35.0, 15.0],
                [-4.0, 52.0, 13.0],
                [-42.0, 38.0, 13.0],
                [-60.0, 2.0, 15.0],
                [-44.0, -40.0, 19.0],
                [2.0, -56.0, 11.0],
                [37.0, -38.0, 20.0],
                [62.0, -2.0, 12.0],
                [50.0, 41.0, 18.0],
                [4.0, 65.0, 18.0],
                [-47.0, 45.0, 17.0],
                [-61.0, 4.0, 13.0],
                [-49.0, -46.0, 13.0],
                [-4.0, -60.0, 18.0],
                [40.0, -48.0, 13.0],
                [69.0, 3.0, 13.0],
                [47.0, 53.0, 18.0],
                [2.0, 75.0, 20.0],
                [-48.0, 46.0, 16.0],
                [-74.0, 4.0, 11.0],
                [-56.0, -47.0, 20.0],
                [3.0, -70.0, 11.0],
                [55.0, -55.0, 14.0],
                [75.0, 2.0, 16.0],
                [60.0, 50.0, 20.0],
                [2.0, 80.0, 20.0],
                [-52.0, 55.0, 17.0],
                [-81.0, 2.0, 16.0],
                [-53.0, -53.0, 17.0],
                [3.0, -80.0, 13.0],
                [56.0, -51.0, 20.0],
                [89.0, -1.0, 19.0],
                [65.0, 64.0, 16.0],
                [-2.0, 81.0, 18.0],
                [-60.0, 56.0, 15.0],
                [-88.0, 1.0, 15.0],
                [-62.0, -61.0, 19.0],
                [3.0, -89.0, 16.0],
                [62.0, -57.0, 14.0],
                [96.0, -3.0, 14.0],
                [64.0, 67.0, 18.0],
                [-5.0, 97.0, 17.0],
                [-67.0, 61.0, 18.0],
                [-93.0, -3.0, 13.0],
                [-66.0, -66.0, 18.0],
                [0.0, -91.0, 20.0],
                [60.0, -70.0, 12.0],
                [103.0, 0.0, 12.0],
                [67.0, 70.0, 19.0],
                [1.0, 102.0, 20.0],
                [-72.0, 67.0, 12.0],
                [-98.0, -5.0, 20.0],
                [-73.0, -73.0, 20.0],
                [-3.0, -101.0, 12.0],
                [66.0, -71.0, 17.0],
                [49.0, 0.0, 20.0],
                [30.0, 30.0, 23.0],
                [-3.0, 45.0, 16.0],
                [-40.0, 32.0, 19.0],
                [-53.0, 1.0, 18.0],
                [-32.0, -35.0, 22.0],
                [0.0, -51.0, 17.0],
                [39.0, -31.0, 22.0],
                [60.0, 4.0, 22.0],
                [43.0, 36.0, 24.0],
                [1.0, 52.0, 22.0],
                [-41.0, 38.0, 24.0],
                [-58.0, 3.0, 20.0],
                [-36.0, -45.0, 16.0],
                [-5.0, -61.0, 23.0],
                [35.0, -38.0, 19.0],
                [60.0, 3.0, 23.0],
                [45.0, 45.0, 23.0],
                [-4.0, 62.0, 24.0],
                [-43.0, 50.0, 24.0],
                [-63.0, 1.0, 23.0],
                [-47.0, -50.0, 17.0],
                [-5.0, -67.0, 15.0],
                [49.0, -51.0, 16.0],
                [71.0, 2.0, 17.0],
                [52.0, 45.0, 23.0],
                [0.0, 72.0, 21.0],
                [-49.0, 53.0, 22.0],
                [-75.0, 3.0, 17.0],
                [-53.0, -48.0, 20.0],
                [4.0, -75.0, 23.0],
                [45.0, -55.0, 20.0],
                [79.0, 1.0, 21.0],
                [58.0, 55.0, 17.0],
                [-3.0, 79.0, 19.0],
                [-55.0, 50.0, 24.0],
                [-83.0, -4.0, 17.0],
                [-54.0, -52.0, 16.0],
                [-2.0, -77.0, 22.0],
                [59.0, -56.0, 22.0],
                [85.0, 0.0, 20.0],
                [61.0, 61.0, 20.0],
                [-4.0, 89.0, 22.0],
                [-62.0, 65.0, 19.0],
                [-83.0, 1.0, 18.0],
                [-59.0, -62.0, 19.0],
                [-5.0, -82.0, 21.0],
                [58.0, -61.0, 19.0],
                [96.0, 3.0, 18.0],
                [64.0, 61.0, 18.0],
                [-5.0, 93.0, 24.0],
                [-71.0, 61.0, 19.0],
                [-89.0, -1.0, 17.0],
                [-70.0, -69.0, 15.0],
                [2.0, -93.0, 24.0],
                [69.0, -69.0, 16.0],
                [102.0, -1.0, 17.0],
                [71.0, 67.0, 17.0],
                [-3.0, 104.0, 23.0],
                [-71.0, 67.0, 18.0],
                [-96.0, 2.0, 19.0],
                [-71.0, -76.0, 20.0],
                [3.0, -104.0, 19.0],
                [67.0, -67.0, 24.0],
                [52.0, -2.0, 20.0],
                [36.0, 30.0, 28.0],
                [-3.0, 54.0, 19.0],
                [-32.0, 31.0, 20.0],
                [-47.0, 2.0, 28.0],
                [-35.0, -34.0, 23.0],
                [1.0, -51.0, 25.0],
                [34.0, -32.0, 23.0],
                [53.0, 1.0, 20.0],
                [45.0, 40.0, 26.0],
                [3.0, 53.0, 23.0],
                [-44.0, 41.0, 23.0],
                [-53.0, 4.0, 25.0],
                [-43.0, -40.0, 27.0],
                [4.0, -62.0, 20.0],
                [38.0, -41.0, 24.0],
                [66.0, -2.0, 28.0],
                [40.0, 47.0, 28.0],
                [4.0, 68.0, 20.0],
                [-45.0, 41.0, 21.0],
                [-66.0, -1.0, 19.0],
                [-43.0, -51.0, 27.0],
                [2.0, -63.0, 24.0],
                [46.0, -48.0, 27.0],
                [74.0, 0.0, 26.0],
                [52.0, 45.0, 19.0],
                [-2.0, 74.0, 27.0],
                [-56.0, 49.0, 24.0],
                [-69.0, 1.0, 25.0],
                [-50.0, -46.0, 23.0],
                [-3.0, -74.0, 19.0],
                [51.0, -50.0, 22.0],
                [81.0, 2.0, 25.0],
                [52.0, 51.0, 19.0],
                [4.0, 81.0, 26.0],
                [-54.0, 58.0, 28.0],
                [-79.0, -3.0, 24.0],
                [-58.0, -53.0, 26.0],
                [4.0, -83.0, 25.0],
                [55.0, -56.0, 28.0],
                [81.0, 2.0, 28.0],
                [55.0, 63.0, 28.0],
                [0.0, 90.0, 20.0],
                [-61.0, 57.0, 19.0],
                [-89.0, -1.0, 26.0],
                [-59.0, -65.0, 21.0],
                [-4.0, -84.0, 20.0],
                [65.0, -59.0, 21.0],
                [89.0, -5.0, 24.0],
                [69.0, 62.0, 22.0],
                [2.0, 92.0, 23.0],
                [-62.0, 67.0, 22.0],
                [-89.0, -3.0, 27.0],
                [-61.0, -70.0, 20.0],
                [-4.0, -95.0, 21.0],
                [60.0, -67.0, 22.0],
                [102.0, 1.0, 25.0],
                [72.0, 74.0, 21.0],
                [1.0, 100.0, 24.0],
                [-68.0, 66.0, 25.0],
                [-100.0, 1.0, 24.0],
                [-68.0, -70.0, 28.0],
                [3.0, -101.0, 28.0],
                [70.0, -75.0, 27.0],
                [49.0, 1.0, 32.0],
                [32.0, 33.0, 26.0],
                [3.0, 54.0, 29.0],
                [-32.0, 33.0, 29.0],
                [-48.0, 4.0, 23.0],
                [-40.0, -33.0, 26.0],
                [0.0, -48.0, 25.0],
                [32.0, -39.0, 25.0],
                [58.0, -2.0, 31.0],
                [41.0, 40.0, 23.0],
                [2.0, 61.0, 24.0],
                [-36.0, 37.0, 23.0],
                [-58.0, -1.0, 26.0],
                [-36.0, -36.0, 28.0],
                [-1.0, -54.0, 28.0],
                [39.0, -44.0, 23.0],
                [63.0, -1.0, 30.0],
                [49.0, 44.0, 29.0],
                [-5.0, 63.0, 25.0],
                [-50.0, 42.0, 32.0],
                [-67.0, 2.0, 26.0],
                [-49.0, -43.0, 31.0],
                [3.0, -68.0, 23.0],
                [41.0, -47.0, 29.0],
                [75.0, 1.0, 29.0],
                [55.0, 52.0, 24.0],
                [-5.0, 69.0, 31.0],
                [-55.0, 52.0, 26.0],
                [-75.0, 2.0, 24.0],
                [-56.0, -47.0, 29.0],
                [0.0, -76.0, 27.0],
                [52.0, -53.0, 30.0],
                [76.0, 0.0, 24.0],
                [53.0, 52.0, 24.0],
                [-1.0, 81.0, 32.0],
                [-56.0, 55.0, 31.0],
                [-78.0, -1.0, 32.0],
                [-54.0, -55.0, 30.0],
                [-2.0, -78.0, 30.0],
                [50.0, -56.0, 29.0],
                [81.0, -3.0, 26.0],
                [62.0, 62.0, 30.0],
                [4.0, 88.0, 26.0],
                [-59.0, 57.0, 24.0],
                [-85.0, -4.0, 29.0],
                [-60.0, -64.0, 23.0],
                [-2.0, -91.0, 25.0],
                [62.0, -60.0, 32.0],
                [96.0, -1.0, 28.0],
                [67.0, 69.0, 26.0],
                [-2.0, 89.0, 28.0],
                [-62.0, 68.0, 27.0],
                [-95.0, -5.0, 24.0],
                [-70.0, -66.0, 26.0],
                [-4.0, -91.0, 29.0],
                [65.0, -68.0, 27.0],
                [99.0, -5.0, 25.0],
                [72.0, 67.0, 30.0],
                [-2.0, 101.0, 32.0],
                [-71.0, 74.0, 31.0],
                [-103.0, -2.0, 24.0],
                [-73.0, -75.0, 24.0],
                [4.0, -100.0, 30.0],
                [66.0, -73.0, 23.0],
                [54.0, -1.0, 34.0],
                [35.0, 33.0, 34.0],
                [3.0, 47.0, 32.0],
                [-40.0, 37.0, 32.0],
                [-49.0, -4.0, 33.0],
                [-33.0, -40.0, 36.0],
                [4.0, -49.0, 29.0],
                [40.0, -36.0, 34.0],
                [59.0, -5.0, 28.0],
                [39.0, 39.0, 29.0],
                [-3.0, 57.0, 28.0],
                [-36.0, 35.0, 35.0],
                [-55.0, -5.0, 27.0],
                [-45.0, -43.0, 31.0],
                [-5.0, -53.0, 34.0],
                [44.0, -37.0, 31.0],
                [62.0, -4.0, 32.0],
                [50.0, 48.0, 32.0],
                [-1.0, 68.0, 35.0],
                [-51.0, 44.0, 28.0],
                [-64.0, -5.0, 31.0],
                [-42.0, -50.0, 32.0],
                [0.0, -63.0, 35.0],
                [48.0, -46.0, 32.0],
                [68.0, 3.0, 32.0],
                [50.0, 52.0, 32.0],
                [-4.0, 71.0, 27.0],
                [-50.0, 48.0, 36.0],
                [-70.0, 0.0, 32.0],
                [-46.0, -53.0, 34.0],
                [-2.0, -70.0, 27.0],
                [48.0, -49.0, 36.0],
                [78.0, -3.0, 29.0],
                [52.0, 58.0, 27.0],
                [4.0, 81.0, 33.0],
                [-57.0, 58.0, 28.0],
                [-80.0, -4.0, 35.0],
                [-51.0, -56.0, 34.0],
                [-3.0, -75.0, 27.0],
                [53.0, -61.0, 33.0],
                [82.0, -5.0, 27.0],
                [59.0, 60.0, 27.0],
                [3.0, 80.0, 31.0],
                [-62.0, 58.0, 31.0],
                [-84.0, 2.0, 34.0],
                [-65.0, -58.0, 29.0],
                [-2.0, -90.0, 30.0],
                [64.0, -57.0, 32.0],
                [88.0, 4.0, 31.0],
                [70.0, 68.0, 33.0],
                [0.0, 91.0, 32.0],
                [-61.0, 63.0, 27.0],
                [-91.0, -2.0, 33.0],
                [-64.0, -69.0, 28.0],
                [-1.0, -97.0, 33.0],
                [62.0, -67.0, 28.0],
                [96.0, 1.0, 27.0],
                [68.0, 70.0, 35.0],
                [0.0, 103.0, 29.0],
                [-74.0, 67.0, 27.0],
                [-102.0, 2.0, 28.0],
                [-71.0, -71.0, 34.0],
                [-4.0, -102.0, 35.0],
                [68.0, -69.0, 28.0],
                [45.0, 1.0, 37.0],
                [34.0, 34.0, 39.0],
                [-2.0, 51.0, 37.0],
                [-36.0, 31.0, 35.0],
                [-46.0, -5.0, 37.0],
                [-38.0, -34.0, 35.0],
                [-5.0, -53.0, 35.0],
                [40.0, -39.0, 31.0],
                [54.0, -5.0, 34.0],
                [39.0, 39.0, 38.0],
                [-1.0, 57.0, 32.0],
                [-39.0, 39.0, 31.0],
                [-59.0, -3.0, 34.0],
                [-44.0, -45.0, 39.0],
                [1.0, -54.0, 33.0],
                [38.0, -40.0, 35.0],
                [59.0, -1.0, 36.0],
                [44.0, 42.0, 39.0],
                [2.0, 63.0, 34.0],
                [-48.0, 40.0, 35.0],
                [-61.0, -4.0, 31.0],
                [-48.0, -48.0, 40.0],
                [-5.0, -68.0, 31.0],
                [41.0, -46.0, 35.0],
                [70.0, 1.0, 36.0],
                [47.0, 55.0, 38.0],
                [4.0, 69.0, 39.0],
                [-47.0, 51.0, 34.0],
                [-68.0, -5.0, 32.0],
                [-54.0, -53.0, 38.0],
                [-3.0, -72.0, 36.0],
                [47.0, -55.0, 34.0],
                [77.0, -2.0, 31.0],
                [53.0, 51.0, 31.0],
                [-3.0, 74.0, 32.0],
                [-52.0, 60.0, 36.0],
                [-77.0, 2.0, 39.0],
                [-53.0, -55.0, 40.0],
                [-4.0, -77.0, 37.0],
                [59.0, -56.0, 37.0],
                [81.0, 4.0, 32.0],
                [61.0, 63.0, 35.0],
                [4.0, 89.0, 37.0],
                [-66.0, 60.0, 31.0],
                [-90.0, -5.0, 34.0],
                [-65.0, -59.0, 35.0],
                [0.0, -87.0, 35.0],
                [61.0, -66.0, 32.0],
                [89.0, 1.0, 38.0],
                [69.0, 60.0, 39.0],
                [3.0, 91.0, 32.0],
                [-67.0, 62.0, 32.0],
                [-94.0, -1.0, 35.0],
                [-69.0, -68.0, 31.0],
                [4.0, -95.0, 31.0],
                [60.0, -64.0, 33.0],
                [103.0, 2.0, 35.0],
                [67.0, 70.0, 36.0],
                [0.0, 97.0, 34.0],
                [-74.0, 70.0, 36.0],
                [-105.0, -4.0, 35.0],
                [-76.0, -73.0, 32.0],
                [-1.0, -105.0, 35.0],
                [66.0, -72.0, 38.0],
                [50.0, 1.0, 42.0],
                [31.0, 30.0, 44.0],
                [4.0, 52.0, 36.0],
                [-31.0, 34.0, 37.0],
                [-47.0, -4.0, 35.0],
                [-38.0, -32.0, 40.0],
                [0.0, -48.0, 38.0],
                [32.0, -38.0, 38.0],
                [53.0, 4.0, 42.0],
                [40.0, 44.0, 35.0],
                [3.0, 59.0, 37.0],
                [-42.0, 44.0, 36.0],
                [-60.0, -2.0, 37.0],
                [-41.0, -43.0, 35.0],
                [0.0, -56.0, 36.0],
                [41.0, -37.0, 43.0],
                [59.0, -4.0, 36.0],
                [43.0, 43.0, 43.0],
                [-1.0, 61.0, 41.0],
                [-42.0, 40.0, 38.0],
                [-63.0, 1.0, 44.0],
                [-50.0, -47.0, 37.0],
                [2.0, -69.0, 42.0],
                [47.0, -49.0, 36.0],
                [67.0, 2.0, 43.0],
                [49.0, 52.0, 41.0],
                [1.0, 68.0, 40.0],
                [-47.0, 46.0, 41.0],
                [-69.0, -3.0, 44.0],
                [-47.0, -54.0, 36.0],
                [-4.0, -72.0, 43.0],
                [50.0, -56.0, 36.0],
                [83.0, 2.0, 40.0],
                [59.0, 59.0, 39.0],
                [0.0, 77.0, 42.0],
                [-55.0, 51.0, 39.0],
                [-83.0, 4.0, 43.0],
                [-56.0, -54.0, 40.0],
                [-1.0, -80.0, 40.0],
                [57.0, -55.0, 42.0],
                [86.0, -1.0, 38.0],
                [64.0, 65.0, 37.0],
                [0.0, 86.0, 39.0],
                [-64.0, 56.0, 39.0],
                [-90.0, -3.0, 39.0],
                [-60.0, -64.0, 38.0],
                [4.0, -85.0, 36.0],
                [56.0, -59.0, 41.0],
                [87.0, -1.0, 43.0],
                [66.0, 67.0, 38.0],
                [3.0, 93.0, 41.0],
                [-69.0, 67.0, 36.0],
                [-93.0, -5.0, 43.0],
                [-64.0, -68.0, 35.0],
                [2.0, -89.0, 40.0],
                [69.0, -66.0, 36.0],
                [103.0, -5.0, 36.0],
                [74.0, 73.0, 35.0],
                [-2.0, 100.0, 43.0],
                [-75.0, 72.0, 43.0],
                [-97.0, -2.0, 42.0],
                [-72.0, -73.0, 39.0],
                [3.0, -96.0, 36.0],
                [71.0, -74.0, 36.0],
            ]
        )
        basis0 = BSplineBasis(
            7, np.array([-1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.4, 2.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 4.4]), 0
        )
        basis1 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 1.3, 1.6, 3.3, 4.0, 4.0, 4.0, 4.0, 4.0]))
        basis2 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 1.9, 2.8, 3.7, 4.7, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0])
        )
        vol = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2 += np.array([9.5, 0.3, 9.6])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] -= 9.500000
        pt2[..., 1] -= 0.300000
        pt2[..., 2] -= 9.600000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_volume_3D_p675_C0_periodic(self):
        controlpoints = np.array(
            [
                [52.0, -3.0, 2.0],
                [37.0, 28.0, -4.0],
                [10.0, 46.0, -3.0],
                [-30.0, 45.0, 3.0],
                [-50.0, 18.0, -5.0],
                [-47.0, -20.0, 4.0],
                [-29.0, -46.0, -1.0],
                [6.0, -51.0, -3.0],
                [35.0, -34.0, 3.0],
                [54.0, -4.0, 3.0],
                [45.0, 34.0, 0.0],
                [7.0, 56.0, -4.0],
                [-31.0, 45.0, -2.0],
                [-51.0, 18.0, 2.0],
                [-58.0, -17.0, 4.0],
                [-32.0, -48.0, 3.0],
                [7.0, -56.0, 4.0],
                [43.0, -38.0, -4.0],
                [63.0, 0.0, 4.0],
                [45.0, 44.0, 0.0],
                [13.0, 67.0, 3.0],
                [-36.0, 54.0, -1.0],
                [-56.0, 18.0, -1.0],
                [-63.0, -27.0, -5.0],
                [-31.0, -53.0, -1.0],
                [14.0, -61.0, -1.0],
                [52.0, -37.0, -1.0],
                [75.0, -5.0, 0.0],
                [57.0, 48.0, 2.0],
                [17.0, 70.0, 4.0],
                [-36.0, 61.0, -3.0],
                [-69.0, 21.0, -2.0],
                [-67.0, -24.0, 2.0],
                [-32.0, -65.0, 0.0],
                [9.0, -66.0, -3.0],
                [58.0, -43.0, -2.0],
                [77.0, -4.0, 2.0],
                [60.0, 51.0, -4.0],
                [13.0, 76.0, 1.0],
                [-39.0, 70.0, 4.0],
                [-71.0, 23.0, -5.0],
                [-74.0, -32.0, 4.0],
                [-40.0, -73.0, 3.0],
                [9.0, -81.0, 2.0],
                [58.0, -47.0, 2.0],
                [81.0, 2.0, 0.0],
                [61.0, 57.0, -4.0],
                [16.0, 82.0, 2.0],
                [-45.0, 76.0, -1.0],
                [-83.0, 26.0, 3.0],
                [-81.0, -25.0, -2.0],
                [-42.0, -79.0, 1.0],
                [11.0, -84.0, -2.0],
                [66.0, -57.0, -1.0],
                [96.0, 4.0, 0.0],
                [70.0, 58.0, -1.0],
                [19.0, 87.0, -4.0],
                [-48.0, 84.0, -2.0],
                [-87.0, 29.0, 4.0],
                [-87.0, -34.0, 2.0],
                [-51.0, -86.0, -4.0],
                [12.0, -87.0, -5.0],
                [67.0, -64.0, -5.0],
                [100.0, 1.0, 3.0],
                [72.0, 63.0, -1.0],
                [13.0, 94.0, -5.0],
                [-47.0, 84.0, 4.0],
                [-93.0, 37.0, -5.0],
                [-97.0, -34.0, -5.0],
                [-47.0, -86.0, -2.0],
                [17.0, -98.0, -2.0],
                [72.0, -61.0, -5.0],
                [53.0, -1.0, 0.0],
                [33.0, 35.0, 2.0],
                [11.0, 48.0, 5.0],
                [-27.0, 38.0, 7.0],
                [-47.0, 13.0, 7.0],
                [-49.0, -14.0, 7.0],
                [-21.0, -49.0, 1.0],
                [11.0, -52.0, 6.0],
                [35.0, -32.0, 5.0],
                [61.0, -1.0, 2.0],
                [43.0, 35.0, 8.0],
                [6.0, 56.0, 0.0],
                [-31.0, 47.0, 6.0],
                [-49.0, 18.0, 4.0],
                [-54.0, -20.0, 3.0],
                [-27.0, -50.0, 3.0],
                [6.0, -53.0, 6.0],
                [40.0, -36.0, 2.0],
                [64.0, 4.0, 0.0],
                [47.0, 45.0, 3.0],
                [10.0, 65.0, 0.0],
                [-34.0, 57.0, 8.0],
                [-66.0, 24.0, 4.0],
                [-59.0, -21.0, 1.0],
                [-36.0, -51.0, 6.0],
                [11.0, -68.0, 5.0],
                [47.0, -42.0, -1.0],
                [71.0, -1.0, 1.0],
                [53.0, 44.0, 4.0],
                [13.0, 70.0, 1.0],
                [-35.0, 66.0, 2.0],
                [-63.0, 20.0, 8.0],
                [-63.0, -27.0, 2.0],
                [-36.0, -59.0, 3.0],
                [14.0, -71.0, 5.0],
                [52.0, -44.0, 0.0],
                [76.0, -5.0, 1.0],
                [60.0, 50.0, 8.0],
                [13.0, 77.0, 2.0],
                [-36.0, 64.0, 5.0],
                [-73.0, 30.0, 1.0],
                [-76.0, -24.0, 4.0],
                [-41.0, -67.0, 8.0],
                [16.0, -76.0, 1.0],
                [64.0, -50.0, 5.0],
                [86.0, -1.0, 1.0],
                [69.0, 53.0, 8.0],
                [13.0, 82.0, 1.0],
                [-44.0, 70.0, 7.0],
                [-85.0, 25.0, 7.0],
                [-85.0, -27.0, 0.0],
                [-41.0, -75.0, 2.0],
                [15.0, -88.0, 4.0],
                [61.0, -53.0, 5.0],
                [93.0, 2.0, 7.0],
                [68.0, 63.0, 4.0],
                [18.0, 95.0, 0.0],
                [-49.0, 76.0, 7.0],
                [-92.0, 35.0, 7.0],
                [-87.0, -37.0, 6.0],
                [-49.0, -78.0, 5.0],
                [13.0, -96.0, 4.0],
                [73.0, -65.0, 1.0],
                [95.0, 1.0, 8.0],
                [77.0, 67.0, 4.0],
                [12.0, 97.0, 6.0],
                [-46.0, 85.0, 4.0],
                [-96.0, 39.0, 1.0],
                [-99.0, -35.0, 1.0],
                [-46.0, -89.0, 3.0],
                [21.0, -97.0, 3.0],
                [73.0, -66.0, 4.0],
                [52.0, 1.0, 5.0],
                [35.0, 31.0, 5.0],
                [8.0, 45.0, 12.0],
                [-30.0, 46.0, 10.0],
                [-47.0, 13.0, 10.0],
                [-52.0, -19.0, 9.0],
                [-26.0, -41.0, 11.0],
                [5.0, -50.0, 7.0],
                [36.0, -28.0, 10.0],
                [55.0, -1.0, 12.0],
                [46.0, 34.0, 7.0],
                [13.0, 54.0, 7.0],
                [-27.0, 46.0, 8.0],
                [-54.0, 23.0, 8.0],
                [-50.0, -24.0, 6.0],
                [-28.0, -47.0, 7.0],
                [6.0, -55.0, 10.0],
                [46.0, -40.0, 9.0],
                [62.0, 1.0, 11.0],
                [53.0, 45.0, 13.0],
                [12.0, 59.0, 10.0],
                [-36.0, 59.0, 9.0],
                [-58.0, 17.0, 7.0],
                [-58.0, -22.0, 11.0],
                [-30.0, -60.0, 12.0],
                [10.0, -68.0, 8.0],
                [46.0, -44.0, 7.0],
                [72.0, -2.0, 12.0],
                [54.0, 47.0, 10.0],
                [12.0, 67.0, 13.0],
                [-33.0, 59.0, 8.0],
                [-64.0, 26.0, 7.0],
                [-64.0, -26.0, 8.0],
                [-35.0, -59.0, 11.0],
                [15.0, -69.0, 11.0],
                [59.0, -44.0, 7.0],
                [75.0, -3.0, 5.0],
                [64.0, 49.0, 4.0],
                [15.0, 76.0, 13.0],
                [-41.0, 69.0, 12.0],
                [-74.0, 29.0, 13.0],
                [-75.0, -30.0, 8.0],
                [-35.0, -72.0, 6.0],
                [18.0, -76.0, 9.0],
                [63.0, -53.0, 12.0],
                [84.0, 0.0, 13.0],
                [66.0, 54.0, 7.0],
                [13.0, 84.0, 7.0],
                [-43.0, 72.0, 5.0],
                [-76.0, 32.0, 9.0],
                [-86.0, -35.0, 12.0],
                [-41.0, -74.0, 7.0],
                [17.0, -81.0, 6.0],
                [69.0, -60.0, 8.0],
                [94.0, 1.0, 8.0],
                [73.0, 56.0, 4.0],
                [17.0, 87.0, 11.0],
                [-45.0, 82.0, 5.0],
                [-84.0, 32.0, 8.0],
                [-85.0, -35.0, 10.0],
                [-47.0, -79.0, 12.0],
                [13.0, -97.0, 9.0],
                [75.0, -61.0, 8.0],
                [103.0, 1.0, 11.0],
                [80.0, 66.0, 5.0],
                [21.0, 97.0, 11.0],
                [-53.0, 89.0, 6.0],
                [-96.0, 39.0, 10.0],
                [-90.0, -33.0, 12.0],
                [-48.0, -83.0, 5.0],
                [20.0, -97.0, 5.0],
                [72.0, -67.0, 6.0],
                [53.0, -2.0, 16.0],
                [42.0, 35.0, 12.0],
                [5.0, 46.0, 14.0],
                [-29.0, 39.0, 16.0],
                [-50.0, 21.0, 8.0],
                [-52.0, -15.0, 11.0],
                [-26.0, -39.0, 13.0],
                [9.0, -53.0, 8.0],
                [42.0, -35.0, 10.0],
                [61.0, -5.0, 13.0],
                [43.0, 40.0, 9.0],
                [10.0, 52.0, 9.0],
                [-30.0, 50.0, 12.0],
                [-50.0, 23.0, 8.0],
                [-56.0, -23.0, 8.0],
                [-27.0, -46.0, 16.0],
                [6.0, -57.0, 11.0],
                [48.0, -36.0, 8.0],
                [69.0, -4.0, 11.0],
                [45.0, 45.0, 14.0],
                [12.0, 58.0, 13.0],
                [-29.0, 55.0, 16.0],
                [-61.0, 24.0, 11.0],
                [-65.0, -20.0, 16.0],
                [-35.0, -59.0, 17.0],
                [11.0, -65.0, 15.0],
                [53.0, -46.0, 15.0],
                [70.0, 0.0, 10.0],
                [52.0, 45.0, 15.0],
                [15.0, 74.0, 12.0],
                [-35.0, 58.0, 15.0],
                [-72.0, 29.0, 13.0],
                [-65.0, -24.0, 17.0],
                [-40.0, -61.0, 15.0],
                [16.0, -67.0, 10.0],
                [54.0, -49.0, 13.0],
                [77.0, 3.0, 14.0],
                [56.0, 48.0, 16.0],
                [8.0, 79.0, 14.0],
                [-40.0, 68.0, 16.0],
                [-76.0, 27.0, 14.0],
                [-75.0, -30.0, 10.0],
                [-36.0, -67.0, 13.0],
                [14.0, -77.0, 14.0],
                [61.0, -56.0, 16.0],
                [80.0, 4.0, 8.0],
                [63.0, 60.0, 13.0],
                [16.0, 84.0, 16.0],
                [-45.0, 77.0, 17.0],
                [-85.0, 33.0, 14.0],
                [-81.0, -27.0, 13.0],
                [-44.0, -78.0, 10.0],
                [12.0, -81.0, 11.0],
                [67.0, -54.0, 16.0],
                [89.0, 3.0, 9.0],
                [70.0, 62.0, 17.0],
                [19.0, 87.0, 11.0],
                [-45.0, 81.0, 16.0],
                [-86.0, 29.0, 16.0],
                [-83.0, -35.0, 17.0],
                [-51.0, -85.0, 14.0],
                [15.0, -97.0, 13.0],
                [70.0, -63.0, 10.0],
                [98.0, 0.0, 10.0],
                [74.0, 63.0, 16.0],
                [17.0, 103.0, 14.0],
                [-55.0, 83.0, 10.0],
                [-93.0, 38.0, 15.0],
                [-99.0, -38.0, 12.0],
                [-50.0, -90.0, 13.0],
                [14.0, -103.0, 14.0],
                [72.0, -64.0, 14.0],
                [52.0, -5.0, 19.0],
                [39.0, 32.0, 15.0],
                [13.0, 47.0, 21.0],
                [-21.0, 43.0, 20.0],
                [-47.0, 12.0, 14.0],
                [-51.0, -15.0, 21.0],
                [-25.0, -41.0, 18.0],
                [12.0, -47.0, 19.0],
                [42.0, -33.0, 13.0],
                [52.0, -2.0, 16.0],
                [41.0, 34.0, 20.0],
                [14.0, 56.0, 13.0],
                [-29.0, 46.0, 14.0],
                [-54.0, 23.0, 13.0],
                [-57.0, -17.0, 21.0],
                [-25.0, -54.0, 14.0],
                [5.0, -56.0, 15.0],
                [48.0, -33.0, 19.0],
                [59.0, 2.0, 12.0],
                [45.0, 41.0, 17.0],
                [15.0, 60.0, 20.0],
                [-29.0, 55.0, 13.0],
                [-60.0, 24.0, 21.0],
                [-61.0, -24.0, 18.0],
                [-37.0, -58.0, 13.0],
                [15.0, -62.0, 20.0],
                [45.0, -39.0, 21.0],
                [67.0, -2.0, 21.0],
                [50.0, 49.0, 20.0],
                [16.0, 75.0, 19.0],
                [-40.0, 58.0, 13.0],
                [-66.0, 21.0, 17.0],
                [-68.0, -28.0, 16.0],
                [-40.0, -65.0, 22.0],
                [10.0, -74.0, 17.0],
                [51.0, -47.0, 19.0],
                [75.0, 2.0, 18.0],
                [57.0, 48.0, 17.0],
                [15.0, 79.0, 17.0],
                [-44.0, 67.0, 18.0],
                [-75.0, 25.0, 16.0],
                [-78.0, -28.0, 18.0],
                [-36.0, -66.0, 20.0],
                [14.0, -82.0, 21.0],
                [61.0, -52.0, 20.0],
                [85.0, 4.0, 15.0],
                [66.0, 51.0, 19.0],
                [12.0, 88.0, 14.0],
                [-43.0, 72.0, 18.0],
                [-78.0, 32.0, 16.0],
                [-77.0, -26.0, 16.0],
                [-48.0, -71.0, 15.0],
                [17.0, -90.0, 20.0],
                [61.0, -52.0, 14.0],
                [88.0, -4.0, 15.0],
                [67.0, 57.0, 16.0],
                [17.0, 91.0, 17.0],
                [-47.0, 82.0, 20.0],
                [-87.0, 27.0, 20.0],
                [-87.0, -27.0, 14.0],
                [-45.0, -85.0, 16.0],
                [16.0, -89.0, 22.0],
                [69.0, -63.0, 21.0],
                [103.0, 0.0, 20.0],
                [79.0, 68.0, 17.0],
                [20.0, 96.0, 17.0],
                [-46.0, 83.0, 19.0],
                [-91.0, 36.0, 14.0],
                [-96.0, -32.0, 17.0],
                [-47.0, -84.0, 21.0],
                [14.0, -97.0, 21.0],
                [81.0, -69.0, 18.0],
                [53.0, -5.0, 19.0],
                [40.0, 29.0, 26.0],
                [6.0, 46.0, 21.0],
                [-30.0, 48.0, 23.0],
                [-46.0, 12.0, 22.0],
                [-47.0, -17.0, 24.0],
                [-27.0, -41.0, 26.0],
                [5.0, -48.0, 20.0],
                [38.0, -28.0, 21.0],
                [60.0, -5.0, 23.0],
                [47.0, 35.0, 18.0],
                [5.0, 60.0, 26.0],
                [-27.0, 48.0, 18.0],
                [-59.0, 20.0, 26.0],
                [-55.0, -22.0, 19.0],
                [-28.0, -53.0, 24.0],
                [9.0, -54.0, 26.0],
                [45.0, -33.0, 18.0],
                [64.0, 0.0, 23.0],
                [47.0, 44.0, 22.0],
                [10.0, 65.0, 21.0],
                [-37.0, 53.0, 24.0],
                [-65.0, 23.0, 27.0],
                [-65.0, -25.0, 22.0],
                [-31.0, -56.0, 19.0],
                [6.0, -59.0, 17.0],
                [50.0, -42.0, 21.0],
                [73.0, -5.0, 21.0],
                [57.0, 45.0, 26.0],
                [8.0, 73.0, 22.0],
                [-31.0, 63.0, 22.0],
                [-70.0, 19.0, 18.0],
                [-69.0, -27.0, 19.0],
                [-33.0, -65.0, 22.0],
                [11.0, -73.0, 20.0],
                [50.0, -51.0, 20.0],
                [83.0, 2.0, 24.0],
                [58.0, 52.0, 18.0],
                [15.0, 78.0, 22.0],
                [-35.0, 69.0, 19.0],
                [-75.0, 30.0, 24.0],
                [-71.0, -28.0, 22.0],
                [-38.0, -71.0, 25.0],
                [12.0, -79.0, 22.0],
                [61.0, -47.0, 23.0],
                [88.0, -4.0, 20.0],
                [69.0, 56.0, 19.0],
                [15.0, 84.0, 20.0],
                [-41.0, 70.0, 26.0],
                [-80.0, 25.0, 19.0],
                [-84.0, -33.0, 20.0],
                [-42.0, -75.0, 25.0],
                [17.0, -83.0, 26.0],
                [66.0, -52.0, 18.0],
                [91.0, -2.0, 19.0],
                [68.0, 55.0, 26.0],
                [11.0, 94.0, 24.0],
                [-46.0, 83.0, 17.0],
                [-89.0, 29.0, 26.0],
                [-89.0, -30.0, 18.0],
                [-43.0, -77.0, 24.0],
                [15.0, -96.0, 27.0],
                [70.0, -60.0, 24.0],
                [101.0, -2.0, 19.0],
                [80.0, 62.0, 25.0],
                [16.0, 100.0, 17.0],
                [-47.0, 91.0, 27.0],
                [-94.0, 32.0, 22.0],
                [-97.0, -36.0, 22.0],
                [-49.0, -88.0, 22.0],
                [20.0, -99.0, 26.0],
                [74.0, -61.0, 23.0],
                [49.0, 0.0, 28.0],
                [37.0, 29.0, 22.0],
                [13.0, 53.0, 30.0],
                [-26.0, 43.0, 26.0],
                [-49.0, 14.0, 31.0],
                [-48.0, -13.0, 23.0],
                [-24.0, -44.0, 29.0],
                [7.0, -51.0, 25.0],
                [34.0, -32.0, 24.0],
                [54.0, 3.0, 27.0],
                [40.0, 33.0, 28.0],
                [10.0, 54.0, 22.0],
                [-31.0, 53.0, 21.0],
                [-57.0, 17.0, 30.0],
                [-52.0, -21.0, 24.0],
                [-28.0, -49.0, 24.0],
                [5.0, -54.0, 21.0],
                [38.0, -41.0, 26.0],
                [59.0, -5.0, 24.0],
                [51.0, 37.0, 29.0],
                [15.0, 59.0, 24.0],
                [-33.0, 51.0, 23.0],
                [-58.0, 22.0, 27.0],
                [-60.0, -27.0, 23.0],
                [-28.0, -58.0, 25.0],
                [10.0, -65.0, 24.0],
                [53.0, -37.0, 25.0],
                [67.0, -1.0, 23.0],
                [57.0, 48.0, 28.0],
                [11.0, 71.0, 26.0],
                [-38.0, 62.0, 26.0],
                [-71.0, 28.0, 25.0],
                [-71.0, -24.0, 31.0],
                [-37.0, -66.0, 26.0],
                [15.0, -72.0, 28.0],
                [53.0, -50.0, 29.0],
                [82.0, 0.0, 27.0],
                [58.0, 50.0, 23.0],
                [16.0, 75.0, 24.0],
                [-38.0, 67.0, 30.0],
                [-69.0, 28.0, 22.0],
                [-74.0, -29.0, 23.0],
                [-43.0, -66.0, 28.0],
                [10.0, -79.0, 31.0],
                [64.0, -47.0, 23.0],
                [86.0, -2.0, 30.0],
                [62.0, 51.0, 27.0],
                [10.0, 88.0, 24.0],
                [-43.0, 73.0, 31.0],
                [-82.0, 32.0, 22.0],
                [-85.0, -35.0, 24.0],
                [-47.0, -76.0, 26.0],
                [17.0, -88.0, 23.0],
                [67.0, -52.0, 21.0],
                [92.0, 3.0, 30.0],
                [72.0, 62.0, 28.0],
                [17.0, 88.0, 30.0],
                [-42.0, 83.0, 28.0],
                [-88.0, 33.0, 29.0],
                [-90.0, -37.0, 24.0],
                [-48.0, -82.0, 31.0],
                [18.0, -93.0, 27.0],
                [68.0, -59.0, 21.0],
                [95.0, -1.0, 22.0],
                [75.0, 59.0, 26.0],
                [14.0, 98.0, 30.0],
                [-50.0, 90.0, 27.0],
                [-94.0, 34.0, 28.0],
                [-93.0, -30.0, 22.0],
                [-54.0, -84.0, 30.0],
                [21.0, -103.0, 30.0],
                [78.0, -61.0, 31.0],
                [52.0, 1.0, 27.0],
                [34.0, 31.0, 32.0],
                [9.0, 53.0, 26.0],
                [-25.0, 43.0, 35.0],
                [-48.0, 19.0, 32.0],
                [-48.0, -21.0, 28.0],
                [-29.0, -47.0, 28.0],
                [11.0, -50.0, 32.0],
                [39.0, -29.0, 29.0],
                [52.0, -5.0, 27.0],
                [42.0, 41.0, 29.0],
                [6.0, 54.0, 33.0],
                [-28.0, 52.0, 29.0],
                [-54.0, 22.0, 35.0],
                [-49.0, -24.0, 34.0],
                [-25.0, -50.0, 31.0],
                [12.0, -59.0, 27.0],
                [47.0, -33.0, 35.0],
                [61.0, -4.0, 32.0],
                [45.0, 37.0, 27.0],
                [15.0, 63.0, 34.0],
                [-36.0, 59.0, 35.0],
                [-60.0, 20.0, 35.0],
                [-58.0, -18.0, 27.0],
                [-30.0, -57.0, 34.0],
                [8.0, -61.0, 35.0],
                [52.0, -46.0, 26.0],
                [71.0, 0.0, 27.0],
                [53.0, 48.0, 29.0],
                [16.0, 65.0, 35.0],
                [-38.0, 61.0, 34.0],
                [-67.0, 21.0, 27.0],
                [-63.0, -23.0, 26.0],
                [-36.0, -64.0, 28.0],
                [16.0, -70.0, 30.0],
                [50.0, -45.0, 30.0],
                [82.0, -4.0, 33.0],
                [64.0, 47.0, 34.0],
                [13.0, 73.0, 35.0],
                [-36.0, 71.0, 34.0],
                [-70.0, 28.0, 33.0],
                [-70.0, -24.0, 36.0],
                [-36.0, -64.0, 29.0],
                [13.0, -82.0, 28.0],
                [58.0, -51.0, 29.0],
                [85.0, -2.0, 32.0],
                [67.0, 50.0, 31.0],
                [14.0, 88.0, 30.0],
                [-46.0, 78.0, 26.0],
                [-83.0, 25.0, 27.0],
                [-84.0, -28.0, 32.0],
                [-46.0, -71.0, 35.0],
                [16.0, -86.0, 32.0],
                [67.0, -56.0, 34.0],
                [92.0, 1.0, 31.0],
                [75.0, 63.0, 35.0],
                [20.0, 92.0, 30.0],
                [-51.0, 78.0, 33.0],
                [-87.0, 30.0, 32.0],
                [-92.0, -28.0, 32.0],
                [-43.0, -81.0, 29.0],
                [17.0, -87.0, 32.0],
                [72.0, -55.0, 33.0],
                [96.0, -3.0, 29.0],
                [80.0, 60.0, 29.0],
                [16.0, 99.0, 28.0],
                [-55.0, 89.0, 35.0],
                [-97.0, 30.0, 29.0],
                [-97.0, -37.0, 32.0],
                [-46.0, -88.0, 33.0],
                [16.0, -95.0, 34.0],
                [76.0, -61.0, 32.0],
                [54.0, 3.0, 39.0],
                [40.0, 36.0, 34.0],
                [4.0, 51.0, 34.0],
                [-27.0, 43.0, 37.0],
                [-48.0, 14.0, 37.0],
                [-43.0, -19.0, 31.0],
                [-26.0, -46.0, 34.0],
                [4.0, -54.0, 39.0],
                [41.0, -38.0, 37.0],
                [53.0, -1.0, 36.0],
                [42.0, 37.0, 37.0],
                [11.0, 55.0, 30.0],
                [-27.0, 49.0, 40.0],
                [-51.0, 19.0, 40.0],
                [-49.0, -22.0, 38.0],
                [-27.0, -54.0, 38.0],
                [7.0, -53.0, 32.0],
                [38.0, -37.0, 40.0],
                [64.0, -2.0, 37.0],
                [52.0, 44.0, 40.0],
                [12.0, 64.0, 31.0],
                [-30.0, 58.0, 38.0],
                [-65.0, 21.0, 35.0],
                [-62.0, -18.0, 38.0],
                [-32.0, -56.0, 31.0],
                [10.0, -61.0, 32.0],
                [52.0, -45.0, 32.0],
                [71.0, 2.0, 33.0],
                [54.0, 48.0, 33.0],
                [12.0, 72.0, 31.0],
                [-38.0, 65.0, 33.0],
                [-69.0, 28.0, 37.0],
                [-66.0, -23.0, 39.0],
                [-35.0, -63.0, 39.0],
                [9.0, -68.0, 36.0],
                [50.0, -46.0, 34.0],
                [79.0, -3.0, 32.0],
                [60.0, 53.0, 32.0],
                [17.0, 74.0, 40.0],
                [-40.0, 70.0, 39.0],
                [-77.0, 22.0, 31.0],
                [-74.0, -26.0, 31.0],
                [-40.0, -67.0, 39.0],
                [10.0, -79.0, 35.0],
                [60.0, -49.0, 35.0],
                [84.0, 4.0, 34.0],
                [62.0, 54.0, 30.0],
                [13.0, 82.0, 38.0],
                [-39.0, 70.0, 32.0],
                [-82.0, 25.0, 36.0],
                [-86.0, -35.0, 32.0],
                [-40.0, -79.0, 40.0],
                [16.0, -89.0, 39.0],
                [64.0, -55.0, 35.0],
                [96.0, -5.0, 39.0],
                [75.0, 64.0, 33.0],
                [14.0, 94.0, 33.0],
                [-51.0, 82.0, 37.0],
                [-90.0, 32.0, 34.0],
                [-88.0, -37.0, 36.0],
                [-47.0, -78.0, 34.0],
                [17.0, -96.0, 39.0],
                [70.0, -62.0, 38.0],
                [95.0, 2.0, 36.0],
                [79.0, 64.0, 40.0],
                [20.0, 96.0, 33.0],
                [-53.0, 90.0, 33.0],
                [-97.0, 31.0, 30.0],
                [-93.0, -39.0, 39.0],
                [-53.0, -90.0, 39.0],
                [16.0, -96.0, 36.0],
                [73.0, -66.0, 37.0],
                [50.0, -3.0, 38.0],
                [41.0, 31.0, 44.0],
                [9.0, 50.0, 43.0],
                [-24.0, 40.0, 36.0],
                [-45.0, 16.0, 39.0],
                [-47.0, -18.0, 44.0],
                [-23.0, -43.0, 37.0],
                [9.0, -47.0, 36.0],
                [36.0, -31.0, 38.0],
                [57.0, 1.0, 42.0],
                [39.0, 38.0, 37.0],
                [14.0, 51.0, 38.0],
                [-25.0, 47.0, 38.0],
                [-50.0, 18.0, 44.0],
                [-55.0, -15.0, 39.0],
                [-24.0, -50.0, 35.0],
                [11.0, -59.0, 43.0],
                [42.0, -40.0, 38.0],
                [66.0, 0.0, 41.0],
                [50.0, 39.0, 44.0],
                [7.0, 67.0, 44.0],
                [-35.0, 56.0, 42.0],
                [-60.0, 22.0, 39.0],
                [-58.0, -27.0, 40.0],
                [-35.0, -52.0, 39.0],
                [11.0, -60.0, 41.0],
                [44.0, -46.0, 39.0],
                [69.0, 1.0, 35.0],
                [59.0, 46.0, 44.0],
                [10.0, 74.0, 38.0],
                [-38.0, 65.0, 36.0],
                [-70.0, 27.0, 40.0],
                [-67.0, -24.0, 37.0],
                [-38.0, -58.0, 40.0],
                [15.0, -66.0, 40.0],
                [51.0, -46.0, 35.0],
                [80.0, 2.0, 37.0],
                [64.0, 52.0, 38.0],
                [11.0, 79.0, 43.0],
                [-40.0, 72.0, 37.0],
                [-71.0, 30.0, 39.0],
                [-70.0, -27.0, 44.0],
                [-42.0, -72.0, 42.0],
                [11.0, -78.0, 39.0],
                [59.0, -52.0, 38.0],
                [88.0, -3.0, 37.0],
                [62.0, 51.0, 43.0],
                [14.0, 84.0, 40.0],
                [-39.0, 78.0, 41.0],
                [-86.0, 31.0, 41.0],
                [-82.0, -27.0, 39.0],
                [-47.0, -80.0, 38.0],
                [18.0, -82.0, 40.0],
                [66.0, -60.0, 44.0],
                [94.0, 1.0, 41.0],
                [76.0, 56.0, 41.0],
                [16.0, 89.0, 44.0],
                [-49.0, 83.0, 41.0],
                [-89.0, 32.0, 43.0],
                [-88.0, -32.0, 44.0],
                [-43.0, -82.0, 39.0],
                [18.0, -87.0, 38.0],
                [68.0, -59.0, 38.0],
                [95.0, 2.0, 43.0],
                [77.0, 61.0, 43.0],
                [12.0, 99.0, 35.0],
                [-48.0, 82.0, 37.0],
                [-98.0, 29.0, 37.0],
                [-93.0, -37.0, 39.0],
                [-47.0, -86.0, 39.0],
                [17.0, -94.0, 43.0],
                [74.0, -68.0, 39.0],
            ]
        )
        basis0 = BSplineBasis(
            6, np.array([-0.7, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 2.1, 3.0, 4.3, 5.0, 5.0, 5.0, 5.0, 5.0, 5.8]), 0
        )
        basis1 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0])
        )
        basis2 = BSplineBasis(
            5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 2.2, 2.9, 3.9, 5.4, 6.0, 6.0, 6.0, 6.0, 6.0])
        )
        vol = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2 *= np.array([9.2, 7.1, 10.6])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] /= 9.200000
        pt2[..., 1] /= 7.100000
        pt2[..., 2] /= 10.600000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_volume_3D_p755_C0_periodic(self):
        controlpoints = np.array(
            [
                [46.0, -1.0, -2.0],
                [37.0, 37.0, -4.0],
                [-3.0, 45.0, -3.0],
                [-35.0, 38.0, -4.0],
                [-49.0, 0.0, 1.0],
                [-35.0, -36.0, -1.0],
                [-5.0, -55.0, 0.0],
                [39.0, -35.0, -2.0],
                [55.0, -5.0, 2.0],
                [44.0, 44.0, 0.0],
                [0.0, 60.0, -2.0],
                [-46.0, 38.0, -5.0],
                [-54.0, 1.0, -2.0],
                [-39.0, -46.0, 4.0],
                [-4.0, -58.0, -5.0],
                [45.0, -37.0, -4.0],
                [68.0, 1.0, -4.0],
                [49.0, 50.0, 4.0],
                [-2.0, 69.0, 2.0],
                [-49.0, 47.0, 0.0],
                [-63.0, 4.0, 4.0],
                [-48.0, -51.0, 1.0],
                [-1.0, -63.0, 2.0],
                [48.0, -48.0, -2.0],
                [75.0, 0.0, -2.0],
                [51.0, 54.0, -1.0],
                [-3.0, 74.0, -3.0],
                [-49.0, 56.0, -2.0],
                [-77.0, -1.0, -1.0],
                [-53.0, -54.0, 1.0],
                [4.0, -75.0, 3.0],
                [57.0, -55.0, -5.0],
                [78.0, -3.0, -2.0],
                [57.0, 63.0, -4.0],
                [-4.0, 82.0, -2.0],
                [-59.0, 55.0, -5.0],
                [-80.0, 2.0, 2.0],
                [-63.0, -63.0, 3.0],
                [-4.0, -87.0, 4.0],
                [54.0, -61.0, -2.0],
                [89.0, -3.0, 4.0],
                [63.0, 62.0, -5.0],
                [3.0, 96.0, 3.0],
                [-64.0, 66.0, -4.0],
                [-94.0, 4.0, 2.0],
                [-67.0, -64.0, 4.0],
                [1.0, -91.0, 4.0],
                [64.0, -69.0, 1.0],
                [100.0, 0.0, -5.0],
                [69.0, 72.0, -1.0],
                [-1.0, 99.0, -1.0],
                [-66.0, 69.0, 4.0],
                [-96.0, 4.0, 2.0],
                [-72.0, -75.0, 3.0],
                [-5.0, -103.0, 3.0],
                [66.0, -76.0, -2.0],
                [51.0, -3.0, 0.0],
                [31.0, 40.0, 2.0],
                [-3.0, 48.0, 6.0],
                [-37.0, 39.0, 5.0],
                [-54.0, 1.0, 8.0],
                [-37.0, -38.0, 3.0],
                [-4.0, -55.0, 4.0],
                [32.0, -33.0, 8.0],
                [61.0, -5.0, 0.0],
                [44.0, 45.0, 1.0],
                [-5.0, 55.0, 4.0],
                [-46.0, 37.0, 7.0],
                [-54.0, -5.0, 7.0],
                [-42.0, -41.0, 3.0],
                [-1.0, -57.0, 3.0],
                [43.0, -39.0, 9.0],
                [63.0, 3.0, 7.0],
                [46.0, 51.0, 0.0],
                [2.0, 66.0, 9.0],
                [-51.0, 47.0, 8.0],
                [-70.0, -3.0, 2.0],
                [-44.0, -49.0, 7.0],
                [1.0, -68.0, 6.0],
                [49.0, -51.0, 9.0],
                [78.0, 0.0, 9.0],
                [51.0, 54.0, 6.0],
                [4.0, 74.0, 1.0],
                [-50.0, 53.0, 0.0],
                [-76.0, 0.0, 1.0],
                [-49.0, -55.0, 1.0],
                [-2.0, -77.0, 3.0],
                [55.0, -49.0, 9.0],
                [83.0, -4.0, 7.0],
                [55.0, 55.0, 7.0],
                [-4.0, 83.0, 7.0],
                [-56.0, 60.0, 8.0],
                [-84.0, -5.0, 4.0],
                [-61.0, -62.0, 8.0],
                [-2.0, -83.0, 0.0],
                [62.0, -60.0, 9.0],
                [93.0, 1.0, 7.0],
                [62.0, 67.0, 0.0],
                [-2.0, 93.0, 5.0],
                [-66.0, 66.0, 9.0],
                [-91.0, -4.0, 4.0],
                [-61.0, -68.0, 0.0],
                [-5.0, -95.0, 0.0],
                [61.0, -61.0, 9.0],
                [97.0, 0.0, 8.0],
                [66.0, 70.0, 5.0],
                [4.0, 99.0, 3.0],
                [-70.0, 71.0, 4.0],
                [-101.0, 1.0, 4.0],
                [-74.0, -69.0, 2.0],
                [-2.0, -105.0, 2.0],
                [68.0, -70.0, 4.0],
                [49.0, -5.0, 7.0],
                [39.0, 33.0, 7.0],
                [-1.0, 52.0, 7.0],
                [-32.0, 35.0, 7.0],
                [-54.0, -3.0, 7.0],
                [-39.0, -38.0, 11.0],
                [3.0, -47.0, 6.0],
                [39.0, -33.0, 14.0],
                [55.0, -4.0, 10.0],
                [45.0, 44.0, 8.0],
                [-1.0, 59.0, 9.0],
                [-37.0, 45.0, 10.0],
                [-61.0, 2.0, 7.0],
                [-38.0, -45.0, 13.0],
                [-4.0, -62.0, 13.0],
                [38.0, -46.0, 12.0],
                [63.0, 3.0, 7.0],
                [45.0, 48.0, 12.0],
                [3.0, 67.0, 13.0],
                [-47.0, 46.0, 8.0],
                [-63.0, 1.0, 5.0],
                [-49.0, -49.0, 5.0],
                [4.0, -66.0, 5.0],
                [43.0, -47.0, 7.0],
                [76.0, 4.0, 7.0],
                [53.0, 52.0, 5.0],
                [1.0, 76.0, 14.0],
                [-56.0, 57.0, 13.0],
                [-79.0, 1.0, 11.0],
                [-52.0, -49.0, 8.0],
                [0.0, -78.0, 14.0],
                [51.0, -50.0, 13.0],
                [80.0, 1.0, 9.0],
                [58.0, 63.0, 13.0],
                [0.0, 86.0, 10.0],
                [-56.0, 62.0, 6.0],
                [-83.0, 1.0, 9.0],
                [-55.0, -56.0, 9.0],
                [2.0, -84.0, 12.0],
                [61.0, -55.0, 9.0],
                [87.0, 4.0, 5.0],
                [64.0, 60.0, 10.0],
                [-4.0, 87.0, 9.0],
                [-61.0, 60.0, 11.0],
                [-97.0, 4.0, 12.0],
                [-64.0, -66.0, 10.0],
                [0.0, -91.0, 8.0],
                [63.0, -68.0, 14.0],
                [101.0, -3.0, 13.0],
                [67.0, 71.0, 12.0],
                [-1.0, 100.0, 10.0],
                [-76.0, 71.0, 14.0],
                [-99.0, -3.0, 11.0],
                [-75.0, -76.0, 11.0],
                [-5.0, -98.0, 9.0],
                [70.0, -73.0, 10.0],
                [45.0, 1.0, 15.0],
                [37.0, 33.0, 12.0],
                [1.0, 45.0, 12.0],
                [-35.0, 39.0, 15.0],
                [-46.0, -1.0, 16.0],
                [-40.0, -40.0, 13.0],
                [-1.0, -48.0, 14.0],
                [33.0, -38.0, 13.0],
                [56.0, -1.0, 17.0],
                [42.0, 41.0, 18.0],
                [-5.0, 57.0, 17.0],
                [-43.0, 38.0, 12.0],
                [-59.0, -4.0, 18.0],
                [-39.0, -40.0, 10.0],
                [-1.0, -54.0, 18.0],
                [38.0, -41.0, 13.0],
                [64.0, 1.0, 16.0],
                [51.0, 42.0, 16.0],
                [4.0, 64.0, 12.0],
                [-48.0, 44.0, 10.0],
                [-68.0, 3.0, 11.0],
                [-48.0, -46.0, 12.0],
                [-4.0, -71.0, 18.0],
                [49.0, -48.0, 10.0],
                [76.0, 2.0, 11.0],
                [50.0, 48.0, 15.0],
                [3.0, 71.0, 15.0],
                [-54.0, 55.0, 13.0],
                [-76.0, -1.0, 13.0],
                [-53.0, -55.0, 19.0],
                [-5.0, -80.0, 18.0],
                [53.0, -50.0, 14.0],
                [87.0, -4.0, 11.0],
                [62.0, 55.0, 19.0],
                [-4.0, 83.0, 16.0],
                [-62.0, 58.0, 19.0],
                [-79.0, -5.0, 16.0],
                [-57.0, -57.0, 18.0],
                [-2.0, -84.0, 13.0],
                [63.0, -55.0, 13.0],
                [91.0, 0.0, 19.0],
                [61.0, 63.0, 10.0],
                [-5.0, 96.0, 10.0],
                [-69.0, 68.0, 14.0],
                [-92.0, 0.0, 15.0],
                [-67.0, -68.0, 11.0],
                [4.0, -90.0, 14.0],
                [68.0, -62.0, 16.0],
                [102.0, -2.0, 19.0],
                [75.0, 69.0, 11.0],
                [0.0, 102.0, 13.0],
                [-68.0, 68.0, 11.0],
                [-105.0, -4.0, 14.0],
                [-73.0, -67.0, 10.0],
                [1.0, -100.0, 10.0],
                [72.0, -71.0, 15.0],
                [53.0, 0.0, 23.0],
                [35.0, 34.0, 20.0],
                [0.0, 52.0, 20.0],
                [-32.0, 38.0, 24.0],
                [-49.0, -2.0, 18.0],
                [-40.0, -38.0, 19.0],
                [2.0, -52.0, 24.0],
                [36.0, -36.0, 18.0],
                [57.0, -2.0, 21.0],
                [45.0, 38.0, 23.0],
                [3.0, 58.0, 16.0],
                [-41.0, 36.0, 18.0],
                [-61.0, 2.0, 16.0],
                [-45.0, -40.0, 24.0],
                [4.0, -63.0, 18.0],
                [42.0, -37.0, 19.0],
                [70.0, 2.0, 20.0],
                [46.0, 49.0, 15.0],
                [-4.0, 61.0, 21.0],
                [-51.0, 44.0, 20.0],
                [-62.0, -5.0, 18.0],
                [-51.0, -43.0, 22.0],
                [0.0, -66.0, 18.0],
                [51.0, -48.0, 21.0],
                [72.0, -4.0, 17.0],
                [55.0, 49.0, 19.0],
                [-1.0, 77.0, 22.0],
                [-58.0, 49.0, 24.0],
                [-80.0, -5.0, 15.0],
                [-51.0, -53.0, 19.0],
                [3.0, -76.0, 16.0],
                [48.0, -55.0, 16.0],
                [88.0, -2.0, 15.0],
                [60.0, 57.0, 22.0],
                [4.0, 87.0, 16.0],
                [-64.0, 55.0, 22.0],
                [-83.0, -2.0, 22.0],
                [-61.0, -62.0, 22.0],
                [-3.0, -84.0, 22.0],
                [55.0, -56.0, 24.0],
                [92.0, -5.0, 24.0],
                [62.0, 60.0, 23.0],
                [1.0, 88.0, 17.0],
                [-63.0, 66.0, 23.0],
                [-93.0, 4.0, 20.0],
                [-68.0, -69.0, 18.0],
                [-3.0, -95.0, 21.0],
                [62.0, -61.0, 18.0],
                [98.0, -4.0, 21.0],
                [75.0, 75.0, 17.0],
                [3.0, 103.0, 15.0],
                [-67.0, 75.0, 16.0],
                [-96.0, -5.0, 23.0],
                [-72.0, -73.0, 23.0],
                [1.0, -96.0, 16.0],
                [69.0, -69.0, 22.0],
                [46.0, 3.0, 28.0],
                [39.0, 37.0, 25.0],
                [-2.0, 51.0, 24.0],
                [-36.0, 31.0, 28.0],
                [-49.0, 3.0, 21.0],
                [-40.0, -39.0, 24.0],
                [-5.0, -52.0, 22.0],
                [31.0, -34.0, 21.0],
                [60.0, 3.0, 22.0],
                [39.0, 41.0, 29.0],
                [0.0, 58.0, 29.0],
                [-40.0, 42.0, 24.0],
                [-57.0, -1.0, 23.0],
                [-41.0, -38.0, 29.0],
                [3.0, -58.0, 28.0],
                [37.0, -45.0, 22.0],
                [65.0, 4.0, 22.0],
                [50.0, 43.0, 20.0],
                [4.0, 64.0, 21.0],
                [-48.0, 49.0, 26.0],
                [-67.0, -1.0, 23.0],
                [-50.0, -47.0, 21.0],
                [-2.0, -63.0, 21.0],
                [45.0, -48.0, 21.0],
                [76.0, -2.0, 21.0],
                [53.0, 55.0, 23.0],
                [-4.0, 71.0, 20.0],
                [-51.0, 50.0, 26.0],
                [-79.0, -1.0, 20.0],
                [-49.0, -52.0, 27.0],
                [1.0, -73.0, 26.0],
                [54.0, -56.0, 24.0],
                [79.0, -4.0, 22.0],
                [62.0, 54.0, 25.0],
                [-3.0, 83.0, 22.0],
                [-56.0, 56.0, 29.0],
                [-89.0, 2.0, 21.0],
                [-55.0, -59.0, 29.0],
                [-5.0, -86.0, 24.0],
                [59.0, -57.0, 27.0],
                [88.0, 3.0, 28.0],
                [64.0, 67.0, 21.0],
                [-5.0, 86.0, 29.0],
                [-66.0, 66.0, 21.0],
                [-90.0, -5.0, 20.0],
                [-62.0, -67.0, 27.0],
                [-2.0, -94.0, 24.0],
                [68.0, -62.0, 24.0],
                [99.0, 0.0, 21.0],
                [71.0, 66.0, 24.0],
                [3.0, 98.0, 27.0],
                [-68.0, 67.0, 25.0],
                [-101.0, -5.0, 28.0],
                [-68.0, -70.0, 25.0],
                [0.0, -99.0, 29.0],
                [65.0, -70.0, 21.0],
                [51.0, 0.0, 32.0],
                [34.0, 38.0, 34.0],
                [-2.0, 54.0, 32.0],
                [-32.0, 31.0, 26.0],
                [-46.0, 3.0, 25.0],
                [-38.0, -40.0, 29.0],
                [-4.0, -54.0, 28.0],
                [34.0, -32.0, 28.0],
                [59.0, -4.0, 30.0],
                [39.0, 39.0, 26.0],
                [4.0, 61.0, 32.0],
                [-41.0, 40.0, 33.0],
                [-61.0, -3.0, 28.0],
                [-38.0, -37.0, 25.0],
                [-1.0, -63.0, 32.0],
                [40.0, -38.0, 29.0],
                [62.0, 0.0, 25.0],
                [46.0, 48.0, 30.0],
                [2.0, 62.0, 31.0],
                [-43.0, 50.0, 27.0],
                [-67.0, -4.0, 27.0],
                [-52.0, -52.0, 26.0],
                [-1.0, -63.0, 29.0],
                [51.0, -51.0, 25.0],
                [74.0, 1.0, 34.0],
                [56.0, 50.0, 26.0],
                [4.0, 71.0, 25.0],
                [-54.0, 53.0, 34.0],
                [-80.0, -3.0, 30.0],
                [-56.0, -54.0, 34.0],
                [-1.0, -71.0, 25.0],
                [49.0, -53.0, 25.0],
                [85.0, 3.0, 25.0],
                [54.0, 57.0, 31.0],
                [3.0, 85.0, 29.0],
                [-61.0, 61.0, 27.0],
                [-83.0, 0.0, 34.0],
                [-55.0, -62.0, 30.0],
                [-1.0, -89.0, 29.0],
                [54.0, -56.0, 29.0],
                [87.0, -4.0, 31.0],
                [66.0, 65.0, 25.0],
                [-4.0, 89.0, 29.0],
                [-70.0, 65.0, 31.0],
                [-94.0, 4.0, 33.0],
                [-67.0, -63.0, 31.0],
                [1.0, -90.0, 27.0],
                [68.0, -64.0, 32.0],
                [103.0, 0.0, 27.0],
                [70.0, 66.0, 32.0],
                [2.0, 100.0, 25.0],
                [-67.0, 74.0, 28.0],
                [-102.0, 0.0, 30.0],
                [-70.0, -74.0, 27.0],
                [4.0, -98.0, 28.0],
                [73.0, -73.0, 27.0],
                [48.0, -3.0, 37.0],
                [38.0, 31.0, 38.0],
                [-2.0, 45.0, 34.0],
                [-33.0, 40.0, 38.0],
                [-48.0, -4.0, 30.0],
                [-34.0, -38.0, 34.0],
                [-1.0, -53.0, 37.0],
                [31.0, -34.0, 39.0],
                [60.0, -5.0, 30.0],
                [39.0, 42.0, 36.0],
                [1.0, 58.0, 36.0],
                [-40.0, 41.0, 33.0],
                [-56.0, -1.0, 31.0],
                [-42.0, -44.0, 31.0],
                [-1.0, -59.0, 36.0],
                [42.0, -40.0, 34.0],
                [65.0, -5.0, 33.0],
                [44.0, 48.0, 33.0],
                [-5.0, 68.0, 31.0],
                [-51.0, 46.0, 32.0],
                [-71.0, 0.0, 34.0],
                [-46.0, -51.0, 32.0],
                [0.0, -72.0, 31.0],
                [47.0, -45.0, 33.0],
                [75.0, 2.0, 32.0],
                [53.0, 50.0, 32.0],
                [3.0, 75.0, 30.0],
                [-51.0, 50.0, 38.0],
                [-72.0, -3.0, 31.0],
                [-51.0, -57.0, 39.0],
                [-3.0, -74.0, 32.0],
                [52.0, -51.0, 32.0],
                [78.0, -2.0, 32.0],
                [54.0, 56.0, 32.0],
                [-1.0, 80.0, 32.0],
                [-64.0, 58.0, 35.0],
                [-81.0, -2.0, 34.0],
                [-60.0, -57.0, 33.0],
                [0.0, -82.0, 34.0],
                [54.0, -57.0, 35.0],
                [91.0, -5.0, 30.0],
                [63.0, 68.0, 33.0],
                [-4.0, 90.0, 35.0],
                [-67.0, 64.0, 36.0],
                [-93.0, -1.0, 34.0],
                [-67.0, -64.0, 38.0],
                [4.0, -94.0, 34.0],
                [68.0, -68.0, 30.0],
                [98.0, -4.0, 30.0],
                [74.0, 70.0, 31.0],
                [1.0, 95.0, 31.0],
                [-72.0, 69.0, 34.0],
                [-98.0, -3.0, 33.0],
                [-71.0, -70.0, 33.0],
                [2.0, -97.0, 30.0],
                [69.0, -76.0, 37.0],
                [51.0, -1.0, 43.0],
                [37.0, 32.0, 37.0],
                [-5.0, 47.0, 37.0],
                [-31.0, 33.0, 42.0],
                [-51.0, 0.0, 35.0],
                [-38.0, -41.0, 43.0],
                [-3.0, -48.0, 41.0],
                [30.0, -39.0, 40.0],
                [62.0, -4.0, 36.0],
                [37.0, 38.0, 39.0],
                [-2.0, 54.0, 36.0],
                [-45.0, 45.0, 38.0],
                [-58.0, -3.0, 44.0],
                [-43.0, -43.0, 35.0],
                [-3.0, -62.0, 36.0],
                [41.0, -38.0, 37.0],
                [66.0, 1.0, 41.0],
                [52.0, 45.0, 44.0],
                [-1.0, 65.0, 41.0],
                [-43.0, 50.0, 38.0],
                [-63.0, -1.0, 43.0],
                [-46.0, -51.0, 44.0],
                [1.0, -67.0, 41.0],
                [50.0, -52.0, 35.0],
                [77.0, 2.0, 40.0],
                [55.0, 54.0, 35.0],
                [3.0, 72.0, 35.0],
                [-58.0, 49.0, 39.0],
                [-74.0, -5.0, 43.0],
                [-56.0, -55.0, 39.0],
                [-1.0, -72.0, 37.0],
                [56.0, -53.0, 44.0],
                [84.0, -1.0, 40.0],
                [60.0, 58.0, 41.0],
                [4.0, 79.0, 43.0],
                [-55.0, 63.0, 44.0],
                [-85.0, -5.0, 36.0],
                [-60.0, -58.0, 39.0],
                [-3.0, -87.0, 35.0],
                [56.0, -62.0, 35.0],
                [95.0, 3.0, 38.0],
                [59.0, 67.0, 44.0],
                [0.0, 90.0, 42.0],
                [-65.0, 60.0, 37.0],
                [-93.0, -4.0, 41.0],
                [-69.0, -66.0, 40.0],
                [1.0, -93.0, 44.0],
                [61.0, -68.0, 42.0],
                [102.0, 0.0, 41.0],
                [72.0, 66.0, 44.0],
                [-1.0, 97.0, 36.0],
                [-69.0, 65.0, 36.0],
                [-103.0, 2.0, 40.0],
                [-71.0, -69.0, 43.0],
                [0.0, -99.0, 35.0],
                [71.0, -70.0, 43.0],
            ]
        )
        basis0 = BSplineBasis(
            7, np.array([-1.1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.3, 1.9, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 4.3]), 0
        )
        basis1 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.2, 3.0, 3.0, 3.0, 3.0, 3.0]))
        basis2 = BSplineBasis(
            5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.6, 2.1, 3.3, 4.3, 5.0, 5.0, 5.0, 5.0, 5.0])
        )
        vol = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2.mirror([0, 0, 2])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 2] = -pt2[..., 2]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_curve_3D_p5_C1_periodic(self):
        controlpoints = np.array(
            [
                [98.0, -2.0, -2.0],
                [65.0, 80.0, 3.0],
                [-20.0, 101.0, 1.0],
                [-95.0, 47.0, 4.0],
                [-89.0, -44.0, -4.0],
                [-20.0, -103.0, -3.0],
                [59.0, -74.0, -5.0],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([-1.9, -1.3, 0.0, 0.0, 0.0, 1.4, 1.9, 3.1, 3.7, 5.0, 5.0, 5.0, 6.4, 6.9]), 1
        )
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 += np.array([3.4, 0.2, 4.7])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] -= 3.400000
        pt2[..., 1] -= 0.200000
        pt2[..., 2] -= 4.700000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_curve_3D_p7_C1_periodic(self):
        controlpoints = np.array(
            [
                [103.0, 4.0, -3.0],
                [78.0, 64.0, 3.0],
                [20.0, 98.0, -2.0],
                [-46.0, 82.0, -3.0],
                [-96.0, 37.0, -5.0],
                [-92.0, -39.0, -5.0],
                [-55.0, -86.0, 4.0],
                [17.0, -101.0, 3.0],
                [77.0, -67.0, -3.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [-2.1, -1.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6, 1.9, 2.9, 3.8, 5.0, 5.0, 5.0, 5.0, 5.0, 5.6, 6.9]
            ),
            1,
        )
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 *= np.array([6.2, 9.4, 6.9])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] /= 6.200000
        pt2[..., 1] /= 9.400000
        pt2[..., 2] /= 6.900000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_curve_3D_p7_C1_periodic(self):
        controlpoints = np.array(
            [
                [99.0, 2.0, -1.0],
                [66.0, 73.0, 2.0],
                [-2.0, 102.0, 1.0],
                [-68.0, 67.0, 4.0],
                [-105.0, 4.0, 2.0],
                [-71.0, -68.0, -2.0],
                [-2.0, -103.0, 1.0],
                [65.0, -75.0, 1.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array([-2.0, -1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1, 2.0, 3.0, 4.0, 4.0, 4.0, 4.0, 4.0, 5.1, 6.0]),
            1,
        )
        crv = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2.mirror([3, 0, 0])

        u = np.linspace(crv.start(0), crv.end(0), 13)
        pt = crv(u)
        pt2 = crv2(u)
        pt2[..., 0] = -pt2[..., 0]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_surface_3D_p67_C1_periodic(self):
        controlpoints = np.array(
            [
                [55.0, 4.0, 1.0],
                [34.0, 43.0, 0.0],
                [-12.0, 54.0, -3.0],
                [-53.0, 31.0, 2.0],
                [-50.0, -23.0, -3.0],
                [-9.0, -59.0, -3.0],
                [33.0, -52.0, -4.0],
                [63.0, 4.0, 1.0],
                [41.0, 47.0, -5.0],
                [-17.0, 58.0, -2.0],
                [-63.0, 31.0, 1.0],
                [-55.0, -27.0, -4.0],
                [-18.0, -65.0, 2.0],
                [42.0, -47.0, -5.0],
                [69.0, -4.0, 2.0],
                [42.0, 59.0, 1.0],
                [-18.0, 68.0, 1.0],
                [-65.0, 32.0, 3.0],
                [-61.0, -27.0, 1.0],
                [-18.0, -67.0, 0.0],
                [47.0, -59.0, 4.0],
                [74.0, -2.0, -1.0],
                [50.0, 57.0, 0.0],
                [-21.0, 68.0, -3.0],
                [-72.0, 36.0, 3.0],
                [-67.0, -31.0, -5.0],
                [-18.0, -75.0, 4.0],
                [42.0, -60.0, 2.0],
                [83.0, -2.0, 1.0],
                [52.0, 62.0, 1.0],
                [-20.0, 76.0, -1.0],
                [-76.0, 37.0, -5.0],
                [-76.0, -34.0, -1.0],
                [-18.0, -76.0, -2.0],
                [50.0, -59.0, 3.0],
                [82.0, -4.0, 1.0],
                [57.0, 63.0, -4.0],
                [-17.0, 82.0, 3.0],
                [-73.0, 36.0, 4.0],
                [-77.0, -39.0, -2.0],
                [-18.0, -88.0, -4.0],
                [54.0, -67.0, -5.0],
                [86.0, 0.0, -2.0],
                [57.0, 75.0, 2.0],
                [-25.0, 86.0, -2.0],
                [-82.0, 36.0, -5.0],
                [-77.0, -41.0, -2.0],
                [-19.0, -84.0, 4.0],
                [60.0, -70.0, -3.0],
                [91.0, -4.0, -1.0],
                [59.0, 76.0, 2.0],
                [-20.0, 89.0, 1.0],
                [-81.0, 45.0, 2.0],
                [-81.0, -38.0, 0.0],
                [-19.0, -95.0, 1.0],
                [58.0, -74.0, 2.0],
                [103.0, -5.0, -1.0],
                [61.0, 79.0, 0.0],
                [-27.0, 102.0, 2.0],
                [-94.0, 39.0, -1.0],
                [-88.0, -44.0, 0.0],
                [-22.0, -95.0, 2.0],
                [63.0, -80.0, 4.0],
            ]
        )
        basis0 = BSplineBasis(
            6, np.array([-1.8, -0.8, 0.0, 0.0, 0.0, 0.0, 1.2, 2.2, 3.2, 4.0, 4.0, 4.0, 4.0, 5.2, 6.2]), 1
        )
        basis1 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 1.6, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0])
        )
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 += np.array([6.2, 4.5, 9.8])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] -= 6.200000
        pt2[..., 1] -= 4.500000
        pt2[..., 2] -= 9.800000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_surface_3D_p55_C1_periodic(self):
        controlpoints = np.array(
            [
                [60.0, -2.0, 4.0],
                [45.0, 40.0, -1.0],
                [2.0, 58.0, -5.0],
                [-42.0, 40.0, 2.0],
                [-58.0, 4.0, -1.0],
                [-43.0, -39.0, 0.0],
                [-1.0, -59.0, 1.0],
                [37.0, -48.0, -2.0],
                [66.0, -3.0, -3.0],
                [45.0, 51.0, 1.0],
                [3.0, 69.0, -1.0],
                [-52.0, 50.0, -1.0],
                [-69.0, 3.0, -2.0],
                [-42.0, -48.0, 2.0],
                [4.0, -63.0, -4.0],
                [45.0, -52.0, 2.0],
                [74.0, -5.0, -5.0],
                [48.0, 53.0, 0.0],
                [0.0, 68.0, 4.0],
                [-47.0, 48.0, -4.0],
                [-74.0, -5.0, -1.0],
                [-56.0, -49.0, -5.0],
                [-5.0, -74.0, -5.0],
                [46.0, -52.0, 1.0],
                [76.0, 4.0, -5.0],
                [49.0, 57.0, 1.0],
                [-1.0, 77.0, 0.0],
                [-53.0, 51.0, -3.0],
                [-80.0, -5.0, 2.0],
                [-53.0, -57.0, -2.0],
                [-1.0, -78.0, -4.0],
                [58.0, -58.0, -2.0],
                [82.0, -5.0, 2.0],
                [57.0, 55.0, 0.0],
                [-2.0, 85.0, -4.0],
                [-62.0, 53.0, -3.0],
                [-79.0, 4.0, 4.0],
                [-63.0, -63.0, 4.0],
                [-3.0, -84.0, -3.0],
                [58.0, -59.0, -4.0],
                [89.0, 1.0, -4.0],
                [60.0, 60.0, 4.0],
                [3.0, 93.0, -3.0],
                [-67.0, 62.0, -2.0],
                [-89.0, -2.0, 2.0],
                [-66.0, -62.0, -5.0],
                [-4.0, -88.0, -2.0],
                [67.0, -67.0, 2.0],
                [96.0, 4.0, 0.0],
                [68.0, 68.0, -1.0],
                [-3.0, 90.0, 2.0],
                [-66.0, 70.0, -4.0],
                [-91.0, 4.0, -4.0],
                [-69.0, -69.0, 2.0],
                [-4.0, -96.0, 4.0],
                [68.0, -70.0, 0.0],
                [96.0, 0.0, -3.0],
                [68.0, 67.0, -3.0],
                [4.0, 95.0, -2.0],
                [-66.0, 70.0, -4.0],
                [-102.0, -2.0, -4.0],
                [-75.0, -75.0, 0.0],
                [-3.0, -100.0, -3.0],
                [66.0, -72.0, 0.0],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([-1.7, -0.8, 0.0, 0.0, 0.0, 0.8, 2.2, 2.9, 4.3, 5.2, 6.0, 6.0, 6.0, 6.8, 8.2]), 1
        )
        basis1 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 1.1, 1.6, 3.0, 4.0, 4.0, 4.0, 4.0, 4.0]))
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 *= np.array([4.0, 9.7, 2.7])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] /= 4.000000
        pt2[..., 1] /= 9.700000
        pt2[..., 2] /= 2.700000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_surface_3D_p66_C1_periodic(self):
        controlpoints = np.array(
            [
                [58.0, 2.0, -4.0],
                [49.0, 36.0, 4.0],
                [12.0, 62.0, 1.0],
                [-30.0, 52.0, 4.0],
                [-59.0, 18.0, -3.0],
                [-55.0, -19.0, 0.0],
                [-30.0, -53.0, -1.0],
                [13.0, -61.0, 0.0],
                [47.0, -35.0, 0.0],
                [68.0, 1.0, -3.0],
                [54.0, 40.0, -4.0],
                [15.0, 60.0, -5.0],
                [-37.0, 52.0, 2.0],
                [-60.0, 22.0, -3.0],
                [-62.0, -21.0, 1.0],
                [-29.0, -59.0, -2.0],
                [15.0, -61.0, 2.0],
                [50.0, -43.0, -3.0],
                [72.0, 0.0, -2.0],
                [48.0, 42.0, 2.0],
                [13.0, 71.0, -3.0],
                [-35.0, 61.0, 0.0],
                [-70.0, 26.0, 4.0],
                [-66.0, -26.0, 0.0],
                [-32.0, -60.0, -1.0],
                [15.0, -65.0, -4.0],
                [52.0, -42.0, 3.0],
                [72.0, -3.0, -1.0],
                [53.0, 52.0, -3.0],
                [13.0, 77.0, -5.0],
                [-39.0, 62.0, -3.0],
                [-75.0, 26.0, -1.0],
                [-70.0, -31.0, 2.0],
                [-35.0, -65.0, 3.0],
                [14.0, -75.0, 3.0],
                [53.0, -47.0, 4.0],
                [80.0, -1.0, 2.0],
                [59.0, 54.0, 1.0],
                [11.0, 82.0, -5.0],
                [-40.0, 69.0, 1.0],
                [-78.0, 29.0, -3.0],
                [-75.0, -33.0, -1.0],
                [-39.0, -74.0, -5.0],
                [11.0, -81.0, 2.0],
                [61.0, -57.0, -2.0],
                [89.0, -3.0, 1.0],
                [61.0, 54.0, 3.0],
                [12.0, 83.0, 2.0],
                [-42.0, 71.0, -4.0],
                [-81.0, 31.0, 0.0],
                [-79.0, -32.0, 2.0],
                [-43.0, -73.0, -4.0],
                [12.0, -85.0, 2.0],
                [64.0, -52.0, 3.0],
                [90.0, 4.0, 4.0],
                [70.0, 61.0, -3.0],
                [11.0, 84.0, 4.0],
                [-42.0, 77.0, -1.0],
                [-83.0, 29.0, 2.0],
                [-90.0, -27.0, -2.0],
                [-46.0, -83.0, -4.0],
                [12.0, -88.0, -5.0],
                [66.0, -63.0, -4.0],
                [91.0, 4.0, -3.0],
                [73.0, 56.0, -5.0],
                [15.0, 96.0, 0.0],
                [-51.0, 79.0, 4.0],
                [-92.0, 36.0, -1.0],
                [-86.0, -33.0, 4.0],
                [-49.0, -81.0, -5.0],
                [20.0, -97.0, -1.0],
                [77.0, -60.0, 3.0],
                [95.0, -2.0, 2.0],
                [79.0, 62.0, -4.0],
                [21.0, 97.0, 3.0],
                [-50.0, 88.0, -3.0],
                [-97.0, 33.0, -5.0],
                [-90.0, -30.0, -2.0],
                [-50.0, -84.0, -3.0],
                [15.0, -94.0, 1.0],
                [73.0, -60.0, -4.0],
            ]
        )
        basis0 = BSplineBasis(
            6,
            np.array([-1.8, -0.7, 0.0, 0.0, 0.0, 0.0, 0.7, 2.2, 2.9, 4.2, 5.3, 6.0, 6.0, 6.0, 6.0, 6.7, 8.2]),
            1,
        )
        basis1 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.2, 1.6, 3.4, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        surf = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2.mirror([3, 0, 0])

        u = np.linspace(surf.start(0), surf.end(0), 9)
        v = np.linspace(surf.start(1), surf.end(1), 9)
        pt = surf(u, v)
        pt2 = surf2(u, v)

        pt2[..., 0] = -pt2[..., 0]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_translate_volume_3D_p655_C1_periodic(self):
        controlpoints = np.array(
            [
                [47.0, -5.0, 2.0],
                [39.0, 32.0, -3.0],
                [11.0, 50.0, -2.0],
                [-13.0, 49.0, -2.0],
                [-42.0, 32.0, 2.0],
                [-49.0, 4.0, -3.0],
                [-43.0, -32.0, 0.0],
                [-18.0, -44.0, -4.0],
                [13.0, -45.0, 4.0],
                [39.0, -26.0, -3.0],
                [52.0, 2.0, -3.0],
                [40.0, 36.0, -3.0],
                [16.0, 52.0, -5.0],
                [-13.0, 55.0, -4.0],
                [-42.0, 30.0, 2.0],
                [-54.0, 1.0, 1.0],
                [-46.0, -29.0, 3.0],
                [-17.0, -54.0, -5.0],
                [16.0, -55.0, 1.0],
                [45.0, -30.0, -3.0],
                [61.0, 4.0, -4.0],
                [45.0, 39.0, 3.0],
                [15.0, 56.0, 1.0],
                [-15.0, 62.0, 3.0],
                [-52.0, 40.0, 4.0],
                [-57.0, -5.0, 4.0],
                [-46.0, -41.0, -5.0],
                [-22.0, -56.0, 3.0],
                [14.0, -59.0, 3.0],
                [50.0, -40.0, -3.0],
                [63.0, 1.0, 2.0],
                [50.0, 37.0, 4.0],
                [23.0, 63.0, 4.0],
                [-24.0, 63.0, 2.0],
                [-57.0, 39.0, 2.0],
                [-67.0, -4.0, -1.0],
                [-50.0, -43.0, -4.0],
                [-24.0, -67.0, -4.0],
                [19.0, -69.0, 3.0],
                [50.0, -44.0, -3.0],
                [71.0, 4.0, -4.0],
                [55.0, 37.0, -2.0],
                [22.0, 64.0, 4.0],
                [-27.0, 64.0, 0.0],
                [-60.0, 38.0, 0.0],
                [-71.0, 1.0, 2.0],
                [-64.0, -42.0, -3.0],
                [-20.0, -71.0, 1.0],
                [19.0, -67.0, -5.0],
                [55.0, -44.0, -1.0],
                [74.0, -4.0, 1.0],
                [60.0, 45.0, 3.0],
                [22.0, 75.0, -4.0],
                [-21.0, 71.0, 0.0],
                [-64.0, 48.0, -2.0],
                [-76.0, -5.0, 2.0],
                [-59.0, -44.0, 4.0],
                [-20.0, -77.0, -3.0],
                [25.0, -71.0, 3.0],
                [61.0, -51.0, 4.0],
                [83.0, -3.0, 4.0],
                [70.0, 48.0, 0.0],
                [22.0, 80.0, -2.0],
                [-27.0, 84.0, -1.0],
                [-68.0, 51.0, -4.0],
                [-82.0, -4.0, 0.0],
                [-70.0, -45.0, -1.0],
                [-31.0, -77.0, -3.0],
                [24.0, -76.0, 0.0],
                [68.0, -46.0, 0.0],
                [91.0, 4.0, -3.0],
                [68.0, 56.0, 0.0],
                [30.0, 88.0, -3.0],
                [-30.0, 86.0, 4.0],
                [-74.0, 49.0, -1.0],
                [-88.0, 0.0, 0.0],
                [-68.0, -56.0, 0.0],
                [-32.0, -89.0, -4.0],
                [27.0, -89.0, -5.0],
                [68.0, -48.0, -3.0],
                [97.0, 0.0, -4.0],
                [76.0, 53.0, 3.0],
                [25.0, 89.0, 3.0],
                [-33.0, 87.0, -3.0],
                [-73.0, 53.0, 0.0],
                [-95.0, -1.0, -4.0],
                [-72.0, -51.0, -5.0],
                [-26.0, -92.0, -4.0],
                [25.0, -86.0, 4.0],
                [77.0, -52.0, 3.0],
                [95.0, -3.0, -5.0],
                [79.0, 61.0, 1.0],
                [33.0, 93.0, 1.0],
                [-31.0, 92.0, 0.0],
                [-83.0, 56.0, -3.0],
                [-96.0, 4.0, 3.0],
                [-78.0, -58.0, 1.0],
                [-32.0, -97.0, 4.0],
                [26.0, -93.0, -5.0],
                [77.0, -56.0, -2.0],
                [49.0, 2.0, 9.0],
                [41.0, 33.0, 9.0],
                [18.0, 47.0, 8.0],
                [-18.0, 51.0, 10.0],
                [-38.0, 28.0, 4.0],
                [-49.0, 1.0, 4.0],
                [-43.0, -32.0, 8.0],
                [-12.0, -49.0, 3.0],
                [13.0, -46.0, 8.0],
                [44.0, -33.0, 5.0],
                [55.0, -2.0, 11.0],
                [48.0, 36.0, 5.0],
                [18.0, 48.0, 5.0],
                [-15.0, 50.0, 8.0],
                [-43.0, 33.0, 12.0],
                [-57.0, -5.0, 6.0],
                [-45.0, -34.0, 7.0],
                [-21.0, -57.0, 3.0],
                [18.0, -49.0, 7.0],
                [49.0, -38.0, 9.0],
                [60.0, 2.0, 7.0],
                [44.0, 33.0, 8.0],
                [21.0, 54.0, 3.0],
                [-16.0, 53.0, 7.0],
                [-54.0, 36.0, 5.0],
                [-57.0, -3.0, 5.0],
                [-50.0, -39.0, 10.0],
                [-16.0, -57.0, 7.0],
                [23.0, -62.0, 3.0],
                [52.0, -35.0, 6.0],
                [63.0, -2.0, 6.0],
                [51.0, 41.0, 6.0],
                [18.0, 66.0, 5.0],
                [-19.0, 66.0, 3.0],
                [-58.0, 34.0, 4.0],
                [-67.0, 1.0, 11.0],
                [-57.0, -42.0, 7.0],
                [-18.0, -61.0, 10.0],
                [20.0, -68.0, 3.0],
                [55.0, -44.0, 3.0],
                [72.0, 2.0, 8.0],
                [55.0, 38.0, 4.0],
                [26.0, 69.0, 5.0],
                [-19.0, 65.0, 12.0],
                [-59.0, 41.0, 6.0],
                [-77.0, -4.0, 8.0],
                [-57.0, -43.0, 7.0],
                [-25.0, -72.0, 10.0],
                [19.0, -70.0, 3.0],
                [55.0, -42.0, 7.0],
                [82.0, -3.0, 11.0],
                [61.0, 45.0, 9.0],
                [19.0, 75.0, 8.0],
                [-27.0, 78.0, 6.0],
                [-59.0, 46.0, 7.0],
                [-80.0, 2.0, 5.0],
                [-60.0, -42.0, 8.0],
                [-25.0, -70.0, 10.0],
                [25.0, -72.0, 5.0],
                [62.0, -50.0, 3.0],
                [87.0, -4.0, 4.0],
                [71.0, 45.0, 5.0],
                [28.0, 79.0, 9.0],
                [-23.0, 82.0, 7.0],
                [-64.0, 48.0, 4.0],
                [-86.0, 3.0, 3.0],
                [-65.0, -47.0, 12.0],
                [-26.0, -75.0, 3.0],
                [21.0, -76.0, 7.0],
                [64.0, -54.0, 3.0],
                [86.0, 3.0, 9.0],
                [72.0, 50.0, 5.0],
                [27.0, 87.0, 9.0],
                [-30.0, 82.0, 12.0],
                [-73.0, 56.0, 12.0],
                [-86.0, 0.0, 6.0],
                [-77.0, -51.0, 3.0],
                [-33.0, -86.0, 4.0],
                [29.0, -90.0, 9.0],
                [68.0, -57.0, 6.0],
                [99.0, 3.0, 8.0],
                [72.0, 52.0, 9.0],
                [28.0, 91.0, 3.0],
                [-33.0, 89.0, 9.0],
                [-80.0, 59.0, 3.0],
                [-95.0, -4.0, 6.0],
                [-77.0, -59.0, 3.0],
                [-33.0, -91.0, 7.0],
                [31.0, -90.0, 3.0],
                [77.0, -56.0, 4.0],
                [100.0, 3.0, 11.0],
                [81.0, 61.0, 8.0],
                [29.0, 97.0, 10.0],
                [-31.0, 95.0, 10.0],
                [-78.0, 57.0, 11.0],
                [-103.0, -1.0, 10.0],
                [-78.0, -56.0, 11.0],
                [-27.0, -96.0, 5.0],
                [33.0, -94.0, 9.0],
                [75.0, -57.0, 3.0],
                [48.0, 1.0, 11.0],
                [41.0, 27.0, 17.0],
                [19.0, 50.0, 20.0],
                [-16.0, 50.0, 12.0],
                [-40.0, 25.0, 17.0],
                [-46.0, 1.0, 20.0],
                [-40.0, -30.0, 19.0],
                [-17.0, -44.0, 20.0],
                [13.0, -50.0, 12.0],
                [44.0, -26.0, 13.0],
                [57.0, -5.0, 15.0],
                [49.0, 27.0, 14.0],
                [20.0, 48.0, 12.0],
                [-17.0, 56.0, 13.0],
                [-43.0, 28.0, 20.0],
                [-51.0, 1.0, 20.0],
                [-44.0, -31.0, 17.0],
                [-16.0, -50.0, 19.0],
                [16.0, -49.0, 12.0],
                [41.0, -33.0, 11.0],
                [59.0, 4.0, 14.0],
                [45.0, 40.0, 16.0],
                [21.0, 56.0, 12.0],
                [-15.0, 60.0, 20.0],
                [-50.0, 37.0, 16.0],
                [-59.0, 2.0, 17.0],
                [-47.0, -39.0, 18.0],
                [-18.0, -61.0, 16.0],
                [15.0, -54.0, 17.0],
                [53.0, -35.0, 16.0],
                [67.0, 2.0, 13.0],
                [53.0, 36.0, 14.0],
                [23.0, 64.0, 18.0],
                [-24.0, 66.0, 13.0],
                [-54.0, 36.0, 17.0],
                [-69.0, 4.0, 12.0],
                [-59.0, -41.0, 11.0],
                [-19.0, -64.0, 19.0],
                [16.0, -60.0, 20.0],
                [51.0, -38.0, 17.0],
                [68.0, 0.0, 14.0],
                [54.0, 39.0, 13.0],
                [24.0, 71.0, 16.0],
                [-18.0, 72.0, 12.0],
                [-58.0, 42.0, 11.0],
                [-74.0, -2.0, 19.0],
                [-60.0, -40.0, 12.0],
                [-25.0, -67.0, 15.0],
                [21.0, -66.0, 16.0],
                [54.0, -43.0, 20.0],
                [75.0, 0.0, 19.0],
                [65.0, 50.0, 17.0],
                [19.0, 73.0, 19.0],
                [-27.0, 78.0, 13.0],
                [-67.0, 41.0, 17.0],
                [-74.0, -3.0, 18.0],
                [-66.0, -43.0, 18.0],
                [-21.0, -78.0, 16.0],
                [22.0, -75.0, 18.0],
                [61.0, -44.0, 20.0],
                [80.0, -2.0, 13.0],
                [70.0, 52.0, 20.0],
                [27.0, 82.0, 15.0],
                [-25.0, 81.0, 14.0],
                [-66.0, 51.0, 12.0],
                [-85.0, -5.0, 17.0],
                [-66.0, -48.0, 15.0],
                [-30.0, -76.0, 11.0],
                [27.0, -83.0, 12.0],
                [63.0, -54.0, 13.0],
                [83.0, -2.0, 13.0],
                [67.0, 47.0, 20.0],
                [30.0, 84.0, 11.0],
                [-24.0, 80.0, 13.0],
                [-76.0, 49.0, 15.0],
                [-91.0, 3.0, 18.0],
                [-72.0, -51.0, 15.0],
                [-31.0, -88.0, 18.0],
                [26.0, -84.0, 15.0],
                [72.0, -50.0, 14.0],
                [94.0, -1.0, 11.0],
                [80.0, 59.0, 15.0],
                [31.0, 90.0, 13.0],
                [-26.0, 86.0, 11.0],
                [-77.0, 55.0, 20.0],
                [-90.0, 4.0, 20.0],
                [-74.0, -60.0, 14.0],
                [-34.0, -93.0, 15.0],
                [26.0, -88.0, 13.0],
                [74.0, -56.0, 20.0],
                [95.0, -3.0, 16.0],
                [78.0, 54.0, 17.0],
                [28.0, 99.0, 18.0],
                [-36.0, 94.0, 13.0],
                [-77.0, 59.0, 13.0],
                [-100.0, -1.0, 20.0],
                [-79.0, -58.0, 17.0],
                [-32.0, -96.0, 18.0],
                [29.0, -100.0, 18.0],
                [78.0, -57.0, 18.0],
                [52.0, -2.0, 26.0],
                [41.0, 33.0, 26.0],
                [10.0, 43.0, 25.0],
                [-15.0, 44.0, 26.0],
                [-42.0, 31.0, 20.0],
                [-48.0, 2.0, 24.0],
                [-42.0, -32.0, 24.0],
                [-16.0, -52.0, 24.0],
                [14.0, -45.0, 22.0],
                [45.0, -33.0, 22.0],
                [53.0, 4.0, 27.0],
                [45.0, 29.0, 25.0],
                [13.0, 54.0, 19.0],
                [-19.0, 50.0, 25.0],
                [-44.0, 31.0, 28.0],
                [-56.0, 1.0, 20.0],
                [-43.0, -31.0, 27.0],
                [-16.0, -51.0, 28.0],
                [20.0, -53.0, 26.0],
                [41.0, -34.0, 19.0],
                [57.0, 4.0, 24.0],
                [48.0, 40.0, 27.0],
                [21.0, 62.0, 24.0],
                [-23.0, 57.0, 23.0],
                [-54.0, 39.0, 19.0],
                [-64.0, 3.0, 28.0],
                [-52.0, -38.0, 26.0],
                [-16.0, -58.0, 20.0],
                [17.0, -59.0, 24.0],
                [50.0, -36.0, 23.0],
                [65.0, 4.0, 21.0],
                [51.0, 40.0, 20.0],
                [17.0, 66.0, 24.0],
                [-23.0, 60.0, 28.0],
                [-55.0, 40.0, 28.0],
                [-64.0, 1.0, 23.0],
                [-50.0, -42.0, 22.0],
                [-21.0, -59.0, 20.0],
                [23.0, -59.0, 25.0],
                [58.0, -39.0, 22.0],
                [76.0, 1.0, 28.0],
                [59.0, 38.0, 23.0],
                [22.0, 70.0, 23.0],
                [-25.0, 67.0, 24.0],
                [-62.0, 37.0, 26.0],
                [-77.0, 0.0, 19.0],
                [-61.0, -44.0, 23.0],
                [-21.0, -69.0, 25.0],
                [18.0, -64.0, 24.0],
                [62.0, -46.0, 24.0],
                [81.0, -2.0, 20.0],
                [62.0, 42.0, 22.0],
                [27.0, 71.0, 20.0],
                [-24.0, 70.0, 25.0],
                [-61.0, 47.0, 26.0],
                [-83.0, 2.0, 27.0],
                [-59.0, -41.0, 26.0],
                [-23.0, -78.0, 20.0],
                [27.0, -76.0, 20.0],
                [66.0, -44.0, 19.0],
                [82.0, -4.0, 26.0],
                [71.0, 47.0, 26.0],
                [23.0, 79.0, 19.0],
                [-27.0, 80.0, 19.0],
                [-70.0, 47.0, 19.0],
                [-81.0, 3.0, 27.0],
                [-68.0, -48.0, 28.0],
                [-27.0, -79.0, 21.0],
                [30.0, -77.0, 23.0],
                [71.0, -49.0, 22.0],
                [85.0, -4.0, 26.0],
                [74.0, 53.0, 21.0],
                [26.0, 83.0, 26.0],
                [-25.0, 89.0, 27.0],
                [-73.0, 50.0, 28.0],
                [-85.0, -2.0, 26.0],
                [-72.0, -55.0, 24.0],
                [-33.0, -87.0, 22.0],
                [26.0, -84.0, 22.0],
                [76.0, -51.0, 28.0],
                [90.0, -1.0, 28.0],
                [80.0, 56.0, 23.0],
                [25.0, 87.0, 22.0],
                [-25.0, 89.0, 28.0],
                [-82.0, 50.0, 19.0],
                [-92.0, -5.0, 21.0],
                [-77.0, -53.0, 23.0],
                [-33.0, -86.0, 21.0],
                [28.0, -95.0, 26.0],
                [75.0, -57.0, 20.0],
                [98.0, -1.0, 24.0],
                [85.0, 57.0, 20.0],
                [26.0, 100.0, 27.0],
                [-29.0, 96.0, 27.0],
                [-79.0, 60.0, 25.0],
                [-102.0, 1.0, 23.0],
                [-85.0, -63.0, 28.0],
                [-33.0, -92.0, 21.0],
                [31.0, -97.0, 20.0],
                [77.0, -60.0, 23.0],
                [50.0, -3.0, 28.0],
                [44.0, 30.0, 29.0],
                [18.0, 44.0, 27.0],
                [-13.0, 44.0, 33.0],
                [-45.0, 27.0, 31.0],
                [-47.0, 4.0, 36.0],
                [-38.0, -32.0, 27.0],
                [-17.0, -45.0, 32.0],
                [20.0, -50.0, 27.0],
                [40.0, -29.0, 31.0],
                [52.0, -3.0, 34.0],
                [40.0, 36.0, 33.0],
                [21.0, 54.0, 36.0],
                [-20.0, 48.0, 27.0],
                [-44.0, 33.0, 31.0],
                [-59.0, -3.0, 33.0],
                [-47.0, -35.0, 36.0],
                [-20.0, -57.0, 28.0],
                [16.0, -56.0, 31.0],
                [49.0, -30.0, 32.0],
                [59.0, 0.0, 30.0],
                [46.0, 38.0, 27.0],
                [22.0, 53.0, 27.0],
                [-18.0, 59.0, 33.0],
                [-52.0, 36.0, 28.0],
                [-63.0, -5.0, 30.0],
                [-47.0, -36.0, 27.0],
                [-24.0, -63.0, 30.0],
                [16.0, -63.0, 32.0],
                [50.0, -33.0, 35.0],
                [66.0, -2.0, 33.0],
                [52.0, 43.0, 33.0],
                [15.0, 67.0, 36.0],
                [-17.0, 59.0, 35.0],
                [-52.0, 42.0, 28.0],
                [-64.0, 2.0, 36.0],
                [-55.0, -35.0, 29.0],
                [-24.0, -59.0, 34.0],
                [20.0, -67.0, 27.0],
                [52.0, -37.0, 32.0],
                [75.0, 0.0, 29.0],
                [57.0, 41.0, 32.0],
                [21.0, 70.0, 34.0],
                [-24.0, 71.0, 27.0],
                [-61.0, 39.0, 27.0],
                [-71.0, 0.0, 34.0],
                [-58.0, -46.0, 36.0],
                [-23.0, -70.0, 36.0],
                [19.0, -73.0, 34.0],
                [57.0, -44.0, 27.0],
                [75.0, -2.0, 33.0],
                [61.0, 49.0, 30.0],
                [22.0, 74.0, 30.0],
                [-26.0, 69.0, 27.0],
                [-61.0, 41.0, 36.0],
                [-75.0, 4.0, 36.0],
                [-60.0, -42.0, 29.0],
                [-21.0, -71.0, 27.0],
                [26.0, -77.0, 34.0],
                [67.0, -47.0, 27.0],
                [85.0, 4.0, 36.0],
                [65.0, 53.0, 28.0],
                [28.0, 78.0, 34.0],
                [-27.0, 78.0, 35.0],
                [-68.0, 51.0, 29.0],
                [-88.0, -5.0, 33.0],
                [-67.0, -44.0, 33.0],
                [-23.0, -78.0, 31.0],
                [27.0, -79.0, 31.0],
                [68.0, -54.0, 30.0],
                [87.0, 2.0, 28.0],
                [68.0, 49.0, 27.0],
                [30.0, 80.0, 31.0],
                [-26.0, 87.0, 34.0],
                [-75.0, 56.0, 32.0],
                [-87.0, 0.0, 33.0],
                [-77.0, -53.0, 34.0],
                [-31.0, -81.0, 27.0],
                [28.0, -83.0, 29.0],
                [68.0, -56.0, 36.0],
                [96.0, -1.0, 36.0],
                [81.0, 56.0, 33.0],
                [30.0, 92.0, 28.0],
                [-31.0, 93.0, 36.0],
                [-73.0, 59.0, 35.0],
                [-97.0, -5.0, 35.0],
                [-78.0, -61.0, 36.0],
                [-32.0, -89.0, 30.0],
                [31.0, -94.0, 36.0],
                [71.0, -55.0, 30.0],
                [96.0, 0.0, 36.0],
                [82.0, 59.0, 34.0],
                [25.0, 91.0, 29.0],
                [-36.0, 97.0, 28.0],
                [-82.0, 59.0, 29.0],
                [-97.0, 4.0, 27.0],
                [-83.0, -60.0, 32.0],
                [-34.0, -96.0, 27.0],
                [28.0, -96.0, 35.0],
                [85.0, -59.0, 34.0],
                [46.0, 4.0, 40.0],
                [39.0, 33.0, 43.0],
                [13.0, 44.0, 42.0],
                [-17.0, 49.0, 43.0],
                [-45.0, 29.0, 37.0],
                [-46.0, 4.0, 42.0],
                [-40.0, -35.0, 37.0],
                [-14.0, -51.0, 37.0],
                [16.0, -49.0, 41.0],
                [37.0, -27.0, 41.0],
                [51.0, 1.0, 40.0],
                [41.0, 28.0, 42.0],
                [18.0, 54.0, 43.0],
                [-17.0, 52.0, 41.0],
                [-46.0, 34.0, 37.0],
                [-60.0, 0.0, 37.0],
                [-50.0, -31.0, 36.0],
                [-21.0, -53.0, 36.0],
                [12.0, -54.0, 42.0],
                [42.0, -32.0, 42.0],
                [58.0, -2.0, 37.0],
                [53.0, 36.0, 40.0],
                [14.0, 55.0, 36.0],
                [-20.0, 62.0, 43.0],
                [-46.0, 36.0, 38.0],
                [-65.0, 1.0, 38.0],
                [-48.0, -35.0, 44.0],
                [-16.0, -62.0, 43.0],
                [17.0, -63.0, 42.0],
                [53.0, -40.0, 43.0],
                [64.0, -4.0, 36.0],
                [50.0, 40.0, 40.0],
                [18.0, 59.0, 35.0],
                [-18.0, 59.0, 43.0],
                [-58.0, 40.0, 39.0],
                [-70.0, -4.0, 39.0],
                [-58.0, -37.0, 37.0],
                [-24.0, -61.0, 39.0],
                [23.0, -62.0, 36.0],
                [58.0, -43.0, 40.0],
                [68.0, 3.0, 37.0],
                [62.0, 42.0, 42.0],
                [19.0, 65.0, 35.0],
                [-26.0, 65.0, 42.0],
                [-59.0, 41.0, 37.0],
                [-77.0, -2.0, 44.0],
                [-58.0, -45.0, 38.0],
                [-26.0, -69.0, 39.0],
                [21.0, -64.0, 37.0],
                [60.0, -41.0, 44.0],
                [81.0, -1.0, 44.0],
                [59.0, 46.0, 36.0],
                [22.0, 73.0, 43.0],
                [-26.0, 71.0, 36.0],
                [-65.0, 43.0, 40.0],
                [-82.0, -4.0, 38.0],
                [-60.0, -49.0, 43.0],
                [-25.0, -75.0, 39.0],
                [26.0, -73.0, 42.0],
                [66.0, -43.0, 43.0],
                [78.0, 3.0, 36.0],
                [71.0, 46.0, 36.0],
                [26.0, 76.0, 39.0],
                [-25.0, 78.0, 38.0],
                [-66.0, 50.0, 38.0],
                [-84.0, 0.0, 43.0],
                [-63.0, -49.0, 39.0],
                [-30.0, -83.0, 35.0],
                [24.0, -84.0, 42.0],
                [66.0, -51.0, 39.0],
                [89.0, 2.0, 42.0],
                [68.0, 55.0, 41.0],
                [30.0, 82.0, 43.0],
                [-28.0, 87.0, 38.0],
                [-72.0, 50.0, 38.0],
                [-93.0, -1.0, 42.0],
                [-77.0, -56.0, 41.0],
                [-27.0, -83.0, 38.0],
                [26.0, -88.0, 39.0],
                [69.0, -52.0, 39.0],
                [95.0, 3.0, 41.0],
                [77.0, 53.0, 42.0],
                [29.0, 86.0, 44.0],
                [-25.0, 92.0, 36.0],
                [-80.0, 57.0, 44.0],
                [-91.0, -3.0, 44.0],
                [-72.0, -57.0, 44.0],
                [-28.0, -87.0, 37.0],
                [24.0, -86.0, 44.0],
                [78.0, -55.0, 43.0],
                [99.0, -2.0, 36.0],
                [83.0, 61.0, 39.0],
                [31.0, 91.0, 41.0],
                [-29.0, 98.0, 35.0],
                [-79.0, 59.0, 42.0],
                [-101.0, -5.0, 38.0],
                [-81.0, -63.0, 36.0],
                [-29.0, -93.0, 36.0],
                [30.0, -94.0, 43.0],
                [80.0, -57.0, 42.0],
            ]
        )
        basis0 = BSplineBasis(
            6,
            np.array(
                [-2.2, -0.8, 0.0, 0.0, 0.0, 0.0, 0.8, 1.9, 2.9, 4.3, 4.8, 6.2, 7.0, 7.0, 7.0, 7.0, 7.8, 8.9]
            ),
            1,
        )
        basis1 = BSplineBasis(
            5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 1.2, 2.1, 3.2, 4.3, 5.0, 6.0, 6.0, 6.0, 6.0, 6.0])
        )
        basis2 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.6, 2.0, 2.0, 2.0, 2.0, 2.0]))
        vol = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2 += np.array([4.6, 2.0, 3.1])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] -= 4.600000
        pt2[..., 1] -= 2.000000
        pt2[..., 2] -= 3.100000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_scale_volume_3D_p577_C1_periodic(self):
        controlpoints = np.array(
            [
                [48.0, -4.0, -2.0],
                [38.0, 36.0, -3.0],
                [-2.0, 54.0, -3.0],
                [-34.0, 34.0, 3.0],
                [-49.0, 2.0, -4.0],
                [-34.0, -34.0, 0.0],
                [-1.0, -48.0, -3.0],
                [31.0, -34.0, 3.0],
                [56.0, -2.0, -3.0],
                [43.0, 42.0, 3.0],
                [-2.0, 57.0, 2.0],
                [-43.0, 36.0, 1.0],
                [-58.0, -3.0, -4.0],
                [-41.0, -41.0, -1.0],
                [-3.0, -57.0, 2.0],
                [41.0, -39.0, 1.0],
                [60.0, -4.0, 1.0],
                [49.0, 49.0, -2.0],
                [0.0, 66.0, -2.0],
                [-44.0, 47.0, 2.0],
                [-65.0, 2.0, -4.0],
                [-48.0, -44.0, 0.0],
                [2.0, -67.0, -4.0],
                [39.0, -48.0, 1.0],
                [67.0, 4.0, 1.0],
                [45.0, 46.0, -3.0],
                [-4.0, 73.0, 0.0],
                [-52.0, 53.0, -2.0],
                [-72.0, 0.0, -3.0],
                [-51.0, -54.0, 3.0],
                [1.0, -66.0, 3.0],
                [43.0, -44.0, 2.0],
                [71.0, 1.0, -3.0],
                [49.0, 56.0, -3.0],
                [-2.0, 79.0, -2.0],
                [-57.0, 49.0, -4.0],
                [-77.0, 0.0, 1.0],
                [-50.0, -51.0, -4.0],
                [-5.0, -71.0, 0.0],
                [53.0, -54.0, 0.0],
                [81.0, 1.0, -2.0],
                [54.0, 59.0, -3.0],
                [0.0, 79.0, -3.0],
                [-54.0, 53.0, -4.0],
                [-77.0, 2.0, 0.0],
                [-53.0, -63.0, 4.0],
                [-1.0, -85.0, 3.0],
                [56.0, -53.0, 4.0],
                [84.0, 4.0, -1.0],
                [59.0, 63.0, 4.0],
                [-2.0, 89.0, 0.0],
                [-60.0, 63.0, 2.0],
                [-84.0, 4.0, 3.0],
                [-58.0, -59.0, 4.0],
                [-1.0, -90.0, -3.0],
                [59.0, -63.0, -3.0],
                [90.0, 4.0, 1.0],
                [70.0, 67.0, 1.0],
                [-5.0, 94.0, 3.0],
                [-63.0, 66.0, 3.0],
                [-95.0, -4.0, -1.0],
                [-64.0, -65.0, 0.0],
                [-1.0, -91.0, -5.0],
                [70.0, -67.0, 2.0],
                [97.0, -3.0, -3.0],
                [71.0, 74.0, 4.0],
                [-5.0, 95.0, 1.0],
                [-73.0, 70.0, 1.0],
                [-96.0, -2.0, 0.0],
                [-76.0, -74.0, 0.0],
                [3.0, -97.0, 0.0],
                [70.0, -71.0, -3.0],
                [45.0, 1.0, 6.0],
                [33.0, 40.0, -1.0],
                [-5.0, 46.0, 5.0],
                [-35.0, 39.0, 2.0],
                [-52.0, 4.0, 1.0],
                [-37.0, -36.0, -1.0],
                [-1.0, -46.0, 4.0],
                [36.0, -32.0, 5.0],
                [53.0, -2.0, 1.0],
                [42.0, 43.0, 5.0],
                [1.0, 57.0, 0.0],
                [-45.0, 41.0, 2.0],
                [-52.0, 3.0, -1.0],
                [-40.0, -35.0, 0.0],
                [2.0, -57.0, 3.0],
                [40.0, -45.0, 5.0],
                [59.0, 3.0, 7.0],
                [45.0, 46.0, 7.0],
                [-5.0, 64.0, 4.0],
                [-48.0, 42.0, 1.0],
                [-63.0, -4.0, -2.0],
                [-48.0, -48.0, 6.0],
                [-1.0, -63.0, 3.0],
                [45.0, -43.0, -1.0],
                [65.0, -1.0, 0.0],
                [44.0, 48.0, 1.0],
                [-1.0, 70.0, 6.0],
                [-48.0, 53.0, 4.0],
                [-70.0, -1.0, 7.0],
                [-54.0, -49.0, 3.0],
                [-3.0, -70.0, -1.0],
                [52.0, -46.0, 1.0],
                [74.0, 1.0, 8.0],
                [57.0, 51.0, 5.0],
                [-4.0, 75.0, 2.0],
                [-52.0, 54.0, 2.0],
                [-72.0, -5.0, 6.0],
                [-51.0, -51.0, -2.0],
                [2.0, -76.0, 0.0],
                [50.0, -52.0, 7.0],
                [79.0, -2.0, 0.0],
                [55.0, 62.0, 6.0],
                [4.0, 83.0, 5.0],
                [-59.0, 55.0, 2.0],
                [-81.0, -3.0, 0.0],
                [-55.0, -61.0, 5.0],
                [0.0, -82.0, 0.0],
                [55.0, -60.0, 6.0],
                [83.0, 3.0, 3.0],
                [65.0, 60.0, 3.0],
                [-3.0, 86.0, 3.0],
                [-67.0, 65.0, 2.0],
                [-90.0, 1.0, 8.0],
                [-62.0, -66.0, 5.0],
                [-5.0, -85.0, -1.0],
                [61.0, -65.0, 0.0],
                [89.0, -1.0, 6.0],
                [64.0, 62.0, 2.0],
                [4.0, 93.0, 7.0],
                [-66.0, 61.0, 8.0],
                [-92.0, -5.0, 1.0],
                [-70.0, -68.0, 2.0],
                [-3.0, -94.0, 1.0],
                [66.0, -67.0, 1.0],
                [102.0, -1.0, 8.0],
                [66.0, 70.0, 6.0],
                [-2.0, 99.0, 3.0],
                [-68.0, 67.0, 2.0],
                [-104.0, -1.0, 1.0],
                [-74.0, -72.0, 7.0],
                [-4.0, -98.0, 6.0],
                [70.0, -66.0, 7.0],
                [50.0, -4.0, 2.0],
                [37.0, 37.0, 7.0],
                [0.0, 50.0, 11.0],
                [-32.0, 38.0, 7.0],
                [-52.0, -4.0, 9.0],
                [-38.0, -37.0, 3.0],
                [-4.0, -51.0, 7.0],
                [35.0, -33.0, 7.0],
                [59.0, -3.0, 4.0],
                [44.0, 36.0, 8.0],
                [1.0, 54.0, 3.0],
                [-37.0, 38.0, 2.0],
                [-61.0, -5.0, 4.0],
                [-43.0, -42.0, 2.0],
                [-3.0, -60.0, 5.0],
                [36.0, -40.0, 12.0],
                [66.0, 1.0, 9.0],
                [46.0, 40.0, 7.0],
                [2.0, 61.0, 3.0],
                [-48.0, 41.0, 4.0],
                [-63.0, -5.0, 2.0],
                [-40.0, -44.0, 8.0],
                [3.0, -62.0, 8.0],
                [46.0, -43.0, 3.0],
                [65.0, 1.0, 3.0],
                [49.0, 44.0, 10.0],
                [1.0, 72.0, 9.0],
                [-49.0, 47.0, 3.0],
                [-72.0, -2.0, 3.0],
                [-49.0, -50.0, 8.0],
                [-4.0, -68.0, 3.0],
                [45.0, -47.0, 6.0],
                [71.0, 2.0, 2.0],
                [50.0, 55.0, 8.0],
                [-1.0, 71.0, 8.0],
                [-56.0, 53.0, 3.0],
                [-73.0, -3.0, 8.0],
                [-51.0, -51.0, 7.0],
                [3.0, -72.0, 6.0],
                [53.0, -51.0, 8.0],
                [85.0, -1.0, 10.0],
                [57.0, 55.0, 11.0],
                [1.0, 80.0, 7.0],
                [-62.0, 60.0, 8.0],
                [-84.0, -2.0, 5.0],
                [-57.0, -57.0, 10.0],
                [-2.0, -83.0, 9.0],
                [57.0, -63.0, 4.0],
                [87.0, 2.0, 11.0],
                [59.0, 58.0, 10.0],
                [-3.0, 82.0, 4.0],
                [-64.0, 60.0, 10.0],
                [-85.0, 4.0, 10.0],
                [-60.0, -64.0, 2.0],
                [-4.0, -87.0, 5.0],
                [57.0, -62.0, 3.0],
                [92.0, 3.0, 10.0],
                [68.0, 64.0, 3.0],
                [-1.0, 92.0, 3.0],
                [-63.0, 61.0, 6.0],
                [-96.0, -5.0, 6.0],
                [-66.0, -70.0, 11.0],
                [4.0, -90.0, 11.0],
                [61.0, -71.0, 3.0],
                [102.0, -5.0, 7.0],
                [74.0, 75.0, 3.0],
                [-2.0, 98.0, 11.0],
                [-70.0, 75.0, 7.0],
                [-100.0, 1.0, 9.0],
                [-66.0, -74.0, 3.0],
                [-1.0, -99.0, 8.0],
                [72.0, -67.0, 10.0],
                [53.0, 3.0, 8.0],
                [34.0, 34.0, 12.0],
                [1.0, 49.0, 12.0],
                [-33.0, 35.0, 10.0],
                [-48.0, -1.0, 15.0],
                [-34.0, -39.0, 10.0],
                [-1.0, -54.0, 12.0],
                [31.0, -33.0, 13.0],
                [56.0, -2.0, 11.0],
                [39.0, 37.0, 6.0],
                [4.0, 52.0, 13.0],
                [-44.0, 43.0, 14.0],
                [-55.0, -2.0, 14.0],
                [-40.0, -44.0, 7.0],
                [0.0, -62.0, 15.0],
                [37.0, -38.0, 10.0],
                [60.0, 2.0, 9.0],
                [43.0, 42.0, 14.0],
                [1.0, 62.0, 14.0],
                [-42.0, 45.0, 8.0],
                [-61.0, 0.0, 8.0],
                [-40.0, -44.0, 6.0],
                [-4.0, -65.0, 8.0],
                [47.0, -47.0, 10.0],
                [72.0, -4.0, 8.0],
                [51.0, 44.0, 14.0],
                [-1.0, 69.0, 10.0],
                [-48.0, 48.0, 14.0],
                [-64.0, -4.0, 8.0],
                [-53.0, -52.0, 12.0],
                [-1.0, -70.0, 13.0],
                [50.0, -49.0, 15.0],
                [70.0, -4.0, 15.0],
                [56.0, 55.0, 14.0],
                [-1.0, 73.0, 15.0],
                [-57.0, 57.0, 7.0],
                [-79.0, -4.0, 13.0],
                [-50.0, -49.0, 7.0],
                [-4.0, -73.0, 9.0],
                [53.0, -52.0, 6.0],
                [81.0, -5.0, 15.0],
                [57.0, 53.0, 6.0],
                [2.0, 80.0, 15.0],
                [-57.0, 61.0, 9.0],
                [-85.0, 4.0, 8.0],
                [-63.0, -56.0, 7.0],
                [3.0, -81.0, 6.0],
                [59.0, -55.0, 12.0],
                [88.0, -4.0, 12.0],
                [66.0, 63.0, 14.0],
                [4.0, 83.0, 6.0],
                [-60.0, 57.0, 14.0],
                [-88.0, -5.0, 13.0],
                [-59.0, -64.0, 15.0],
                [2.0, -92.0, 10.0],
                [57.0, -66.0, 12.0],
                [94.0, -4.0, 12.0],
                [67.0, 70.0, 11.0],
                [-2.0, 91.0, 14.0],
                [-67.0, 64.0, 6.0],
                [-93.0, 2.0, 6.0],
                [-62.0, -64.0, 10.0],
                [-1.0, -94.0, 10.0],
                [66.0, -71.0, 9.0],
                [104.0, 2.0, 15.0],
                [68.0, 67.0, 10.0],
                [3.0, 98.0, 8.0],
                [-74.0, 71.0, 8.0],
                [-101.0, -2.0, 7.0],
                [-69.0, -70.0, 6.0],
                [-2.0, -99.0, 15.0],
                [66.0, -72.0, 10.0],
                [52.0, 1.0, 13.0],
                [33.0, 38.0, 12.0],
                [-3.0, 53.0, 16.0],
                [-33.0, 30.0, 16.0],
                [-49.0, -4.0, 17.0],
                [-31.0, -41.0, 14.0],
                [0.0, -54.0, 15.0],
                [33.0, -40.0, 14.0],
                [51.0, 1.0, 15.0],
                [40.0, 38.0, 11.0],
                [-4.0, 53.0, 11.0],
                [-45.0, 36.0, 15.0],
                [-60.0, -4.0, 14.0],
                [-38.0, -37.0, 10.0],
                [-4.0, -59.0, 16.0],
                [40.0, -39.0, 14.0],
                [60.0, -1.0, 17.0],
                [39.0, 48.0, 16.0],
                [-4.0, 63.0, 14.0],
                [-48.0, 44.0, 16.0],
                [-61.0, -1.0, 17.0],
                [-49.0, -47.0, 18.0],
                [0.0, -64.0, 14.0],
                [49.0, -49.0, 10.0],
                [72.0, -2.0, 10.0],
                [51.0, 51.0, 19.0],
                [-4.0, 72.0, 15.0],
                [-44.0, 43.0, 11.0],
                [-73.0, 4.0, 11.0],
                [-51.0, -46.0, 13.0],
                [1.0, -71.0, 12.0],
                [52.0, -52.0, 16.0],
                [77.0, -2.0, 15.0],
                [54.0, 57.0, 17.0],
                [1.0, 75.0, 15.0],
                [-52.0, 52.0, 14.0],
                [-73.0, -5.0, 13.0],
                [-56.0, -55.0, 10.0],
                [-2.0, -76.0, 13.0],
                [56.0, -50.0, 17.0],
                [82.0, -4.0, 11.0],
                [62.0, 53.0, 15.0],
                [-2.0, 81.0, 12.0],
                [-54.0, 61.0, 11.0],
                [-83.0, 0.0, 10.0],
                [-62.0, -61.0, 18.0],
                [-1.0, -83.0, 13.0],
                [58.0, -59.0, 10.0],
                [89.0, 2.0, 12.0],
                [66.0, 65.0, 14.0],
                [-3.0, 88.0, 14.0],
                [-59.0, 62.0, 19.0],
                [-84.0, 0.0, 11.0],
                [-66.0, -61.0, 19.0],
                [-5.0, -89.0, 14.0],
                [65.0, -61.0, 17.0],
                [96.0, -4.0, 13.0],
                [63.0, 63.0, 11.0],
                [-4.0, 93.0, 10.0],
                [-62.0, 63.0, 17.0],
                [-94.0, 1.0, 16.0],
                [-70.0, -65.0, 16.0],
                [-5.0, -92.0, 16.0],
                [71.0, -70.0, 18.0],
                [100.0, -4.0, 10.0],
                [73.0, 72.0, 11.0],
                [-4.0, 95.0, 10.0],
                [-69.0, 66.0, 14.0],
                [-96.0, 3.0, 18.0],
                [-75.0, -69.0, 10.0],
                [-2.0, -102.0, 13.0],
                [74.0, -70.0, 12.0],
                [54.0, -1.0, 13.0],
                [34.0, 30.0, 19.0],
                [1.0, 46.0, 21.0],
                [-38.0, 31.0, 14.0],
                [-55.0, 3.0, 21.0],
                [-35.0, -36.0, 16.0],
                [3.0, -46.0, 18.0],
                [37.0, -33.0, 20.0],
                [57.0, 2.0, 16.0],
                [35.0, 43.0, 20.0],
                [-5.0, 54.0, 17.0],
                [-39.0, 35.0, 17.0],
                [-54.0, 3.0, 17.0],
                [-41.0, -43.0, 13.0],
                [-3.0, -61.0, 17.0],
                [43.0, -40.0, 20.0],
                [61.0, -1.0, 21.0],
                [48.0, 45.0, 16.0],
                [1.0, 64.0, 17.0],
                [-44.0, 45.0, 19.0],
                [-61.0, 3.0, 17.0],
                [-41.0, -40.0, 22.0],
                [-4.0, -68.0, 14.0],
                [43.0, -46.0, 20.0],
                [65.0, -3.0, 13.0],
                [50.0, 47.0, 17.0],
                [3.0, 64.0, 16.0],
                [-50.0, 46.0, 16.0],
                [-72.0, 1.0, 16.0],
                [-49.0, -51.0, 13.0],
                [-2.0, -68.0, 22.0],
                [53.0, -49.0, 18.0],
                [76.0, -3.0, 21.0],
                [50.0, 50.0, 15.0],
                [0.0, 74.0, 14.0],
                [-52.0, 51.0, 18.0],
                [-74.0, -2.0, 14.0],
                [-53.0, -54.0, 22.0],
                [1.0, -73.0, 21.0],
                [54.0, -54.0, 16.0],
                [80.0, 4.0, 18.0],
                [57.0, 58.0, 14.0],
                [4.0, 84.0, 18.0],
                [-54.0, 55.0, 14.0],
                [-82.0, 1.0, 14.0],
                [-61.0, -54.0, 22.0],
                [-4.0, -78.0, 22.0],
                [59.0, -55.0, 22.0],
                [89.0, 3.0, 16.0],
                [58.0, 58.0, 14.0],
                [4.0, 90.0, 16.0],
                [-59.0, 64.0, 16.0],
                [-90.0, 2.0, 22.0],
                [-65.0, -58.0, 17.0],
                [4.0, -86.0, 17.0],
                [62.0, -63.0, 15.0],
                [98.0, 4.0, 20.0],
                [70.0, 66.0, 19.0],
                [0.0, 88.0, 19.0],
                [-71.0, 70.0, 23.0],
                [-92.0, 0.0, 17.0],
                [-63.0, -68.0, 15.0],
                [4.0, -95.0, 22.0],
                [65.0, -70.0, 19.0],
                [98.0, 1.0, 17.0],
                [73.0, 71.0, 20.0],
                [1.0, 97.0, 13.0],
                [-68.0, 72.0, 17.0],
                [-101.0, 3.0, 14.0],
                [-70.0, -67.0, 16.0],
                [2.0, -97.0, 14.0],
                [67.0, -73.0, 21.0],
                [51.0, -5.0, 18.0],
                [32.0, 31.0, 25.0],
                [-1.0, 46.0, 22.0],
                [-33.0, 33.0, 24.0],
                [-47.0, -1.0, 20.0],
                [-40.0, -40.0, 18.0],
                [-4.0, -48.0, 17.0],
                [37.0, -33.0, 25.0],
                [53.0, 1.0, 24.0],
                [38.0, 44.0, 23.0],
                [-4.0, 52.0, 21.0],
                [-41.0, 36.0, 22.0],
                [-60.0, 4.0, 20.0],
                [-39.0, -39.0, 26.0],
                [-1.0, -57.0, 19.0],
                [42.0, -45.0, 17.0],
                [58.0, 4.0, 26.0],
                [41.0, 47.0, 24.0],
                [3.0, 58.0, 25.0],
                [-48.0, 42.0, 26.0],
                [-64.0, -4.0, 17.0],
                [-43.0, -43.0, 21.0],
                [1.0, -65.0, 20.0],
                [40.0, -43.0, 25.0],
                [70.0, 2.0, 23.0],
                [50.0, 45.0, 16.0],
                [-2.0, 69.0, 21.0],
                [-52.0, 53.0, 23.0],
                [-68.0, 2.0, 18.0],
                [-47.0, -53.0, 19.0],
                [-5.0, -69.0, 21.0],
                [49.0, -51.0, 24.0],
                [76.0, 2.0, 20.0],
                [50.0, 56.0, 23.0],
                [-5.0, 78.0, 18.0],
                [-56.0, 56.0, 18.0],
                [-77.0, -3.0, 17.0],
                [-58.0, -58.0, 18.0],
                [-4.0, -74.0, 18.0],
                [56.0, -59.0, 17.0],
                [76.0, 4.0, 26.0],
                [61.0, 57.0, 16.0],
                [0.0, 85.0, 25.0],
                [-60.0, 58.0, 24.0],
                [-86.0, 1.0, 23.0],
                [-60.0, -56.0, 20.0],
                [-2.0, -82.0, 23.0],
                [59.0, -57.0, 20.0],
                [91.0, 4.0, 18.0],
                [60.0, 64.0, 23.0],
                [-1.0, 90.0, 23.0],
                [-60.0, 63.0, 24.0],
                [-84.0, -3.0, 19.0],
                [-65.0, -66.0, 17.0],
                [0.0, -92.0, 21.0],
                [65.0, -65.0, 26.0],
                [91.0, -1.0, 24.0],
                [63.0, 71.0, 19.0],
                [-4.0, 89.0, 25.0],
                [-68.0, 67.0, 26.0],
                [-92.0, -3.0, 25.0],
                [-65.0, -72.0, 22.0],
                [-2.0, -99.0, 21.0],
                [69.0, -62.0, 19.0],
                [98.0, 2.0, 19.0],
                [71.0, 74.0, 25.0],
                [4.0, 97.0, 20.0],
                [-74.0, 68.0, 23.0],
                [-104.0, 4.0, 17.0],
                [-76.0, -70.0, 24.0],
                [-1.0, -104.0, 21.0],
                [72.0, -73.0, 19.0],
                [46.0, -3.0, 23.0],
                [30.0, 33.0, 26.0],
                [4.0, 54.0, 26.0],
                [-41.0, 32.0, 27.0],
                [-50.0, 0.0, 20.0],
                [-38.0, -36.0, 26.0],
                [-1.0, -50.0, 26.0],
                [36.0, -33.0, 25.0],
                [60.0, -4.0, 30.0],
                [44.0, 42.0, 29.0],
                [3.0, 54.0, 28.0],
                [-42.0, 35.0, 22.0],
                [-54.0, 0.0, 22.0],
                [-42.0, -44.0, 22.0],
                [-4.0, -58.0, 25.0],
                [40.0, -40.0, 25.0],
                [61.0, 1.0, 23.0],
                [47.0, 43.0, 24.0],
                [-1.0, 61.0, 28.0],
                [-47.0, 48.0, 23.0],
                [-66.0, 4.0, 25.0],
                [-48.0, -47.0, 20.0],
                [4.0, -64.0, 24.0],
                [48.0, -47.0, 21.0],
                [64.0, -5.0, 28.0],
                [47.0, 50.0, 26.0],
                [-4.0, 70.0, 24.0],
                [-47.0, 52.0, 22.0],
                [-72.0, -4.0, 23.0],
                [-51.0, -48.0, 24.0],
                [-3.0, -70.0, 25.0],
                [53.0, -50.0, 27.0],
                [71.0, -2.0, 30.0],
                [57.0, 54.0, 29.0],
                [-5.0, 74.0, 21.0],
                [-57.0, 53.0, 30.0],
                [-71.0, -3.0, 23.0],
                [-58.0, -50.0, 26.0],
                [3.0, -75.0, 21.0],
                [51.0, -57.0, 26.0],
                [85.0, -5.0, 21.0],
                [52.0, 61.0, 26.0],
                [-5.0, 82.0, 21.0],
                [-59.0, 60.0, 23.0],
                [-80.0, 4.0, 27.0],
                [-53.0, -56.0, 27.0],
                [-2.0, -86.0, 20.0],
                [61.0, -58.0, 23.0],
                [82.0, 4.0, 23.0],
                [63.0, 59.0, 28.0],
                [-5.0, 90.0, 21.0],
                [-66.0, 58.0, 25.0],
                [-89.0, 3.0, 24.0],
                [-66.0, -61.0, 26.0],
                [-2.0, -92.0, 28.0],
                [62.0, -62.0, 22.0],
                [92.0, 4.0, 21.0],
                [67.0, 66.0, 28.0],
                [2.0, 97.0, 30.0],
                [-70.0, 67.0, 28.0],
                [-98.0, -4.0, 20.0],
                [-63.0, -62.0, 24.0],
                [-3.0, -89.0, 29.0],
                [66.0, -69.0, 20.0],
                [99.0, -2.0, 25.0],
                [72.0, 72.0, 24.0],
                [-2.0, 103.0, 27.0],
                [-72.0, 68.0, 25.0],
                [-97.0, 0.0, 27.0],
                [-70.0, -70.0, 25.0],
                [-2.0, -96.0, 25.0],
                [74.0, -76.0, 30.0],
                [52.0, -1.0, 29.0],
                [30.0, 32.0, 31.0],
                [-2.0, 49.0, 32.0],
                [-39.0, 37.0, 31.0],
                [-52.0, -5.0, 25.0],
                [-39.0, -39.0, 25.0],
                [-5.0, -46.0, 25.0],
                [31.0, -31.0, 28.0],
                [54.0, -4.0, 32.0],
                [42.0, 42.0, 34.0],
                [-2.0, 55.0, 33.0],
                [-44.0, 38.0, 29.0],
                [-56.0, -2.0, 27.0],
                [-43.0, -45.0, 32.0],
                [-5.0, -61.0, 24.0],
                [39.0, -44.0, 33.0],
                [63.0, 1.0, 25.0],
                [48.0, 40.0, 30.0],
                [-1.0, 64.0, 33.0],
                [-46.0, 46.0, 25.0],
                [-59.0, 2.0, 29.0],
                [-47.0, -46.0, 26.0],
                [-4.0, -62.0, 31.0],
                [47.0, -43.0, 28.0],
                [70.0, -2.0, 27.0],
                [44.0, 51.0, 26.0],
                [0.0, 67.0, 34.0],
                [-53.0, 46.0, 27.0],
                [-71.0, 2.0, 32.0],
                [-53.0, -53.0, 32.0],
                [-3.0, -65.0, 30.0],
                [52.0, -48.0, 31.0],
                [75.0, 3.0, 32.0],
                [53.0, 50.0, 26.0],
                [4.0, 77.0, 33.0],
                [-53.0, 49.0, 30.0],
                [-72.0, 3.0, 30.0],
                [-53.0, -55.0, 30.0],
                [4.0, -76.0, 29.0],
                [56.0, -53.0, 32.0],
                [77.0, 0.0, 26.0],
                [59.0, 52.0, 33.0],
                [1.0, 82.0, 25.0],
                [-58.0, 52.0, 31.0],
                [-86.0, 0.0, 25.0],
                [-61.0, -57.0, 27.0],
                [3.0, -82.0, 31.0],
                [61.0, -58.0, 32.0],
                [84.0, -5.0, 26.0],
                [57.0, 59.0, 28.0],
                [-2.0, 88.0, 33.0],
                [-59.0, 66.0, 31.0],
                [-91.0, -4.0, 30.0],
                [-67.0, -62.0, 31.0],
                [-1.0, -87.0, 24.0],
                [64.0, -63.0, 24.0],
                [97.0, 0.0, 33.0],
                [71.0, 63.0, 28.0],
                [0.0, 90.0, 33.0],
                [-70.0, 70.0, 27.0],
                [-95.0, 1.0, 32.0],
                [-62.0, -65.0, 27.0],
                [4.0, -93.0, 32.0],
                [62.0, -64.0, 26.0],
                [102.0, 0.0, 30.0],
                [70.0, 73.0, 28.0],
                [3.0, 96.0, 28.0],
                [-67.0, 69.0, 27.0],
                [-104.0, 4.0, 28.0],
                [-74.0, -76.0, 28.0],
                [2.0, -97.0, 31.0],
                [71.0, -75.0, 32.0],
                [47.0, -5.0, 33.0],
                [36.0, 32.0, 28.0],
                [-4.0, 50.0, 37.0],
                [-32.0, 30.0, 28.0],
                [-55.0, 2.0, 30.0],
                [-36.0, -32.0, 37.0],
                [-4.0, -48.0, 32.0],
                [35.0, -36.0, 37.0],
                [51.0, 2.0, 28.0],
                [36.0, 41.0, 33.0],
                [3.0, 52.0, 29.0],
                [-36.0, 42.0, 36.0],
                [-55.0, 3.0, 37.0],
                [-39.0, -45.0, 34.0],
                [2.0, -53.0, 32.0],
                [39.0, -36.0, 33.0],
                [57.0, -2.0, 29.0],
                [44.0, 44.0, 28.0],
                [3.0, 65.0, 34.0],
                [-42.0, 45.0, 30.0],
                [-63.0, -5.0, 28.0],
                [-46.0, -44.0, 27.0],
                [-5.0, -65.0, 29.0],
                [46.0, -43.0, 36.0],
                [73.0, 0.0, 32.0],
                [43.0, 46.0, 37.0],
                [0.0, 72.0, 34.0],
                [-51.0, 53.0, 34.0],
                [-69.0, -3.0, 33.0],
                [-52.0, -50.0, 29.0],
                [0.0, -71.0, 31.0],
                [45.0, -54.0, 35.0],
                [72.0, 1.0, 32.0],
                [51.0, 54.0, 34.0],
                [1.0, 76.0, 33.0],
                [-52.0, 55.0, 35.0],
                [-76.0, 3.0, 28.0],
                [-55.0, -58.0, 31.0],
                [-5.0, -73.0, 28.0],
                [48.0, -49.0, 31.0],
                [79.0, 1.0, 28.0],
                [61.0, 52.0, 34.0],
                [1.0, 81.0, 34.0],
                [-61.0, 56.0, 37.0],
                [-85.0, 1.0, 36.0],
                [-61.0, -55.0, 31.0],
                [-3.0, -80.0, 30.0],
                [60.0, -58.0, 33.0],
                [88.0, 4.0, 29.0],
                [65.0, 65.0, 27.0],
                [-3.0, 86.0, 29.0],
                [-67.0, 62.0, 31.0],
                [-86.0, 0.0, 35.0],
                [-61.0, -60.0, 29.0],
                [3.0, -84.0, 34.0],
                [59.0, -60.0, 34.0],
                [95.0, -3.0, 28.0],
                [63.0, 68.0, 29.0],
                [-1.0, 88.0, 28.0],
                [-63.0, 62.0, 33.0],
                [-97.0, -2.0, 34.0],
                [-72.0, -68.0, 32.0],
                [1.0, -95.0, 28.0],
                [63.0, -70.0, 28.0],
                [97.0, -5.0, 29.0],
                [67.0, 75.0, 33.0],
                [-2.0, 101.0, 33.0],
                [-68.0, 71.0, 32.0],
                [-98.0, -2.0, 34.0],
                [-67.0, -67.0, 32.0],
                [-4.0, -102.0, 34.0],
                [67.0, -71.0, 36.0],
                [54.0, -2.0, 33.0],
                [37.0, 30.0, 33.0],
                [-3.0, 51.0, 36.0],
                [-34.0, 31.0, 35.0],
                [-52.0, 1.0, 34.0],
                [-38.0, -34.0, 35.0],
                [-2.0, -51.0, 39.0],
                [32.0, -35.0, 32.0],
                [60.0, -1.0, 38.0],
                [43.0, 39.0, 33.0],
                [0.0, 56.0, 39.0],
                [-44.0, 41.0, 34.0],
                [-60.0, 4.0, 33.0],
                [-37.0, -39.0, 37.0],
                [-5.0, -54.0, 41.0],
                [40.0, -40.0, 37.0],
                [60.0, 4.0, 34.0],
                [39.0, 39.0, 39.0],
                [-3.0, 62.0, 37.0],
                [-45.0, 42.0, 36.0],
                [-59.0, 0.0, 35.0],
                [-41.0, -44.0, 38.0],
                [-4.0, -60.0, 39.0],
                [47.0, -49.0, 36.0],
                [68.0, -2.0, 37.0],
                [48.0, 49.0, 39.0],
                [-1.0, 72.0, 40.0],
                [-48.0, 48.0, 36.0],
                [-73.0, -3.0, 32.0],
                [-48.0, -48.0, 33.0],
                [-2.0, -68.0, 41.0],
                [50.0, -52.0, 39.0],
                [77.0, 0.0, 38.0],
                [53.0, 51.0, 39.0],
                [-5.0, 74.0, 36.0],
                [-53.0, 56.0, 40.0],
                [-80.0, -5.0, 35.0],
                [-50.0, -55.0, 40.0],
                [4.0, -74.0, 36.0],
                [49.0, -54.0, 36.0],
                [76.0, 3.0, 40.0],
                [53.0, 57.0, 35.0],
                [-1.0, 77.0, 38.0],
                [-60.0, 60.0, 40.0],
                [-78.0, -2.0, 33.0],
                [-54.0, -58.0, 40.0],
                [-5.0, -84.0, 34.0],
                [55.0, -54.0, 31.0],
                [87.0, 1.0, 40.0],
                [62.0, 60.0, 36.0],
                [2.0, 84.0, 33.0],
                [-65.0, 65.0, 38.0],
                [-87.0, -2.0, 40.0],
                [-58.0, -66.0, 39.0],
                [3.0, -92.0, 35.0],
                [62.0, -59.0, 36.0],
                [96.0, 3.0, 38.0],
                [65.0, 62.0, 32.0],
                [3.0, 90.0, 39.0],
                [-71.0, 67.0, 41.0],
                [-93.0, -1.0, 39.0],
                [-63.0, -70.0, 34.0],
                [-1.0, -91.0, 34.0],
                [66.0, -67.0, 31.0],
                [102.0, 3.0, 38.0],
                [75.0, 68.0, 40.0],
                [-2.0, 97.0, 35.0],
                [-69.0, 67.0, 39.0],
                [-101.0, -2.0, 33.0],
                [-73.0, -73.0, 37.0],
                [2.0, -102.0, 38.0],
                [70.0, -67.0, 34.0],
                [52.0, -3.0, 44.0],
                [33.0, 35.0, 38.0],
                [0.0, 45.0, 42.0],
                [-35.0, 40.0, 36.0],
                [-49.0, -3.0, 42.0],
                [-34.0, -34.0, 41.0],
                [-2.0, -55.0, 43.0],
                [34.0, -40.0, 40.0],
                [52.0, -1.0, 42.0],
                [42.0, 40.0, 42.0],
                [2.0, 55.0, 36.0],
                [-41.0, 40.0, 40.0],
                [-52.0, 0.0, 37.0],
                [-40.0, -42.0, 37.0],
                [2.0, -59.0, 38.0],
                [37.0, -45.0, 37.0],
                [63.0, 2.0, 39.0],
                [48.0, 48.0, 36.0],
                [3.0, 64.0, 37.0],
                [-45.0, 41.0, 42.0],
                [-61.0, -4.0, 43.0],
                [-46.0, -43.0, 38.0],
                [-4.0, -62.0, 44.0],
                [45.0, -45.0, 39.0],
                [71.0, -5.0, 43.0],
                [48.0, 46.0, 38.0],
                [4.0, 67.0, 36.0],
                [-49.0, 52.0, 35.0],
                [-70.0, 3.0, 38.0],
                [-53.0, -44.0, 36.0],
                [-3.0, -68.0, 37.0],
                [46.0, -52.0, 41.0],
                [76.0, 3.0, 44.0],
                [56.0, 49.0, 35.0],
                [-2.0, 72.0, 41.0],
                [-52.0, 56.0, 41.0],
                [-80.0, -4.0, 43.0],
                [-54.0, -57.0, 42.0],
                [-3.0, -78.0, 40.0],
                [48.0, -56.0, 38.0],
                [81.0, -1.0, 42.0],
                [56.0, 52.0, 43.0],
                [2.0, 85.0, 37.0],
                [-58.0, 58.0, 38.0],
                [-84.0, 2.0, 39.0],
                [-56.0, -57.0, 35.0],
                [2.0, -83.0, 42.0],
                [53.0, -55.0, 37.0],
                [88.0, 0.0, 41.0],
                [59.0, 62.0, 38.0],
                [0.0, 85.0, 44.0],
                [-58.0, 64.0, 37.0],
                [-90.0, -3.0, 38.0],
                [-61.0, -67.0, 40.0],
                [-5.0, -90.0, 43.0],
                [66.0, -59.0, 35.0],
                [89.0, -4.0, 36.0],
                [66.0, 63.0, 43.0],
                [-1.0, 90.0, 41.0],
                [-67.0, 62.0, 38.0],
                [-93.0, -4.0, 44.0],
                [-70.0, -65.0, 36.0],
                [4.0, -89.0, 35.0],
                [68.0, -62.0, 43.0],
                [97.0, 2.0, 36.0],
                [70.0, 68.0, 40.0],
                [1.0, 99.0, 40.0],
                [-73.0, 72.0, 40.0],
                [-100.0, -1.0, 35.0],
                [-68.0, -67.0, 42.0],
                [0.0, -100.0, 42.0],
                [72.0, -75.0, 35.0],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([-2.4, -1.3, 0.0, 0.0, 0.0, 1.0, 1.8, 3.1, 3.6, 4.7, 6.0, 6.0, 6.0, 7.0, 7.8]), 1
        )
        basis1 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6, 2.3, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0])
        )
        basis2 = BSplineBasis(
            7,
            np.array(
                [
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.0,
                    2.0,
                    3.2,
                    3.9,
                    5.2,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                ]
            ),
        )
        vol = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2 *= np.array([9.7, 6.9, 11.4])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 0] /= 9.700000
        pt2[..., 1] /= 6.900000
        pt2[..., 2] /= 11.400000
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)

    def test_mirror_volume_3D_p667_C1_periodic(self):
        controlpoints = np.array(
            [
                [50.0, -1.0, 3.0],
                [36.0, 38.0, 4.0],
                [-5.0, 46.0, 4.0],
                [-39.0, 33.0, 4.0],
                [-46.0, 3.0, -1.0],
                [-32.0, -38.0, -4.0],
                [-3.0, -47.0, -5.0],
                [36.0, -38.0, 2.0],
                [58.0, 0.0, -1.0],
                [45.0, 44.0, 1.0],
                [-5.0, 60.0, -3.0],
                [-45.0, 44.0, 0.0],
                [-55.0, 4.0, -5.0],
                [-40.0, -43.0, -4.0],
                [-5.0, -58.0, -5.0],
                [45.0, -41.0, -4.0],
                [62.0, 4.0, 4.0],
                [45.0, 50.0, 0.0],
                [-1.0, 64.0, -1.0],
                [-46.0, 44.0, 1.0],
                [-65.0, 0.0, -1.0],
                [-49.0, -43.0, -1.0],
                [-1.0, -71.0, -2.0],
                [43.0, -46.0, -5.0],
                [76.0, 4.0, 3.0],
                [50.0, 56.0, 2.0],
                [0.0, 72.0, -4.0],
                [-54.0, 57.0, -2.0],
                [-72.0, -5.0, -3.0],
                [-55.0, -58.0, 2.0],
                [-2.0, -72.0, -4.0],
                [49.0, -49.0, -2.0],
                [82.0, -2.0, 3.0],
                [57.0, 54.0, 3.0],
                [-2.0, 87.0, 4.0],
                [-62.0, 55.0, 4.0],
                [-86.0, -5.0, 3.0],
                [-63.0, -64.0, 1.0],
                [-2.0, -85.0, -3.0],
                [60.0, -62.0, 0.0],
                [95.0, 4.0, 2.0],
                [63.0, 64.0, 0.0],
                [2.0, 92.0, 2.0],
                [-67.0, 59.0, 4.0],
                [-91.0, 1.0, 4.0],
                [-69.0, -64.0, -2.0],
                [4.0, -95.0, 0.0],
                [68.0, -62.0, -1.0],
                [99.0, 3.0, 0.0],
                [72.0, 69.0, 0.0],
                [0.0, 104.0, -3.0],
                [-71.0, 69.0, -2.0],
                [-105.0, -1.0, -5.0],
                [-71.0, -69.0, -4.0],
                [0.0, -104.0, 1.0],
                [68.0, -71.0, -2.0],
                [48.0, 0.0, 2.0],
                [30.0, 30.0, 1.0],
                [2.0, 49.0, 2.0],
                [-37.0, 37.0, 5.0],
                [-52.0, 2.0, 8.0],
                [-37.0, -37.0, 1.0],
                [4.0, -48.0, 1.0],
                [35.0, -35.0, 0.0],
                [59.0, -5.0, 1.0],
                [40.0, 43.0, 7.0],
                [-2.0, 57.0, 4.0],
                [-39.0, 45.0, 1.0],
                [-59.0, -4.0, 3.0],
                [-43.0, -37.0, 3.0],
                [1.0, -61.0, 1.0],
                [40.0, -46.0, 4.0],
                [67.0, -5.0, 2.0],
                [44.0, 43.0, 6.0],
                [1.0, 64.0, 2.0],
                [-49.0, 46.0, 6.0],
                [-69.0, -3.0, 0.0],
                [-49.0, -45.0, 7.0],
                [0.0, -71.0, 7.0],
                [51.0, -43.0, 3.0],
                [73.0, -1.0, 4.0],
                [52.0, 48.0, 7.0],
                [3.0, 70.0, 4.0],
                [-50.0, 51.0, 7.0],
                [-74.0, -4.0, -1.0],
                [-52.0, -52.0, 3.0],
                [-3.0, -71.0, 7.0],
                [50.0, -55.0, 6.0],
                [88.0, 3.0, -1.0],
                [58.0, 58.0, 7.0],
                [0.0, 82.0, 6.0],
                [-57.0, 62.0, -2.0],
                [-88.0, 2.0, 0.0],
                [-58.0, -57.0, 5.0],
                [-2.0, -80.0, 4.0],
                [56.0, -58.0, 1.0],
                [89.0, 2.0, 7.0],
                [60.0, 66.0, 3.0],
                [3.0, 95.0, 0.0],
                [-69.0, 64.0, 0.0],
                [-93.0, -3.0, 3.0],
                [-69.0, -64.0, 6.0],
                [2.0, -95.0, 6.0],
                [63.0, -70.0, 5.0],
                [96.0, -1.0, 6.0],
                [69.0, 71.0, -1.0],
                [-2.0, 104.0, 1.0],
                [-76.0, 66.0, -1.0],
                [-103.0, -2.0, 0.0],
                [-68.0, -75.0, 3.0],
                [2.0, -101.0, 6.0],
                [66.0, -70.0, 6.0],
                [47.0, -4.0, 12.0],
                [36.0, 35.0, 9.0],
                [-1.0, 47.0, 10.0],
                [-31.0, 37.0, 10.0],
                [-50.0, 1.0, 3.0],
                [-34.0, -33.0, 3.0],
                [2.0, -46.0, 4.0],
                [34.0, -38.0, 5.0],
                [57.0, 2.0, 11.0],
                [45.0, 41.0, 4.0],
                [3.0, 58.0, 2.0],
                [-40.0, 43.0, 11.0],
                [-62.0, 4.0, 4.0],
                [-40.0, -43.0, 7.0],
                [0.0, -57.0, 6.0],
                [44.0, -44.0, 5.0],
                [66.0, 4.0, 7.0],
                [47.0, 47.0, 9.0],
                [2.0, 67.0, 6.0],
                [-45.0, 45.0, 6.0],
                [-64.0, 4.0, 10.0],
                [-45.0, -50.0, 7.0],
                [-1.0, -67.0, 2.0],
                [46.0, -50.0, 9.0],
                [71.0, 0.0, 9.0],
                [53.0, 50.0, 12.0],
                [0.0, 77.0, 3.0],
                [-50.0, 57.0, 4.0],
                [-72.0, 0.0, 4.0],
                [-57.0, -58.0, 10.0],
                [-5.0, -80.0, 8.0],
                [55.0, -52.0, 11.0],
                [87.0, -2.0, 2.0],
                [62.0, 56.0, 6.0],
                [-4.0, 86.0, 8.0],
                [-57.0, 55.0, 6.0],
                [-83.0, -5.0, 5.0],
                [-59.0, -58.0, 5.0],
                [4.0, -79.0, 10.0],
                [61.0, -62.0, 2.0],
                [89.0, 1.0, 6.0],
                [68.0, 61.0, 10.0],
                [-2.0, 90.0, 3.0],
                [-64.0, 68.0, 2.0],
                [-97.0, 2.0, 11.0],
                [-68.0, -69.0, 7.0],
                [-1.0, -96.0, 7.0],
                [62.0, -69.0, 7.0],
                [98.0, 2.0, 9.0],
                [69.0, 74.0, 10.0],
                [-3.0, 103.0, 4.0],
                [-71.0, 70.0, 6.0],
                [-99.0, -1.0, 7.0],
                [-75.0, -72.0, 8.0],
                [0.0, -97.0, 7.0],
                [65.0, -75.0, 3.0],
                [45.0, 2.0, 13.0],
                [35.0, 39.0, 9.0],
                [4.0, 46.0, 7.0],
                [-35.0, 32.0, 12.0],
                [-46.0, -5.0, 14.0],
                [-35.0, -36.0, 6.0],
                [-5.0, -54.0, 8.0],
                [36.0, -41.0, 10.0],
                [56.0, 2.0, 8.0],
                [44.0, 45.0, 6.0],
                [-5.0, 55.0, 10.0],
                [-44.0, 46.0, 15.0],
                [-64.0, -5.0, 9.0],
                [-42.0, -43.0, 8.0],
                [-4.0, -60.0, 10.0],
                [41.0, -41.0, 13.0],
                [67.0, 3.0, 11.0],
                [47.0, 43.0, 8.0],
                [2.0, 70.0, 10.0],
                [-51.0, 50.0, 11.0],
                [-64.0, -2.0, 8.0],
                [-48.0, -43.0, 10.0],
                [-3.0, -66.0, 12.0],
                [44.0, -51.0, 8.0],
                [70.0, -3.0, 12.0],
                [57.0, 57.0, 10.0],
                [-1.0, 72.0, 14.0],
                [-57.0, 57.0, 6.0],
                [-76.0, -1.0, 15.0],
                [-58.0, -56.0, 10.0],
                [2.0, -73.0, 15.0],
                [55.0, -53.0, 6.0],
                [86.0, 0.0, 11.0],
                [62.0, 63.0, 8.0],
                [4.0, 81.0, 15.0],
                [-62.0, 56.0, 11.0],
                [-81.0, 1.0, 6.0],
                [-64.0, -57.0, 8.0],
                [2.0, -84.0, 12.0],
                [60.0, -55.0, 11.0],
                [96.0, 4.0, 14.0],
                [61.0, 59.0, 14.0],
                [0.0, 95.0, 9.0],
                [-66.0, 62.0, 12.0],
                [-89.0, -4.0, 11.0],
                [-70.0, -64.0, 8.0],
                [-3.0, -90.0, 15.0],
                [60.0, -68.0, 14.0],
                [96.0, -4.0, 6.0],
                [68.0, 68.0, 11.0],
                [-1.0, 101.0, 15.0],
                [-72.0, 66.0, 6.0],
                [-101.0, 4.0, 9.0],
                [-68.0, -74.0, 8.0],
                [-3.0, -98.0, 14.0],
                [65.0, -76.0, 12.0],
                [48.0, 1.0, 15.0],
                [32.0, 35.0, 16.0],
                [-2.0, 52.0, 15.0],
                [-32.0, 32.0, 11.0],
                [-49.0, -1.0, 12.0],
                [-39.0, -39.0, 12.0],
                [4.0, -52.0, 15.0],
                [34.0, -39.0, 12.0],
                [55.0, -1.0, 15.0],
                [40.0, 37.0, 13.0],
                [1.0, 60.0, 18.0],
                [-37.0, 43.0, 10.0],
                [-64.0, 1.0, 9.0],
                [-45.0, -39.0, 11.0],
                [-4.0, -62.0, 13.0],
                [37.0, -40.0, 17.0],
                [65.0, -1.0, 10.0],
                [48.0, 50.0, 11.0],
                [1.0, 69.0, 10.0],
                [-45.0, 43.0, 15.0],
                [-69.0, -5.0, 16.0],
                [-47.0, -52.0, 12.0],
                [-3.0, -69.0, 15.0],
                [46.0, -47.0, 16.0],
                [78.0, -2.0, 12.0],
                [48.0, 53.0, 13.0],
                [-5.0, 78.0, 14.0],
                [-54.0, 49.0, 12.0],
                [-80.0, 4.0, 14.0],
                [-54.0, -56.0, 15.0],
                [-2.0, -79.0, 11.0],
                [53.0, -56.0, 10.0],
                [80.0, 1.0, 14.0],
                [57.0, 54.0, 17.0],
                [-4.0, 84.0, 18.0],
                [-61.0, 59.0, 12.0],
                [-87.0, -5.0, 11.0],
                [-63.0, -58.0, 14.0],
                [-3.0, -79.0, 13.0],
                [56.0, -60.0, 12.0],
                [96.0, 2.0, 19.0],
                [60.0, 67.0, 10.0],
                [-4.0, 88.0, 17.0],
                [-67.0, 68.0, 19.0],
                [-92.0, 0.0, 17.0],
                [-61.0, -63.0, 17.0],
                [-1.0, -91.0, 10.0],
                [66.0, -65.0, 15.0],
                [103.0, 4.0, 10.0],
                [74.0, 72.0, 18.0],
                [-1.0, 102.0, 11.0],
                [-67.0, 68.0, 16.0],
                [-103.0, -3.0, 14.0],
                [-76.0, -70.0, 14.0],
                [-1.0, -99.0, 17.0],
                [72.0, -71.0, 16.0],
                [51.0, 4.0, 19.0],
                [35.0, 32.0, 21.0],
                [2.0, 46.0, 20.0],
                [-38.0, 40.0, 15.0],
                [-55.0, -2.0, 20.0],
                [-35.0, -32.0, 17.0],
                [-5.0, -51.0, 22.0],
                [30.0, -40.0, 20.0],
                [59.0, -1.0, 16.0],
                [40.0, 38.0, 17.0],
                [3.0, 54.0, 14.0],
                [-42.0, 44.0, 17.0],
                [-57.0, 3.0, 15.0],
                [-46.0, -46.0, 13.0],
                [-4.0, -64.0, 15.0],
                [44.0, -40.0, 16.0],
                [71.0, -2.0, 21.0],
                [49.0, 45.0, 21.0],
                [-2.0, 65.0, 14.0],
                [-47.0, 46.0, 16.0],
                [-69.0, -2.0, 19.0],
                [-46.0, -45.0, 18.0],
                [-2.0, -68.0, 19.0],
                [43.0, -47.0, 22.0],
                [74.0, -3.0, 22.0],
                [56.0, 53.0, 13.0],
                [-5.0, 71.0, 18.0],
                [-53.0, 56.0, 14.0],
                [-77.0, 2.0, 17.0],
                [-58.0, -56.0, 13.0],
                [-5.0, -77.0, 17.0],
                [48.0, -58.0, 14.0],
                [79.0, -3.0, 17.0],
                [56.0, 56.0, 14.0],
                [-5.0, 83.0, 19.0],
                [-55.0, 59.0, 21.0],
                [-79.0, 2.0, 17.0],
                [-62.0, -58.0, 19.0],
                [1.0, -87.0, 13.0],
                [59.0, -59.0, 19.0],
                [90.0, 3.0, 17.0],
                [67.0, 62.0, 13.0],
                [-2.0, 87.0, 15.0],
                [-64.0, 67.0, 19.0],
                [-87.0, -2.0, 13.0],
                [-63.0, -67.0, 23.0],
                [3.0, -89.0, 22.0],
                [69.0, -64.0, 15.0],
                [103.0, 2.0, 21.0],
                [74.0, 66.0, 21.0],
                [2.0, 98.0, 15.0],
                [-73.0, 68.0, 19.0],
                [-100.0, -1.0, 22.0],
                [-76.0, -70.0, 13.0],
                [-3.0, -105.0, 19.0],
                [70.0, -67.0, 17.0],
                [47.0, -1.0, 17.0],
                [37.0, 34.0, 19.0],
                [-4.0, 50.0, 18.0],
                [-36.0, 35.0, 24.0],
                [-51.0, 0.0, 24.0],
                [-37.0, -34.0, 21.0],
                [1.0, -54.0, 26.0],
                [32.0, -33.0, 21.0],
                [54.0, -1.0, 24.0],
                [46.0, 45.0, 24.0],
                [3.0, 62.0, 22.0],
                [-37.0, 41.0, 25.0],
                [-57.0, 3.0, 19.0],
                [-38.0, -47.0, 22.0],
                [-4.0, -60.0, 23.0],
                [45.0, -41.0, 18.0],
                [66.0, -3.0, 23.0],
                [43.0, 44.0, 21.0],
                [-1.0, 63.0, 21.0],
                [-44.0, 50.0, 18.0],
                [-68.0, 0.0, 19.0],
                [-46.0, -47.0, 19.0],
                [1.0, -63.0, 23.0],
                [44.0, -50.0, 22.0],
                [77.0, -4.0, 19.0],
                [55.0, 48.0, 21.0],
                [-2.0, 73.0, 21.0],
                [-55.0, 50.0, 24.0],
                [-75.0, 3.0, 23.0],
                [-50.0, -50.0, 24.0],
                [3.0, -80.0, 17.0],
                [54.0, -51.0, 18.0],
                [88.0, -3.0, 19.0],
                [59.0, 55.0, 26.0],
                [2.0, 87.0, 19.0],
                [-56.0, 63.0, 20.0],
                [-80.0, 0.0, 26.0],
                [-63.0, -64.0, 19.0],
                [1.0, -88.0, 23.0],
                [59.0, -63.0, 21.0],
                [86.0, -1.0, 24.0],
                [69.0, 64.0, 20.0],
                [-3.0, 88.0, 18.0],
                [-67.0, 62.0, 23.0],
                [-92.0, 1.0, 18.0],
                [-60.0, -69.0, 24.0],
                [-4.0, -90.0, 17.0],
                [63.0, -64.0, 24.0],
                [95.0, 0.0, 23.0],
                [70.0, 74.0, 26.0],
                [2.0, 101.0, 17.0],
                [-76.0, 68.0, 17.0],
                [-98.0, -4.0, 20.0],
                [-74.0, -71.0, 17.0],
                [-2.0, -101.0, 20.0],
                [75.0, -68.0, 25.0],
                [46.0, -3.0, 24.0],
                [36.0, 32.0, 24.0],
                [0.0, 47.0, 26.0],
                [-40.0, 32.0, 26.0],
                [-55.0, 3.0, 24.0],
                [-37.0, -40.0, 22.0],
                [0.0, -55.0, 23.0],
                [39.0, -40.0, 22.0],
                [55.0, -4.0, 24.0],
                [43.0, 37.0, 29.0],
                [2.0, 56.0, 27.0],
                [-43.0, 44.0, 27.0],
                [-55.0, 3.0, 26.0],
                [-37.0, -46.0, 29.0],
                [1.0, -59.0, 30.0],
                [45.0, -44.0, 26.0],
                [68.0, 4.0, 30.0],
                [47.0, 42.0, 24.0],
                [-4.0, 68.0, 29.0],
                [-48.0, 48.0, 21.0],
                [-69.0, -2.0, 23.0],
                [-44.0, -49.0, 29.0],
                [4.0, -62.0, 27.0],
                [45.0, -48.0, 30.0],
                [71.0, 3.0, 26.0],
                [49.0, 53.0, 22.0],
                [3.0, 78.0, 21.0],
                [-57.0, 56.0, 23.0],
                [-76.0, 4.0, 24.0],
                [-51.0, -51.0, 27.0],
                [-4.0, -74.0, 30.0],
                [57.0, -54.0, 24.0],
                [83.0, 1.0, 26.0],
                [56.0, 60.0, 21.0],
                [-4.0, 80.0, 23.0],
                [-55.0, 57.0, 29.0],
                [-88.0, -4.0, 21.0],
                [-57.0, -64.0, 22.0],
                [-5.0, -86.0, 26.0],
                [57.0, -59.0, 23.0],
                [92.0, 2.0, 24.0],
                [62.0, 60.0, 24.0],
                [1.0, 87.0, 21.0],
                [-68.0, 64.0, 26.0],
                [-93.0, 4.0, 30.0],
                [-64.0, -63.0, 22.0],
                [-1.0, -88.0, 26.0],
                [62.0, -62.0, 23.0],
                [99.0, 1.0, 25.0],
                [67.0, 68.0, 29.0],
                [-4.0, 104.0, 23.0],
                [-69.0, 74.0, 25.0],
                [-100.0, 2.0, 22.0],
                [-75.0, -75.0, 22.0],
                [-3.0, -96.0, 28.0],
                [74.0, -71.0, 28.0],
                [54.0, 0.0, 24.0],
                [38.0, 36.0, 25.0],
                [2.0, 48.0, 31.0],
                [-41.0, 38.0, 25.0],
                [-50.0, -5.0, 33.0],
                [-32.0, -40.0, 30.0],
                [-1.0, -46.0, 25.0],
                [40.0, -38.0, 33.0],
                [59.0, -5.0, 25.0],
                [44.0, 41.0, 27.0],
                [-5.0, 60.0, 33.0],
                [-40.0, 36.0, 32.0],
                [-58.0, 4.0, 24.0],
                [-40.0, -38.0, 31.0],
                [3.0, -61.0, 33.0],
                [41.0, -46.0, 26.0],
                [62.0, -5.0, 32.0],
                [43.0, 46.0, 33.0],
                [-3.0, 68.0, 32.0],
                [-44.0, 50.0, 25.0],
                [-69.0, -1.0, 25.0],
                [-52.0, -48.0, 30.0],
                [4.0, -72.0, 24.0],
                [46.0, -50.0, 25.0],
                [78.0, -2.0, 29.0],
                [57.0, 57.0, 24.0],
                [-1.0, 73.0, 30.0],
                [-52.0, 54.0, 30.0],
                [-74.0, 4.0, 28.0],
                [-57.0, -51.0, 31.0],
                [-4.0, -80.0, 26.0],
                [56.0, -56.0, 29.0],
                [84.0, -4.0, 24.0],
                [56.0, 54.0, 33.0],
                [2.0, 86.0, 26.0],
                [-62.0, 60.0, 24.0],
                [-86.0, 1.0, 28.0],
                [-58.0, -57.0, 31.0],
                [-2.0, -80.0, 25.0],
                [58.0, -62.0, 32.0],
                [94.0, -4.0, 28.0],
                [63.0, 65.0, 24.0],
                [2.0, 90.0, 32.0],
                [-60.0, 63.0, 24.0],
                [-95.0, -4.0, 26.0],
                [-67.0, -61.0, 31.0],
                [-2.0, -96.0, 24.0],
                [68.0, -62.0, 25.0],
                [100.0, 3.0, 27.0],
                [67.0, 75.0, 28.0],
                [-5.0, 97.0, 33.0],
                [-73.0, 68.0, 29.0],
                [-96.0, 0.0, 28.0],
                [-72.0, -71.0, 32.0],
                [4.0, -99.0, 32.0],
                [73.0, -67.0, 33.0],
                [45.0, -4.0, 36.0],
                [40.0, 36.0, 29.0],
                [-3.0, 47.0, 28.0],
                [-36.0, 33.0, 33.0],
                [-53.0, -3.0, 34.0],
                [-35.0, -38.0, 34.0],
                [2.0, -48.0, 37.0],
                [39.0, -36.0, 31.0],
                [59.0, -4.0, 34.0],
                [40.0, 40.0, 30.0],
                [0.0, 60.0, 31.0],
                [-38.0, 43.0, 33.0],
                [-63.0, -1.0, 36.0],
                [-45.0, -38.0, 29.0],
                [-4.0, -61.0, 32.0],
                [36.0, -45.0, 29.0],
                [67.0, -3.0, 34.0],
                [51.0, 51.0, 36.0],
                [3.0, 63.0, 28.0],
                [-52.0, 50.0, 34.0],
                [-67.0, -1.0, 29.0],
                [-45.0, -51.0, 32.0],
                [1.0, -66.0, 33.0],
                [47.0, -50.0, 35.0],
                [74.0, 0.0, 34.0],
                [50.0, 52.0, 30.0],
                [-4.0, 74.0, 32.0],
                [-50.0, 52.0, 32.0],
                [-73.0, -5.0, 28.0],
                [-50.0, -54.0, 34.0],
                [2.0, -72.0, 35.0],
                [52.0, -50.0, 31.0],
                [78.0, 1.0, 31.0],
                [58.0, 54.0, 33.0],
                [0.0, 80.0, 34.0],
                [-58.0, 54.0, 36.0],
                [-86.0, 1.0, 35.0],
                [-59.0, -60.0, 32.0],
                [3.0, -80.0, 31.0],
                [55.0, -57.0, 30.0],
                [95.0, 1.0, 28.0],
                [61.0, 64.0, 36.0],
                [1.0, 92.0, 32.0],
                [-65.0, 69.0, 35.0],
                [-96.0, 3.0, 28.0],
                [-70.0, -65.0, 35.0],
                [3.0, -91.0, 28.0],
                [60.0, -67.0, 34.0],
                [101.0, -5.0, 34.0],
                [73.0, 70.0, 37.0],
                [-1.0, 96.0, 32.0],
                [-73.0, 69.0, 35.0],
                [-98.0, -3.0, 37.0],
                [-68.0, -71.0, 32.0],
                [-5.0, -99.0, 35.0],
                [70.0, -68.0, 33.0],
                [45.0, 0.0, 38.0],
                [34.0, 34.0, 34.0],
                [1.0, 45.0, 32.0],
                [-35.0, 32.0, 38.0],
                [-54.0, 4.0, 38.0],
                [-36.0, -35.0, 35.0],
                [3.0, -49.0, 39.0],
                [39.0, -35.0, 33.0],
                [53.0, 3.0, 33.0],
                [36.0, 42.0, 40.0],
                [0.0, 60.0, 38.0],
                [-38.0, 39.0, 34.0],
                [-64.0, -3.0, 39.0],
                [-38.0, -45.0, 38.0],
                [0.0, -59.0, 35.0],
                [37.0, -44.0, 39.0],
                [65.0, -5.0, 37.0],
                [48.0, 45.0, 35.0],
                [-1.0, 63.0, 38.0],
                [-44.0, 45.0, 35.0],
                [-63.0, 2.0, 40.0],
                [-45.0, -45.0, 34.0],
                [-3.0, -67.0, 35.0],
                [51.0, -51.0, 33.0],
                [75.0, 1.0, 34.0],
                [50.0, 53.0, 38.0],
                [-2.0, 76.0, 34.0],
                [-54.0, 48.0, 34.0],
                [-72.0, 2.0, 36.0],
                [-57.0, -53.0, 34.0],
                [-2.0, -72.0, 38.0],
                [53.0, -57.0, 40.0],
                [87.0, -4.0, 34.0],
                [57.0, 60.0, 33.0],
                [3.0, 80.0, 36.0],
                [-60.0, 59.0, 35.0],
                [-82.0, -1.0, 40.0],
                [-58.0, -58.0, 38.0],
                [4.0, -83.0, 33.0],
                [60.0, -60.0, 32.0],
                [94.0, -4.0, 35.0],
                [61.0, 63.0, 38.0],
                [-3.0, 94.0, 40.0],
                [-67.0, 65.0, 35.0],
                [-90.0, -2.0, 38.0],
                [-64.0, -62.0, 32.0],
                [-4.0, -92.0, 34.0],
                [65.0, -66.0, 35.0],
                [101.0, 3.0, 35.0],
                [73.0, 71.0, 31.0],
                [2.0, 100.0, 35.0],
                [-76.0, 65.0, 34.0],
                [-97.0, -2.0, 38.0],
                [-74.0, -75.0, 41.0],
                [2.0, -105.0, 38.0],
                [70.0, -71.0, 33.0],
                [52.0, -2.0, 43.0],
                [30.0, 38.0, 40.0],
                [-2.0, 50.0, 37.0],
                [-33.0, 34.0, 44.0],
                [-52.0, 2.0, 42.0],
                [-36.0, -34.0, 41.0],
                [0.0, -52.0, 35.0],
                [32.0, -41.0, 40.0],
                [60.0, 4.0, 40.0],
                [37.0, 45.0, 41.0],
                [-2.0, 57.0, 38.0],
                [-46.0, 46.0, 44.0],
                [-59.0, -1.0, 44.0],
                [-37.0, -46.0, 42.0],
                [-3.0, -56.0, 43.0],
                [41.0, -43.0, 42.0],
                [66.0, -4.0, 36.0],
                [44.0, 42.0, 41.0],
                [-3.0, 69.0, 38.0],
                [-47.0, 43.0, 44.0],
                [-64.0, -5.0, 36.0],
                [-49.0, -46.0, 39.0],
                [-3.0, -68.0, 43.0],
                [42.0, -45.0, 36.0],
                [73.0, -4.0, 35.0],
                [57.0, 53.0, 38.0],
                [-3.0, 77.0, 39.0],
                [-49.0, 52.0, 41.0],
                [-72.0, 0.0, 37.0],
                [-54.0, -53.0, 41.0],
                [-2.0, -76.0, 40.0],
                [51.0, -50.0, 43.0],
                [86.0, 2.0, 41.0],
                [63.0, 62.0, 38.0],
                [0.0, 86.0, 36.0],
                [-56.0, 54.0, 43.0],
                [-86.0, 1.0, 42.0],
                [-56.0, -56.0, 39.0],
                [-5.0, -87.0, 37.0],
                [54.0, -56.0, 36.0],
                [91.0, 4.0, 35.0],
                [62.0, 67.0, 36.0],
                [1.0, 91.0, 38.0],
                [-63.0, 64.0, 40.0],
                [-97.0, 1.0, 36.0],
                [-61.0, -61.0, 43.0],
                [4.0, -92.0, 36.0],
                [64.0, -66.0, 42.0],
                [97.0, 0.0, 39.0],
                [69.0, 71.0, 41.0],
                [-4.0, 96.0, 40.0],
                [-69.0, 74.0, 35.0],
                [-101.0, 4.0, 41.0],
                [-72.0, -67.0, 41.0],
                [-5.0, -99.0, 42.0],
                [75.0, -69.0, 41.0],
            ]
        )
        basis0 = BSplineBasis(
            6, np.array([-2.2, -1.2, 0.0, 0.0, 0.0, 0.0, 1.0, 2.3, 2.8, 3.8, 5.0, 5.0, 5.0, 5.0, 6.0, 7.3]), 1
        )
        basis1 = BSplineBasis(6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0]))
        basis2 = BSplineBasis(
            7,
            np.array(
                [
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.8,
                    2.4,
                    3.2,
                    4.4,
                    5.1,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                ]
            ),
        )
        vol = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2.mirror([0, 0, 1])

        u = np.linspace(vol.start(0), vol.end(0), 7)
        v = np.linspace(vol.start(1), vol.end(1), 7)
        w = np.linspace(vol.start(2), vol.end(2), 7)
        pt = vol(u, v, w)
        pt2 = vol2(u, v, w)
        pt2[..., 2] = -pt2[..., 2]
        self.assertAlmostEqual(np.linalg.norm(pt - pt2), 0.0)


if __name__ == "__main__":
    unittest.main()
