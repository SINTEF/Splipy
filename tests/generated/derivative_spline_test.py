# --- Automatic generated test file  ---
# Generator    : generate_derivative_spline.py
# Date         : 2017-01-23
# Git revision : b458827cf91658b8da98744b230af11b9c95dd94
from __future__ import annotations

import unittest

import numpy as np

from splipy import BSplineBasis, Curve, SplineObject, Surface, Volume


class TestDerivativeSpline(unittest.TestCase):
    def test_curve_2D_p2(self) -> None:
        controlpoints = np.array([[1.0, -1.0], [35.0, 0.0], [61.0, -4.0], [95.0, -5.0]])
        basis0 = BSplineBasis(2, np.array([0.0, 0.0, 0.7, 1.7, 3.0, 3.0]))
        crv = Curve(basis0, controlpoints, False)
        crv2: SplineObject = crv.clone()
        crv2 = crv.get_derivative_spline(0)
        self.assertEqual(crv2.order(direction=0), 1)

        u = np.linspace(crv.start(0), crv.end(0), 11)
        du = crv.derivative(u)
        du2 = crv2(u)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)

    def test_surface_2D_p23(self) -> None:
        controlpoints = np.array(
            [
                [1.0, -3.0],
                [52.0, -2.0],
                [96.0, -5.0],
                [2.0, 20.0],
                [50.0, 21.0],
                [96.0, 22.0],
                [2.0, 47.0],
                [48.0, 52.0],
                [100.0, 54.0],
                [-2.0, 75.0],
                [49.0, 78.0],
                [98.0, 73.0],
                [-2.0, 104.0],
                [45.0, 98.0],
                [98.0, 95.0],
            ]
        )
        basis0 = BSplineBasis(2, np.array([0.0, 0.0, 1.2, 2.0, 2.0]))
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.1, 1.8, 3.0, 3.0, 3.0]))
        surf: SplineObject = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 = surf.get_derivative_spline(0)
        self.assertEqual(surf2.order(direction=0), 1)
        self.assertEqual(surf2.order(direction=1), 3)
        surf3 = surf.get_derivative_spline(1)
        self.assertEqual(surf3.order(direction=0), 2)
        self.assertEqual(surf3.order(direction=1), 2)

        u = np.linspace(surf.start(0), surf.end(0), 7)
        v = np.linspace(surf.start(1), surf.end(1), 7)
        du = surf.derivative(u, v, d=(1, 0))
        du2 = surf2(u, v)
        dv = surf.derivative(u, v, d=(0, 1))
        dv2 = surf3(u, v)

        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)

    def test_curve_2D_p4_C0_periodic(self) -> None:
        controlpoints = np.array(
            [
                [99.0, 1.0],
                [73.0, 71.0],
                [-2.0, 102.0],
                [-73.0, 66.0],
                [-100.0, 3.0],
                [-69.0, -68.0],
                [3.0, -104.0],
                [70.0, -73.0],
            ]
        )
        basis0 = BSplineBasis(
            4, np.array([-0.7, 0.0, 0.0, 0.0, 0.6, 2.2, 2.8, 4.1, 5.3, 6.0, 6.0, 6.0, 6.6]), 0
        )
        crv: SplineObject = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 = crv.get_derivative_spline(0)
        self.assertEqual(crv2.order(direction=0), 3)

        u = np.linspace(crv.start(0), crv.end(0), 11)
        du = crv.derivative(u)
        du2 = crv2(u)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)

    def test_surface_2D_p22_C0_periodic(self) -> None:
        controlpoints = np.array(
            [
                [64.0, 3.0],
                [2.0, 58.0],
                [-56.0, -5.0],
                [0.0, -65.0],
                [76.0, -2.0],
                [3.0, 77.0],
                [-71.0, -2.0],
                [0.0, -74.0],
                [86.0, 0.0],
                [-4.0, 87.0],
                [-91.0, -4.0],
                [2.0, -92.0],
                [104.0, -2.0],
                [-5.0, 96.0],
                [-98.0, -4.0],
                [-2.0, -98.0],
            ]
        )
        basis0 = BSplineBasis(2, np.array([-0.6, 0.0, 1.1, 2.0, 3.4, 4.0, 5.1]), 0)
        basis1 = BSplineBasis(2, np.array([0.0, 0.0, 1.2, 1.7, 3.0, 3.0]))
        surf: SplineObject = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 = surf.get_derivative_spline(0)
        self.assertEqual(surf2.order(direction=0), 1)
        self.assertEqual(surf2.order(direction=1), 2)
        surf3 = surf.get_derivative_spline(1)
        self.assertEqual(surf3.order(direction=0), 2)
        self.assertEqual(surf3.order(direction=1), 1)

        u = np.linspace(surf.start(0), surf.end(0), 7)
        v = np.linspace(surf.start(1), surf.end(1), 7)
        du = surf.derivative(u, v, d=(1, 0))
        du2 = surf2(u, v)
        dv = surf.derivative(u, v, d=(0, 1))
        dv2 = surf3(u, v)

        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)

    def test_curve_3D_p3(self) -> None:
        controlpoints = np.array([[-1.0, -1.0, 0.0], [29.0, 1.0, -5.0], [68.0, 0.0, 1.0], [104.0, -1.0, 4.0]])
        basis0 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.3, 2.0, 2.0, 2.0]))
        crv: SplineObject = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 = crv.get_derivative_spline(0)
        self.assertEqual(crv2.order(direction=0), 2)

        u = np.linspace(crv.start(0), crv.end(0), 11)
        du = crv.derivative(u)
        du2 = crv2(u)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)

    def test_surface_3D_p43(self) -> None:
        controlpoints = np.array(
            [
                [4.0, 4.0, -4.0],
                [13.0, 1.0, 3.0],
                [36.0, -5.0, 3.0],
                [48.0, 0.0, -4.0],
                [64.0, 2.0, 2.0],
                [86.0, 3.0, -4.0],
                [95.0, 4.0, 1.0],
                [-4.0, 23.0, -1.0],
                [17.0, 20.0, 0.0],
                [34.0, 18.0, -3.0],
                [47.0, 22.0, 3.0],
                [66.0, 19.0, -5.0],
                [80.0, 18.0, 0.0],
                [95.0, 17.0, -1.0],
                [3.0, 42.0, 3.0],
                [14.0, 41.0, 0.0],
                [30.0, 37.0, -2.0],
                [52.0, 41.0, -5.0],
                [68.0, 37.0, 4.0],
                [86.0, 40.0, 0.0],
                [104.0, 36.0, 2.0],
                [3.0, 57.0, 4.0],
                [12.0, 57.0, 1.0],
                [37.0, 60.0, 0.0],
                [53.0, 55.0, -4.0],
                [63.0, 60.0, 2.0],
                [86.0, 59.0, 2.0],
                [95.0, 61.0, 3.0],
                [-4.0, 81.0, -4.0],
                [18.0, 84.0, -1.0],
                [28.0, 79.0, 0.0],
                [48.0, 75.0, -2.0],
                [71.0, 83.0, 0.0],
                [83.0, 80.0, -4.0],
                [104.0, 84.0, -4.0],
                [-1.0, 104.0, -3.0],
                [13.0, 100.0, 2.0],
                [37.0, 102.0, -5.0],
                [51.0, 101.0, -4.0],
                [66.0, 97.0, -3.0],
                [81.0, 95.0, -4.0],
                [103.0, 97.0, 3.0],
            ]
        )
        basis0 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 0.8, 1.7, 2.7, 4.0, 4.0, 4.0, 4.0]))
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.2, 1.9, 2.8, 4.0, 4.0, 4.0]))
        surf: SplineObject = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 = surf.get_derivative_spline(0)
        self.assertEqual(surf2.order(direction=0), 3)
        self.assertEqual(surf2.order(direction=1), 3)
        surf3 = surf.get_derivative_spline(1)
        self.assertEqual(surf3.order(direction=0), 4)
        self.assertEqual(surf3.order(direction=1), 2)

        u = np.linspace(surf.start(0), surf.end(0), 7)
        v = np.linspace(surf.start(1), surf.end(1), 7)
        du = surf.derivative(u, v, d=(1, 0))
        du2 = surf2(u, v)
        dv = surf.derivative(u, v, d=(0, 1))
        dv2 = surf3(u, v)

        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)

    def test_volume_3D_p434(self) -> None:
        controlpoints = np.array(
            [
                [3.0, 1.0, -3.0],
                [23.0, -1.0, -2.0],
                [41.0, 0.0, 1.0],
                [56.0, 3.0, -3.0],
                [75.0, 1.0, 4.0],
                [101.0, 0.0, -1.0],
                [2.0, 33.0, 3.0],
                [22.0, 35.0, -2.0],
                [38.0, 35.0, -1.0],
                [63.0, 37.0, -2.0],
                [83.0, 31.0, 4.0],
                [103.0, 36.0, -2.0],
                [-4.0, 64.0, 1.0],
                [20.0, 66.0, -3.0],
                [43.0, 68.0, -5.0],
                [63.0, 63.0, -1.0],
                [76.0, 68.0, 2.0],
                [104.0, 70.0, -5.0],
                [4.0, 96.0, -4.0],
                [19.0, 101.0, 0.0],
                [42.0, 101.0, 2.0],
                [64.0, 100.0, -2.0],
                [82.0, 97.0, 3.0],
                [102.0, 101.0, 3.0],
                [0.0, -4.0, 21.0],
                [17.0, -5.0, 17.0],
                [42.0, 1.0, 20.0],
                [56.0, 0.0, 14.0],
                [78.0, -4.0, 16.0],
                [103.0, -1.0, 13.0],
                [3.0, 38.0, 21.0],
                [22.0, 32.0, 14.0],
                [35.0, 29.0, 16.0],
                [63.0, 35.0, 15.0],
                [76.0, 36.0, 13.0],
                [102.0, 33.0, 18.0],
                [-4.0, 68.0, 16.0],
                [23.0, 67.0, 20.0],
                [37.0, 67.0, 18.0],
                [59.0, 69.0, 15.0],
                [75.0, 70.0, 12.0],
                [95.0, 66.0, 19.0],
                [1.0, 98.0, 19.0],
                [24.0, 103.0, 12.0],
                [40.0, 98.0, 18.0],
                [61.0, 102.0, 21.0],
                [84.0, 97.0, 18.0],
                [102.0, 97.0, 12.0],
                [3.0, -4.0, 28.0],
                [15.0, -4.0, 29.0],
                [38.0, 4.0, 35.0],
                [62.0, -1.0, 31.0],
                [79.0, -1.0, 30.0],
                [96.0, 3.0, 28.0],
                [3.0, 35.0, 31.0],
                [19.0, 32.0, 37.0],
                [42.0, 28.0, 30.0],
                [60.0, 29.0, 37.0],
                [83.0, 38.0, 37.0],
                [103.0, 35.0, 37.0],
                [-5.0, 69.0, 33.0],
                [21.0, 70.0, 35.0],
                [39.0, 62.0, 36.0],
                [63.0, 68.0, 28.0],
                [77.0, 67.0, 34.0],
                [97.0, 66.0, 28.0],
                [4.0, 102.0, 31.0],
                [23.0, 104.0, 37.0],
                [42.0, 95.0, 31.0],
                [58.0, 97.0, 35.0],
                [79.0, 95.0, 32.0],
                [100.0, 101.0, 31.0],
                [-3.0, 1.0, 54.0],
                [18.0, -5.0, 50.0],
                [35.0, -5.0, 49.0],
                [55.0, 4.0, 52.0],
                [82.0, 1.0, 51.0],
                [95.0, -3.0, 48.0],
                [-2.0, 30.0, 54.0],
                [23.0, 33.0, 53.0],
                [41.0, 37.0, 50.0],
                [63.0, 29.0, 51.0],
                [83.0, 32.0, 54.0],
                [98.0, 33.0, 49.0],
                [-3.0, 64.0, 48.0],
                [22.0, 70.0, 50.0],
                [40.0, 66.0, 47.0],
                [59.0, 69.0, 46.0],
                [75.0, 63.0, 46.0],
                [95.0, 66.0, 54.0],
                [-4.0, 101.0, 47.0],
                [19.0, 97.0, 48.0],
                [44.0, 99.0, 46.0],
                [55.0, 98.0, 46.0],
                [75.0, 96.0, 46.0],
                [95.0, 98.0, 54.0],
                [3.0, 1.0, 64.0],
                [16.0, -5.0, 70.0],
                [43.0, -1.0, 62.0],
                [55.0, -4.0, 68.0],
                [81.0, 0.0, 69.0],
                [100.0, -3.0, 68.0],
                [1.0, 30.0, 66.0],
                [21.0, 36.0, 62.0],
                [39.0, 29.0, 62.0],
                [56.0, 33.0, 62.0],
                [84.0, 28.0, 66.0],
                [96.0, 32.0, 63.0],
                [2.0, 61.0, 69.0],
                [18.0, 66.0, 67.0],
                [36.0, 65.0, 68.0],
                [60.0, 70.0, 65.0],
                [77.0, 71.0, 66.0],
                [97.0, 68.0, 65.0],
                [-1.0, 101.0, 63.0],
                [22.0, 96.0, 71.0],
                [44.0, 101.0, 66.0],
                [55.0, 97.0, 62.0],
                [84.0, 103.0, 69.0],
                [97.0, 101.0, 64.0],
                [-4.0, 2.0, 78.0],
                [24.0, -1.0, 85.0],
                [35.0, -3.0, 82.0],
                [63.0, -2.0, 80.0],
                [82.0, 4.0, 82.0],
                [98.0, -1.0, 82.0],
                [-2.0, 32.0, 85.0],
                [18.0, 36.0, 84.0],
                [35.0, 34.0, 87.0],
                [60.0, 31.0, 86.0],
                [81.0, 32.0, 84.0],
                [104.0, 35.0, 78.0],
                [2.0, 65.0, 84.0],
                [24.0, 62.0, 86.0],
                [42.0, 70.0, 87.0],
                [57.0, 69.0, 84.0],
                [81.0, 66.0, 86.0],
                [104.0, 65.0, 80.0],
                [-3.0, 97.0, 88.0],
                [17.0, 101.0, 86.0],
                [43.0, 96.0, 78.0],
                [58.0, 95.0, 84.0],
                [75.0, 96.0, 86.0],
                [98.0, 97.0, 83.0],
                [2.0, 3.0, 95.0],
                [21.0, -3.0, 97.0],
                [38.0, 1.0, 102.0],
                [56.0, -5.0, 96.0],
                [79.0, -1.0, 97.0],
                [95.0, -3.0, 96.0],
                [-3.0, 29.0, 100.0],
                [18.0, 32.0, 101.0],
                [42.0, 36.0, 101.0],
                [60.0, 38.0, 96.0],
                [80.0, 33.0, 95.0],
                [96.0, 30.0, 103.0],
                [-4.0, 64.0, 100.0],
                [18.0, 66.0, 99.0],
                [44.0, 63.0, 100.0],
                [59.0, 61.0, 104.0],
                [81.0, 62.0, 95.0],
                [98.0, 66.0, 103.0],
                [-2.0, 96.0, 101.0],
                [22.0, 100.0, 98.0],
                [36.0, 99.0, 103.0],
                [60.0, 100.0, 98.0],
                [76.0, 98.0, 96.0],
                [95.0, 98.0, 98.0],
            ]
        )
        basis0 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.0, 1.7, 3.0, 3.0, 3.0, 3.0]))
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 0.8, 2.0, 2.0, 2.0]))
        basis2 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 1.2, 1.9, 2.8, 4.0, 4.0, 4.0, 4.0]))
        vol: SplineObject = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2 = vol.get_derivative_spline(0)
        self.assertEqual(vol2.order(direction=0), 3)
        self.assertEqual(vol2.order(direction=1), 3)
        self.assertEqual(vol2.order(direction=2), 4)
        vol3 = vol.get_derivative_spline(1)
        self.assertEqual(vol3.order(direction=0), 4)
        self.assertEqual(vol3.order(direction=1), 2)
        self.assertEqual(vol3.order(direction=2), 4)
        vol4 = vol.get_derivative_spline(2)
        self.assertEqual(vol4.order(direction=0), 4)
        self.assertEqual(vol4.order(direction=1), 3)
        self.assertEqual(vol4.order(direction=2), 3)

        u = np.linspace(vol.start(0), vol.end(0), 5)
        v = np.linspace(vol.start(1), vol.end(1), 5)
        w = np.linspace(vol.start(2), vol.end(2), 5)
        du = vol.derivative(u, v, w, d=(1, 0, 0))
        du2 = vol2(u, v, w)
        dv = vol.derivative(u, v, w, d=(0, 1, 0))
        dv2 = vol3(u, v, w)
        dw = vol.derivative(u, v, w, d=(0, 0, 1))
        dw2 = vol4(u, v, w)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dw - dw2)), 0.0)

    def test_curve_3D_p4_C0_periodic(self) -> None:
        controlpoints = np.array(
            [
                [103.0, 0.0, -1.0],
                [67.0, 74.0, 0.0],
                [-2.0, 101.0, -4.0],
                [-76.0, 72.0, 0.0],
                [-97.0, -3.0, -1.0],
                [-75.0, -69.0, -2.0],
                [0.0, -98.0, 3.0],
                [65.0, -70.0, 1.0],
            ]
        )
        basis0 = BSplineBasis(
            4, np.array([-0.9, 0.0, 0.0, 0.0, 0.6, 2.3, 3.1, 4.1, 5.1, 6.0, 6.0, 6.0, 6.6]), 0
        )
        crv: SplineObject = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 = crv.get_derivative_spline(0)
        self.assertEqual(crv2.order(direction=0), 3)

        u = np.linspace(crv.start(0), crv.end(0), 11)
        du = crv.derivative(u)
        du2 = crv2(u)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)

    def test_surface_3D_p43_C0_periodic(self) -> None:
        controlpoints = np.array(
            [
                [58.0, -2.0, 1.0],
                [47.0, 43.0, 3.0],
                [1.0, 57.0, -4.0],
                [-38.0, 40.0, -3.0],
                [-63.0, -1.0, -3.0],
                [-41.0, -41.0, 4.0],
                [-4.0, -63.0, 1.0],
                [40.0, -43.0, 2.0],
                [68.0, 1.0, -5.0],
                [52.0, 56.0, 3.0],
                [-4.0, 73.0, 1.0],
                [-57.0, 52.0, -2.0],
                [-73.0, -2.0, 3.0],
                [-49.0, -57.0, 1.0],
                [-5.0, -69.0, -4.0],
                [48.0, -57.0, 0.0],
                [82.0, -4.0, 2.0],
                [59.0, 57.0, 1.0],
                [4.0, 88.0, -2.0],
                [-63.0, 58.0, -4.0],
                [-86.0, 3.0, -4.0],
                [-57.0, -59.0, 4.0],
                [3.0, -88.0, -1.0],
                [63.0, -59.0, -3.0],
                [101.0, 2.0, -2.0],
                [69.0, 74.0, -5.0],
                [-1.0, 103.0, -3.0],
                [-71.0, 71.0, -2.0],
                [-105.0, -5.0, 4.0],
                [-68.0, -68.0, 1.0],
                [2.0, -99.0, 3.0],
                [68.0, -67.0, -2.0],
            ]
        )
        basis0 = BSplineBasis(
            4, np.array([-1.3, 0.0, 0.0, 0.0, 1.2, 1.7, 3.3, 3.9, 4.7, 6.0, 6.0, 6.0, 7.2]), 0
        )
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 0.6, 2.0, 2.0, 2.0]))
        surf: SplineObject = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 = surf.get_derivative_spline(0)
        self.assertEqual(surf2.order(direction=0), 3)
        self.assertEqual(surf2.order(direction=1), 3)
        surf3 = surf.get_derivative_spline(1)
        self.assertEqual(surf3.order(direction=0), 4)
        self.assertEqual(surf3.order(direction=1), 2)

        u = np.linspace(surf.start(0), surf.end(0), 7)
        v = np.linspace(surf.start(1), surf.end(1), 7)
        du = surf.derivative(u, v, d=(1, 0))
        du2 = surf2(u, v)
        dv = surf.derivative(u, v, d=(0, 1))
        dv2 = surf3(u, v)

        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)

    def test_volume_3D_p334_C0_periodic(self) -> None:
        controlpoints = np.array(
            [
                [54.0, 1.0, -1.0],
                [25.0, 38.0, 4.0],
                [-22.0, 41.0, 4.0],
                [-46.0, 4.0, 4.0],
                [-28.0, -41.0, 1.0],
                [21.0, -47.0, 0.0],
                [59.0, -3.0, -2.0],
                [27.0, 59.0, -3.0],
                [-31.0, 57.0, 1.0],
                [-63.0, 3.0, 2.0],
                [-36.0, -55.0, 0.0],
                [35.0, -51.0, 0.0],
                [71.0, 2.0, 2.0],
                [41.0, 63.0, -3.0],
                [-40.0, 62.0, 1.0],
                [-72.0, 3.0, 4.0],
                [-36.0, -65.0, 0.0],
                [34.0, -69.0, -5.0],
                [83.0, 1.0, -2.0],
                [41.0, 78.0, 3.0],
                [-45.0, 79.0, -1.0],
                [-86.0, 2.0, -2.0],
                [-42.0, -81.0, -1.0],
                [43.0, -76.0, 1.0],
                [102.0, -2.0, -1.0],
                [48.0, 90.0, 4.0],
                [-51.0, 90.0, -5.0],
                [-104.0, -4.0, -2.0],
                [-51.0, -85.0, 3.0],
                [45.0, -86.0, -5.0],
                [47.0, -3.0, 12.0],
                [28.0, 45.0, 14.0],
                [-30.0, 41.0, 7.0],
                [-48.0, 1.0, 13.0],
                [-27.0, -44.0, 5.0],
                [21.0, -43.0, 11.0],
                [60.0, 1.0, 6.0],
                [29.0, 58.0, 8.0],
                [-35.0, 50.0, 6.0],
                [-63.0, 4.0, 8.0],
                [-34.0, -53.0, 13.0],
                [31.0, -54.0, 12.0],
                [79.0, 2.0, 8.0],
                [37.0, 63.0, 7.0],
                [-40.0, 69.0, 14.0],
                [-73.0, 4.0, 8.0],
                [-35.0, -67.0, 14.0],
                [42.0, -62.0, 14.0],
                [92.0, -4.0, 5.0],
                [41.0, 78.0, 11.0],
                [-48.0, 76.0, 10.0],
                [-92.0, -3.0, 6.0],
                [-46.0, -73.0, 7.0],
                [41.0, -78.0, 14.0],
                [96.0, -4.0, 11.0],
                [49.0, 82.0, 12.0],
                [-52.0, 85.0, 7.0],
                [-102.0, 3.0, 7.0],
                [-51.0, -90.0, 9.0],
                [48.0, -91.0, 6.0],
                [54.0, -4.0, 15.0],
                [23.0, 47.0, 16.0],
                [-22.0, 45.0, 22.0],
                [-54.0, 2.0, 21.0],
                [-22.0, -46.0, 20.0],
                [22.0, -44.0, 17.0],
                [66.0, -4.0, 21.0],
                [29.0, 50.0, 17.0],
                [-36.0, 51.0, 21.0],
                [-66.0, -3.0, 15.0],
                [-32.0, -58.0, 23.0],
                [27.0, -54.0, 23.0],
                [72.0, 1.0, 23.0],
                [40.0, 69.0, 23.0],
                [-39.0, 66.0, 22.0],
                [-77.0, 0.0, 19.0],
                [-37.0, -60.0, 17.0],
                [41.0, -69.0, 21.0],
                [85.0, -1.0, 18.0],
                [47.0, 80.0, 19.0],
                [-49.0, 74.0, 19.0],
                [-89.0, 0.0, 22.0],
                [-41.0, -77.0, 19.0],
                [41.0, -78.0, 15.0],
                [100.0, 1.0, 16.0],
                [51.0, 89.0, 21.0],
                [-51.0, 88.0, 19.0],
                [-98.0, 0.0, 15.0],
                [-53.0, -85.0, 18.0],
                [47.0, -87.0, 24.0],
                [54.0, 3.0, 33.0],
                [29.0, 48.0, 29.0],
                [-24.0, 39.0, 27.0],
                [-47.0, -2.0, 32.0],
                [-29.0, -41.0, 33.0],
                [20.0, -47.0, 33.0],
                [63.0, -5.0, 28.0],
                [26.0, 51.0, 34.0],
                [-32.0, 52.0, 25.0],
                [-64.0, 0.0, 32.0],
                [-33.0, -52.0, 25.0],
                [34.0, -60.0, 30.0],
                [78.0, -5.0, 31.0],
                [33.0, 64.0, 34.0],
                [-39.0, 61.0, 33.0],
                [-72.0, 4.0, 29.0],
                [-41.0, -70.0, 26.0],
                [42.0, -63.0, 31.0],
                [87.0, 4.0, 26.0],
                [45.0, 78.0, 32.0],
                [-49.0, 76.0, 31.0],
                [-89.0, 3.0, 27.0],
                [-46.0, -79.0, 25.0],
                [47.0, -72.0, 34.0],
                [97.0, -5.0, 32.0],
                [47.0, 84.0, 30.0],
                [-51.0, 90.0, 25.0],
                [-98.0, -2.0, 34.0],
                [-46.0, -86.0, 27.0],
                [52.0, -85.0, 31.0],
                [54.0, -2.0, 35.0],
                [29.0, 42.0, 43.0],
                [-27.0, 47.0, 42.0],
                [-48.0, -5.0, 37.0],
                [-29.0, -44.0, 41.0],
                [27.0, -40.0, 43.0],
                [60.0, 4.0, 36.0],
                [35.0, 56.0, 40.0],
                [-28.0, 56.0, 41.0],
                [-63.0, 4.0, 41.0],
                [-32.0, -53.0, 40.0],
                [31.0, -58.0, 35.0],
                [78.0, 0.0, 37.0],
                [37.0, 67.0, 35.0],
                [-39.0, 67.0, 39.0],
                [-77.0, 2.0, 41.0],
                [-33.0, -65.0, 37.0],
                [39.0, -67.0, 39.0],
                [89.0, -4.0, 37.0],
                [48.0, 77.0, 41.0],
                [-42.0, 77.0, 43.0],
                [-91.0, 2.0, 42.0],
                [-41.0, -74.0, 39.0],
                [47.0, -74.0, 36.0],
                [95.0, 0.0, 42.0],
                [50.0, 88.0, 41.0],
                [-47.0, 90.0, 38.0],
                [-102.0, -5.0, 38.0],
                [-50.0, -82.0, 37.0],
                [46.0, -87.0, 38.0],
            ]
        )
        basis0 = BSplineBasis(3, np.array([-0.9, 0.0, 0.0, 1.4, 2.0, 3.4, 4.1, 5.0, 5.0, 6.4]), 0)
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.1, 2.1, 3.0, 3.0, 3.0]))
        basis2 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 0.9, 2.0, 2.0, 2.0, 2.0]))
        vol: SplineObject = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2 = vol.get_derivative_spline(0)
        self.assertEqual(vol2.order(direction=0), 2)
        self.assertEqual(vol2.order(direction=1), 3)
        self.assertEqual(vol2.order(direction=2), 4)
        vol3 = vol.get_derivative_spline(1)
        self.assertEqual(vol3.order(direction=0), 3)
        self.assertEqual(vol3.order(direction=1), 2)
        self.assertEqual(vol3.order(direction=2), 4)
        vol4 = vol.get_derivative_spline(2)
        self.assertEqual(vol4.order(direction=0), 3)
        self.assertEqual(vol4.order(direction=1), 3)
        self.assertEqual(vol4.order(direction=2), 3)

        u = np.linspace(vol.start(0), vol.end(0), 5)
        v = np.linspace(vol.start(1), vol.end(1), 5)
        w = np.linspace(vol.start(2), vol.end(2), 5)
        du = vol.derivative(u, v, w, d=(1, 0, 0))
        du2 = vol2(u, v, w)
        dv = vol.derivative(u, v, w, d=(0, 1, 0))
        dv2 = vol3(u, v, w)
        dw = vol.derivative(u, v, w, d=(0, 0, 1))
        dw2 = vol4(u, v, w)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dw - dw2)), 0.0)

    def test_curve_3D_p4_C1_periodic(self) -> None:
        controlpoints = np.array(
            [
                [96.0, 2.0, 0.0],
                [80.0, 61.0, 1.0],
                [28.0, 93.0, 1.0],
                [-29.0, 96.0, 0.0],
                [-86.0, 53.0, -3.0],
                [-105.0, 1.0, -2.0],
                [-83.0, -63.0, 3.0],
                [-28.0, -95.0, -5.0],
                [32.0, -95.0, -4.0],
                [82.0, -62.0, 0.0],
            ]
        )
        basis0 = BSplineBasis(
            4,
            np.array([-2.2, -1.0, 0.0, 0.0, 0.9, 2.2, 3.1, 4.3, 4.7, 5.8, 6.8, 8.0, 9.0, 9.0, 9.9, 11.2]),
            1,
        )
        crv: SplineObject = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 = crv.get_derivative_spline(0)
        self.assertEqual(crv2.order(direction=0), 3)

        u = np.linspace(crv.start(0), crv.end(0), 11)
        du = crv.derivative(u)
        du2 = crv2(u)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)

    def test_surface_3D_p44_C1_periodic(self) -> None:
        controlpoints = np.array(
            [
                [61.0, 4.0, -3.0],
                [46.0, 37.0, 0.0],
                [19.0, 55.0, 3.0],
                [-17.0, 58.0, -4.0],
                [-48.0, 36.0, 4.0],
                [-64.0, -3.0, 1.0],
                [-48.0, -33.0, -4.0],
                [-18.0, -62.0, 4.0],
                [15.0, -56.0, -5.0],
                [52.0, -32.0, 1.0],
                [66.0, 3.0, 3.0],
                [50.0, 43.0, -3.0],
                [15.0, 63.0, 1.0],
                [-22.0, 63.0, -2.0],
                [-50.0, 37.0, -3.0],
                [-68.0, 1.0, 0.0],
                [-59.0, -42.0, -2.0],
                [-17.0, -61.0, 0.0],
                [16.0, -67.0, -5.0],
                [51.0, -39.0, 1.0],
                [76.0, -3.0, -4.0],
                [60.0, 38.0, -5.0],
                [26.0, 69.0, -5.0],
                [-28.0, 66.0, -3.0],
                [-63.0, 41.0, -2.0],
                [-74.0, 1.0, 2.0],
                [-56.0, -47.0, -5.0],
                [-28.0, -67.0, -4.0],
                [24.0, -66.0, -2.0],
                [55.0, -42.0, -3.0],
                [77.0, -2.0, -5.0],
                [65.0, 51.0, -3.0],
                [27.0, 71.0, 0.0],
                [-28.0, 73.0, 3.0],
                [-65.0, 44.0, 0.0],
                [-77.0, 1.0, -1.0],
                [-68.0, -45.0, -3.0],
                [-27.0, -79.0, 3.0],
                [24.0, -78.0, -4.0],
                [68.0, -47.0, 1.0],
                [90.0, -3.0, -3.0],
                [71.0, 50.0, -3.0],
                [31.0, 79.0, 4.0],
                [-29.0, 79.0, -4.0],
                [-72.0, 47.0, 0.0],
                [-85.0, 3.0, 0.0],
                [-74.0, -52.0, 0.0],
                [-29.0, -84.0, -2.0],
                [23.0, -87.0, -5.0],
                [66.0, -49.0, 2.0],
                [93.0, -2.0, -1.0],
                [71.0, 57.0, 3.0],
                [33.0, 93.0, 0.0],
                [-26.0, 85.0, 0.0],
                [-72.0, 59.0, 3.0],
                [-96.0, 0.0, 4.0],
                [-75.0, -53.0, 2.0],
                [-32.0, -88.0, -1.0],
                [24.0, -93.0, 3.0],
                [79.0, -56.0, -4.0],
                [101.0, 3.0, -3.0],
                [84.0, 60.0, 0.0],
                [30.0, 92.0, -1.0],
                [-27.0, 99.0, 2.0],
                [-81.0, 58.0, 2.0],
                [-97.0, -3.0, 1.0],
                [-85.0, -55.0, -3.0],
                [-33.0, -91.0, 1.0],
                [26.0, -91.0, -1.0],
                [77.0, -60.0, 0.0],
            ]
        )
        basis0 = BSplineBasis(
            4,
            np.array([-1.7, -1.2, 0.0, 0.0, 0.7, 1.9, 2.8, 4.0, 5.2, 5.9, 7.3, 7.8, 9.0, 9.0, 9.7, 10.9]),
            1,
        )
        basis1 = BSplineBasis(4, np.array([0.0, 0.0, 0.0, 0.0, 0.9, 2.2, 3.4, 4.0, 4.0, 4.0, 4.0]))
        surf: SplineObject = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 = surf.get_derivative_spline(0)
        self.assertEqual(surf2.order(direction=0), 3)
        self.assertEqual(surf2.order(direction=1), 4)
        surf3 = surf.get_derivative_spline(1)
        self.assertEqual(surf3.order(direction=0), 4)
        self.assertEqual(surf3.order(direction=1), 3)

        u = np.linspace(surf.start(0), surf.end(0), 7)
        v = np.linspace(surf.start(1), surf.end(1), 7)
        du = surf.derivative(u, v, d=(1, 0))
        du2 = surf2(u, v)
        dv = surf.derivative(u, v, d=(0, 1))
        dv2 = surf3(u, v)

        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)

    def test_volume_3D_p432_C1_periodic(self) -> None:
        controlpoints = np.array(
            [
                [50.0, 3.0, -1.0],
                [41.0, 29.0, 2.0],
                [12.0, 49.0, 3.0],
                [-15.0, 44.0, -2.0],
                [-42.0, 34.0, -3.0],
                [-46.0, -4.0, -2.0],
                [-39.0, -32.0, 4.0],
                [-17.0, -53.0, 3.0],
                [11.0, -52.0, 0.0],
                [38.0, -34.0, -2.0],
                [59.0, -2.0, 1.0],
                [48.0, 30.0, -3.0],
                [22.0, 61.0, -1.0],
                [-22.0, 59.0, -4.0],
                [-50.0, 33.0, 4.0],
                [-61.0, 0.0, 2.0],
                [-52.0, -35.0, -5.0],
                [-18.0, -59.0, -4.0],
                [18.0, -61.0, -4.0],
                [51.0, -34.0, 3.0],
                [72.0, -2.0, -2.0],
                [58.0, 39.0, -1.0],
                [26.0, 64.0, 3.0],
                [-19.0, 65.0, -1.0],
                [-61.0, 39.0, 0.0],
                [-72.0, -4.0, 0.0],
                [-59.0, -40.0, 3.0],
                [-27.0, -68.0, -4.0],
                [22.0, -65.0, 1.0],
                [60.0, -46.0, -1.0],
                [84.0, 4.0, 1.0],
                [69.0, 44.0, 4.0],
                [25.0, 76.0, -3.0],
                [-23.0, 76.0, -5.0],
                [-70.0, 51.0, -1.0],
                [-77.0, -3.0, -1.0],
                [-66.0, -46.0, 1.0],
                [-27.0, -81.0, -2.0],
                [22.0, -75.0, 3.0],
                [68.0, -44.0, -3.0],
                [86.0, -1.0, 1.0],
                [76.0, 50.0, 4.0],
                [30.0, 86.0, 2.0],
                [-26.0, 87.0, -3.0],
                [-71.0, 57.0, -1.0],
                [-88.0, 2.0, -1.0],
                [-74.0, -57.0, 2.0],
                [-26.0, -90.0, 3.0],
                [24.0, -86.0, 0.0],
                [76.0, -58.0, 2.0],
                [100.0, -2.0, 2.0],
                [83.0, 62.0, 0.0],
                [26.0, 93.0, 4.0],
                [-34.0, 94.0, -3.0],
                [-86.0, 61.0, -5.0],
                [-104.0, -3.0, -1.0],
                [-78.0, -55.0, -5.0],
                [-32.0, -99.0, -3.0],
                [27.0, -95.0, -1.0],
                [81.0, -56.0, 0.0],
                [52.0, 3.0, 9.0],
                [38.0, 34.0, 8.0],
                [13.0, 51.0, 9.0],
                [-14.0, 49.0, 12.0],
                [-39.0, 33.0, 13.0],
                [-51.0, 1.0, 14.0],
                [-39.0, -32.0, 14.0],
                [-21.0, -52.0, 8.0],
                [12.0, -51.0, 6.0],
                [44.0, -25.0, 9.0],
                [61.0, 4.0, 9.0],
                [52.0, 35.0, 6.0],
                [14.0, 56.0, 11.0],
                [-16.0, 55.0, 11.0],
                [-46.0, 35.0, 7.0],
                [-64.0, 4.0, 12.0],
                [-47.0, -33.0, 7.0],
                [-22.0, -61.0, 8.0],
                [14.0, -59.0, 9.0],
                [48.0, -36.0, 5.0],
                [69.0, 2.0, 5.0],
                [55.0, 39.0, 13.0],
                [18.0, 64.0, 6.0],
                [-23.0, 62.0, 12.0],
                [-56.0, 37.0, 14.0],
                [-70.0, -1.0, 13.0],
                [-60.0, -44.0, 10.0],
                [-24.0, -70.0, 10.0],
                [25.0, -71.0, 10.0],
                [54.0, -44.0, 12.0],
                [80.0, -1.0, 10.0],
                [61.0, 43.0, 14.0],
                [26.0, 78.0, 12.0],
                [-30.0, 79.0, 7.0],
                [-66.0, 49.0, 14.0],
                [-82.0, 4.0, 11.0],
                [-63.0, -43.0, 8.0],
                [-27.0, -76.0, 10.0],
                [26.0, -74.0, 6.0],
                [66.0, -43.0, 9.0],
                [85.0, 4.0, 13.0],
                [70.0, 57.0, 9.0],
                [25.0, 84.0, 14.0],
                [-25.0, 86.0, 6.0],
                [-71.0, 50.0, 9.0],
                [-91.0, 1.0, 13.0],
                [-70.0, -55.0, 12.0],
                [-30.0, -89.0, 11.0],
                [28.0, -91.0, 12.0],
                [72.0, -56.0, 6.0],
                [102.0, -3.0, 6.0],
                [83.0, 61.0, 10.0],
                [29.0, 94.0, 10.0],
                [-29.0, 97.0, 5.0],
                [-84.0, 54.0, 12.0],
                [-97.0, 4.0, 12.0],
                [-79.0, -56.0, 12.0],
                [-30.0, -98.0, 7.0],
                [29.0, -98.0, 12.0],
                [78.0, -60.0, 6.0],
                [48.0, 1.0, 18.0],
                [40.0, 24.0, 18.0],
                [11.0, 52.0, 19.0],
                [-12.0, 50.0, 19.0],
                [-43.0, 34.0, 19.0],
                [-53.0, -3.0, 24.0],
                [-45.0, -34.0, 23.0],
                [-17.0, -49.0, 18.0],
                [17.0, -47.0, 21.0],
                [42.0, -26.0, 17.0],
                [62.0, -2.0, 16.0],
                [53.0, 32.0, 22.0],
                [19.0, 61.0, 24.0],
                [-21.0, 52.0, 20.0],
                [-53.0, 39.0, 18.0],
                [-59.0, -3.0, 16.0],
                [-49.0, -35.0, 15.0],
                [-17.0, -61.0, 24.0],
                [20.0, -62.0, 16.0],
                [44.0, -32.0, 18.0],
                [65.0, 4.0, 18.0],
                [58.0, 41.0, 20.0],
                [19.0, 71.0, 16.0],
                [-23.0, 64.0, 17.0],
                [-56.0, 37.0, 16.0],
                [-71.0, 3.0, 23.0],
                [-58.0, -42.0, 22.0],
                [-26.0, -69.0, 15.0],
                [19.0, -67.0, 15.0],
                [54.0, -37.0, 17.0],
                [84.0, 1.0, 22.0],
                [66.0, 42.0, 15.0],
                [23.0, 76.0, 20.0],
                [-20.0, 76.0, 21.0],
                [-69.0, 50.0, 15.0],
                [-85.0, 0.0, 23.0],
                [-69.0, -47.0, 18.0],
                [-22.0, -77.0, 21.0],
                [20.0, -81.0, 24.0],
                [69.0, -46.0, 22.0],
                [87.0, -4.0, 21.0],
                [77.0, 53.0, 19.0],
                [24.0, 89.0, 22.0],
                [-26.0, 80.0, 24.0],
                [-77.0, 54.0, 22.0],
                [-92.0, 3.0, 22.0],
                [-72.0, -57.0, 21.0],
                [-30.0, -85.0, 23.0],
                [30.0, -83.0, 18.0],
                [68.0, -54.0, 15.0],
                [102.0, -4.0, 19.0],
                [85.0, 60.0, 17.0],
                [29.0, 93.0, 20.0],
                [-33.0, 95.0, 18.0],
                [-79.0, 62.0, 19.0],
                [-104.0, 1.0, 19.0],
                [-86.0, -58.0, 19.0],
                [-28.0, -91.0, 22.0],
                [31.0, -99.0, 15.0],
                [83.0, -55.0, 23.0],
                [50.0, -4.0, 30.0],
                [42.0, 28.0, 32.0],
                [20.0, 52.0, 26.0],
                [-18.0, 52.0, 31.0],
                [-42.0, 26.0, 33.0],
                [-46.0, -4.0, 34.0],
                [-40.0, -31.0, 27.0],
                [-14.0, -50.0, 32.0],
                [15.0, -53.0, 31.0],
                [45.0, -28.0, 29.0],
                [64.0, 3.0, 29.0],
                [46.0, 31.0, 28.0],
                [17.0, 59.0, 25.0],
                [-14.0, 56.0, 31.0],
                [-47.0, 32.0, 34.0],
                [-57.0, -2.0, 31.0],
                [-45.0, -37.0, 31.0],
                [-20.0, -53.0, 31.0],
                [18.0, -53.0, 32.0],
                [53.0, -35.0, 29.0],
                [70.0, 2.0, 26.0],
                [60.0, 36.0, 32.0],
                [17.0, 65.0, 31.0],
                [-25.0, 69.0, 28.0],
                [-56.0, 43.0, 26.0],
                [-74.0, -3.0, 33.0],
                [-60.0, -37.0, 27.0],
                [-20.0, -66.0, 26.0],
                [17.0, -69.0, 27.0],
                [55.0, -41.0, 34.0],
                [78.0, 4.0, 27.0],
                [63.0, 42.0, 34.0],
                [26.0, 75.0, 29.0],
                [-23.0, 71.0, 31.0],
                [-60.0, 44.0, 26.0],
                [-84.0, 2.0, 29.0],
                [-62.0, -50.0, 32.0],
                [-25.0, -73.0, 34.0],
                [21.0, -81.0, 27.0],
                [60.0, -48.0, 33.0],
                [92.0, 1.0, 29.0],
                [69.0, 55.0, 26.0],
                [25.0, 85.0, 28.0],
                [-29.0, 81.0, 33.0],
                [-73.0, 50.0, 28.0],
                [-88.0, 0.0, 25.0],
                [-76.0, -52.0, 30.0],
                [-25.0, -86.0, 25.0],
                [23.0, -83.0, 27.0],
                [70.0, -53.0, 27.0],
                [100.0, 3.0, 32.0],
                [78.0, 56.0, 28.0],
                [26.0, 92.0, 29.0],
                [-32.0, 99.0, 25.0],
                [-81.0, 59.0, 27.0],
                [-98.0, 2.0, 27.0],
                [-80.0, -56.0, 33.0],
                [-33.0, -92.0, 29.0],
                [26.0, -98.0, 31.0],
                [78.0, -64.0, 33.0],
                [53.0, -2.0, 42.0],
                [39.0, 24.0, 37.0],
                [16.0, 50.0, 40.0],
                [-16.0, 48.0, 40.0],
                [-37.0, 25.0, 40.0],
                [-53.0, 0.0, 35.0],
                [-37.0, -34.0, 35.0],
                [-17.0, -46.0, 44.0],
                [14.0, -50.0, 35.0],
                [37.0, -27.0, 39.0],
                [64.0, 4.0, 39.0],
                [46.0, 36.0, 44.0],
                [14.0, 60.0, 43.0],
                [-17.0, 58.0, 43.0],
                [-48.0, 31.0, 42.0],
                [-62.0, -4.0, 44.0],
                [-46.0, -40.0, 37.0],
                [-20.0, -58.0, 37.0],
                [14.0, -61.0, 44.0],
                [49.0, -37.0, 35.0],
                [65.0, 1.0, 36.0],
                [52.0, 40.0, 41.0],
                [18.0, 63.0, 35.0],
                [-20.0, 67.0, 39.0],
                [-61.0, 40.0, 42.0],
                [-73.0, 2.0, 41.0],
                [-60.0, -39.0, 41.0],
                [-20.0, -67.0, 35.0],
                [23.0, -72.0, 36.0],
                [53.0, -45.0, 43.0],
                [81.0, -4.0, 36.0],
                [64.0, 49.0, 38.0],
                [23.0, 73.0, 41.0],
                [-22.0, 76.0, 36.0],
                [-63.0, 49.0, 38.0],
                [-82.0, -2.0, 38.0],
                [-61.0, -43.0, 43.0],
                [-30.0, -72.0, 44.0],
                [28.0, -74.0, 36.0],
                [62.0, -45.0, 36.0],
                [85.0, 0.0, 36.0],
                [71.0, 50.0, 40.0],
                [27.0, 90.0, 44.0],
                [-27.0, 88.0, 36.0],
                [-72.0, 49.0, 38.0],
                [-87.0, 2.0, 42.0],
                [-69.0, -53.0, 41.0],
                [-31.0, -91.0, 36.0],
                [28.0, -83.0, 42.0],
                [69.0, -50.0, 36.0],
                [99.0, 0.0, 36.0],
                [77.0, 63.0, 42.0],
                [32.0, 93.0, 44.0],
                [-28.0, 93.0, 41.0],
                [-86.0, 61.0, 36.0],
                [-97.0, 3.0, 36.0],
                [-78.0, -56.0, 44.0],
                [-34.0, -99.0, 36.0],
                [29.0, -97.0, 37.0],
                [82.0, -63.0, 39.0],
            ]
        )
        basis0 = BSplineBasis(
            4,
            np.array([-2.4, -0.8, 0.0, 0.0, 0.6, 1.9, 3.2, 3.8, 5.1, 6.3, 6.6, 8.2, 9.0, 9.0, 9.6, 10.9]),
            1,
        )
        basis1 = BSplineBasis(3, np.array([0.0, 0.0, 0.0, 1.4, 2.2, 2.6, 4.0, 4.0, 4.0]))
        basis2 = BSplineBasis(2, np.array([0.0, 0.0, 0.9, 2.0, 3.4, 4.0, 4.0]))
        vol: SplineObject = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2 = vol.get_derivative_spline(0)
        self.assertEqual(vol2.order(direction=0), 3)
        self.assertEqual(vol2.order(direction=1), 3)
        self.assertEqual(vol2.order(direction=2), 2)
        vol3 = vol.get_derivative_spline(1)
        self.assertEqual(vol3.order(direction=0), 4)
        self.assertEqual(vol3.order(direction=1), 2)
        self.assertEqual(vol3.order(direction=2), 2)
        vol4 = vol.get_derivative_spline(2)
        self.assertEqual(vol4.order(direction=0), 4)
        self.assertEqual(vol4.order(direction=1), 3)
        self.assertEqual(vol4.order(direction=2), 1)

        u = np.linspace(vol.start(0), vol.end(0), 5)
        v = np.linspace(vol.start(1), vol.end(1), 5)
        w = np.linspace(vol.start(2), vol.end(2), 5)
        du = vol.derivative(u, v, w, d=(1, 0, 0))
        du2 = vol2(u, v, w)
        dv = vol.derivative(u, v, w, d=(0, 1, 0))
        dv2 = vol3(u, v, w)
        dw = vol.derivative(u, v, w, d=(0, 0, 1))
        dw2 = vol4(u, v, w)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dw - dw2)), 0.0)

    def test_curve_2D_p5(self) -> None:
        controlpoints = np.array(
            [
                [-3.0, -2.0],
                [10.0, 2.0],
                [25.0, 4.0],
                [39.0, 1.0],
                [54.0, -1.0],
                [74.0, -2.0],
                [81.0, -2.0],
                [102.0, 3.0],
            ]
        )
        basis0 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 2.3, 2.8, 4.0, 4.0, 4.0, 4.0, 4.0]))
        crv: SplineObject = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 = crv.get_derivative_spline(0)
        self.assertEqual(crv2.order(direction=0), 4)

        u = np.linspace(crv.start(0), crv.end(0), 11)
        du = crv.derivative(u)
        du2 = crv2(u)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)

    def test_surface_2D_p56(self) -> None:
        controlpoints = np.array(
            [
                [1.0, 3.0],
                [17.0, -3.0],
                [25.0, -5.0],
                [40.0, -2.0],
                [60.0, 2.0],
                [72.0, 0.0],
                [85.0, 3.0],
                [95.0, 2.0],
                [-5.0, 13.0],
                [11.0, 8.0],
                [25.0, 14.0],
                [47.0, 14.0],
                [58.0, 7.0],
                [66.0, 7.0],
                [86.0, 13.0],
                [104.0, 10.0],
                [-1.0, 25.0],
                [11.0, 26.0],
                [32.0, 21.0],
                [40.0, 21.0],
                [56.0, 24.0],
                [67.0, 29.0],
                [85.0, 23.0],
                [98.0, 24.0],
                [-2.0, 38.0],
                [17.0, 39.0],
                [24.0, 34.0],
                [41.0, 38.0],
                [61.0, 33.0],
                [67.0, 39.0],
                [87.0, 36.0],
                [104.0, 37.0],
                [-4.0, 54.0],
                [16.0, 49.0],
                [27.0, 54.0],
                [41.0, 51.0],
                [57.0, 46.0],
                [67.0, 52.0],
                [82.0, 52.0],
                [99.0, 48.0],
                [-2.0, 61.0],
                [14.0, 67.0],
                [32.0, 61.0],
                [40.0, 60.0],
                [59.0, 63.0],
                [72.0, 63.0],
                [84.0, 66.0],
                [103.0, 67.0],
                [4.0, 76.0],
                [9.0, 78.0],
                [32.0, 76.0],
                [41.0, 79.0],
                [59.0, 79.0],
                [76.0, 78.0],
                [81.0, 78.0],
                [101.0, 74.0],
                [-4.0, 88.0],
                [15.0, 84.0],
                [27.0, 83.0],
                [43.0, 84.0],
                [57.0, 91.0],
                [71.0, 87.0],
                [83.0, 91.0],
                [104.0, 85.0],
                [-3.0, 103.0],
                [12.0, 96.0],
                [25.0, 98.0],
                [42.0, 104.0],
                [60.0, 97.0],
                [70.0, 98.0],
                [89.0, 101.0],
                [100.0, 99.0],
            ]
        )
        basis0 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 2.3, 2.9, 4.0, 4.0, 4.0, 4.0, 4.0]))
        basis1 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 2.1, 3.2, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        surf: SplineObject = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 = surf.get_derivative_spline(0)
        self.assertEqual(surf2.order(direction=0), 4)
        self.assertEqual(surf2.order(direction=1), 6)
        surf3 = surf.get_derivative_spline(1)
        self.assertEqual(surf3.order(direction=0), 5)
        self.assertEqual(surf3.order(direction=1), 5)

        u = np.linspace(surf.start(0), surf.end(0), 7)
        v = np.linspace(surf.start(1), surf.end(1), 7)
        du = surf.derivative(u, v, d=(1, 0))
        du2 = surf2(u, v)
        dv = surf.derivative(u, v, d=(0, 1))
        dv2 = surf3(u, v)

        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)

    def test_curve_2D_p5_C0_periodic(self) -> None:
        controlpoints = np.array(
            [
                [100.0, 1.0],
                [76.0, 58.0],
                [35.0, 95.0],
                [-28.0, 99.0],
                [-82.0, 57.0],
                [-105.0, -1.0],
                [-84.0, -61.0],
                [-36.0, -91.0],
                [34.0, -97.0],
                [80.0, -62.0],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([-1.4, 0.0, 0.0, 0.0, 0.0, 0.8, 2.0, 3.3, 4.1, 4.6, 5.6, 7.0, 7.0, 7.0, 7.0, 7.8]), 0
        )
        crv: SplineObject = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 = crv.get_derivative_spline(0)
        self.assertEqual(crv2.order(direction=0), 4)

        u = np.linspace(crv.start(0), crv.end(0), 11)
        du = crv.derivative(u)
        du2 = crv2(u)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)

    def test_surface_2D_p57_C0_periodic(self) -> None:
        controlpoints = np.array(
            [
                [56.0, -1.0],
                [47.0, 39.0],
                [21.0, 59.0],
                [-19.0, 61.0],
                [-52.0, 33.0],
                [-65.0, -3.0],
                [-54.0, -38.0],
                [-24.0, -60.0],
                [16.0, -53.0],
                [53.0, -33.0],
                [67.0, -2.0],
                [47.0, 35.0],
                [23.0, 57.0],
                [-22.0, 65.0],
                [-56.0, 39.0],
                [-69.0, 0.0],
                [-52.0, -36.0],
                [-25.0, -60.0],
                [22.0, -64.0],
                [50.0, -42.0],
                [66.0, -4.0],
                [51.0, 40.0],
                [20.0, 62.0],
                [-26.0, 62.0],
                [-56.0, 37.0],
                [-67.0, 4.0],
                [-53.0, -39.0],
                [-26.0, -71.0],
                [22.0, -63.0],
                [57.0, -46.0],
                [76.0, -4.0],
                [60.0, 39.0],
                [26.0, 68.0],
                [-21.0, 72.0],
                [-59.0, 42.0],
                [-77.0, 4.0],
                [-56.0, -48.0],
                [-23.0, -74.0],
                [18.0, -70.0],
                [64.0, -48.0],
                [79.0, -1.0],
                [66.0, 40.0],
                [21.0, 70.0],
                [-22.0, 78.0],
                [-60.0, 50.0],
                [-76.0, 1.0],
                [-67.0, -41.0],
                [-24.0, -72.0],
                [23.0, -73.0],
                [67.0, -48.0],
                [83.0, 1.0],
                [70.0, 52.0],
                [29.0, 82.0],
                [-31.0, 80.0],
                [-70.0, 48.0],
                [-86.0, -3.0],
                [-63.0, -50.0],
                [-30.0, -84.0],
                [27.0, -80.0],
                [69.0, -50.0],
                [87.0, -1.0],
                [73.0, 55.0],
                [26.0, 83.0],
                [-32.0, 86.0],
                [-67.0, 53.0],
                [-83.0, 3.0],
                [-74.0, -49.0],
                [-22.0, -81.0],
                [31.0, -86.0],
                [73.0, -52.0],
                [95.0, 1.0],
                [75.0, 54.0],
                [31.0, 86.0],
                [-30.0, 84.0],
                [-75.0, 55.0],
                [-89.0, -3.0],
                [-70.0, -52.0],
                [-31.0, -85.0],
                [30.0, -87.0],
                [72.0, -49.0],
                [90.0, -1.0],
                [77.0, 55.0],
                [29.0, 93.0],
                [-35.0, 85.0],
                [-76.0, 55.0],
                [-97.0, 3.0],
                [-74.0, -56.0],
                [-28.0, -93.0],
                [30.0, -92.0],
                [81.0, -58.0],
                [101.0, 4.0],
                [83.0, 63.0],
                [27.0, 96.0],
                [-34.0, 99.0],
                [-80.0, 54.0],
                [-98.0, -5.0],
                [-84.0, -55.0],
                [-36.0, -91.0],
                [33.0, -93.0],
                [78.0, -55.0],
            ]
        )
        basis0 = BSplineBasis(
            5, np.array([-0.6, 0.0, 0.0, 0.0, 0.0, 1.2, 2.4, 3.2, 4.2, 4.9, 6.4, 7.0, 7.0, 7.0, 7.0, 8.2]), 0
        )
        basis1 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6, 1.9, 3.4, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        surf: SplineObject = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 = surf.get_derivative_spline(0)
        self.assertEqual(surf2.order(direction=0), 4)
        self.assertEqual(surf2.order(direction=1), 7)
        surf3 = surf.get_derivative_spline(1)
        self.assertEqual(surf3.order(direction=0), 5)
        self.assertEqual(surf3.order(direction=1), 6)

        u = np.linspace(surf.start(0), surf.end(0), 7)
        v = np.linspace(surf.start(1), surf.end(1), 7)
        du = surf.derivative(u, v, d=(1, 0))
        du2 = surf2(u, v)
        dv = surf.derivative(u, v, d=(0, 1))
        dv2 = surf3(u, v)

        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)

    def test_curve_2D_p5_C1_periodic(self) -> None:
        controlpoints = np.array(
            [
                [99.0, 2.0],
                [91.0, 54.0],
                [50.0, 82.0],
                [-2.0, 96.0],
                [-47.0, 89.0],
                [-88.0, 53.0],
                [-105.0, -5.0],
                [-88.0, -48.0],
                [-55.0, -83.0],
                [3.0, -102.0],
                [50.0, -85.0],
                [89.0, -52.0],
            ]
        )
        basis0 = BSplineBasis(
            5,
            np.array(
                [
                    -2.3,
                    -0.8,
                    0.0,
                    0.0,
                    0.0,
                    0.8,
                    2.1,
                    3.4,
                    3.9,
                    4.7,
                    5.9,
                    6.9,
                    7.7,
                    9.2,
                    10.0,
                    10.0,
                    10.0,
                    10.8,
                    12.1,
                ]
            ),
            1,
        )
        crv: SplineObject = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 = crv.get_derivative_spline(0)
        self.assertEqual(crv2.order(direction=0), 4)

        u = np.linspace(crv.start(0), crv.end(0), 11)
        du = crv.derivative(u)
        du2 = crv2(u)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)

    def test_surface_2D_p66_C1_periodic(self) -> None:
        controlpoints = np.array(
            [
                [59.0, -4.0],
                [52.0, 22.0],
                [36.0, 48.0],
                [8.0, 54.0],
                [-10.0, 59.0],
                [-39.0, 49.0],
                [-54.0, 27.0],
                [-57.0, 1.0],
                [-54.0, -26.0],
                [-34.0, -47.0],
                [-11.0, -59.0],
                [17.0, -64.0],
                [38.0, -49.0],
                [58.0, -22.0],
                [64.0, 3.0],
                [61.0, 33.0],
                [45.0, 54.0],
                [19.0, 69.0],
                [-17.0, 62.0],
                [-43.0, 54.0],
                [-56.0, 32.0],
                [-62.0, -4.0],
                [-64.0, -26.0],
                [-46.0, -56.0],
                [-14.0, -70.0],
                [19.0, -62.0],
                [40.0, -49.0],
                [63.0, -27.0],
                [69.0, -1.0],
                [68.0, 29.0],
                [50.0, 55.0],
                [18.0, 67.0],
                [-18.0, 68.0],
                [-50.0, 59.0],
                [-67.0, 27.0],
                [-74.0, -2.0],
                [-68.0, -36.0],
                [-48.0, -58.0],
                [-12.0, -76.0],
                [13.0, -69.0],
                [42.0, -57.0],
                [70.0, -35.0],
                [76.0, 4.0],
                [68.0, 38.0],
                [54.0, 58.0],
                [16.0, 81.0],
                [-20.0, 78.0],
                [-46.0, 61.0],
                [-77.0, 32.0],
                [-77.0, 0.0],
                [-70.0, -30.0],
                [-52.0, -65.0],
                [-18.0, -75.0],
                [19.0, -78.0],
                [46.0, -59.0],
                [73.0, -32.0],
                [83.0, 4.0],
                [77.0, 40.0],
                [56.0, 69.0],
                [24.0, 81.0],
                [-22.0, 80.0],
                [-50.0, 71.0],
                [-77.0, 39.0],
                [-84.0, -5.0],
                [-77.0, -34.0],
                [-51.0, -71.0],
                [-23.0, -89.0],
                [23.0, -89.0],
                [52.0, -69.0],
                [74.0, -35.0],
                [97.0, -2.0],
                [83.0, 43.0],
                [61.0, 74.0],
                [21.0, 91.0],
                [-24.0, 90.0],
                [-54.0, 77.0],
                [-88.0, 42.0],
                [-89.0, 0.0],
                [-80.0, -44.0],
                [-55.0, -71.0],
                [-21.0, -93.0],
                [25.0, -87.0],
                [57.0, -77.0],
                [86.0, -42.0],
                [104.0, 4.0],
                [88.0, 39.0],
                [61.0, 74.0],
                [21.0, 95.0],
                [-27.0, 100.0],
                [-59.0, 73.0],
                [-88.0, 44.0],
                [-96.0, 3.0],
                [-94.0, -40.0],
                [-63.0, -81.0],
                [-20.0, -102.0],
                [22.0, -94.0],
                [66.0, -81.0],
                [94.0, -45.0],
            ]
        )
        basis0 = BSplineBasis(
            6,
            np.array(
                [
                    -1.9,
                    -0.7,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.1,
                    1.8,
                    3.0,
                    4.2,
                    4.9,
                    6.0,
                    7.4,
                    8.1,
                    9.1,
                    10.3,
                    11.0,
                    11.0,
                    11.0,
                    11.0,
                    12.1,
                    12.8,
                ]
            ),
            1,
        )
        basis1 = BSplineBasis(6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.3, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0]))
        surf: SplineObject = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 = surf.get_derivative_spline(0)
        self.assertEqual(surf2.order(direction=0), 5)
        self.assertEqual(surf2.order(direction=1), 6)
        surf3 = surf.get_derivative_spline(1)
        self.assertEqual(surf3.order(direction=0), 6)
        self.assertEqual(surf3.order(direction=1), 5)

        u = np.linspace(surf.start(0), surf.end(0), 7)
        v = np.linspace(surf.start(1), surf.end(1), 7)
        du = surf.derivative(u, v, d=(1, 0))
        du2 = surf2(u, v)
        dv = surf.derivative(u, v, d=(0, 1))
        dv2 = surf3(u, v)

        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)

    def test_curve_2D_p7_C2_periodic(self) -> None:
        controlpoints = np.array(
            [
                [97.0, 2.0],
                [94.0, 37.0],
                [79.0, 60.0],
                [50.0, 91.0],
                [22.0, 101.0],
                [-18.0, 103.0],
                [-53.0, 84.0],
                [-81.0, 68.0],
                [-93.0, 33.0],
                [-100.0, 1.0],
                [-92.0, -33.0],
                [-76.0, -68.0],
                [-55.0, -89.0],
                [-23.0, -98.0],
                [19.0, -98.0],
                [48.0, -89.0],
                [81.0, -65.0],
                [93.0, -38.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    -3.3,
                    -1.9,
                    -0.8,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.0,
                    2.3,
                    2.7,
                    4.1,
                    5.2,
                    6.4,
                    6.7,
                    7.9,
                    9.0,
                    10.0,
                    11.4,
                    11.7,
                    13.1,
                    14.2,
                    15.0,
                    15.0,
                    15.0,
                    15.0,
                    16.0,
                    17.3,
                    17.7,
                ]
            ),
            2,
        )
        crv: SplineObject = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 = crv.get_derivative_spline(0)
        self.assertEqual(crv2.order(direction=0), 6)

        u = np.linspace(crv.start(0), crv.end(0), 11)
        du = crv.derivative(u)
        du2 = crv2(u)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)

    def test_surface_2D_p56_C2_periodic(self) -> None:
        controlpoints = np.array(
            [
                [63.0, -5.0],
                [53.0, 26.0],
                [38.0, 42.0],
                [9.0, 58.0],
                [-13.0, 61.0],
                [-36.0, 47.0],
                [-53.0, 25.0],
                [-62.0, 1.0],
                [-53.0, -29.0],
                [-38.0, -51.0],
                [-11.0, -62.0],
                [16.0, -57.0],
                [36.0, -43.0],
                [56.0, -25.0],
                [62.0, 0.0],
                [57.0, 26.0],
                [39.0, 53.0],
                [14.0, 62.0],
                [-13.0, 65.0],
                [-36.0, 54.0],
                [-57.0, 26.0],
                [-65.0, 3.0],
                [-62.0, -26.0],
                [-43.0, -53.0],
                [-15.0, -63.0],
                [15.0, -66.0],
                [38.0, -56.0],
                [56.0, -30.0],
                [70.0, 3.0],
                [66.0, 30.0],
                [47.0, 50.0],
                [11.0, 64.0],
                [-19.0, 65.0],
                [-49.0, 52.0],
                [-60.0, 31.0],
                [-68.0, -3.0],
                [-66.0, -36.0],
                [-49.0, -53.0],
                [-14.0, -74.0],
                [15.0, -73.0],
                [41.0, -52.0],
                [63.0, -26.0],
                [71.0, 4.0],
                [70.0, 28.0],
                [43.0, 62.0],
                [15.0, 71.0],
                [-22.0, 73.0],
                [-47.0, 57.0],
                [-65.0, 28.0],
                [-74.0, -4.0],
                [-69.0, -31.0],
                [-47.0, -63.0],
                [-19.0, -73.0],
                [13.0, -69.0],
                [49.0, -56.0],
                [62.0, -31.0],
                [83.0, 2.0],
                [67.0, 35.0],
                [50.0, 64.0],
                [18.0, 76.0],
                [-15.0, 81.0],
                [-48.0, 62.0],
                [-77.0, 35.0],
                [-85.0, -5.0],
                [-75.0, -36.0],
                [-49.0, -68.0],
                [-21.0, -77.0],
                [20.0, -78.0],
                [48.0, -67.0],
                [71.0, -39.0],
                [86.0, 2.0],
                [80.0, 37.0],
                [53.0, 63.0],
                [15.0, 80.0],
                [-18.0, 85.0],
                [-50.0, 62.0],
                [-72.0, 35.0],
                [-89.0, 1.0],
                [-73.0, -36.0],
                [-57.0, -62.0],
                [-22.0, -78.0],
                [20.0, -78.0],
                [49.0, -67.0],
                [80.0, -40.0],
                [85.0, -4.0],
                [77.0, 43.0],
                [55.0, 65.0],
                [17.0, 85.0],
                [-20.0, 86.0],
                [-54.0, 69.0],
                [-79.0, 42.0],
                [-89.0, -2.0],
                [-77.0, -44.0],
                [-57.0, -76.0],
                [-17.0, -83.0],
                [15.0, -87.0],
                [60.0, -67.0],
                [82.0, -41.0],
                [90.0, 3.0],
                [87.0, 39.0],
                [56.0, 74.0],
                [18.0, 89.0],
                [-25.0, 91.0],
                [-57.0, 76.0],
                [-84.0, 44.0],
                [-91.0, 2.0],
                [-86.0, -39.0],
                [-55.0, -72.0],
                [-26.0, -95.0],
                [19.0, -88.0],
                [61.0, -77.0],
                [83.0, -45.0],
                [96.0, -5.0],
                [90.0, 44.0],
                [65.0, 75.0],
                [17.0, 93.0],
                [-20.0, 99.0],
                [-60.0, 79.0],
                [-89.0, 48.0],
                [-98.0, -1.0],
                [-95.0, -43.0],
                [-63.0, -81.0],
                [-21.0, -99.0],
                [18.0, -100.0],
                [63.0, -76.0],
                [87.0, -44.0],
            ]
        )
        basis0 = BSplineBasis(
            5,
            np.array(
                [
                    -2.9,
                    -2.0,
                    -1.3,
                    0.0,
                    0.0,
                    1.1,
                    1.8,
                    3.0,
                    4.3,
                    4.7,
                    5.7,
                    6.6,
                    8.4,
                    8.8,
                    10.1,
                    11.0,
                    11.7,
                    13.0,
                    13.0,
                    14.1,
                    14.8,
                    16.0,
                ]
            ),
            2,
        )
        basis1 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 3.1, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        surf: SplineObject = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 = surf.get_derivative_spline(0)
        self.assertEqual(surf2.order(direction=0), 4)
        self.assertEqual(surf2.order(direction=1), 6)
        surf3 = surf.get_derivative_spline(1)
        self.assertEqual(surf3.order(direction=0), 5)
        self.assertEqual(surf3.order(direction=1), 5)

        u = np.linspace(surf.start(0), surf.end(0), 7)
        v = np.linspace(surf.start(1), surf.end(1), 7)
        du = surf.derivative(u, v, d=(1, 0))
        du2 = surf2(u, v)
        dv = surf.derivative(u, v, d=(0, 1))
        dv2 = surf3(u, v)

        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)

    def test_curve_3D_p5(self) -> None:
        controlpoints = np.array(
            [
                [-4.0, -4.0, 4.0],
                [19.0, -5.0, -5.0],
                [26.0, 1.0, -2.0],
                [45.0, -1.0, -4.0],
                [60.0, -3.0, -1.0],
                [75.0, 4.0, -5.0],
                [89.0, -1.0, 1.0],
                [97.0, 0.0, 1.0],
            ]
        )
        basis0 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 1.9, 2.9, 4.0, 4.0, 4.0, 4.0, 4.0]))
        crv: SplineObject = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 = crv.get_derivative_spline(0)
        self.assertEqual(crv2.order(direction=0), 4)

        u = np.linspace(crv.start(0), crv.end(0), 11)
        du = crv.derivative(u)
        du2 = crv2(u)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)

    def test_surface_3D_p77(self) -> None:
        controlpoints = np.array(
            [
                [2.0, 0.0, 4.0],
                [10.0, 4.0, -1.0],
                [23.0, -3.0, 0.0],
                [30.0, 3.0, -5.0],
                [40.0, -2.0, -4.0],
                [44.0, 0.0, 1.0],
                [57.0, -3.0, -3.0],
                [61.0, 1.0, -1.0],
                [71.0, 3.0, 2.0],
                [80.0, -5.0, -2.0],
                [86.0, -4.0, -5.0],
                [101.0, 3.0, -2.0],
                [4.0, 15.0, -3.0],
                [8.0, 9.0, -5.0],
                [17.0, 18.0, 2.0],
                [25.0, 13.0, 0.0],
                [32.0, 12.0, -4.0],
                [48.0, 14.0, 0.0],
                [53.0, 17.0, -5.0],
                [67.0, 13.0, 0.0],
                [68.0, 14.0, 1.0],
                [82.0, 15.0, -5.0],
                [95.0, 16.0, -3.0],
                [98.0, 13.0, 1.0],
                [-1.0, 30.0, -4.0],
                [10.0, 27.0, 2.0],
                [16.0, 27.0, 0.0],
                [27.0, 25.0, 4.0],
                [34.0, 25.0, 2.0],
                [41.0, 30.0, -4.0],
                [56.0, 32.0, 1.0],
                [63.0, 32.0, 1.0],
                [68.0, 23.0, -4.0],
                [83.0, 27.0, -4.0],
                [89.0, 26.0, -1.0],
                [99.0, 30.0, 2.0],
                [4.0, 41.0, 3.0],
                [12.0, 43.0, -2.0],
                [18.0, 42.0, -3.0],
                [24.0, 45.0, 3.0],
                [41.0, 46.0, -4.0],
                [49.0, 41.0, -5.0],
                [50.0, 44.0, 1.0],
                [63.0, 44.0, 4.0],
                [67.0, 40.0, -1.0],
                [77.0, 43.0, -3.0],
                [91.0, 38.0, 3.0],
                [104.0, 41.0, 2.0],
                [0.0, 57.0, 0.0],
                [8.0, 60.0, -5.0],
                [16.0, 54.0, 4.0],
                [23.0, 53.0, 4.0],
                [39.0, 61.0, 0.0],
                [49.0, 55.0, -5.0],
                [54.0, 61.0, 0.0],
                [60.0, 60.0, -5.0],
                [75.0, 52.0, -1.0],
                [78.0, 58.0, -1.0],
                [93.0, 58.0, 3.0],
                [99.0, 57.0, -2.0],
                [4.0, 75.0, -3.0],
                [8.0, 74.0, 2.0],
                [20.0, 71.0, 0.0],
                [30.0, 73.0, -4.0],
                [40.0, 73.0, 0.0],
                [47.0, 72.0, 3.0],
                [58.0, 70.0, -1.0],
                [68.0, 74.0, -5.0],
                [71.0, 67.0, 1.0],
                [86.0, 75.0, -4.0],
                [87.0, 72.0, -3.0],
                [102.0, 72.0, 2.0],
                [2.0, 82.0, 3.0],
                [10.0, 83.0, 1.0],
                [14.0, 82.0, 2.0],
                [29.0, 86.0, 3.0],
                [36.0, 85.0, -4.0],
                [48.0, 81.0, 0.0],
                [59.0, 88.0, 0.0],
                [68.0, 82.0, 2.0],
                [68.0, 80.0, 2.0],
                [82.0, 81.0, -5.0],
                [94.0, 83.0, 2.0],
                [101.0, 83.0, 3.0],
                [1.0, 104.0, -2.0],
                [8.0, 104.0, -4.0],
                [17.0, 101.0, -4.0],
                [22.0, 100.0, 2.0],
                [37.0, 103.0, -2.0],
                [47.0, 104.0, 1.0],
                [55.0, 99.0, 1.0],
                [63.0, 98.0, 3.0],
                [69.0, 99.0, 3.0],
                [85.0, 95.0, -5.0],
                [87.0, 98.0, 1.0],
                [101.0, 102.0, -3.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.9,
                    2.2,
                    3.2,
                    3.7,
                    4.8,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                ]
            ),
        )
        basis1 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.3, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0])
        )
        surf: SplineObject = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 = surf.get_derivative_spline(0)
        self.assertEqual(surf2.order(direction=0), 6)
        self.assertEqual(surf2.order(direction=1), 7)
        surf3 = surf.get_derivative_spline(1)
        self.assertEqual(surf3.order(direction=0), 7)
        self.assertEqual(surf3.order(direction=1), 6)

        u = np.linspace(surf.start(0), surf.end(0), 7)
        v = np.linspace(surf.start(1), surf.end(1), 7)
        du = surf.derivative(u, v, d=(1, 0))
        du2 = surf2(u, v)
        dv = surf.derivative(u, v, d=(0, 1))
        dv2 = surf3(u, v)

        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)

    def test_volume_3D_p565(self) -> None:
        controlpoints = np.array(
            [
                [3.0, -1.0, -4.0],
                [18.0, 1.0, -5.0],
                [28.0, -2.0, 1.0],
                [41.0, 0.0, -5.0],
                [54.0, -1.0, 0.0],
                [70.0, 1.0, -5.0],
                [82.0, -1.0, 1.0],
                [96.0, 0.0, -2.0],
                [-3.0, 20.0, -4.0],
                [13.0, 17.0, 1.0],
                [25.0, 20.0, 3.0],
                [46.0, 15.0, 0.0],
                [59.0, 17.0, 0.0],
                [74.0, 13.0, 4.0],
                [84.0, 20.0, -1.0],
                [101.0, 17.0, 1.0],
                [-1.0, 28.0, -2.0],
                [12.0, 30.0, -4.0],
                [24.0, 33.0, 0.0],
                [46.0, 33.0, 3.0],
                [60.0, 30.0, 1.0],
                [75.0, 34.0, 4.0],
                [87.0, 30.0, -3.0],
                [96.0, 37.0, 1.0],
                [-3.0, 50.0, -3.0],
                [16.0, 51.0, -5.0],
                [28.0, 46.0, 0.0],
                [40.0, 45.0, 2.0],
                [61.0, 51.0, 2.0],
                [73.0, 45.0, -5.0],
                [86.0, 45.0, 2.0],
                [96.0, 53.0, -5.0],
                [0.0, 70.0, 4.0],
                [11.0, 70.0, 0.0],
                [23.0, 62.0, -2.0],
                [41.0, 63.0, -5.0],
                [53.0, 63.0, 2.0],
                [70.0, 65.0, 1.0],
                [89.0, 64.0, 3.0],
                [103.0, 70.0, -4.0],
                [-5.0, 85.0, 0.0],
                [11.0, 87.0, 2.0],
                [29.0, 81.0, 1.0],
                [40.0, 82.0, 2.0],
                [60.0, 81.0, 4.0],
                [68.0, 81.0, 2.0],
                [88.0, 86.0, 3.0],
                [97.0, 79.0, -4.0],
                [-3.0, 98.0, -2.0],
                [9.0, 98.0, -5.0],
                [25.0, 104.0, 2.0],
                [38.0, 97.0, 2.0],
                [60.0, 97.0, 1.0],
                [68.0, 101.0, 3.0],
                [81.0, 99.0, 4.0],
                [101.0, 100.0, 4.0],
                [2.0, -5.0, 17.0],
                [12.0, -1.0, 21.0],
                [24.0, -2.0, 24.0],
                [47.0, 0.0, 22.0],
                [56.0, -1.0, 23.0],
                [70.0, 4.0, 15.0],
                [87.0, -2.0, 18.0],
                [100.0, -1.0, 23.0],
                [-5.0, 12.0, 17.0],
                [17.0, 13.0, 21.0],
                [31.0, 16.0, 17.0],
                [47.0, 20.0, 17.0],
                [58.0, 21.0, 21.0],
                [74.0, 19.0, 24.0],
                [86.0, 15.0, 22.0],
                [104.0, 15.0, 19.0],
                [-2.0, 37.0, 18.0],
                [17.0, 34.0, 15.0],
                [24.0, 32.0, 24.0],
                [42.0, 37.0, 16.0],
                [53.0, 28.0, 23.0],
                [72.0, 33.0, 20.0],
                [89.0, 37.0, 19.0],
                [100.0, 31.0, 17.0],
                [3.0, 47.0, 20.0],
                [18.0, 46.0, 24.0],
                [26.0, 50.0, 22.0],
                [43.0, 51.0, 21.0],
                [58.0, 47.0, 21.0],
                [66.0, 47.0, 23.0],
                [87.0, 53.0, 16.0],
                [98.0, 50.0, 24.0],
                [-4.0, 71.0, 17.0],
                [13.0, 63.0, 21.0],
                [26.0, 68.0, 21.0],
                [39.0, 71.0, 22.0],
                [53.0, 63.0, 21.0],
                [69.0, 67.0, 22.0],
                [88.0, 61.0, 16.0],
                [95.0, 64.0, 20.0],
                [-3.0, 83.0, 15.0],
                [10.0, 79.0, 23.0],
                [26.0, 85.0, 19.0],
                [44.0, 83.0, 17.0],
                [55.0, 85.0, 17.0],
                [70.0, 85.0, 21.0],
                [90.0, 87.0, 20.0],
                [97.0, 84.0, 15.0],
                [-1.0, 96.0, 16.0],
                [11.0, 97.0, 21.0],
                [25.0, 98.0, 22.0],
                [41.0, 95.0, 21.0],
                [58.0, 104.0, 22.0],
                [74.0, 96.0, 15.0],
                [86.0, 101.0, 18.0],
                [95.0, 102.0, 20.0],
                [4.0, 4.0, 42.0],
                [11.0, -4.0, 44.0],
                [31.0, 0.0, 42.0],
                [45.0, -4.0, 36.0],
                [58.0, -2.0, 44.0],
                [69.0, -4.0, 35.0],
                [83.0, -2.0, 39.0],
                [96.0, 1.0, 42.0],
                [4.0, 13.0, 37.0],
                [16.0, 16.0, 42.0],
                [28.0, 20.0, 38.0],
                [37.0, 18.0, 40.0],
                [57.0, 18.0, 41.0],
                [71.0, 20.0, 43.0],
                [87.0, 20.0, 40.0],
                [97.0, 20.0, 40.0],
                [4.0, 30.0, 41.0],
                [14.0, 35.0, 44.0],
                [28.0, 38.0, 39.0],
                [42.0, 37.0, 43.0],
                [57.0, 29.0, 39.0],
                [71.0, 38.0, 41.0],
                [86.0, 38.0, 36.0],
                [99.0, 32.0, 41.0],
                [0.0, 53.0, 39.0],
                [13.0, 53.0, 44.0],
                [29.0, 49.0, 42.0],
                [46.0, 46.0, 40.0],
                [58.0, 50.0, 43.0],
                [69.0, 47.0, 43.0],
                [81.0, 54.0, 41.0],
                [101.0, 45.0, 38.0],
                [0.0, 66.0, 36.0],
                [14.0, 70.0, 44.0],
                [32.0, 69.0, 38.0],
                [39.0, 67.0, 44.0],
                [53.0, 63.0, 35.0],
                [74.0, 65.0, 37.0],
                [89.0, 62.0, 44.0],
                [103.0, 62.0, 35.0],
                [3.0, 86.0, 44.0],
                [10.0, 81.0, 36.0],
                [32.0, 79.0, 44.0],
                [43.0, 84.0, 36.0],
                [56.0, 80.0, 44.0],
                [74.0, 85.0, 41.0],
                [83.0, 85.0, 40.0],
                [97.0, 87.0, 41.0],
                [1.0, 100.0, 43.0],
                [17.0, 99.0, 39.0],
                [26.0, 100.0, 41.0],
                [41.0, 97.0, 41.0],
                [55.0, 96.0, 44.0],
                [70.0, 103.0, 35.0],
                [89.0, 102.0, 42.0],
                [98.0, 104.0, 44.0],
                [-4.0, 2.0, 61.0],
                [13.0, -3.0, 60.0],
                [27.0, 0.0, 57.0],
                [40.0, -4.0, 61.0],
                [54.0, -5.0, 57.0],
                [72.0, 4.0, 58.0],
                [83.0, -1.0, 61.0],
                [96.0, 1.0, 59.0],
                [-4.0, 17.0, 57.0],
                [18.0, 20.0, 63.0],
                [24.0, 17.0, 58.0],
                [45.0, 12.0, 60.0],
                [60.0, 14.0, 57.0],
                [70.0, 21.0, 60.0],
                [83.0, 19.0, 63.0],
                [100.0, 13.0, 60.0],
                [-4.0, 34.0, 64.0],
                [10.0, 30.0, 62.0],
                [26.0, 29.0, 60.0],
                [40.0, 33.0, 61.0],
                [60.0, 32.0, 62.0],
                [69.0, 28.0, 55.0],
                [83.0, 29.0, 55.0],
                [96.0, 32.0, 63.0],
                [0.0, 46.0, 59.0],
                [15.0, 51.0, 58.0],
                [30.0, 53.0, 58.0],
                [41.0, 46.0, 64.0],
                [58.0, 46.0, 55.0],
                [74.0, 48.0, 64.0],
                [88.0, 47.0, 64.0],
                [101.0, 48.0, 55.0],
                [1.0, 71.0, 61.0],
                [12.0, 70.0, 58.0],
                [27.0, 69.0, 57.0],
                [47.0, 65.0, 60.0],
                [53.0, 69.0, 64.0],
                [67.0, 64.0, 59.0],
                [85.0, 64.0, 62.0],
                [99.0, 62.0, 57.0],
                [-4.0, 82.0, 59.0],
                [17.0, 86.0, 64.0],
                [29.0, 85.0, 64.0],
                [38.0, 80.0, 63.0],
                [60.0, 82.0, 56.0],
                [74.0, 87.0, 60.0],
                [84.0, 82.0, 56.0],
                [102.0, 82.0, 64.0],
                [4.0, 103.0, 64.0],
                [14.0, 101.0, 59.0],
                [29.0, 98.0, 62.0],
                [46.0, 96.0, 63.0],
                [52.0, 95.0, 55.0],
                [74.0, 97.0, 64.0],
                [89.0, 102.0, 61.0],
                [97.0, 96.0, 59.0],
                [2.0, -3.0, 84.0],
                [14.0, 3.0, 80.0],
                [30.0, 3.0, 75.0],
                [46.0, -1.0, 82.0],
                [61.0, -4.0, 81.0],
                [69.0, 3.0, 82.0],
                [82.0, -1.0, 83.0],
                [95.0, 4.0, 77.0],
                [2.0, 19.0, 75.0],
                [14.0, 16.0, 82.0],
                [31.0, 15.0, 82.0],
                [46.0, 18.0, 82.0],
                [61.0, 21.0, 84.0],
                [67.0, 14.0, 84.0],
                [81.0, 17.0, 79.0],
                [97.0, 16.0, 78.0],
                [-3.0, 34.0, 83.0],
                [11.0, 35.0, 84.0],
                [29.0, 35.0, 77.0],
                [46.0, 38.0, 76.0],
                [61.0, 34.0, 75.0],
                [70.0, 32.0, 80.0],
                [90.0, 28.0, 75.0],
                [101.0, 37.0, 79.0],
                [-5.0, 52.0, 82.0],
                [19.0, 50.0, 79.0],
                [32.0, 49.0, 77.0],
                [43.0, 45.0, 80.0],
                [58.0, 50.0, 82.0],
                [74.0, 46.0, 77.0],
                [87.0, 48.0, 84.0],
                [96.0, 46.0, 79.0],
                [2.0, 63.0, 76.0],
                [14.0, 64.0, 84.0],
                [33.0, 67.0, 77.0],
                [38.0, 65.0, 84.0],
                [60.0, 70.0, 80.0],
                [74.0, 63.0, 75.0],
                [86.0, 66.0, 76.0],
                [95.0, 67.0, 79.0],
                [4.0, 80.0, 79.0],
                [18.0, 87.0, 75.0],
                [29.0, 79.0, 82.0],
                [45.0, 86.0, 75.0],
                [58.0, 88.0, 83.0],
                [69.0, 82.0, 83.0],
                [86.0, 78.0, 76.0],
                [99.0, 83.0, 78.0],
                [-5.0, 103.0, 80.0],
                [12.0, 98.0, 75.0],
                [26.0, 99.0, 79.0],
                [39.0, 96.0, 75.0],
                [55.0, 103.0, 81.0],
                [67.0, 98.0, 77.0],
                [88.0, 99.0, 81.0],
                [103.0, 101.0, 79.0],
                [-2.0, -5.0, 103.0],
                [18.0, -4.0, 100.0],
                [31.0, 1.0, 95.0],
                [45.0, 3.0, 99.0],
                [61.0, -5.0, 104.0],
                [67.0, -2.0, 104.0],
                [90.0, -1.0, 98.0],
                [104.0, 1.0, 97.0],
                [0.0, 13.0, 101.0],
                [18.0, 16.0, 98.0],
                [30.0, 14.0, 95.0],
                [38.0, 19.0, 95.0],
                [60.0, 18.0, 104.0],
                [67.0, 14.0, 103.0],
                [87.0, 19.0, 100.0],
                [99.0, 13.0, 102.0],
                [-5.0, 37.0, 98.0],
                [15.0, 30.0, 97.0],
                [33.0, 36.0, 101.0],
                [40.0, 29.0, 104.0],
                [61.0, 37.0, 104.0],
                [69.0, 28.0, 96.0],
                [87.0, 34.0, 99.0],
                [100.0, 31.0, 100.0],
                [-5.0, 52.0, 102.0],
                [15.0, 46.0, 100.0],
                [24.0, 45.0, 98.0],
                [47.0, 50.0, 98.0],
                [58.0, 48.0, 99.0],
                [68.0, 47.0, 97.0],
                [87.0, 51.0, 95.0],
                [104.0, 47.0, 100.0],
                [1.0, 68.0, 95.0],
                [10.0, 67.0, 99.0],
                [24.0, 66.0, 97.0],
                [40.0, 61.0, 99.0],
                [60.0, 66.0, 95.0],
                [70.0, 67.0, 102.0],
                [84.0, 62.0, 101.0],
                [98.0, 71.0, 103.0],
                [-1.0, 80.0, 100.0],
                [11.0, 80.0, 96.0],
                [33.0, 78.0, 100.0],
                [38.0, 88.0, 95.0],
                [54.0, 82.0, 100.0],
                [67.0, 82.0, 98.0],
                [84.0, 80.0, 101.0],
                [97.0, 79.0, 100.0],
                [-1.0, 101.0, 102.0],
                [17.0, 101.0, 101.0],
                [29.0, 104.0, 101.0],
                [39.0, 102.0, 97.0],
                [61.0, 97.0, 101.0],
                [70.0, 96.0, 96.0],
                [82.0, 100.0, 98.0],
                [103.0, 102.0, 95.0],
            ]
        )
        basis0 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 1.6, 2.9, 4.0, 4.0, 4.0, 4.0, 4.0]))
        basis1 = BSplineBasis(6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0]))
        basis2 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 2.0, 2.0, 2.0, 2.0, 2.0]))
        vol: SplineObject = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2 = vol.get_derivative_spline(0)
        self.assertEqual(vol2.order(direction=0), 4)
        self.assertEqual(vol2.order(direction=1), 6)
        self.assertEqual(vol2.order(direction=2), 5)
        vol3 = vol.get_derivative_spline(1)
        self.assertEqual(vol3.order(direction=0), 5)
        self.assertEqual(vol3.order(direction=1), 5)
        self.assertEqual(vol3.order(direction=2), 5)
        vol4 = vol.get_derivative_spline(2)
        self.assertEqual(vol4.order(direction=0), 5)
        self.assertEqual(vol4.order(direction=1), 6)
        self.assertEqual(vol4.order(direction=2), 4)

        u = np.linspace(vol.start(0), vol.end(0), 5)
        v = np.linspace(vol.start(1), vol.end(1), 5)
        w = np.linspace(vol.start(2), vol.end(2), 5)
        du = vol.derivative(u, v, w, d=(1, 0, 0))
        du2 = vol2(u, v, w)
        dv = vol.derivative(u, v, w, d=(0, 1, 0))
        dv2 = vol3(u, v, w)
        dw = vol.derivative(u, v, w, d=(0, 0, 1))
        dw2 = vol4(u, v, w)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dw - dw2)), 0.0)

    def test_curve_3D_p6_C0_periodic(self) -> None:
        controlpoints = np.array(
            [
                [103.0, 1.0, -1.0],
                [90.0, 46.0, -1.0],
                [52.0, 85.0, 3.0],
                [1.0, 98.0, -5.0],
                [-51.0, 84.0, 4.0],
                [-90.0, 51.0, 2.0],
                [-104.0, -5.0, -3.0],
                [-87.0, -54.0, 0.0],
                [-46.0, -88.0, 1.0],
                [-5.0, -99.0, 4.0],
                [45.0, -86.0, 0.0],
                [90.0, -52.0, 0.0],
            ]
        )
        basis0 = BSplineBasis(
            6,
            np.array(
                [
                    -1.2,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.1,
                    2.2,
                    3.3,
                    4.3,
                    4.8,
                    6.1,
                    6.8,
                    8.0,
                    8.0,
                    8.0,
                    8.0,
                    8.0,
                    9.1,
                ]
            ),
            0,
        )
        crv: SplineObject = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 = crv.get_derivative_spline(0)
        self.assertEqual(crv2.order(direction=0), 5)

        u = np.linspace(crv.start(0), crv.end(0), 11)
        du = crv.derivative(u)
        du2 = crv2(u)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)

    def test_surface_3D_p77_C0_periodic(self) -> None:
        controlpoints = np.array(
            [
                [55.0, -2.0, 0.0],
                [57.0, 27.0, -1.0],
                [36.0, 47.0, 3.0],
                [16.0, 55.0, -1.0],
                [-10.0, 53.0, -5.0],
                [-39.0, 46.0, 0.0],
                [-59.0, 24.0, 2.0],
                [-61.0, 0.0, 3.0],
                [-55.0, -22.0, 4.0],
                [-38.0, -44.0, -4.0],
                [-18.0, -57.0, -4.0],
                [8.0, -57.0, -3.0],
                [33.0, -44.0, 1.0],
                [56.0, -22.0, -4.0],
                [63.0, -4.0, -1.0],
                [58.0, 29.0, -3.0],
                [38.0, 51.0, 0.0],
                [12.0, 58.0, 0.0],
                [-19.0, 66.0, 1.0],
                [-38.0, 50.0, 1.0],
                [-62.0, 24.0, -5.0],
                [-61.0, -5.0, 0.0],
                [-60.0, -32.0, -2.0],
                [-45.0, -49.0, 2.0],
                [-12.0, -68.0, -3.0],
                [17.0, -68.0, 1.0],
                [43.0, -49.0, -1.0],
                [56.0, -31.0, 3.0],
                [70.0, 4.0, -5.0],
                [63.0, 31.0, 4.0],
                [45.0, 58.0, 0.0],
                [11.0, 72.0, -5.0],
                [-16.0, 66.0, 0.0],
                [-44.0, 54.0, 1.0],
                [-64.0, 28.0, 0.0],
                [-66.0, 2.0, 1.0],
                [-63.0, -32.0, -1.0],
                [-43.0, -50.0, -4.0],
                [-21.0, -66.0, -3.0],
                [10.0, -67.0, 1.0],
                [41.0, -52.0, 0.0],
                [57.0, -33.0, -2.0],
                [72.0, -3.0, -3.0],
                [65.0, 31.0, -3.0],
                [48.0, 54.0, 0.0],
                [13.0, 68.0, 0.0],
                [-19.0, 67.0, 3.0],
                [-45.0, 54.0, -3.0],
                [-63.0, 28.0, -1.0],
                [-72.0, -4.0, -3.0],
                [-66.0, -37.0, 4.0],
                [-49.0, -59.0, -4.0],
                [-16.0, -70.0, 0.0],
                [15.0, -72.0, -3.0],
                [46.0, -54.0, -2.0],
                [65.0, -37.0, 1.0],
                [73.0, 3.0, -4.0],
                [65.0, 36.0, -2.0],
                [44.0, 63.0, 4.0],
                [21.0, 73.0, 0.0],
                [-19.0, 74.0, -2.0],
                [-44.0, 56.0, -3.0],
                [-68.0, 35.0, -2.0],
                [-82.0, 1.0, -2.0],
                [-73.0, -35.0, 2.0],
                [-47.0, -58.0, -3.0],
                [-17.0, -77.0, -4.0],
                [15.0, -76.0, -5.0],
                [45.0, -57.0, 1.0],
                [74.0, -38.0, 1.0],
                [86.0, 4.0, -5.0],
                [70.0, 34.0, 1.0],
                [56.0, 68.0, -2.0],
                [16.0, 83.0, -2.0],
                [-19.0, 75.0, -1.0],
                [-53.0, 61.0, 0.0],
                [-77.0, 34.0, 3.0],
                [-81.0, 3.0, -5.0],
                [-73.0, -36.0, 0.0],
                [-55.0, -67.0, 3.0],
                [-21.0, -85.0, -2.0],
                [16.0, -77.0, -2.0],
                [52.0, -66.0, -4.0],
                [70.0, -35.0, 4.0],
                [91.0, 2.0, -4.0],
                [73.0, 38.0, 0.0],
                [54.0, 66.0, -1.0],
                [19.0, 79.0, -4.0],
                [-15.0, 81.0, 2.0],
                [-53.0, 63.0, 0.0],
                [-83.0, 36.0, -1.0],
                [-83.0, -5.0, 0.0],
                [-80.0, -41.0, -5.0],
                [-54.0, -72.0, 2.0],
                [-18.0, -85.0, 2.0],
                [23.0, -87.0, -2.0],
                [55.0, -73.0, -5.0],
                [75.0, -38.0, 4.0],
                [89.0, -3.0, -1.0],
                [79.0, 35.0, 3.0],
                [60.0, 68.0, -4.0],
                [18.0, 85.0, -2.0],
                [-24.0, 89.0, -2.0],
                [-61.0, 73.0, -3.0],
                [-81.0, 41.0, -3.0],
                [-92.0, 1.0, -4.0],
                [-82.0, -36.0, 3.0],
                [-61.0, -67.0, -5.0],
                [-20.0, -94.0, 3.0],
                [22.0, -89.0, 1.0],
                [61.0, -72.0, -1.0],
                [81.0, -37.0, 1.0],
                [91.0, -5.0, 1.0],
                [83.0, 46.0, 3.0],
                [56.0, 76.0, -2.0],
                [23.0, 97.0, -2.0],
                [-20.0, 94.0, -4.0],
                [-60.0, 72.0, -2.0],
                [-86.0, 38.0, 3.0],
                [-99.0, -5.0, -1.0],
                [-84.0, -43.0, -4.0],
                [-59.0, -74.0, -1.0],
                [-24.0, -90.0, 3.0],
                [20.0, -90.0, 3.0],
                [59.0, -78.0, 1.0],
                [90.0, -39.0, -3.0],
                [97.0, -2.0, 4.0],
                [89.0, 48.0, 4.0],
                [66.0, 77.0, -3.0],
                [20.0, 95.0, -2.0],
                [-25.0, 102.0, 0.0],
                [-67.0, 73.0, 3.0],
                [-90.0, 41.0, -2.0],
                [-103.0, 0.0, -1.0],
                [-88.0, -43.0, -1.0],
                [-67.0, -83.0, 4.0],
                [-23.0, -102.0, -5.0],
                [25.0, -95.0, -5.0],
                [59.0, -83.0, -3.0],
                [95.0, -40.0, 3.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    -0.7,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.2,
                    1.6,
                    3.1,
                    3.8,
                    5.2,
                    6.3,
                    6.7,
                    8.3,
                    9.0,
                    9.0,
                    9.0,
                    9.0,
                    9.0,
                    9.0,
                    10.2,
                ]
            ),
            0,
        )
        basis1 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 3.3, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        surf: SplineObject = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 = surf.get_derivative_spline(0)
        self.assertEqual(surf2.order(direction=0), 6)
        self.assertEqual(surf2.order(direction=1), 7)
        surf3 = surf.get_derivative_spline(1)
        self.assertEqual(surf3.order(direction=0), 7)
        self.assertEqual(surf3.order(direction=1), 6)

        u = np.linspace(surf.start(0), surf.end(0), 7)
        v = np.linspace(surf.start(1), surf.end(1), 7)
        du = surf.derivative(u, v, d=(1, 0))
        du2 = surf2(u, v)
        dv = surf.derivative(u, v, d=(0, 1))
        dv2 = surf3(u, v)

        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)

    def test_volume_3D_p766_C0_periodic(self) -> None:
        controlpoints = np.array(
            [
                [53.0, -5.0, -2.0],
                [45.0, 24.0, 1.0],
                [30.0, 38.0, -4.0],
                [6.0, 50.0, -2.0],
                [-9.0, 46.0, -3.0],
                [-36.0, 41.0, 2.0],
                [-45.0, 22.0, 1.0],
                [-51.0, -2.0, 1.0],
                [-48.0, -20.0, -4.0],
                [-32.0, -36.0, 4.0],
                [-7.0, -47.0, -5.0],
                [11.0, -45.0, -2.0],
                [33.0, -40.0, -1.0],
                [47.0, -20.0, -1.0],
                [58.0, -1.0, -4.0],
                [51.0, 29.0, 4.0],
                [34.0, 40.0, -3.0],
                [10.0, 58.0, 1.0],
                [-14.0, 52.0, 2.0],
                [-36.0, 41.0, 4.0],
                [-55.0, 25.0, 1.0],
                [-58.0, 3.0, -3.0],
                [-47.0, -23.0, -1.0],
                [-39.0, -49.0, 0.0],
                [-10.0, -58.0, 0.0],
                [10.0, -60.0, 0.0],
                [31.0, -42.0, 3.0],
                [54.0, -24.0, -4.0],
                [64.0, -4.0, 4.0],
                [56.0, 23.0, -2.0],
                [36.0, 47.0, 3.0],
                [9.0, 62.0, -2.0],
                [-18.0, 62.0, 4.0],
                [-42.0, 53.0, 4.0],
                [-56.0, 28.0, 1.0],
                [-65.0, -5.0, -5.0],
                [-53.0, -33.0, -4.0],
                [-36.0, -51.0, 0.0],
                [-15.0, -62.0, 2.0],
                [9.0, -61.0, 1.0],
                [43.0, -47.0, -5.0],
                [59.0, -31.0, 1.0],
                [66.0, -4.0, -4.0],
                [62.0, 33.0, -4.0],
                [43.0, 53.0, -5.0],
                [17.0, 64.0, -5.0],
                [-15.0, 65.0, -1.0],
                [-46.0, 49.0, -3.0],
                [-67.0, 31.0, 3.0],
                [-66.0, 0.0, 3.0],
                [-67.0, -33.0, 1.0],
                [-40.0, -58.0, 4.0],
                [-12.0, -72.0, 2.0],
                [11.0, -71.0, -2.0],
                [46.0, -58.0, 1.0],
                [57.0, -26.0, -4.0],
                [71.0, 4.0, -4.0],
                [64.0, 37.0, -4.0],
                [50.0, 62.0, 4.0],
                [14.0, 69.0, -3.0],
                [-22.0, 70.0, -3.0],
                [-48.0, 63.0, 2.0],
                [-69.0, 32.0, -4.0],
                [-73.0, -3.0, -5.0],
                [-68.0, -34.0, 0.0],
                [-50.0, -57.0, -2.0],
                [-14.0, -77.0, 1.0],
                [15.0, -70.0, 0.0],
                [48.0, -58.0, -1.0],
                [66.0, -28.0, 2.0],
                [82.0, 3.0, 4.0],
                [69.0, 32.0, -2.0],
                [54.0, 59.0, -1.0],
                [13.0, 83.0, -1.0],
                [-18.0, 84.0, 1.0],
                [-51.0, 66.0, 1.0],
                [-77.0, 37.0, 4.0],
                [-79.0, -4.0, -1.0],
                [-70.0, -33.0, -5.0],
                [-55.0, -59.0, -2.0],
                [-18.0, -79.0, -5.0],
                [15.0, -76.0, -4.0],
                [47.0, -60.0, 1.0],
                [74.0, -32.0, 2.0],
                [92.0, 1.0, 1.0],
                [77.0, 39.0, -4.0],
                [52.0, 72.0, 3.0],
                [21.0, 81.0, 3.0],
                [-17.0, 85.0, -4.0],
                [-60.0, 63.0, 1.0],
                [-80.0, 40.0, -5.0],
                [-88.0, 4.0, 3.0],
                [-82.0, -35.0, -3.0],
                [-57.0, -73.0, 4.0],
                [-24.0, -86.0, -1.0],
                [14.0, -86.0, 0.0],
                [50.0, -72.0, -1.0],
                [77.0, -37.0, -2.0],
                [96.0, -2.0, 0.0],
                [83.0, 42.0, -4.0],
                [57.0, 71.0, 1.0],
                [22.0, 93.0, -1.0],
                [-26.0, 94.0, 0.0],
                [-56.0, 71.0, 1.0],
                [-87.0, 41.0, -4.0],
                [-96.0, -2.0, 2.0],
                [-84.0, -42.0, -3.0],
                [-62.0, -78.0, -3.0],
                [-21.0, -92.0, -4.0],
                [24.0, -89.0, -2.0],
                [53.0, -77.0, -2.0],
                [85.0, -38.0, 1.0],
                [101.0, 2.0, 0.0],
                [92.0, 40.0, 3.0],
                [57.0, 80.0, 2.0],
                [24.0, 97.0, 0.0],
                [-27.0, 99.0, -4.0],
                [-62.0, 80.0, -3.0],
                [-94.0, 39.0, 3.0],
                [-101.0, 4.0, -1.0],
                [-93.0, -41.0, -2.0],
                [-62.0, -75.0, 1.0],
                [-25.0, -98.0, 4.0],
                [18.0, -102.0, -5.0],
                [65.0, -79.0, 2.0],
                [85.0, -46.0, -1.0],
                [51.0, -3.0, 7.0],
                [44.0, 23.0, 2.0],
                [30.0, 37.0, 11.0],
                [13.0, 50.0, 1.0],
                [-10.0, 48.0, 4.0],
                [-27.0, 43.0, 4.0],
                [-41.0, 21.0, 1.0],
                [-52.0, -5.0, 6.0],
                [-42.0, -23.0, 6.0],
                [-30.0, -40.0, 7.0],
                [-12.0, -49.0, 2.0],
                [13.0, -46.0, 10.0],
                [32.0, -40.0, 10.0],
                [48.0, -17.0, 4.0],
                [54.0, 2.0, 9.0],
                [54.0, 25.0, 1.0],
                [30.0, 42.0, 7.0],
                [12.0, 56.0, 11.0],
                [-16.0, 57.0, 11.0],
                [-39.0, 40.0, 5.0],
                [-55.0, 23.0, 8.0],
                [-53.0, 4.0, 8.0],
                [-52.0, -25.0, 8.0],
                [-32.0, -48.0, 6.0],
                [-14.0, -53.0, 7.0],
                [11.0, -57.0, 5.0],
                [32.0, -45.0, 9.0],
                [51.0, -23.0, 5.0],
                [63.0, -3.0, 6.0],
                [57.0, 24.0, 8.0],
                [38.0, 51.0, 7.0],
                [11.0, 59.0, 3.0],
                [-14.0, 62.0, 10.0],
                [-39.0, 43.0, 2.0],
                [-54.0, 23.0, 3.0],
                [-59.0, 0.0, 2.0],
                [-54.0, -25.0, 3.0],
                [-39.0, -52.0, 3.0],
                [-15.0, -57.0, 4.0],
                [15.0, -60.0, 11.0],
                [37.0, -53.0, 3.0],
                [57.0, -25.0, 5.0],
                [71.0, -3.0, 3.0],
                [57.0, 27.0, 5.0],
                [43.0, 54.0, 4.0],
                [13.0, 65.0, 6.0],
                [-18.0, 66.0, 3.0],
                [-45.0, 56.0, 9.0],
                [-58.0, 25.0, 4.0],
                [-74.0, 3.0, 2.0],
                [-66.0, -33.0, 6.0],
                [-46.0, -58.0, 2.0],
                [-14.0, -65.0, 7.0],
                [16.0, -65.0, 2.0],
                [39.0, -56.0, 10.0],
                [58.0, -28.0, 5.0],
                [78.0, -1.0, 3.0],
                [63.0, 33.0, 8.0],
                [51.0, 56.0, 4.0],
                [15.0, 74.0, 6.0],
                [-12.0, 68.0, 2.0],
                [-46.0, 56.0, 5.0],
                [-64.0, 37.0, 2.0],
                [-76.0, -3.0, 4.0],
                [-68.0, -36.0, 4.0],
                [-43.0, -57.0, 3.0],
                [-14.0, -72.0, 6.0],
                [17.0, -71.0, 1.0],
                [49.0, -57.0, 1.0],
                [66.0, -38.0, 6.0],
                [85.0, 0.0, 2.0],
                [69.0, 37.0, 10.0],
                [55.0, 66.0, 8.0],
                [21.0, 77.0, 7.0],
                [-22.0, 77.0, 10.0],
                [-55.0, 59.0, 3.0],
                [-77.0, 33.0, 9.0],
                [-86.0, -2.0, 9.0],
                [-73.0, -31.0, 6.0],
                [-53.0, -64.0, 5.0],
                [-17.0, -83.0, 3.0],
                [15.0, -84.0, 5.0],
                [52.0, -63.0, 7.0],
                [71.0, -35.0, 6.0],
                [89.0, 3.0, 9.0],
                [78.0, 36.0, 7.0],
                [53.0, 69.0, 2.0],
                [21.0, 80.0, 11.0],
                [-23.0, 83.0, 6.0],
                [-51.0, 73.0, 9.0],
                [-80.0, 34.0, 3.0],
                [-90.0, 0.0, 7.0],
                [-82.0, -35.0, 3.0],
                [-60.0, -73.0, 11.0],
                [-20.0, -84.0, 3.0],
                [19.0, -84.0, 7.0],
                [55.0, -67.0, 10.0],
                [74.0, -33.0, 4.0],
                [96.0, 1.0, 10.0],
                [84.0, 37.0, 4.0],
                [59.0, 76.0, 10.0],
                [24.0, 88.0, 8.0],
                [-21.0, 88.0, 4.0],
                [-57.0, 73.0, 3.0],
                [-90.0, 35.0, 10.0],
                [-91.0, 3.0, 2.0],
                [-83.0, -42.0, 3.0],
                [-56.0, -72.0, 4.0],
                [-21.0, -88.0, 6.0],
                [15.0, -95.0, 2.0],
                [53.0, -72.0, 6.0],
                [82.0, -36.0, 10.0],
                [103.0, -3.0, 11.0],
                [85.0, 40.0, 6.0],
                [67.0, 73.0, 3.0],
                [21.0, 100.0, 4.0],
                [-23.0, 95.0, 3.0],
                [-63.0, 76.0, 1.0],
                [-95.0, 44.0, 5.0],
                [-103.0, -5.0, 2.0],
                [-94.0, -41.0, 6.0],
                [-64.0, -74.0, 6.0],
                [-24.0, -98.0, 3.0],
                [24.0, -93.0, 8.0],
                [60.0, -77.0, 5.0],
                [86.0, -48.0, 5.0],
                [46.0, -1.0, 13.0],
                [45.0, 23.0, 14.0],
                [32.0, 34.0, 16.0],
                [12.0, 46.0, 10.0],
                [-9.0, 52.0, 14.0],
                [-36.0, 38.0, 9.0],
                [-47.0, 21.0, 13.0],
                [-55.0, -5.0, 12.0],
                [-46.0, -22.0, 17.0],
                [-29.0, -36.0, 15.0],
                [-12.0, -45.0, 8.0],
                [11.0, -46.0, 11.0],
                [28.0, -44.0, 10.0],
                [45.0, -26.0, 14.0],
                [53.0, -1.0, 9.0],
                [46.0, 25.0, 15.0],
                [37.0, 42.0, 17.0],
                [10.0, 59.0, 13.0],
                [-10.0, 58.0, 16.0],
                [-33.0, 40.0, 9.0],
                [-54.0, 26.0, 8.0],
                [-54.0, -4.0, 16.0],
                [-50.0, -25.0, 16.0],
                [-37.0, -45.0, 12.0],
                [-14.0, -52.0, 14.0],
                [9.0, -58.0, 18.0],
                [35.0, -48.0, 15.0],
                [51.0, -29.0, 16.0],
                [57.0, 1.0, 18.0],
                [52.0, 24.0, 8.0],
                [35.0, 53.0, 11.0],
                [16.0, 56.0, 10.0],
                [-16.0, 63.0, 13.0],
                [-38.0, 51.0, 14.0],
                [-55.0, 31.0, 15.0],
                [-66.0, -5.0, 10.0],
                [-56.0, -24.0, 11.0],
                [-35.0, -45.0, 10.0],
                [-16.0, -58.0, 11.0],
                [16.0, -57.0, 10.0],
                [38.0, -53.0, 14.0],
                [55.0, -30.0, 17.0],
                [70.0, -2.0, 10.0],
                [60.0, 26.0, 9.0],
                [38.0, 53.0, 18.0],
                [15.0, 65.0, 8.0],
                [-14.0, 70.0, 10.0],
                [-42.0, 56.0, 15.0],
                [-62.0, 34.0, 12.0],
                [-67.0, -4.0, 17.0],
                [-63.0, -27.0, 12.0],
                [-48.0, -59.0, 18.0],
                [-15.0, -70.0, 9.0],
                [17.0, -67.0, 10.0],
                [43.0, -51.0, 13.0],
                [62.0, -32.0, 9.0],
                [72.0, 0.0, 9.0],
                [65.0, 37.0, 10.0],
                [48.0, 56.0, 9.0],
                [14.0, 71.0, 14.0],
                [-12.0, 77.0, 17.0],
                [-49.0, 54.0, 12.0],
                [-67.0, 28.0, 15.0],
                [-74.0, -3.0, 13.0],
                [-73.0, -30.0, 14.0],
                [-45.0, -58.0, 12.0],
                [-20.0, -77.0, 13.0],
                [18.0, -76.0, 17.0],
                [46.0, -62.0, 15.0],
                [66.0, -32.0, 8.0],
                [85.0, -5.0, 15.0],
                [71.0, 32.0, 8.0],
                [51.0, 60.0, 16.0],
                [14.0, 80.0, 15.0],
                [-17.0, 75.0, 18.0],
                [-52.0, 59.0, 14.0],
                [-73.0, 33.0, 9.0],
                [-84.0, -1.0, 16.0],
                [-76.0, -40.0, 8.0],
                [-53.0, -65.0, 10.0],
                [-23.0, -80.0, 14.0],
                [22.0, -83.0, 17.0],
                [45.0, -63.0, 17.0],
                [69.0, -41.0, 10.0],
                [88.0, -5.0, 10.0],
                [82.0, 39.0, 18.0],
                [57.0, 71.0, 10.0],
                [23.0, 82.0, 13.0],
                [-24.0, 81.0, 9.0],
                [-51.0, 71.0, 10.0],
                [-78.0, 34.0, 9.0],
                [-87.0, -4.0, 10.0],
                [-76.0, -37.0, 15.0],
                [-56.0, -66.0, 9.0],
                [-19.0, -86.0, 9.0],
                [15.0, -87.0, 10.0],
                [50.0, -69.0, 8.0],
                [75.0, -39.0, 15.0],
                [97.0, 1.0, 13.0],
                [80.0, 37.0, 10.0],
                [54.0, 74.0, 9.0],
                [23.0, 91.0, 13.0],
                [-25.0, 95.0, 16.0],
                [-59.0, 78.0, 14.0],
                [-88.0, 42.0, 15.0],
                [-92.0, -2.0, 10.0],
                [-89.0, -44.0, 15.0],
                [-59.0, -75.0, 8.0],
                [-19.0, -97.0, 9.0],
                [24.0, -87.0, 15.0],
                [55.0, -78.0, 9.0],
                [87.0, -43.0, 16.0],
                [96.0, 3.0, 10.0],
                [91.0, 43.0, 15.0],
                [64.0, 82.0, 12.0],
                [23.0, 98.0, 17.0],
                [-23.0, 100.0, 17.0],
                [-61.0, 79.0, 14.0],
                [-89.0, 47.0, 15.0],
                [-104.0, -2.0, 12.0],
                [-91.0, -48.0, 8.0],
                [-58.0, -79.0, 13.0],
                [-19.0, -102.0, 12.0],
                [25.0, -101.0, 13.0],
                [62.0, -80.0, 16.0],
                [91.0, -42.0, 8.0],
                [54.0, 2.0, 18.0],
                [49.0, 24.0, 23.0],
                [27.0, 35.0, 15.0],
                [11.0, 46.0, 15.0],
                [-9.0, 52.0, 22.0],
                [-35.0, 40.0, 18.0],
                [-45.0, 20.0, 17.0],
                [-50.0, 1.0, 24.0],
                [-49.0, -23.0, 18.0],
                [-29.0, -36.0, 18.0],
                [-8.0, -46.0, 17.0],
                [9.0, -45.0, 21.0],
                [27.0, -36.0, 24.0],
                [47.0, -20.0, 20.0],
                [58.0, 1.0, 17.0],
                [55.0, 19.0, 16.0],
                [30.0, 43.0, 18.0],
                [14.0, 52.0, 20.0],
                [-18.0, 58.0, 22.0],
                [-32.0, 42.0, 15.0],
                [-56.0, 22.0, 18.0],
                [-55.0, 2.0, 15.0],
                [-51.0, -27.0, 21.0],
                [-37.0, -46.0, 21.0],
                [-11.0, -51.0, 24.0],
                [13.0, -57.0, 19.0],
                [30.0, -46.0, 15.0],
                [54.0, -23.0, 23.0],
                [66.0, -2.0, 18.0],
                [55.0, 29.0, 20.0],
                [43.0, 52.0, 18.0],
                [15.0, 60.0, 19.0],
                [-14.0, 62.0, 23.0],
                [-39.0, 44.0, 19.0],
                [-56.0, 22.0, 24.0],
                [-61.0, -2.0, 19.0],
                [-55.0, -27.0, 17.0],
                [-37.0, -52.0, 22.0],
                [-17.0, -63.0, 23.0],
                [8.0, -65.0, 16.0],
                [36.0, -54.0, 15.0],
                [53.0, -27.0, 23.0],
                [70.0, 1.0, 23.0],
                [63.0, 32.0, 15.0],
                [39.0, 51.0, 21.0],
                [12.0, 67.0, 19.0],
                [-12.0, 67.0, 19.0],
                [-47.0, 55.0, 21.0],
                [-66.0, 33.0, 22.0],
                [-68.0, -3.0, 19.0],
                [-66.0, -32.0, 21.0],
                [-47.0, -54.0, 24.0],
                [-16.0, -65.0, 18.0],
                [15.0, -65.0, 24.0],
                [42.0, -50.0, 17.0],
                [61.0, -26.0, 22.0],
                [74.0, -5.0, 20.0],
                [70.0, 29.0, 18.0],
                [43.0, 61.0, 21.0],
                [17.0, 72.0, 17.0],
                [-13.0, 76.0, 20.0],
                [-48.0, 58.0, 19.0],
                [-72.0, 29.0, 16.0],
                [-77.0, -2.0, 24.0],
                [-69.0, -36.0, 21.0],
                [-48.0, -63.0, 23.0],
                [-14.0, -77.0, 20.0],
                [19.0, -78.0, 16.0],
                [42.0, -57.0, 17.0],
                [72.0, -33.0, 15.0],
                [78.0, 3.0, 24.0],
                [74.0, 40.0, 22.0],
                [52.0, 58.0, 16.0],
                [18.0, 77.0, 17.0],
                [-21.0, 80.0, 17.0],
                [-53.0, 58.0, 23.0],
                [-72.0, 36.0, 18.0],
                [-85.0, -1.0, 21.0],
                [-76.0, -31.0, 15.0],
                [-53.0, -64.0, 23.0],
                [-16.0, -76.0, 18.0],
                [22.0, -83.0, 15.0],
                [46.0, -64.0, 20.0],
                [73.0, -35.0, 18.0],
                [83.0, -2.0, 24.0],
                [81.0, 40.0, 24.0],
                [54.0, 65.0, 18.0],
                [17.0, 81.0, 19.0],
                [-25.0, 81.0, 22.0],
                [-60.0, 71.0, 19.0],
                [-81.0, 40.0, 24.0],
                [-90.0, -4.0, 23.0],
                [-80.0, -36.0, 20.0],
                [-53.0, -71.0, 17.0],
                [-23.0, -91.0, 24.0],
                [17.0, -84.0, 24.0],
                [53.0, -65.0, 23.0],
                [79.0, -38.0, 24.0],
                [94.0, 4.0, 24.0],
                [82.0, 41.0, 17.0],
                [59.0, 71.0, 18.0],
                [20.0, 93.0, 16.0],
                [-24.0, 90.0, 24.0],
                [-62.0, 76.0, 20.0],
                [-88.0, 41.0, 20.0],
                [-97.0, 3.0, 20.0],
                [-89.0, -38.0, 21.0],
                [-57.0, -75.0, 15.0],
                [-22.0, -87.0, 24.0],
                [24.0, -90.0, 19.0],
                [60.0, -72.0, 23.0],
                [87.0, -45.0, 24.0],
                [95.0, -1.0, 24.0],
                [90.0, 41.0, 16.0],
                [62.0, 74.0, 23.0],
                [18.0, 93.0, 18.0],
                [-27.0, 94.0, 21.0],
                [-68.0, 76.0, 16.0],
                [-87.0, 42.0, 20.0],
                [-103.0, 3.0, 18.0],
                [-95.0, -39.0, 19.0],
                [-65.0, -74.0, 15.0],
                [-26.0, -97.0, 24.0],
                [27.0, -94.0, 20.0],
                [62.0, -82.0, 21.0],
                [93.0, -42.0, 21.0],
                [45.0, -4.0, 28.0],
                [46.0, 25.0, 22.0],
                [29.0, 36.0, 28.0],
                [8.0, 51.0, 29.0],
                [-9.0, 45.0, 26.0],
                [-31.0, 41.0, 25.0],
                [-47.0, 22.0, 26.0],
                [-52.0, -3.0, 23.0],
                [-45.0, -18.0, 28.0],
                [-31.0, -37.0, 30.0],
                [-17.0, -49.0, 29.0],
                [7.0, -51.0, 28.0],
                [26.0, -43.0, 24.0],
                [48.0, -20.0, 28.0],
                [52.0, -3.0, 26.0],
                [49.0, 22.0, 29.0],
                [33.0, 39.0, 28.0],
                [14.0, 50.0, 21.0],
                [-11.0, 55.0, 30.0],
                [-31.0, 43.0, 22.0],
                [-49.0, 20.0, 30.0],
                [-56.0, -4.0, 23.0],
                [-54.0, -23.0, 27.0],
                [-37.0, -48.0, 31.0],
                [-12.0, -54.0, 24.0],
                [12.0, -55.0, 29.0],
                [33.0, -44.0, 31.0],
                [49.0, -25.0, 24.0],
                [67.0, -2.0, 30.0],
                [54.0, 24.0, 29.0],
                [38.0, 50.0, 28.0],
                [16.0, 59.0, 21.0],
                [-10.0, 58.0, 24.0],
                [-39.0, 52.0, 25.0],
                [-54.0, 28.0, 31.0],
                [-63.0, 2.0, 25.0],
                [-57.0, -32.0, 23.0],
                [-37.0, -46.0, 26.0],
                [-11.0, -59.0, 27.0],
                [9.0, -59.0, 28.0],
                [35.0, -54.0, 29.0],
                [58.0, -32.0, 31.0],
                [71.0, 1.0, 22.0],
                [57.0, 28.0, 23.0],
                [43.0, 50.0, 29.0],
                [20.0, 70.0, 29.0],
                [-11.0, 68.0, 29.0],
                [-39.0, 50.0, 22.0],
                [-63.0, 27.0, 30.0],
                [-69.0, -2.0, 30.0],
                [-58.0, -31.0, 23.0],
                [-43.0, -54.0, 25.0],
                [-19.0, -64.0, 28.0],
                [14.0, -69.0, 23.0],
                [42.0, -54.0, 30.0],
                [59.0, -28.0, 26.0],
                [76.0, -5.0, 25.0],
                [72.0, 34.0, 23.0],
                [45.0, 60.0, 30.0],
                [12.0, 77.0, 27.0],
                [-18.0, 71.0, 27.0],
                [-47.0, 56.0, 28.0],
                [-72.0, 33.0, 24.0],
                [-74.0, -2.0, 24.0],
                [-67.0, -29.0, 23.0],
                [-50.0, -58.0, 29.0],
                [-21.0, -75.0, 22.0],
                [21.0, -74.0, 30.0],
                [48.0, -63.0, 30.0],
                [72.0, -31.0, 25.0],
                [78.0, 1.0, 31.0],
                [74.0, 30.0, 30.0],
                [52.0, 64.0, 28.0],
                [16.0, 80.0, 31.0],
                [-18.0, 76.0, 26.0],
                [-50.0, 64.0, 28.0],
                [-71.0, 34.0, 29.0],
                [-80.0, -3.0, 30.0],
                [-77.0, -33.0, 25.0],
                [-47.0, -63.0, 31.0],
                [-18.0, -80.0, 30.0],
                [16.0, -83.0, 28.0],
                [48.0, -67.0, 24.0],
                [69.0, -37.0, 28.0],
                [87.0, 0.0, 28.0],
                [76.0, 38.0, 27.0],
                [49.0, 70.0, 26.0],
                [17.0, 83.0, 23.0],
                [-20.0, 88.0, 31.0],
                [-55.0, 72.0, 29.0],
                [-80.0, 36.0, 28.0],
                [-93.0, -2.0, 22.0],
                [-79.0, -39.0, 25.0],
                [-60.0, -69.0, 21.0],
                [-19.0, -89.0, 28.0],
                [18.0, -84.0, 28.0],
                [52.0, -71.0, 27.0],
                [76.0, -36.0, 28.0],
                [90.0, 0.0, 29.0],
                [83.0, 39.0, 27.0],
                [55.0, 77.0, 28.0],
                [24.0, 89.0, 22.0],
                [-21.0, 90.0, 28.0],
                [-56.0, 76.0, 22.0],
                [-85.0, 45.0, 24.0],
                [-95.0, -1.0, 28.0],
                [-89.0, -46.0, 25.0],
                [-60.0, -78.0, 22.0],
                [-18.0, -88.0, 28.0],
                [17.0, -90.0, 23.0],
                [62.0, -70.0, 31.0],
                [85.0, -37.0, 27.0],
                [97.0, 2.0, 28.0],
                [88.0, 42.0, 28.0],
                [58.0, 83.0, 26.0],
                [24.0, 93.0, 30.0],
                [-28.0, 93.0, 30.0],
                [-64.0, 80.0, 28.0],
                [-92.0, 46.0, 24.0],
                [-101.0, 3.0, 30.0],
                [-87.0, -47.0, 22.0],
                [-60.0, -81.0, 26.0],
                [-25.0, -102.0, 30.0],
                [22.0, -103.0, 27.0],
                [60.0, -77.0, 28.0],
                [86.0, -46.0, 22.0],
                [47.0, -5.0, 29.0],
                [40.0, 24.0, 35.0],
                [35.0, 38.0, 33.0],
                [11.0, 44.0, 32.0],
                [-14.0, 45.0, 36.0],
                [-35.0, 34.0, 28.0],
                [-42.0, 20.0, 31.0],
                [-49.0, 3.0, 31.0],
                [-42.0, -25.0, 37.0],
                [-30.0, -42.0, 32.0],
                [-16.0, -53.0, 35.0],
                [8.0, -51.0, 30.0],
                [28.0, -35.0, 32.0],
                [41.0, -24.0, 35.0],
                [52.0, -3.0, 29.0],
                [54.0, 19.0, 32.0],
                [33.0, 45.0, 37.0],
                [16.0, 54.0, 37.0],
                [-18.0, 51.0, 29.0],
                [-37.0, 48.0, 35.0],
                [-52.0, 26.0, 32.0],
                [-59.0, 4.0, 31.0],
                [-54.0, -30.0, 35.0],
                [-36.0, -48.0, 35.0],
                [-14.0, -53.0, 28.0],
                [9.0, -57.0, 36.0],
                [33.0, -45.0, 36.0],
                [49.0, -25.0, 38.0],
                [58.0, 4.0, 35.0],
                [58.0, 25.0, 30.0],
                [42.0, 50.0, 31.0],
                [9.0, 62.0, 28.0],
                [-18.0, 59.0, 33.0],
                [-38.0, 44.0, 34.0],
                [-58.0, 22.0, 31.0],
                [-68.0, 4.0, 33.0],
                [-61.0, -25.0, 30.0],
                [-35.0, -52.0, 32.0],
                [-14.0, -57.0, 36.0],
                [16.0, -57.0, 35.0],
                [35.0, -50.0, 30.0],
                [54.0, -24.0, 36.0],
                [69.0, -2.0, 36.0],
                [59.0, 27.0, 32.0],
                [42.0, 58.0, 32.0],
                [10.0, 69.0, 29.0],
                [-12.0, 68.0, 29.0],
                [-46.0, 50.0, 34.0],
                [-60.0, 30.0, 30.0],
                [-70.0, 3.0, 36.0],
                [-62.0, -29.0, 31.0],
                [-42.0, -56.0, 37.0],
                [-18.0, -69.0, 34.0],
                [15.0, -63.0, 33.0],
                [43.0, -56.0, 35.0],
                [64.0, -31.0, 33.0],
                [71.0, 3.0, 32.0],
                [66.0, 37.0, 29.0],
                [48.0, 59.0, 34.0],
                [12.0, 73.0, 34.0],
                [-17.0, 73.0, 32.0],
                [-45.0, 63.0, 37.0],
                [-69.0, 31.0, 32.0],
                [-76.0, 0.0, 32.0],
                [-69.0, -32.0, 34.0],
                [-49.0, -59.0, 31.0],
                [-17.0, -70.0, 34.0],
                [12.0, -73.0, 34.0],
                [45.0, -54.0, 35.0],
                [63.0, -37.0, 35.0],
                [85.0, 2.0, 32.0],
                [76.0, 32.0, 32.0],
                [51.0, 64.0, 34.0],
                [22.0, 80.0, 30.0],
                [-20.0, 76.0, 34.0],
                [-50.0, 66.0, 35.0],
                [-73.0, 33.0, 30.0],
                [-86.0, -1.0, 28.0],
                [-73.0, -40.0, 28.0],
                [-52.0, -62.0, 36.0],
                [-16.0, -81.0, 32.0],
                [16.0, -77.0, 38.0],
                [47.0, -67.0, 30.0],
                [74.0, -39.0, 34.0],
                [92.0, 2.0, 35.0],
                [76.0, 42.0, 34.0],
                [53.0, 68.0, 37.0],
                [16.0, 89.0, 31.0],
                [-24.0, 80.0, 28.0],
                [-50.0, 63.0, 34.0],
                [-78.0, 38.0, 29.0],
                [-85.0, -1.0, 35.0],
                [-80.0, -36.0, 29.0],
                [-59.0, -69.0, 32.0],
                [-22.0, -90.0, 38.0],
                [23.0, -83.0, 37.0],
                [51.0, -68.0, 35.0],
                [82.0, -41.0, 36.0],
                [90.0, -4.0, 28.0],
                [88.0, 40.0, 33.0],
                [59.0, 69.0, 33.0],
                [20.0, 92.0, 37.0],
                [-19.0, 94.0, 32.0],
                [-63.0, 71.0, 37.0],
                [-82.0, 37.0, 29.0],
                [-94.0, -3.0, 32.0],
                [-81.0, -43.0, 37.0],
                [-56.0, -71.0, 31.0],
                [-22.0, -93.0, 36.0],
                [18.0, -94.0, 34.0],
                [60.0, -69.0, 31.0],
                [88.0, -45.0, 35.0],
                [102.0, -3.0, 33.0],
                [94.0, 44.0, 37.0],
                [66.0, 81.0, 28.0],
                [19.0, 98.0, 38.0],
                [-27.0, 98.0, 34.0],
                [-67.0, 78.0, 30.0],
                [-88.0, 47.0, 38.0],
                [-101.0, 0.0, 28.0],
                [-89.0, -41.0, 29.0],
                [-60.0, -81.0, 35.0],
                [-24.0, -99.0, 32.0],
                [26.0, -98.0, 32.0],
                [62.0, -83.0, 30.0],
                [94.0, -48.0, 30.0],
                [49.0, 0.0, 35.0],
                [40.0, 23.0, 40.0],
                [29.0, 39.0, 37.0],
                [14.0, 52.0, 39.0],
                [-8.0, 43.0, 38.0],
                [-30.0, 41.0, 42.0],
                [-49.0, 25.0, 41.0],
                [-47.0, 1.0, 44.0],
                [-47.0, -24.0, 40.0],
                [-27.0, -36.0, 37.0],
                [-12.0, -52.0, 44.0],
                [16.0, -53.0, 42.0],
                [34.0, -40.0, 44.0],
                [49.0, -23.0, 43.0],
                [59.0, 1.0, 43.0],
                [47.0, 23.0, 38.0],
                [34.0, 39.0, 39.0],
                [11.0, 50.0, 43.0],
                [-13.0, 59.0, 36.0],
                [-35.0, 47.0, 41.0],
                [-54.0, 28.0, 35.0],
                [-58.0, -4.0, 40.0],
                [-50.0, -24.0, 36.0],
                [-32.0, -44.0, 41.0],
                [-10.0, -59.0, 41.0],
                [17.0, -55.0, 35.0],
                [33.0, -46.0, 37.0],
                [53.0, -23.0, 39.0],
                [58.0, -1.0, 40.0],
                [52.0, 27.0, 35.0],
                [41.0, 49.0, 41.0],
                [18.0, 58.0, 35.0],
                [-17.0, 64.0, 36.0],
                [-35.0, 49.0, 35.0],
                [-53.0, 27.0, 39.0],
                [-66.0, -4.0, 44.0],
                [-60.0, -32.0, 36.0],
                [-41.0, -50.0, 44.0],
                [-15.0, -58.0, 37.0],
                [17.0, -57.0, 37.0],
                [35.0, -47.0, 44.0],
                [57.0, -25.0, 40.0],
                [65.0, -5.0, 43.0],
                [60.0, 26.0, 44.0],
                [43.0, 51.0, 37.0],
                [15.0, 63.0, 40.0],
                [-19.0, 67.0, 36.0],
                [-46.0, 53.0, 44.0],
                [-59.0, 28.0, 38.0],
                [-68.0, 1.0, 44.0],
                [-67.0, -29.0, 43.0],
                [-41.0, -54.0, 43.0],
                [-13.0, -66.0, 35.0],
                [19.0, -71.0, 35.0],
                [44.0, -55.0, 38.0],
                [66.0, -28.0, 43.0],
                [72.0, -3.0, 42.0],
                [72.0, 28.0, 37.0],
                [47.0, 60.0, 36.0],
                [17.0, 70.0, 39.0],
                [-21.0, 72.0, 37.0],
                [-46.0, 62.0, 41.0],
                [-71.0, 31.0, 40.0],
                [-73.0, 3.0, 42.0],
                [-66.0, -38.0, 36.0],
                [-48.0, -60.0, 44.0],
                [-18.0, -72.0, 40.0],
                [17.0, -77.0, 38.0],
                [43.0, -59.0, 38.0],
                [72.0, -30.0, 36.0],
                [77.0, -5.0, 35.0],
                [70.0, 35.0, 35.0],
                [49.0, 61.0, 36.0],
                [14.0, 82.0, 36.0],
                [-18.0, 75.0, 37.0],
                [-46.0, 68.0, 36.0],
                [-79.0, 36.0, 40.0],
                [-82.0, -3.0, 41.0],
                [-72.0, -34.0, 44.0],
                [-50.0, -68.0, 38.0],
                [-21.0, -79.0, 42.0],
                [19.0, -75.0, 38.0],
                [55.0, -64.0, 38.0],
                [71.0, -39.0, 43.0],
                [89.0, 1.0, 44.0],
                [81.0, 35.0, 43.0],
                [56.0, 68.0, 38.0],
                [16.0, 81.0, 41.0],
                [-19.0, 81.0, 37.0],
                [-52.0, 69.0, 36.0],
                [-76.0, 39.0, 43.0],
                [-87.0, 3.0, 39.0],
                [-83.0, -43.0, 39.0],
                [-53.0, -65.0, 39.0],
                [-19.0, -82.0, 36.0],
                [22.0, -88.0, 43.0],
                [53.0, -73.0, 40.0],
                [83.0, -38.0, 35.0],
                [96.0, 3.0, 39.0],
                [86.0, 40.0, 39.0],
                [58.0, 69.0, 43.0],
                [22.0, 95.0, 41.0],
                [-22.0, 87.0, 43.0],
                [-57.0, 77.0, 38.0],
                [-82.0, 41.0, 39.0],
                [-92.0, 3.0, 39.0],
                [-86.0, -43.0, 39.0],
                [-59.0, -70.0, 44.0],
                [-18.0, -89.0, 42.0],
                [23.0, -93.0, 42.0],
                [60.0, -75.0, 35.0],
                [80.0, -39.0, 35.0],
                [104.0, 3.0, 43.0],
                [85.0, 42.0, 37.0],
                [61.0, 78.0, 35.0],
                [25.0, 95.0, 42.0],
                [-25.0, 93.0, 44.0],
                [-59.0, 82.0, 41.0],
                [-86.0, 43.0, 40.0],
                [-100.0, -2.0, 36.0],
                [-96.0, -43.0, 38.0],
                [-64.0, -81.0, 43.0],
                [-18.0, -95.0, 39.0],
                [24.0, -96.0, 38.0],
                [65.0, -83.0, 41.0],
                [89.0, -45.0, 38.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    -1.4,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.7,
                    2.0,
                    2.7,
                    4.3,
                    4.7,
                    6.2,
                    7.0,
                    7.6,
                    9.0,
                    9.0,
                    9.0,
                    9.0,
                    9.0,
                    9.0,
                    9.7,
                ]
            ),
            0,
        )
        basis1 = BSplineBasis(
            6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 2.0, 3.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        basis2 = BSplineBasis(6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.2, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0]))
        vol: SplineObject = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2 = vol.get_derivative_spline(0)
        self.assertEqual(vol2.order(direction=0), 6)
        self.assertEqual(vol2.order(direction=1), 6)
        self.assertEqual(vol2.order(direction=2), 6)
        vol3 = vol.get_derivative_spline(1)
        self.assertEqual(vol3.order(direction=0), 7)
        self.assertEqual(vol3.order(direction=1), 5)
        self.assertEqual(vol3.order(direction=2), 6)
        vol4 = vol.get_derivative_spline(2)
        self.assertEqual(vol4.order(direction=0), 7)
        self.assertEqual(vol4.order(direction=1), 6)
        self.assertEqual(vol4.order(direction=2), 5)

        u = np.linspace(vol.start(0), vol.end(0), 5)
        v = np.linspace(vol.start(1), vol.end(1), 5)
        w = np.linspace(vol.start(2), vol.end(2), 5)
        du = vol.derivative(u, v, w, d=(1, 0, 0))
        du2 = vol2(u, v, w)
        dv = vol.derivative(u, v, w, d=(0, 1, 0))
        dv2 = vol3(u, v, w)
        dw = vol.derivative(u, v, w, d=(0, 0, 1))
        dw2 = vol4(u, v, w)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dw - dw2)), 0.0)

    def test_curve_3D_p5_C1_periodic(self) -> None:
        controlpoints = np.array(
            [
                [96.0, -5.0, 0.0],
                [83.0, 46.0, -1.0],
                [47.0, 86.0, 3.0],
                [-5.0, 98.0, -2.0],
                [-52.0, 87.0, -4.0],
                [-87.0, 45.0, -2.0],
                [-105.0, 1.0, -1.0],
                [-85.0, -48.0, 1.0],
                [-51.0, -90.0, -5.0],
                [4.0, -97.0, 3.0],
                [45.0, -91.0, -3.0],
                [83.0, -49.0, 2.0],
            ]
        )
        basis0 = BSplineBasis(
            5,
            np.array(
                [
                    -2.0,
                    -0.7,
                    0.0,
                    0.0,
                    0.0,
                    0.7,
                    2.2,
                    2.6,
                    3.8,
                    5.2,
                    6.0,
                    6.9,
                    8.0,
                    9.3,
                    10.0,
                    10.0,
                    10.0,
                    10.7,
                    12.2,
                ]
            ),
            1,
        )
        crv: SplineObject = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 = crv.get_derivative_spline(0)
        self.assertEqual(crv2.order(direction=0), 4)

        u = np.linspace(crv.start(0), crv.end(0), 11)
        du = crv.derivative(u)
        du2 = crv2(u)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)

    def test_surface_3D_p67_C1_periodic(self) -> None:
        controlpoints = np.array(
            [
                [63.0, -5.0, -4.0],
                [58.0, 26.0, -3.0],
                [39.0, 44.0, -3.0],
                [13.0, 58.0, 2.0],
                [-12.0, 58.0, -3.0],
                [-35.0, 50.0, 3.0],
                [-57.0, 23.0, -4.0],
                [-61.0, 1.0, -4.0],
                [-59.0, -24.0, -3.0],
                [-42.0, -46.0, 0.0],
                [-13.0, -62.0, -2.0],
                [16.0, -63.0, 3.0],
                [35.0, -47.0, 2.0],
                [50.0, -30.0, 3.0],
                [60.0, 4.0, 2.0],
                [61.0, 32.0, 0.0],
                [38.0, 48.0, -1.0],
                [16.0, 60.0, 0.0],
                [-16.0, 64.0, -4.0],
                [-37.0, 48.0, -2.0],
                [-55.0, 31.0, 3.0],
                [-70.0, 0.0, -5.0],
                [-54.0, -33.0, -1.0],
                [-37.0, -49.0, -5.0],
                [-10.0, -66.0, -3.0],
                [9.0, -64.0, 4.0],
                [41.0, -46.0, 3.0],
                [62.0, -24.0, -4.0],
                [65.0, 0.0, 3.0],
                [58.0, 30.0, -5.0],
                [37.0, 56.0, 4.0],
                [14.0, 62.0, -5.0],
                [-14.0, 71.0, 1.0],
                [-45.0, 50.0, 4.0],
                [-66.0, 32.0, 0.0],
                [-65.0, -5.0, 3.0],
                [-67.0, -35.0, 2.0],
                [-43.0, -55.0, 0.0],
                [-16.0, -64.0, -4.0],
                [19.0, -65.0, 1.0],
                [41.0, -57.0, 0.0],
                [57.0, -31.0, 4.0],
                [76.0, -4.0, 1.0],
                [70.0, 30.0, -4.0],
                [43.0, 54.0, -4.0],
                [19.0, 72.0, 2.0],
                [-21.0, 71.0, -4.0],
                [-47.0, 59.0, -5.0],
                [-66.0, 27.0, 0.0],
                [-71.0, 4.0, 4.0],
                [-62.0, -30.0, 2.0],
                [-43.0, -56.0, -2.0],
                [-21.0, -72.0, 3.0],
                [18.0, -71.0, -3.0],
                [43.0, -61.0, -4.0],
                [68.0, -35.0, 2.0],
                [81.0, -1.0, -5.0],
                [66.0, 33.0, 2.0],
                [47.0, 57.0, 1.0],
                [14.0, 76.0, 4.0],
                [-15.0, 71.0, -5.0],
                [-46.0, 59.0, -2.0],
                [-69.0, 31.0, -2.0],
                [-79.0, -5.0, 1.0],
                [-75.0, -35.0, -2.0],
                [-48.0, -63.0, -5.0],
                [-20.0, -72.0, 0.0],
                [13.0, -75.0, -3.0],
                [46.0, -62.0, -2.0],
                [65.0, -31.0, -5.0],
                [77.0, -4.0, -1.0],
                [71.0, 31.0, 2.0],
                [49.0, 61.0, -3.0],
                [20.0, 81.0, 2.0],
                [-17.0, 75.0, -2.0],
                [-47.0, 68.0, 4.0],
                [-70.0, 34.0, 4.0],
                [-82.0, -3.0, -5.0],
                [-76.0, -36.0, -2.0],
                [-51.0, -69.0, -5.0],
                [-23.0, -82.0, -3.0],
                [15.0, -76.0, -3.0],
                [51.0, -69.0, -2.0],
                [72.0, -36.0, -1.0],
                [83.0, -2.0, 2.0],
                [79.0, 36.0, 2.0],
                [53.0, 65.0, -3.0],
                [19.0, 88.0, 0.0],
                [-18.0, 86.0, -3.0],
                [-52.0, 67.0, -4.0],
                [-83.0, 36.0, -2.0],
                [-85.0, -5.0, -3.0],
                [-74.0, -34.0, 4.0],
                [-51.0, -72.0, 4.0],
                [-19.0, -87.0, 3.0],
                [18.0, -90.0, -4.0],
                [55.0, -68.0, 0.0],
                [76.0, -36.0, 1.0],
                [91.0, 0.0, -5.0],
                [82.0, 35.0, 3.0],
                [52.0, 73.0, -5.0],
                [15.0, 87.0, 4.0],
                [-16.0, 92.0, 4.0],
                [-56.0, 73.0, -5.0],
                [-83.0, 39.0, 4.0],
                [-92.0, 3.0, -5.0],
                [-87.0, -38.0, 4.0],
                [-61.0, -75.0, -4.0],
                [-23.0, -88.0, -4.0],
                [19.0, -86.0, 4.0],
                [56.0, -69.0, -4.0],
                [78.0, -42.0, 1.0],
                [97.0, 3.0, -3.0],
                [88.0, 42.0, 4.0],
                [64.0, 74.0, -4.0],
                [17.0, 97.0, 0.0],
                [-17.0, 94.0, -3.0],
                [-56.0, 77.0, -3.0],
                [-85.0, 45.0, -1.0],
                [-99.0, 4.0, 2.0],
                [-82.0, -42.0, 4.0],
                [-60.0, -72.0, -3.0],
                [-24.0, -92.0, -3.0],
                [21.0, -93.0, -1.0],
                [57.0, -76.0, 0.0],
                [88.0, -40.0, 1.0],
                [103.0, 0.0, 0.0],
                [92.0, 41.0, 3.0],
                [63.0, 76.0, -3.0],
                [19.0, 93.0, 0.0],
                [-18.0, 101.0, 4.0],
                [-67.0, 73.0, 0.0],
                [-91.0, 46.0, 2.0],
                [-102.0, -3.0, -5.0],
                [-88.0, -48.0, 1.0],
                [-68.0, -78.0, 1.0],
                [-20.0, -95.0, 2.0],
                [19.0, -96.0, 3.0],
                [57.0, -77.0, -3.0],
                [90.0, -39.0, 4.0],
            ]
        )
        basis0 = BSplineBasis(
            6,
            np.array(
                [
                    -1.9,
                    -0.8,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.6,
                    2.0,
                    3.4,
                    4.1,
                    4.7,
                    5.8,
                    7.4,
                    7.9,
                    9.1,
                    10.2,
                    11.0,
                    11.0,
                    11.0,
                    11.0,
                    11.6,
                    13.0,
                ]
            ),
            1,
        )
        basis1 = BSplineBasis(
            7, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.3, 2.1, 3.3, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0])
        )
        surf: SplineObject = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 = surf.get_derivative_spline(0)
        self.assertEqual(surf2.order(direction=0), 5)
        self.assertEqual(surf2.order(direction=1), 7)
        surf3 = surf.get_derivative_spline(1)
        self.assertEqual(surf3.order(direction=0), 6)
        self.assertEqual(surf3.order(direction=1), 6)

        u = np.linspace(surf.start(0), surf.end(0), 7)
        v = np.linspace(surf.start(1), surf.end(1), 7)
        du = surf.derivative(u, v, d=(1, 0))
        du2 = surf2(u, v)
        dv = surf.derivative(u, v, d=(0, 1))
        dv2 = surf3(u, v)

        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)

    def test_volume_3D_p765_C1_periodic(self) -> None:
        controlpoints = np.array(
            [
                [52.0, 2.0, 2.0],
                [44.0, 15.0, 3.0],
                [39.0, 37.0, -5.0],
                [18.0, 41.0, -5.0],
                [3.0, 46.0, 0.0],
                [-24.0, 42.0, 3.0],
                [-40.0, 37.0, -2.0],
                [-44.0, 19.0, 4.0],
                [-53.0, -1.0, 4.0],
                [-48.0, -23.0, -5.0],
                [-32.0, -35.0, -2.0],
                [-22.0, -46.0, 4.0],
                [-4.0, -52.0, -5.0],
                [16.0, -51.0, -1.0],
                [32.0, -31.0, 1.0],
                [49.0, -23.0, 0.0],
                [62.0, -5.0, -4.0],
                [51.0, 24.0, -5.0],
                [44.0, 42.0, -5.0],
                [26.0, 53.0, 0.0],
                [0.0, 59.0, 0.0],
                [-21.0, 56.0, 0.0],
                [-38.0, 40.0, -2.0],
                [-54.0, 20.0, 3.0],
                [-59.0, 0.0, 0.0],
                [-50.0, -25.0, -4.0],
                [-41.0, -38.0, -2.0],
                [-25.0, -51.0, 4.0],
                [0.0, -58.0, 1.0],
                [17.0, -52.0, 2.0],
                [44.0, -39.0, -5.0],
                [57.0, -21.0, -4.0],
                [62.0, 1.0, -4.0],
                [60.0, 27.0, -5.0],
                [47.0, 45.0, 0.0],
                [23.0, 60.0, 1.0],
                [-1.0, 65.0, -5.0],
                [-27.0, 58.0, 0.0],
                [-43.0, 50.0, 1.0],
                [-63.0, 25.0, -2.0],
                [-69.0, -2.0, -2.0],
                [-58.0, -22.0, -2.0],
                [-46.0, -46.0, 0.0],
                [-24.0, -60.0, -2.0],
                [-3.0, -68.0, -2.0],
                [22.0, -60.0, 0.0],
                [50.0, -47.0, -2.0],
                [61.0, -27.0, 1.0],
                [71.0, 1.0, -5.0],
                [66.0, 32.0, -5.0],
                [55.0, 56.0, -3.0],
                [32.0, 72.0, 0.0],
                [-4.0, 76.0, 2.0],
                [-30.0, 69.0, -1.0],
                [-57.0, 50.0, 1.0],
                [-70.0, 27.0, 1.0],
                [-79.0, -3.0, -4.0],
                [-72.0, -29.0, 3.0],
                [-49.0, -57.0, -4.0],
                [-29.0, -67.0, 1.0],
                [-2.0, -75.0, -4.0],
                [24.0, -71.0, -5.0],
                [48.0, -51.0, -3.0],
                [73.0, -25.0, -4.0],
                [80.0, 2.0, -2.0],
                [74.0, 28.0, 1.0],
                [55.0, 62.0, 1.0],
                [36.0, 78.0, -1.0],
                [-4.0, 85.0, -4.0],
                [-31.0, 81.0, 0.0],
                [-58.0, 62.0, -3.0],
                [-75.0, 32.0, 3.0],
                [-85.0, 3.0, 4.0],
                [-77.0, -31.0, -1.0],
                [-55.0, -56.0, -4.0],
                [-36.0, -74.0, -5.0],
                [1.0, -85.0, 4.0],
                [31.0, -82.0, -5.0],
                [63.0, -63.0, -5.0],
                [75.0, -29.0, 4.0],
                [88.0, 1.0, -5.0],
                [86.0, 33.0, -2.0],
                [69.0, 69.0, 0.0],
                [35.0, 86.0, 0.0],
                [0.0, 88.0, -3.0],
                [-39.0, 88.0, 3.0],
                [-64.0, 61.0, 4.0],
                [-88.0, 39.0, 0.0],
                [-93.0, 2.0, -3.0],
                [-85.0, -32.0, 4.0],
                [-65.0, -62.0, 3.0],
                [-37.0, -81.0, -4.0],
                [2.0, -94.0, 3.0],
                [30.0, -84.0, -1.0],
                [60.0, -64.0, -4.0],
                [89.0, -40.0, -1.0],
                [103.0, -1.0, 2.0],
                [92.0, 42.0, -1.0],
                [71.0, 71.0, -3.0],
                [38.0, 91.0, 2.0],
                [1.0, 104.0, -4.0],
                [-36.0, 94.0, 0.0],
                [-70.0, 70.0, -2.0],
                [-94.0, 40.0, 1.0],
                [-99.0, 0.0, 0.0],
                [-98.0, -34.0, -2.0],
                [-70.0, -70.0, 3.0],
                [-40.0, -89.0, -3.0],
                [1.0, -102.0, -2.0],
                [35.0, -94.0, -1.0],
                [67.0, -73.0, -2.0],
                [89.0, -38.0, 4.0],
                [54.0, 4.0, 4.0],
                [50.0, 17.0, 4.0],
                [38.0, 34.0, 3.0],
                [14.0, 43.0, 9.0],
                [-5.0, 51.0, 4.0],
                [-22.0, 46.0, 11.0],
                [-36.0, 31.0, 8.0],
                [-48.0, 19.0, 4.0],
                [-46.0, -2.0, 10.0],
                [-52.0, -21.0, 12.0],
                [-39.0, -31.0, 3.0],
                [-15.0, -47.0, 7.0],
                [3.0, -48.0, 7.0],
                [16.0, -51.0, 7.0],
                [38.0, -36.0, 6.0],
                [46.0, -23.0, 3.0],
                [56.0, 1.0, 8.0],
                [50.0, 18.0, 11.0],
                [40.0, 43.0, 12.0],
                [25.0, 53.0, 12.0],
                [-4.0, 59.0, 10.0],
                [-26.0, 50.0, 5.0],
                [-39.0, 42.0, 10.0],
                [-59.0, 24.0, 3.0],
                [-54.0, -5.0, 10.0],
                [-57.0, -21.0, 8.0],
                [-42.0, -41.0, 7.0],
                [-22.0, -50.0, 11.0],
                [-3.0, -54.0, 3.0],
                [20.0, -57.0, 4.0],
                [36.0, -43.0, 9.0],
                [51.0, -20.0, 3.0],
                [64.0, 3.0, 6.0],
                [61.0, 23.0, 7.0],
                [45.0, 45.0, 10.0],
                [30.0, 58.0, 8.0],
                [-4.0, 65.0, 11.0],
                [-23.0, 59.0, 6.0],
                [-46.0, 45.0, 7.0],
                [-66.0, 29.0, 6.0],
                [-66.0, -1.0, 11.0],
                [-59.0, -26.0, 5.0],
                [-43.0, -48.0, 4.0],
                [-23.0, -64.0, 11.0],
                [-2.0, -67.0, 4.0],
                [29.0, -62.0, 6.0],
                [48.0, -48.0, 5.0],
                [64.0, -24.0, 6.0],
                [75.0, -3.0, 5.0],
                [65.0, 32.0, 3.0],
                [52.0, 54.0, 8.0],
                [25.0, 69.0, 12.0],
                [-5.0, 77.0, 5.0],
                [-30.0, 72.0, 12.0],
                [-57.0, 48.0, 4.0],
                [-71.0, 27.0, 8.0],
                [-76.0, 1.0, 10.0],
                [-71.0, -24.0, 4.0],
                [-52.0, -49.0, 7.0],
                [-33.0, -66.0, 7.0],
                [0.0, -76.0, 12.0],
                [25.0, -70.0, 7.0],
                [48.0, -51.0, 5.0],
                [73.0, -28.0, 4.0],
                [88.0, 3.0, 7.0],
                [80.0, 28.0, 5.0],
                [54.0, 59.0, 9.0],
                [29.0, 73.0, 8.0],
                [-4.0, 86.0, 10.0],
                [-36.0, 75.0, 7.0],
                [-64.0, 59.0, 5.0],
                [-79.0, 30.0, 12.0],
                [-84.0, 0.0, 9.0],
                [-74.0, -37.0, 9.0],
                [-57.0, -61.0, 6.0],
                [-30.0, -80.0, 9.0],
                [-3.0, -87.0, 10.0],
                [29.0, -74.0, 4.0],
                [63.0, -58.0, 12.0],
                [78.0, -31.0, 4.0],
                [88.0, -1.0, 8.0],
                [86.0, 37.0, 5.0],
                [65.0, 66.0, 7.0],
                [39.0, 80.0, 12.0],
                [-4.0, 95.0, 3.0],
                [-32.0, 88.0, 3.0],
                [-61.0, 68.0, 5.0],
                [-83.0, 35.0, 8.0],
                [-93.0, -5.0, 9.0],
                [-86.0, -38.0, 8.0],
                [-65.0, -69.0, 9.0],
                [-38.0, -84.0, 9.0],
                [3.0, -88.0, 3.0],
                [30.0, -81.0, 8.0],
                [65.0, -69.0, 9.0],
                [82.0, -34.0, 4.0],
                [103.0, -1.0, 12.0],
                [93.0, 42.0, 5.0],
                [68.0, 65.0, 7.0],
                [40.0, 89.0, 11.0],
                [0.0, 99.0, 7.0],
                [-43.0, 94.0, 4.0],
                [-72.0, 75.0, 10.0],
                [-96.0, 35.0, 9.0],
                [-105.0, 4.0, 11.0],
                [-93.0, -35.0, 11.0],
                [-68.0, -67.0, 5.0],
                [-38.0, -93.0, 10.0],
                [-1.0, -99.0, 12.0],
                [42.0, -89.0, 8.0],
                [74.0, -75.0, 5.0],
                [89.0, -36.0, 6.0],
                [54.0, 0.0, 13.0],
                [47.0, 19.0, 11.0],
                [38.0, 32.0, 17.0],
                [20.0, 41.0, 15.0],
                [1.0, 50.0, 11.0],
                [-18.0, 48.0, 17.0],
                [-39.0, 38.0, 20.0],
                [-43.0, 18.0, 14.0],
                [-55.0, 4.0, 16.0],
                [-47.0, -23.0, 14.0],
                [-35.0, -40.0, 13.0],
                [-23.0, -51.0, 13.0],
                [2.0, -52.0, 19.0],
                [17.0, -50.0, 11.0],
                [32.0, -35.0, 18.0],
                [44.0, -19.0, 13.0],
                [58.0, -4.0, 18.0],
                [57.0, 21.0, 11.0],
                [44.0, 43.0, 14.0],
                [22.0, 49.0, 11.0],
                [-2.0, 53.0, 13.0],
                [-24.0, 54.0, 14.0],
                [-40.0, 44.0, 17.0],
                [-49.0, 18.0, 12.0],
                [-63.0, 4.0, 18.0],
                [-58.0, -27.0, 16.0],
                [-40.0, -39.0, 13.0],
                [-27.0, -59.0, 14.0],
                [3.0, -59.0, 19.0],
                [26.0, -51.0, 17.0],
                [43.0, -38.0, 20.0],
                [57.0, -21.0, 11.0],
                [65.0, -2.0, 11.0],
                [56.0, 27.0, 18.0],
                [45.0, 50.0, 18.0],
                [27.0, 61.0, 20.0],
                [-3.0, 62.0, 14.0],
                [-27.0, 57.0, 15.0],
                [-48.0, 44.0, 15.0],
                [-60.0, 22.0, 18.0],
                [-65.0, -3.0, 18.0],
                [-57.0, -25.0, 17.0],
                [-45.0, -49.0, 11.0],
                [-24.0, -59.0, 16.0],
                [-1.0, -67.0, 16.0],
                [20.0, -65.0, 13.0],
                [42.0, -47.0, 11.0],
                [64.0, -22.0, 19.0],
                [73.0, -4.0, 11.0],
                [71.0, 28.0, 13.0],
                [52.0, 48.0, 11.0],
                [24.0, 66.0, 13.0],
                [2.0, 71.0, 17.0],
                [-30.0, 74.0, 17.0],
                [-57.0, 57.0, 16.0],
                [-67.0, 27.0, 19.0],
                [-76.0, 2.0, 13.0],
                [-74.0, -33.0, 11.0],
                [-54.0, -49.0, 13.0],
                [-31.0, -73.0, 13.0],
                [1.0, -78.0, 18.0],
                [33.0, -71.0, 12.0],
                [54.0, -55.0, 12.0],
                [70.0, -33.0, 12.0],
                [84.0, -2.0, 11.0],
                [75.0, 35.0, 11.0],
                [55.0, 58.0, 16.0],
                [30.0, 81.0, 16.0],
                [4.0, 85.0, 17.0],
                [-35.0, 81.0, 13.0],
                [-62.0, 62.0, 13.0],
                [-76.0, 36.0, 16.0],
                [-82.0, 1.0, 14.0],
                [-80.0, -37.0, 11.0],
                [-63.0, -62.0, 18.0],
                [-32.0, -77.0, 16.0],
                [-5.0, -81.0, 12.0],
                [33.0, -77.0, 19.0],
                [58.0, -57.0, 12.0],
                [75.0, -33.0, 18.0],
                [90.0, -4.0, 12.0],
                [87.0, 30.0, 13.0],
                [68.0, 60.0, 17.0],
                [39.0, 87.0, 19.0],
                [3.0, 92.0, 13.0],
                [-35.0, 85.0, 13.0],
                [-68.0, 69.0, 13.0],
                [-80.0, 35.0, 16.0],
                [-96.0, 3.0, 17.0],
                [-89.0, -37.0, 13.0],
                [-70.0, -68.0, 14.0],
                [-32.0, -84.0, 14.0],
                [0.0, -91.0, 15.0],
                [32.0, -88.0, 11.0],
                [68.0, -69.0, 12.0],
                [89.0, -32.0, 18.0],
                [100.0, -2.0, 14.0],
                [96.0, 38.0, 17.0],
                [68.0, 71.0, 14.0],
                [40.0, 88.0, 18.0],
                [0.0, 98.0, 20.0],
                [-35.0, 94.0, 20.0],
                [-74.0, 70.0, 13.0],
                [-97.0, 40.0, 16.0],
                [-96.0, -3.0, 14.0],
                [-95.0, -39.0, 14.0],
                [-75.0, -67.0, 18.0],
                [-40.0, -90.0, 19.0],
                [-3.0, -100.0, 18.0],
                [40.0, -93.0, 15.0],
                [70.0, -71.0, 14.0],
                [95.0, -39.0, 17.0],
                [47.0, -3.0, 26.0],
                [43.0, 16.0, 28.0],
                [36.0, 35.0, 19.0],
                [16.0, 43.0, 28.0],
                [2.0, 51.0, 19.0],
                [-19.0, 48.0, 24.0],
                [-32.0, 38.0, 20.0],
                [-43.0, 21.0, 28.0],
                [-50.0, -5.0, 25.0],
                [-49.0, -17.0, 21.0],
                [-36.0, -33.0, 21.0],
                [-15.0, -46.0, 27.0],
                [-2.0, -50.0, 22.0],
                [22.0, -45.0, 27.0],
                [37.0, -34.0, 21.0],
                [43.0, -15.0, 21.0],
                [57.0, -2.0, 21.0],
                [56.0, 21.0, 28.0],
                [44.0, 40.0, 25.0],
                [26.0, 56.0, 26.0],
                [0.0, 55.0, 24.0],
                [-21.0, 53.0, 27.0],
                [-42.0, 43.0, 23.0],
                [-59.0, 27.0, 24.0],
                [-61.0, 3.0, 23.0],
                [-56.0, -19.0, 26.0],
                [-45.0, -46.0, 28.0],
                [-25.0, -50.0, 22.0],
                [-4.0, -60.0, 25.0],
                [19.0, -58.0, 21.0],
                [45.0, -38.0, 24.0],
                [49.0, -27.0, 25.0],
                [62.0, 2.0, 26.0],
                [60.0, 29.0, 25.0],
                [42.0, 51.0, 19.0],
                [24.0, 59.0, 19.0],
                [-5.0, 62.0, 22.0],
                [-28.0, 61.0, 23.0],
                [-50.0, 44.0, 24.0],
                [-57.0, 29.0, 20.0],
                [-69.0, -2.0, 19.0],
                [-66.0, -29.0, 21.0],
                [-52.0, -48.0, 27.0],
                [-24.0, -62.0, 27.0],
                [3.0, -67.0, 20.0],
                [29.0, -60.0, 25.0],
                [44.0, -43.0, 19.0],
                [56.0, -29.0, 20.0],
                [77.0, 4.0, 23.0],
                [66.0, 24.0, 26.0],
                [52.0, 52.0, 22.0],
                [30.0, 64.0, 19.0],
                [-1.0, 75.0, 26.0],
                [-31.0, 72.0, 28.0],
                [-52.0, 51.0, 23.0],
                [-66.0, 30.0, 24.0],
                [-73.0, -2.0, 22.0],
                [-75.0, -31.0, 26.0],
                [-52.0, -49.0, 23.0],
                [-24.0, -73.0, 24.0],
                [1.0, -73.0, 21.0],
                [29.0, -71.0, 28.0],
                [52.0, -50.0, 27.0],
                [65.0, -28.0, 26.0],
                [84.0, 2.0, 25.0],
                [72.0, 34.0, 24.0],
                [59.0, 61.0, 27.0],
                [28.0, 74.0, 20.0],
                [-5.0, 81.0, 26.0],
                [-31.0, 80.0, 28.0],
                [-55.0, 55.0, 19.0],
                [-75.0, 31.0, 22.0],
                [-88.0, -3.0, 23.0],
                [-76.0, -28.0, 19.0],
                [-55.0, -61.0, 25.0],
                [-34.0, -74.0, 25.0],
                [2.0, -81.0, 26.0],
                [32.0, -77.0, 20.0],
                [56.0, -57.0, 25.0],
                [77.0, -36.0, 28.0],
                [93.0, -3.0, 25.0],
                [88.0, 33.0, 24.0],
                [61.0, 66.0, 27.0],
                [31.0, 88.0, 20.0],
                [3.0, 91.0, 26.0],
                [-34.0, 82.0, 23.0],
                [-68.0, 68.0, 25.0],
                [-85.0, 35.0, 26.0],
                [-94.0, 1.0, 27.0],
                [-83.0, -40.0, 25.0],
                [-65.0, -70.0, 20.0],
                [-40.0, -90.0, 25.0],
                [3.0, -94.0, 28.0],
                [30.0, -84.0, 19.0],
                [61.0, -66.0, 25.0],
                [81.0, -38.0, 28.0],
                [100.0, -2.0, 20.0],
                [95.0, 37.0, 23.0],
                [68.0, 66.0, 28.0],
                [39.0, 96.0, 27.0],
                [4.0, 99.0, 23.0],
                [-40.0, 97.0, 28.0],
                [-73.0, 71.0, 28.0],
                [-90.0, 33.0, 25.0],
                [-101.0, 0.0, 24.0],
                [-96.0, -43.0, 25.0],
                [-67.0, -69.0, 20.0],
                [-39.0, -92.0, 28.0],
                [-2.0, -98.0, 28.0],
                [38.0, -90.0, 22.0],
                [72.0, -67.0, 23.0],
                [96.0, -41.0, 27.0],
                [46.0, 4.0, 27.0],
                [48.0, 21.0, 27.0],
                [36.0, 33.0, 32.0],
                [19.0, 42.0, 36.0],
                [-5.0, 47.0, 31.0],
                [-22.0, 50.0, 32.0],
                [-38.0, 33.0, 29.0],
                [-48.0, 23.0, 27.0],
                [-49.0, -3.0, 29.0],
                [-47.0, -23.0, 31.0],
                [-37.0, -35.0, 28.0],
                [-20.0, -47.0, 30.0],
                [-5.0, -50.0, 30.0],
                [16.0, -46.0, 34.0],
                [38.0, -39.0, 34.0],
                [44.0, -15.0, 36.0],
                [54.0, -1.0, 34.0],
                [51.0, 27.0, 34.0],
                [45.0, 37.0, 34.0],
                [22.0, 55.0, 30.0],
                [1.0, 59.0, 27.0],
                [-27.0, 49.0, 35.0],
                [-44.0, 43.0, 36.0],
                [-49.0, 19.0, 27.0],
                [-60.0, 4.0, 36.0],
                [-50.0, -18.0, 27.0],
                [-40.0, -39.0, 34.0],
                [-19.0, -52.0, 28.0],
                [-4.0, -61.0, 33.0],
                [22.0, -58.0, 36.0],
                [36.0, -38.0, 27.0],
                [50.0, -22.0, 27.0],
                [66.0, -2.0, 27.0],
                [65.0, 21.0, 36.0],
                [43.0, 45.0, 28.0],
                [21.0, 60.0, 34.0],
                [1.0, 67.0, 30.0],
                [-21.0, 60.0, 32.0],
                [-43.0, 43.0, 28.0],
                [-62.0, 28.0, 31.0],
                [-66.0, -5.0, 28.0],
                [-59.0, -24.0, 28.0],
                [-45.0, -51.0, 28.0],
                [-26.0, -57.0, 30.0],
                [-1.0, -64.0, 35.0],
                [25.0, -64.0, 33.0],
                [47.0, -50.0, 35.0],
                [56.0, -29.0, 36.0],
                [77.0, -1.0, 31.0],
                [66.0, 31.0, 36.0],
                [50.0, 51.0, 32.0],
                [32.0, 65.0, 33.0],
                [0.0, 77.0, 29.0],
                [-29.0, 69.0, 34.0],
                [-51.0, 57.0, 27.0],
                [-66.0, 25.0, 35.0],
                [-79.0, -4.0, 30.0],
                [-74.0, -31.0, 35.0],
                [-52.0, -52.0, 36.0],
                [-32.0, -66.0, 36.0],
                [-2.0, -73.0, 35.0],
                [29.0, -67.0, 36.0],
                [56.0, -52.0, 31.0],
                [71.0, -26.0, 34.0],
                [78.0, -5.0, 28.0],
                [81.0, 28.0, 29.0],
                [55.0, 58.0, 30.0],
                [30.0, 73.0, 30.0],
                [-1.0, 88.0, 34.0],
                [-33.0, 81.0, 30.0],
                [-63.0, 55.0, 36.0],
                [-73.0, 35.0, 31.0],
                [-83.0, 3.0, 34.0],
                [-77.0, -37.0, 35.0],
                [-62.0, -62.0, 30.0],
                [-31.0, -80.0, 29.0],
                [1.0, -87.0, 29.0],
                [31.0, -78.0, 33.0],
                [61.0, -59.0, 27.0],
                [80.0, -35.0, 29.0],
                [96.0, -2.0, 33.0],
                [87.0, 33.0, 30.0],
                [65.0, 67.0, 36.0],
                [31.0, 86.0, 31.0],
                [3.0, 96.0, 32.0],
                [-35.0, 89.0, 28.0],
                [-62.0, 67.0, 35.0],
                [-83.0, 32.0, 31.0],
                [-88.0, 2.0, 27.0],
                [-80.0, -34.0, 33.0],
                [-62.0, -66.0, 30.0],
                [-31.0, -90.0, 30.0],
                [3.0, -87.0, 30.0],
                [38.0, -84.0, 28.0],
                [67.0, -64.0, 32.0],
                [82.0, -37.0, 28.0],
                [98.0, -5.0, 30.0],
                [93.0, 34.0, 29.0],
                [73.0, 71.0, 33.0],
                [36.0, 95.0, 30.0],
                [0.0, 95.0, 28.0],
                [-34.0, 94.0, 36.0],
                [-75.0, 74.0, 35.0],
                [-97.0, 41.0, 35.0],
                [-97.0, 1.0, 29.0],
                [-95.0, -34.0, 32.0],
                [-71.0, -70.0, 35.0],
                [-41.0, -93.0, 28.0],
                [-1.0, -97.0, 36.0],
                [33.0, -90.0, 35.0],
                [65.0, -68.0, 32.0],
                [90.0, -39.0, 35.0],
                [46.0, 0.0, 39.0],
                [44.0, 21.0, 41.0],
                [33.0, 37.0, 37.0],
                [23.0, 47.0, 39.0],
                [2.0, 54.0, 44.0],
                [-17.0, 42.0, 40.0],
                [-40.0, 35.0, 35.0],
                [-51.0, 14.0, 40.0],
                [-51.0, 4.0, 42.0],
                [-42.0, -23.0, 35.0],
                [-33.0, -39.0, 43.0],
                [-21.0, -45.0, 35.0],
                [-1.0, -55.0, 36.0],
                [21.0, -43.0, 37.0],
                [33.0, -38.0, 37.0],
                [44.0, -20.0, 41.0],
                [59.0, 0.0, 36.0],
                [55.0, 26.0, 40.0],
                [45.0, 43.0, 42.0],
                [23.0, 50.0, 40.0],
                [-4.0, 55.0, 39.0],
                [-24.0, 56.0, 41.0],
                [-39.0, 37.0, 35.0],
                [-58.0, 27.0, 44.0],
                [-60.0, -5.0, 42.0],
                [-52.0, -22.0, 37.0],
                [-38.0, -42.0, 41.0],
                [-23.0, -50.0, 40.0],
                [-4.0, -59.0, 41.0],
                [22.0, -54.0, 40.0],
                [38.0, -46.0, 43.0],
                [50.0, -20.0, 35.0],
                [68.0, -4.0, 40.0],
                [60.0, 20.0, 39.0],
                [50.0, 47.0, 41.0],
                [28.0, 65.0, 35.0],
                [-2.0, 68.0, 40.0],
                [-29.0, 57.0, 37.0],
                [-44.0, 46.0, 40.0],
                [-66.0, 24.0, 35.0],
                [-63.0, -1.0, 41.0],
                [-64.0, -31.0, 44.0],
                [-45.0, -50.0, 36.0],
                [-26.0, -59.0, 43.0],
                [-2.0, -69.0, 36.0],
                [28.0, -61.0, 36.0],
                [51.0, -44.0, 35.0],
                [63.0, -26.0, 35.0],
                [79.0, 3.0, 42.0],
                [65.0, 33.0, 37.0],
                [51.0, 50.0, 42.0],
                [24.0, 69.0, 40.0],
                [-3.0, 78.0, 36.0],
                [-28.0, 64.0, 39.0],
                [-51.0, 49.0, 41.0],
                [-74.0, 26.0, 35.0],
                [-71.0, -2.0, 41.0],
                [-68.0, -26.0, 36.0],
                [-56.0, -52.0, 42.0],
                [-27.0, -73.0, 37.0],
                [-4.0, -80.0, 44.0],
                [29.0, -70.0, 44.0],
                [50.0, -57.0, 41.0],
                [67.0, -28.0, 40.0],
                [87.0, 3.0, 38.0],
                [74.0, 32.0, 37.0],
                [63.0, 58.0, 39.0],
                [32.0, 75.0, 43.0],
                [2.0, 79.0, 37.0],
                [-30.0, 75.0, 42.0],
                [-61.0, 63.0, 42.0],
                [-80.0, 32.0, 37.0],
                [-86.0, -4.0, 39.0],
                [-74.0, -31.0, 38.0],
                [-57.0, -55.0, 42.0],
                [-35.0, -77.0, 37.0],
                [-5.0, -84.0, 43.0],
                [29.0, -73.0, 36.0],
                [58.0, -56.0, 42.0],
                [76.0, -29.0, 38.0],
                [90.0, 2.0, 40.0],
                [81.0, 31.0, 43.0],
                [60.0, 60.0, 44.0],
                [33.0, 84.0, 39.0],
                [3.0, 93.0, 39.0],
                [-32.0, 83.0, 43.0],
                [-65.0, 61.0, 43.0],
                [-83.0, 31.0, 44.0],
                [-95.0, -3.0, 41.0],
                [-81.0, -38.0, 39.0],
                [-70.0, -62.0, 37.0],
                [-35.0, -81.0, 44.0],
                [-5.0, -95.0, 35.0],
                [30.0, -81.0, 39.0],
                [64.0, -66.0, 43.0],
                [85.0, -39.0, 35.0],
                [96.0, -4.0, 35.0],
                [94.0, 34.0, 38.0],
                [73.0, 73.0, 36.0],
                [40.0, 95.0, 39.0],
                [4.0, 101.0, 39.0],
                [-42.0, 92.0, 41.0],
                [-70.0, 72.0, 39.0],
                [-91.0, 42.0, 40.0],
                [-101.0, 1.0, 44.0],
                [-95.0, -39.0, 38.0],
                [-70.0, -69.0, 42.0],
                [-39.0, -96.0, 38.0],
                [2.0, -98.0, 39.0],
                [36.0, -92.0, 37.0],
                [69.0, -74.0, 38.0],
                [95.0, -37.0, 41.0],
            ]
        )
        basis0 = BSplineBasis(
            7,
            np.array(
                [
                    -2.4,
                    -1.4,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.6,
                    2.2,
                    2.8,
                    4.1,
                    4.6,
                    6.0,
                    7.3,
                    8.1,
                    8.8,
                    9.6,
                    10.6,
                    12.0,
                    12.0,
                    12.0,
                    12.0,
                    12.0,
                    12.6,
                    14.2,
                ]
            ),
            1,
        )
        basis1 = BSplineBasis(6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0]))
        basis2 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 2.0, 2.0, 2.0, 2.0, 2.0]))
        vol: SplineObject = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2 = vol.get_derivative_spline(0)
        self.assertEqual(vol2.order(direction=0), 6)
        self.assertEqual(vol2.order(direction=1), 6)
        self.assertEqual(vol2.order(direction=2), 5)
        vol3 = vol.get_derivative_spline(1)
        self.assertEqual(vol3.order(direction=0), 7)
        self.assertEqual(vol3.order(direction=1), 5)
        self.assertEqual(vol3.order(direction=2), 5)
        vol4 = vol.get_derivative_spline(2)
        self.assertEqual(vol4.order(direction=0), 7)
        self.assertEqual(vol4.order(direction=1), 6)
        self.assertEqual(vol4.order(direction=2), 4)

        u = np.linspace(vol.start(0), vol.end(0), 5)
        v = np.linspace(vol.start(1), vol.end(1), 5)
        w = np.linspace(vol.start(2), vol.end(2), 5)
        du = vol.derivative(u, v, w, d=(1, 0, 0))
        du2 = vol2(u, v, w)
        dv = vol.derivative(u, v, w, d=(0, 1, 0))
        dv2 = vol3(u, v, w)
        dw = vol.derivative(u, v, w, d=(0, 0, 1))
        dw2 = vol4(u, v, w)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dw - dw2)), 0.0)

    def test_curve_3D_p6_C2_periodic(self) -> None:
        controlpoints = np.array(
            [
                [102.0, 0.0, -5.0],
                [89.0, 33.0, -5.0],
                [75.0, 66.0, 4.0],
                [40.0, 91.0, 3.0],
                [-4.0, 103.0, -4.0],
                [-40.0, 91.0, -4.0],
                [-68.0, 73.0, -1.0],
                [-90.0, 37.0, 0.0],
                [-105.0, 1.0, 4.0],
                [-93.0, -40.0, 1.0],
                [-75.0, -69.0, -5.0],
                [-35.0, -94.0, 1.0],
                [4.0, -105.0, 0.0],
                [35.0, -95.0, 3.0],
                [70.0, -73.0, -3.0],
                [91.0, -40.0, -1.0],
            ]
        )
        basis0 = BSplineBasis(
            6,
            np.array(
                [
                    -2.8,
                    -2.4,
                    -1.4,
                    0.0,
                    0.0,
                    0.0,
                    1.0,
                    2.1,
                    3.1,
                    4.3,
                    5.4,
                    6.0,
                    7.3,
                    7.7,
                    9.1,
                    10.3,
                    11.2,
                    11.6,
                    12.6,
                    14.0,
                    14.0,
                    14.0,
                    15.0,
                    16.1,
                    17.1,
                ]
            ),
            2,
        )
        crv: SplineObject = Curve(basis0, controlpoints, False)
        crv2 = crv.clone()
        crv2 = crv.get_derivative_spline(0)
        self.assertEqual(crv2.order(direction=0), 5)

        u = np.linspace(crv.start(0), crv.end(0), 11)
        du = crv.derivative(u)
        du2 = crv2(u)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)

    def test_surface_3D_p56_C2_periodic(self) -> None:
        controlpoints = np.array(
            [
                [63.0, -2.0, 0.0],
                [56.0, 26.0, -2.0],
                [35.0, 47.0, -3.0],
                [16.0, 59.0, -1.0],
                [-13.0, 62.0, 2.0],
                [-35.0, 47.0, 2.0],
                [-50.0, 21.0, -2.0],
                [-58.0, 0.0, -2.0],
                [-54.0, -31.0, -3.0],
                [-40.0, -46.0, 4.0],
                [-14.0, -61.0, 4.0],
                [13.0, -61.0, -3.0],
                [34.0, -52.0, -2.0],
                [56.0, -26.0, 0.0],
                [64.0, 4.0, -5.0],
                [55.0, 26.0, -2.0],
                [44.0, 56.0, -3.0],
                [11.0, 69.0, -1.0],
                [-15.0, 69.0, -2.0],
                [-43.0, 48.0, -3.0],
                [-57.0, 29.0, -3.0],
                [-72.0, 3.0, -5.0],
                [-62.0, -33.0, -5.0],
                [-44.0, -51.0, 4.0],
                [-13.0, -63.0, 4.0],
                [14.0, -61.0, 1.0],
                [39.0, -52.0, -2.0],
                [62.0, -32.0, -2.0],
                [78.0, -1.0, -2.0],
                [67.0, 29.0, -2.0],
                [45.0, 56.0, 4.0],
                [18.0, 74.0, -2.0],
                [-12.0, 72.0, -3.0],
                [-49.0, 59.0, -2.0],
                [-62.0, 35.0, -4.0],
                [-76.0, 3.0, -5.0],
                [-65.0, -29.0, 1.0],
                [-42.0, -60.0, -2.0],
                [-17.0, -69.0, -2.0],
                [16.0, -77.0, 2.0],
                [41.0, -57.0, 2.0],
                [70.0, -33.0, -2.0],
                [80.0, -2.0, 4.0],
                [71.0, 34.0, 1.0],
                [49.0, 67.0, 0.0],
                [19.0, 76.0, -4.0],
                [-21.0, 79.0, -3.0],
                [-53.0, 61.0, 3.0],
                [-75.0, 38.0, 3.0],
                [-82.0, -3.0, -5.0],
                [-68.0, -38.0, 0.0],
                [-54.0, -59.0, 0.0],
                [-18.0, -80.0, -3.0],
                [21.0, -76.0, -2.0],
                [50.0, -61.0, -1.0],
                [69.0, -33.0, -5.0],
                [86.0, -5.0, -4.0],
                [82.0, 39.0, 0.0],
                [55.0, 64.0, 1.0],
                [20.0, 80.0, -4.0],
                [-19.0, 81.0, -2.0],
                [-52.0, 65.0, -2.0],
                [-81.0, 32.0, -2.0],
                [-91.0, -3.0, -2.0],
                [-82.0, -39.0, 0.0],
                [-59.0, -68.0, 1.0],
                [-21.0, -82.0, 0.0],
                [19.0, -90.0, 0.0],
                [55.0, -68.0, 2.0],
                [77.0, -34.0, -1.0],
                [95.0, -4.0, 3.0],
                [87.0, 40.0, -4.0],
                [59.0, 75.0, -5.0],
                [19.0, 94.0, -4.0],
                [-24.0, 95.0, -3.0],
                [-61.0, 74.0, 2.0],
                [-84.0, 44.0, 1.0],
                [-95.0, 1.0, -5.0],
                [-82.0, -42.0, -1.0],
                [-61.0, -76.0, -2.0],
                [-18.0, -93.0, 0.0],
                [22.0, -91.0, 0.0],
                [54.0, -76.0, 1.0],
                [88.0, -42.0, -4.0],
                [103.0, -1.0, -1.0],
                [87.0, 47.0, -2.0],
                [66.0, 77.0, 1.0],
                [26.0, 95.0, -1.0],
                [-24.0, 99.0, 4.0],
                [-64.0, 80.0, 2.0],
                [-87.0, 45.0, 0.0],
                [-105.0, -2.0, 3.0],
                [-86.0, -40.0, 0.0],
                [-65.0, -81.0, 2.0],
                [-21.0, -97.0, 4.0],
                [24.0, -95.0, 3.0],
                [58.0, -82.0, 4.0],
                [89.0, -46.0, -3.0],
            ]
        )
        basis0 = BSplineBasis(
            5,
            np.array(
                [
                    -3.2,
                    -1.8,
                    -0.6,
                    0.0,
                    0.0,
                    1.4,
                    2.2,
                    3.2,
                    3.8,
                    4.8,
                    5.9,
                    7.0,
                    7.8,
                    8.7,
                    9.8,
                    11.2,
                    12.4,
                    13.0,
                    13.0,
                    14.4,
                    15.2,
                    16.2,
                ]
            ),
            2,
        )
        basis1 = BSplineBasis(6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0]))
        surf: SplineObject = Surface(basis0, basis1, controlpoints, False)
        surf2 = surf.clone()
        surf2 = surf.get_derivative_spline(0)
        self.assertEqual(surf2.order(direction=0), 4)
        self.assertEqual(surf2.order(direction=1), 6)
        surf3 = surf.get_derivative_spline(1)
        self.assertEqual(surf3.order(direction=0), 5)
        self.assertEqual(surf3.order(direction=1), 5)

        u = np.linspace(surf.start(0), surf.end(0), 7)
        v = np.linspace(surf.start(1), surf.end(1), 7)
        du = surf.derivative(u, v, d=(1, 0))
        du2 = surf2(u, v)
        dv = surf.derivative(u, v, d=(0, 1))
        dv2 = surf3(u, v)

        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)

    def test_volume_3D_p565_C2_periodic(self) -> None:
        controlpoints = np.array(
            [
                [54.0, 2.0, -1.0],
                [41.0, 18.0, 2.0],
                [29.0, 37.0, -5.0],
                [6.0, 49.0, -5.0],
                [-12.0, 46.0, -2.0],
                [-32.0, 40.0, -2.0],
                [-44.0, 20.0, 4.0],
                [-51.0, -1.0, 1.0],
                [-43.0, -26.0, -2.0],
                [-36.0, -39.0, -4.0],
                [-9.0, -47.0, 4.0],
                [7.0, -45.0, -2.0],
                [32.0, -37.0, 1.0],
                [40.0, -22.0, -4.0],
                [60.0, -1.0, -5.0],
                [50.0, 23.0, -2.0],
                [35.0, 48.0, 2.0],
                [13.0, 52.0, -3.0],
                [-9.0, 56.0, -1.0],
                [-35.0, 45.0, 2.0],
                [-55.0, 22.0, -5.0],
                [-58.0, 0.0, 1.0],
                [-49.0, -27.0, -5.0],
                [-34.0, -43.0, 1.0],
                [-12.0, -58.0, 1.0],
                [13.0, -60.0, -1.0],
                [36.0, -43.0, 3.0],
                [48.0, -21.0, -1.0],
                [64.0, -5.0, -2.0],
                [56.0, 29.0, 0.0],
                [41.0, 48.0, -3.0],
                [19.0, 66.0, -4.0],
                [-16.0, 62.0, -5.0],
                [-40.0, 53.0, -3.0],
                [-64.0, 33.0, -3.0],
                [-67.0, 4.0, 4.0],
                [-65.0, -29.0, 4.0],
                [-46.0, -54.0, 1.0],
                [-19.0, -65.0, 4.0],
                [15.0, -69.0, 3.0],
                [42.0, -51.0, -5.0],
                [62.0, -27.0, 4.0],
                [72.0, -2.0, -2.0],
                [64.0, 32.0, -1.0],
                [47.0, 54.0, -2.0],
                [12.0, 77.0, 3.0],
                [-14.0, 75.0, 2.0],
                [-43.0, 57.0, -4.0],
                [-72.0, 33.0, 1.0],
                [-79.0, -2.0, 1.0],
                [-66.0, -36.0, -4.0],
                [-50.0, -61.0, 3.0],
                [-21.0, -74.0, -3.0],
                [12.0, -69.0, 2.0],
                [49.0, -59.0, -1.0],
                [65.0, -33.0, -5.0],
                [81.0, -1.0, 1.0],
                [73.0, 37.0, 2.0],
                [52.0, 63.0, -4.0],
                [17.0, 77.0, -1.0],
                [-21.0, 77.0, -3.0],
                [-56.0, 66.0, -1.0],
                [-79.0, 40.0, 1.0],
                [-79.0, 2.0, -1.0],
                [-75.0, -40.0, -2.0],
                [-54.0, -69.0, 4.0],
                [-16.0, -81.0, -1.0],
                [16.0, -81.0, 0.0],
                [50.0, -70.0, 3.0],
                [70.0, -35.0, -3.0],
                [93.0, 2.0, -1.0],
                [79.0, 42.0, -1.0],
                [59.0, 74.0, 0.0],
                [19.0, 89.0, -2.0],
                [-24.0, 86.0, -3.0],
                [-60.0, 73.0, -2.0],
                [-88.0, 38.0, 4.0],
                [-90.0, -2.0, -2.0],
                [-86.0, -40.0, 3.0],
                [-61.0, -76.0, 2.0],
                [-24.0, -90.0, -3.0],
                [23.0, -91.0, 1.0],
                [58.0, -70.0, 3.0],
                [78.0, -44.0, -2.0],
                [101.0, -5.0, -5.0],
                [88.0, 39.0, -1.0],
                [61.0, 74.0, -3.0],
                [25.0, 93.0, 1.0],
                [-18.0, 99.0, -4.0],
                [-67.0, 77.0, -2.0],
                [-90.0, 45.0, 4.0],
                [-96.0, 4.0, -3.0],
                [-95.0, -40.0, -3.0],
                [-61.0, -78.0, -3.0],
                [-20.0, -97.0, 1.0],
                [24.0, -101.0, -5.0],
                [64.0, -76.0, 1.0],
                [93.0, -45.0, -4.0],
                [53.0, 1.0, 5.0],
                [47.0, 24.0, 9.0],
                [30.0, 40.0, 3.0],
                [12.0, 44.0, 8.0],
                [-7.0, 51.0, 6.0],
                [-29.0, 35.0, 7.0],
                [-48.0, 23.0, 3.0],
                [-49.0, 1.0, 8.0],
                [-43.0, -27.0, 3.0],
                [-32.0, -37.0, 3.0],
                [-16.0, -51.0, 4.0],
                [13.0, -48.0, 11.0],
                [28.0, -44.0, 4.0],
                [47.0, -21.0, 9.0],
                [59.0, 2.0, 8.0],
                [51.0, 27.0, 4.0],
                [32.0, 49.0, 6.0],
                [17.0, 58.0, 8.0],
                [-13.0, 54.0, 8.0],
                [-42.0, 45.0, 3.0],
                [-58.0, 24.0, 5.0],
                [-62.0, 0.0, 11.0],
                [-54.0, -26.0, 9.0],
                [-41.0, -48.0, 5.0],
                [-11.0, -56.0, 5.0],
                [16.0, -60.0, 8.0],
                [36.0, -45.0, 3.0],
                [57.0, -25.0, 5.0],
                [63.0, 1.0, 11.0],
                [64.0, 24.0, 2.0],
                [45.0, 55.0, 6.0],
                [16.0, 66.0, 2.0],
                [-20.0, 66.0, 6.0],
                [-42.0, 47.0, 3.0],
                [-60.0, 27.0, 6.0],
                [-70.0, 1.0, 9.0],
                [-60.0, -32.0, 2.0],
                [-40.0, -52.0, 4.0],
                [-19.0, -66.0, 4.0],
                [16.0, -66.0, 3.0],
                [39.0, -57.0, 9.0],
                [59.0, -30.0, 4.0],
                [72.0, 4.0, 7.0],
                [68.0, 29.0, 7.0],
                [45.0, 62.0, 7.0],
                [17.0, 72.0, 2.0],
                [-12.0, 73.0, 8.0],
                [-48.0, 54.0, 9.0],
                [-63.0, 32.0, 2.0],
                [-79.0, 1.0, 6.0],
                [-69.0, -28.0, 5.0],
                [-46.0, -62.0, 8.0],
                [-14.0, -74.0, 6.0],
                [20.0, -77.0, 2.0],
                [51.0, -62.0, 5.0],
                [69.0, -34.0, 3.0],
                [85.0, 0.0, 6.0],
                [76.0, 35.0, 2.0],
                [55.0, 66.0, 3.0],
                [18.0, 81.0, 10.0],
                [-18.0, 82.0, 2.0],
                [-51.0, 67.0, 4.0],
                [-78.0, 33.0, 11.0],
                [-83.0, 2.0, 4.0],
                [-78.0, -39.0, 9.0],
                [-51.0, -66.0, 6.0],
                [-21.0, -84.0, 8.0],
                [21.0, -83.0, 11.0],
                [49.0, -62.0, 7.0],
                [70.0, -38.0, 11.0],
                [94.0, 2.0, 5.0],
                [80.0, 44.0, 3.0],
                [60.0, 69.0, 11.0],
                [16.0, 87.0, 9.0],
                [-20.0, 85.0, 5.0],
                [-62.0, 75.0, 2.0],
                [-82.0, 41.0, 4.0],
                [-90.0, -1.0, 10.0],
                [-88.0, -38.0, 6.0],
                [-60.0, -74.0, 5.0],
                [-21.0, -88.0, 6.0],
                [21.0, -92.0, 10.0],
                [59.0, -75.0, 11.0],
                [79.0, -43.0, 2.0],
                [96.0, 4.0, 8.0],
                [87.0, 38.0, 10.0],
                [65.0, 83.0, 1.0],
                [19.0, 96.0, 5.0],
                [-23.0, 99.0, 6.0],
                [-63.0, 78.0, 2.0],
                [-86.0, 39.0, 5.0],
                [-104.0, 2.0, 7.0],
                [-86.0, -46.0, 3.0],
                [-59.0, -74.0, 5.0],
                [-27.0, -96.0, 4.0],
                [19.0, -98.0, 3.0],
                [59.0, -75.0, 6.0],
                [88.0, -48.0, 10.0],
                [52.0, -5.0, 12.0],
                [44.0, 16.0, 13.0],
                [33.0, 38.0, 8.0],
                [6.0, 47.0, 15.0],
                [-11.0, 49.0, 17.0],
                [-29.0, 39.0, 13.0],
                [-43.0, 17.0, 8.0],
                [-50.0, -2.0, 17.0],
                [-45.0, -24.0, 13.0],
                [-31.0, -38.0, 15.0],
                [-15.0, -48.0, 17.0],
                [15.0, -50.0, 12.0],
                [28.0, -35.0, 11.0],
                [42.0, -20.0, 17.0],
                [58.0, 1.0, 15.0],
                [56.0, 23.0, 18.0],
                [38.0, 45.0, 17.0],
                [16.0, 54.0, 10.0],
                [-9.0, 52.0, 10.0],
                [-33.0, 42.0, 13.0],
                [-50.0, 26.0, 15.0],
                [-62.0, 2.0, 13.0],
                [-48.0, -25.0, 17.0],
                [-37.0, -47.0, 15.0],
                [-9.0, -61.0, 17.0],
                [16.0, -56.0, 10.0],
                [40.0, -43.0, 16.0],
                [50.0, -22.0, 14.0],
                [68.0, 0.0, 12.0],
                [62.0, 30.0, 10.0],
                [42.0, 51.0, 18.0],
                [15.0, 65.0, 10.0],
                [-16.0, 66.0, 17.0],
                [-44.0, 50.0, 16.0],
                [-64.0, 30.0, 9.0],
                [-67.0, 1.0, 10.0],
                [-64.0, -34.0, 15.0],
                [-41.0, -53.0, 10.0],
                [-12.0, -70.0, 15.0],
                [9.0, -69.0, 14.0],
                [36.0, -54.0, 10.0],
                [60.0, -27.0, 16.0],
                [79.0, 3.0, 15.0],
                [65.0, 33.0, 10.0],
                [43.0, 61.0, 13.0],
                [15.0, 73.0, 13.0],
                [-13.0, 69.0, 11.0],
                [-45.0, 59.0, 16.0],
                [-64.0, 28.0, 18.0],
                [-77.0, -3.0, 12.0],
                [-66.0, -31.0, 14.0],
                [-45.0, -57.0, 13.0],
                [-15.0, -70.0, 14.0],
                [20.0, -70.0, 14.0],
                [43.0, -59.0, 15.0],
                [64.0, -35.0, 15.0],
                [79.0, 3.0, 13.0],
                [71.0, 37.0, 9.0],
                [52.0, 68.0, 14.0],
                [13.0, 80.0, 11.0],
                [-18.0, 82.0, 11.0],
                [-52.0, 65.0, 17.0],
                [-80.0, 38.0, 17.0],
                [-79.0, 2.0, 9.0],
                [-77.0, -39.0, 11.0],
                [-57.0, -67.0, 12.0],
                [-21.0, -82.0, 11.0],
                [14.0, -82.0, 10.0],
                [52.0, -65.0, 12.0],
                [70.0, -40.0, 13.0],
                [91.0, 4.0, 10.0],
                [78.0, 38.0, 15.0],
                [58.0, 74.0, 8.0],
                [20.0, 89.0, 11.0],
                [-16.0, 84.0, 15.0],
                [-53.0, 75.0, 17.0],
                [-85.0, 39.0, 10.0],
                [-88.0, 0.0, 8.0],
                [-81.0, -45.0, 10.0],
                [-58.0, -72.0, 11.0],
                [-17.0, -92.0, 9.0],
                [16.0, -87.0, 15.0],
                [56.0, -67.0, 14.0],
                [81.0, -44.0, 11.0],
                [97.0, -1.0, 16.0],
                [88.0, 45.0, 8.0],
                [59.0, 79.0, 13.0],
                [18.0, 95.0, 13.0],
                [-26.0, 94.0, 10.0],
                [-61.0, 77.0, 14.0],
                [-89.0, 42.0, 16.0],
                [-98.0, -5.0, 12.0],
                [-86.0, -48.0, 15.0],
                [-65.0, -82.0, 15.0],
                [-27.0, -98.0, 16.0],
                [23.0, -94.0, 14.0],
                [61.0, -79.0, 13.0],
                [88.0, -49.0, 13.0],
                [54.0, -1.0, 23.0],
                [49.0, 16.0, 17.0],
                [33.0, 42.0, 17.0],
                [12.0, 45.0, 24.0],
                [-8.0, 53.0, 15.0],
                [-34.0, 35.0, 16.0],
                [-49.0, 21.0, 19.0],
                [-54.0, 0.0, 22.0],
                [-42.0, -19.0, 20.0],
                [-32.0, -44.0, 16.0],
                [-14.0, -48.0, 20.0],
                [7.0, -45.0, 24.0],
                [32.0, -38.0, 21.0],
                [43.0, -23.0, 23.0],
                [60.0, 4.0, 19.0],
                [47.0, 29.0, 22.0],
                [36.0, 50.0, 20.0],
                [8.0, 58.0, 22.0],
                [-12.0, 55.0, 15.0],
                [-40.0, 42.0, 22.0],
                [-56.0, 22.0, 15.0],
                [-55.0, -3.0, 23.0],
                [-51.0, -28.0, 18.0],
                [-37.0, -43.0, 21.0],
                [-16.0, -61.0, 24.0],
                [11.0, -58.0, 22.0],
                [39.0, -50.0, 21.0],
                [51.0, -29.0, 21.0],
                [70.0, 3.0, 21.0],
                [56.0, 29.0, 17.0],
                [46.0, 48.0, 21.0],
                [17.0, 63.0, 18.0],
                [-18.0, 64.0, 24.0],
                [-42.0, 56.0, 24.0],
                [-64.0, 26.0, 15.0],
                [-71.0, 4.0, 15.0],
                [-62.0, -33.0, 19.0],
                [-39.0, -51.0, 17.0],
                [-11.0, -64.0, 22.0],
                [12.0, -67.0, 18.0],
                [41.0, -51.0, 16.0],
                [63.0, -31.0, 20.0],
                [79.0, 1.0, 19.0],
                [67.0, 37.0, 22.0],
                [43.0, 63.0, 16.0],
                [19.0, 77.0, 16.0],
                [-18.0, 77.0, 19.0],
                [-44.0, 59.0, 16.0],
                [-70.0, 31.0, 21.0],
                [-75.0, -3.0, 22.0],
                [-71.0, -32.0, 24.0],
                [-43.0, -55.0, 20.0],
                [-20.0, -72.0, 17.0],
                [17.0, -74.0, 23.0],
                [42.0, -61.0, 15.0],
                [70.0, -28.0, 20.0],
                [83.0, 3.0, 15.0],
                [79.0, 37.0, 22.0],
                [56.0, 62.0, 15.0],
                [19.0, 80.0, 16.0],
                [-17.0, 78.0, 23.0],
                [-52.0, 67.0, 21.0],
                [-73.0, 31.0, 22.0],
                [-89.0, -2.0, 15.0],
                [-79.0, -34.0, 17.0],
                [-54.0, -68.0, 15.0],
                [-15.0, -83.0, 24.0],
                [18.0, -79.0, 24.0],
                [55.0, -67.0, 16.0],
                [71.0, -35.0, 15.0],
                [93.0, -1.0, 22.0],
                [79.0, 39.0, 15.0],
                [56.0, 70.0, 23.0],
                [16.0, 90.0, 18.0],
                [-23.0, 88.0, 16.0],
                [-59.0, 67.0, 21.0],
                [-79.0, 43.0, 18.0],
                [-91.0, -2.0, 16.0],
                [-79.0, -42.0, 21.0],
                [-63.0, -67.0, 20.0],
                [-21.0, -88.0, 23.0],
                [18.0, -91.0, 16.0],
                [61.0, -76.0, 18.0],
                [86.0, -44.0, 24.0],
                [96.0, 1.0, 15.0],
                [88.0, 38.0, 16.0],
                [58.0, 77.0, 20.0],
                [25.0, 99.0, 24.0],
                [-26.0, 95.0, 24.0],
                [-63.0, 81.0, 20.0],
                [-90.0, 45.0, 19.0],
                [-105.0, -1.0, 21.0],
                [-89.0, -48.0, 19.0],
                [-62.0, -75.0, 23.0],
                [-25.0, -99.0, 15.0],
                [26.0, -100.0, 23.0],
                [61.0, -83.0, 24.0],
                [94.0, -40.0, 15.0],
                [50.0, -3.0, 31.0],
                [49.0, 24.0, 23.0],
                [26.0, 37.0, 25.0],
                [7.0, 50.0, 27.0],
                [-7.0, 51.0, 26.0],
                [-35.0, 42.0, 26.0],
                [-42.0, 23.0, 24.0],
                [-53.0, 3.0, 22.0],
                [-41.0, -27.0, 29.0],
                [-34.0, -43.0, 30.0],
                [-12.0, -52.0, 26.0],
                [12.0, -47.0, 25.0],
                [29.0, -37.0, 27.0],
                [41.0, -17.0, 30.0],
                [60.0, 1.0, 28.0],
                [52.0, 24.0, 29.0],
                [31.0, 42.0, 23.0],
                [8.0, 57.0, 23.0],
                [-12.0, 58.0, 28.0],
                [-34.0, 44.0, 29.0],
                [-54.0, 28.0, 30.0],
                [-62.0, -3.0, 25.0],
                [-58.0, -22.0, 25.0],
                [-35.0, -46.0, 24.0],
                [-17.0, -57.0, 26.0],
                [12.0, -58.0, 29.0],
                [39.0, -46.0, 29.0],
                [54.0, -24.0, 30.0],
                [62.0, 4.0, 23.0],
                [62.0, 24.0, 26.0],
                [38.0, 56.0, 27.0],
                [14.0, 67.0, 24.0],
                [-12.0, 63.0, 22.0],
                [-44.0, 50.0, 31.0],
                [-58.0, 28.0, 23.0],
                [-71.0, 2.0, 26.0],
                [-62.0, -29.0, 26.0],
                [-42.0, -48.0, 25.0],
                [-14.0, -64.0, 25.0],
                [11.0, -61.0, 23.0],
                [46.0, -55.0, 27.0],
                [64.0, -26.0, 26.0],
                [73.0, -5.0, 28.0],
                [70.0, 35.0, 23.0],
                [51.0, 55.0, 31.0],
                [20.0, 73.0, 24.0],
                [-14.0, 73.0, 31.0],
                [-47.0, 61.0, 30.0],
                [-66.0, 35.0, 28.0],
                [-76.0, -5.0, 25.0],
                [-72.0, -32.0, 23.0],
                [-51.0, -57.0, 26.0],
                [-14.0, -70.0, 26.0],
                [13.0, -70.0, 25.0],
                [46.0, -58.0, 23.0],
                [65.0, -31.0, 25.0],
                [82.0, 1.0, 30.0],
                [76.0, 37.0, 22.0],
                [54.0, 63.0, 27.0],
                [14.0, 78.0, 26.0],
                [-15.0, 79.0, 22.0],
                [-56.0, 69.0, 25.0],
                [-78.0, 37.0, 27.0],
                [-86.0, 0.0, 30.0],
                [-72.0, -42.0, 29.0],
                [-51.0, -61.0, 24.0],
                [-17.0, -82.0, 25.0],
                [14.0, -79.0, 24.0],
                [52.0, -67.0, 31.0],
                [73.0, -39.0, 27.0],
                [92.0, 1.0, 26.0],
                [86.0, 41.0, 25.0],
                [59.0, 69.0, 31.0],
                [22.0, 92.0, 27.0],
                [-21.0, 85.0, 29.0],
                [-55.0, 72.0, 23.0],
                [-81.0, 43.0, 23.0],
                [-94.0, -2.0, 25.0],
                [-86.0, -39.0, 24.0],
                [-55.0, -72.0, 25.0],
                [-17.0, -90.0, 22.0],
                [15.0, -88.0, 23.0],
                [56.0, -75.0, 29.0],
                [87.0, -36.0, 21.0],
                [100.0, -3.0, 30.0],
                [89.0, 45.0, 31.0],
                [58.0, 80.0, 27.0],
                [26.0, 94.0, 24.0],
                [-22.0, 93.0, 29.0],
                [-66.0, 77.0, 25.0],
                [-93.0, 41.0, 23.0],
                [-102.0, 4.0, 27.0],
                [-90.0, -39.0, 30.0],
                [-59.0, -77.0, 23.0],
                [-25.0, -102.0, 27.0],
                [26.0, -103.0, 24.0],
                [65.0, -76.0, 28.0],
                [93.0, -43.0, 23.0],
                [53.0, 1.0, 31.0],
                [45.0, 20.0, 33.0],
                [33.0, 34.0, 33.0],
                [11.0, 46.0, 31.0],
                [-15.0, 53.0, 28.0],
                [-28.0, 40.0, 35.0],
                [-45.0, 23.0, 30.0],
                [-52.0, -3.0, 33.0],
                [-50.0, -22.0, 29.0],
                [-34.0, -42.0, 31.0],
                [-14.0, -52.0, 30.0],
                [14.0, -54.0, 28.0],
                [34.0, -42.0, 37.0],
                [47.0, -20.0, 34.0],
                [55.0, 2.0, 31.0],
                [51.0, 25.0, 30.0],
                [32.0, 45.0, 29.0],
                [9.0, 54.0, 28.0],
                [-9.0, 54.0, 33.0],
                [-38.0, 49.0, 30.0],
                [-53.0, 25.0, 36.0],
                [-59.0, 3.0, 33.0],
                [-54.0, -23.0, 29.0],
                [-37.0, -42.0, 31.0],
                [-12.0, -58.0, 36.0],
                [14.0, -60.0, 35.0],
                [38.0, -47.0, 36.0],
                [52.0, -22.0, 32.0],
                [66.0, -5.0, 31.0],
                [60.0, 31.0, 34.0],
                [36.0, 51.0, 31.0],
                [14.0, 69.0, 32.0],
                [-14.0, 67.0, 34.0],
                [-42.0, 55.0, 29.0],
                [-60.0, 28.0, 35.0],
                [-69.0, -2.0, 37.0],
                [-64.0, -28.0, 29.0],
                [-44.0, -56.0, 29.0],
                [-20.0, -70.0, 33.0],
                [13.0, -66.0, 34.0],
                [39.0, -50.0, 33.0],
                [64.0, -25.0, 30.0],
                [74.0, 2.0, 33.0],
                [67.0, 33.0, 30.0],
                [46.0, 58.0, 32.0],
                [19.0, 76.0, 30.0],
                [-14.0, 69.0, 30.0],
                [-51.0, 61.0, 29.0],
                [-68.0, 28.0, 30.0],
                [-78.0, -4.0, 31.0],
                [-66.0, -36.0, 30.0],
                [-51.0, -62.0, 29.0],
                [-14.0, -72.0, 29.0],
                [13.0, -71.0, 31.0],
                [44.0, -59.0, 32.0],
                [70.0, -35.0, 37.0],
                [84.0, 0.0, 30.0],
                [77.0, 41.0, 34.0],
                [52.0, 62.0, 32.0],
                [14.0, 77.0, 34.0],
                [-17.0, 80.0, 31.0],
                [-52.0, 68.0, 32.0],
                [-76.0, 33.0, 36.0],
                [-83.0, -5.0, 32.0],
                [-75.0, -38.0, 30.0],
                [-56.0, -65.0, 34.0],
                [-14.0, -80.0, 32.0],
                [17.0, -79.0, 37.0],
                [53.0, -70.0, 37.0],
                [73.0, -37.0, 37.0],
                [89.0, -5.0, 35.0],
                [79.0, 35.0, 30.0],
                [57.0, 72.0, 29.0],
                [23.0, 94.0, 34.0],
                [-24.0, 86.0, 29.0],
                [-59.0, 75.0, 35.0],
                [-84.0, 40.0, 30.0],
                [-92.0, 3.0, 33.0],
                [-80.0, -45.0, 35.0],
                [-59.0, -74.0, 30.0],
                [-17.0, -87.0, 30.0],
                [18.0, -91.0, 32.0],
                [58.0, -76.0, 37.0],
                [84.0, -37.0, 29.0],
                [101.0, 0.0, 31.0],
                [89.0, 47.0, 33.0],
                [58.0, 82.0, 33.0],
                [21.0, 93.0, 35.0],
                [-24.0, 94.0, 34.0],
                [-62.0, 77.0, 36.0],
                [-90.0, 47.0, 28.0],
                [-98.0, 4.0, 36.0],
                [-95.0, -43.0, 36.0],
                [-65.0, -83.0, 33.0],
                [-26.0, -93.0, 32.0],
                [24.0, -93.0, 33.0],
                [61.0, -74.0, 37.0],
                [94.0, -46.0, 35.0],
                [54.0, 2.0, 35.0],
                [48.0, 26.0, 43.0],
                [30.0, 40.0, 41.0],
                [14.0, 50.0, 35.0],
                [-13.0, 45.0, 37.0],
                [-32.0, 43.0, 37.0],
                [-45.0, 22.0, 41.0],
                [-52.0, -1.0, 35.0],
                [-44.0, -24.0, 36.0],
                [-32.0, -39.0, 40.0],
                [-15.0, -47.0, 37.0],
                [14.0, -49.0, 42.0],
                [29.0, -42.0, 44.0],
                [42.0, -18.0, 39.0],
                [59.0, 3.0, 37.0],
                [47.0, 29.0, 42.0],
                [38.0, 49.0, 44.0],
                [8.0, 53.0, 43.0],
                [-12.0, 61.0, 39.0],
                [-38.0, 45.0, 43.0],
                [-51.0, 28.0, 44.0],
                [-63.0, 2.0, 44.0],
                [-53.0, -26.0, 39.0],
                [-36.0, -47.0, 43.0],
                [-17.0, -61.0, 39.0],
                [10.0, -53.0, 40.0],
                [38.0, -50.0, 37.0],
                [54.0, -22.0, 44.0],
                [61.0, 3.0, 41.0],
                [63.0, 25.0, 36.0],
                [36.0, 48.0, 39.0],
                [16.0, 65.0, 40.0],
                [-12.0, 62.0, 38.0],
                [-40.0, 52.0, 41.0],
                [-57.0, 33.0, 38.0],
                [-68.0, 2.0, 38.0],
                [-58.0, -28.0, 43.0],
                [-38.0, -51.0, 36.0],
                [-13.0, -64.0, 41.0],
                [11.0, -64.0, 42.0],
                [42.0, -50.0, 36.0],
                [55.0, -32.0, 36.0],
                [71.0, -5.0, 37.0],
                [64.0, 31.0, 35.0],
                [46.0, 54.0, 38.0],
                [20.0, 68.0, 42.0],
                [-12.0, 68.0, 35.0],
                [-52.0, 55.0, 43.0],
                [-64.0, 35.0, 44.0],
                [-77.0, 4.0, 44.0],
                [-67.0, -35.0, 41.0],
                [-47.0, -64.0, 37.0],
                [-22.0, -76.0, 39.0],
                [20.0, -79.0, 37.0],
                [48.0, -61.0, 44.0],
                [68.0, -29.0, 36.0],
                [84.0, 3.0, 35.0],
                [77.0, 39.0, 40.0],
                [54.0, 60.0, 43.0],
                [17.0, 82.0, 41.0],
                [-23.0, 83.0, 41.0],
                [-53.0, 60.0, 36.0],
                [-77.0, 36.0, 35.0],
                [-84.0, -1.0, 38.0],
                [-73.0, -40.0, 42.0],
                [-49.0, -66.0, 42.0],
                [-17.0, -82.0, 36.0],
                [21.0, -86.0, 42.0],
                [49.0, -64.0, 40.0],
                [78.0, -39.0, 39.0],
                [93.0, 1.0, 37.0],
                [86.0, 36.0, 41.0],
                [58.0, 70.0, 38.0],
                [15.0, 86.0, 37.0],
                [-24.0, 91.0, 43.0],
                [-62.0, 72.0, 39.0],
                [-81.0, 42.0, 38.0],
                [-95.0, 0.0, 38.0],
                [-80.0, -37.0, 35.0],
                [-59.0, -71.0, 40.0],
                [-18.0, -91.0, 41.0],
                [21.0, -95.0, 42.0],
                [60.0, -76.0, 35.0],
                [80.0, -37.0, 41.0],
                [98.0, 2.0, 36.0],
                [94.0, 47.0, 42.0],
                [64.0, 82.0, 41.0],
                [18.0, 92.0, 44.0],
                [-19.0, 102.0, 42.0],
                [-67.0, 76.0, 39.0],
                [-95.0, 43.0, 43.0],
                [-101.0, 0.0, 35.0],
                [-86.0, -42.0, 44.0],
                [-58.0, -82.0, 43.0],
                [-26.0, -101.0, 43.0],
                [22.0, -102.0, 35.0],
                [66.0, -84.0, 37.0],
                [90.0, -49.0, 36.0],
            ]
        )
        basis0 = BSplineBasis(
            5,
            np.array(
                [
                    -2.9,
                    -2.1,
                    -0.8,
                    0.0,
                    0.0,
                    1.2,
                    1.8,
                    2.6,
                    4.4,
                    5.0,
                    5.9,
                    7.4,
                    8.0,
                    9.2,
                    10.1,
                    10.9,
                    12.2,
                    13.0,
                    13.0,
                    14.2,
                    14.8,
                    15.6,
                ]
            ),
            2,
        )
        basis1 = BSplineBasis(6, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.2, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0]))
        basis2 = BSplineBasis(5, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 1.2, 1.9, 3.0, 3.0, 3.0, 3.0, 3.0]))
        vol: SplineObject = Volume(basis0, basis1, basis2, controlpoints, False)
        vol2 = vol.clone()
        vol2 = vol.get_derivative_spline(0)
        self.assertEqual(vol2.order(direction=0), 4)
        self.assertEqual(vol2.order(direction=1), 6)
        self.assertEqual(vol2.order(direction=2), 5)
        vol3 = vol.get_derivative_spline(1)
        self.assertEqual(vol3.order(direction=0), 5)
        self.assertEqual(vol3.order(direction=1), 5)
        self.assertEqual(vol3.order(direction=2), 5)
        vol4 = vol.get_derivative_spline(2)
        self.assertEqual(vol4.order(direction=0), 5)
        self.assertEqual(vol4.order(direction=1), 6)
        self.assertEqual(vol4.order(direction=2), 4)

        u = np.linspace(vol.start(0), vol.end(0), 5)
        v = np.linspace(vol.start(1), vol.end(1), 5)
        w = np.linspace(vol.start(2), vol.end(2), 5)
        du = vol.derivative(u, v, w, d=(1, 0, 0))
        du2 = vol2(u, v, w)
        dv = vol.derivative(u, v, w, d=(0, 1, 0))
        dv2 = vol3(u, v, w)
        dw = vol.derivative(u, v, w, d=(0, 0, 1))
        dw2 = vol4(u, v, w)
        self.assertAlmostEqual(float(np.linalg.norm(du - du2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dv - dv2)), 0.0)
        self.assertAlmostEqual(float(np.linalg.norm(dw - dw2)), 0.0)


if __name__ == "__main__":
    unittest.main()
